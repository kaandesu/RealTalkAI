import Ih from"./pdyh3qub.js";import{_ as Q1}from"./D2CgKfx7.js";import{_ as bo}from"./miWxzsKK.js";import{x as Wa,_ as ua,a3 as q1,a4 as J1,A as Kf,a5 as Z1,a6 as K1,a7 as $1,b as eA,a8 as tA,a9 as rA,aa as nA,ab as iA,ac as aA,ad as oA,ae as sA,af as lA,ag as cA,e as uA,ah as hA,ai as dA,aj as fA,ak as pA}from"./BsDVLhZ1.js";import{m as Dn,C as Eo,o as fr,q as Zr,w as qt,z as qn,D as ha,u as dt,c as ki,a as Fn,b as Tr,A as ja,B as Xa,G as $f,s as Cl,ab as nu,F as Lh,x as Rh,p as ca,v as ji,t as _a,d as Os,ac as Zf,ad as qo,ae as ep,af as vA,ag as mA,g as gA,I as tp,ah as yA,r as AA}from"./B-iXTKfC.js";import{a as Ph,_ as Dh}from"./DLE3387w.js";import{u as bA}from"./DgY4ePJ0.js";import{v as EA,m as wA,g as xA,u as rp}from"./iWOE2xFU.js";import{c as MA}from"./BdIJGPv1.js";import{b as TA,c as SA,a as _A,_ as CA}from"./DWt9d0eE.js";import{u as LA}from"./Dctg8YXp.js";import"./B-R_g041.js";import"./Du8QBjfq.js";import"./DlAUqK2U.js";import"./CPL_NvQu.js";function np(yt,ht){for(var M=0;M<ht.length;M++){const N=ht[M];if(typeof N!="string"&&!Array.isArray(N)){for(const $ in N)if($!=="default"&&!($ in yt)){const l=Object.getOwnPropertyDescriptor(N,$);l&&Object.defineProperty(yt,$,l.get?l:{enumerable:!0,get:()=>N[$]})}}}return Object.freeze(Object.defineProperty(yt,Symbol.toStringTag,{value:"Module"}))}const RA=Dn({__name:"Command",props:{modelValue:{default:""},defaultValue:{},open:{type:Boolean,default:!0},defaultOpen:{type:Boolean},searchTerm:{},selectedValue:{},multiple:{type:Boolean},disabled:{type:Boolean},name:{},dir:{},filterFunction:{},displayValue:{},resetSearchTermOnBlur:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue","update:open","update:searchTerm","update:selectedValue"],setup(yt,{emit:ht}){const M=yt,N=ht,$=Eo(()=>{const{class:w,...A}=M;return A}),l=Wa($,N);return(w,A)=>(fr(),Zr(dt(q1),ha(dt(l),{class:("cn"in w?w.cn:dt(ua))("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",M.class)}),{default:qt(()=>[qn(w.$slots,"default")]),_:3},16,["class"]))}});function PA(yt,ht){return fr(),ki("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[Fn("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z",fill:"currentColor"})])}const DA=Dn({__name:"CommandEmpty",props:{asChild:{type:Boolean},as:{},class:{}},setup(yt){const ht=yt,M=Eo(()=>{const{class:N,...$}=ht;return $});return(N,$)=>(fr(),Zr(dt(J1),ha(M.value,{class:("cn"in N?N.cn:dt(ua))("py-6 text-center text-sm",ht.class)}),{default:qt(()=>[qn(N.$slots,"default")]),_:3},16,["class"]))}}),OA={class:"flex items-center border-b px-3","cmdk-input-wrapper":""},IA=Dn({inheritAttrs:!1,__name:"CommandInput",props:{type:{},disabled:{type:Boolean},autoFocus:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(yt){const ht=yt,M=Eo(()=>{const{class:$,...l}=ht;return l}),N=Kf(M);return($,l)=>(fr(),ki("div",OA,[Tr(dt(PA),{class:"mr-2 h-4 w-4 shrink-0 opacity-50"}),Tr(dt(Z1),ha({...dt(N),...$.$attrs},{"auto-focus":"",class:("cn"in $?$.cn:dt(ua))("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",ht.class)}),null,16,["class"])]))}}),BA=Dn({__name:"CommandItem",props:{value:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["select"],setup(yt,{emit:ht}){const M=yt,N=ht,$=Eo(()=>{const{class:w,...A}=M;return A}),l=Wa($,N);return(w,A)=>(fr(),Zr(dt(K1),ha(dt(l),{class:("cn"in w?w.cn:dt(ua))("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled]:pointer-events-none data-[highlighted]:bg-accent data-[highlighted]:text-accent-foreground data-[disabled]:opacity-50",M.class)}),{default:qt(()=>[qn(w.$slots,"default")]),_:3},16,["class"]))}}),FA={role:"presentation"},NA=Dn({__name:"CommandList",props:{forceMount:{type:Boolean},position:{},bodyLock:{type:Boolean},dismissable:{type:Boolean,default:!1},side:{},sideOffset:{},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},disableOutsidePointerEvents:{type:Boolean},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside"],setup(yt,{emit:ht}){const M=yt,N=ht,$=Eo(()=>{const{class:w,...A}=M;return A}),l=Wa($,N);return(w,A)=>(fr(),Zr(dt($1),ha(dt(l),{class:("cn"in w?w.cn:dt(ua))("max-h-[300px] overflow-y-auto overflow-x-hidden",M.class)}),{default:qt(()=>[Fn("div",FA,[qn(w.$slots,"default")])]),_:3},16,["class"]))}}),kA=Dn({__name:"Drawer",props:{activeSnapPoint:{},closeThreshold:{},shouldScaleBackground:{type:Boolean,default:!0},scrollLockTimeout:{},fixed:{type:Boolean},dismissible:{type:Boolean},modal:{type:Boolean},open:{type:Boolean},defaultOpen:{type:Boolean},nested:{type:Boolean},direction:{},snapPoints:{},fadeFromIndex:{}},emits:["drag","release","close","update:open","update:activeSnapPoint"],setup(yt,{emit:ht}){const $=Wa(yt,ht);return(l,w)=>(fr(),Zr(dt(EA),ja(Xa(dt($))),{default:qt(()=>[qn(l.$slots,"default")]),_:3},16))}}),UA=Dn({__name:"DrawerOverlay",props:{forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(yt){const ht=yt,M=Eo(()=>{const{class:N,...$}=ht;return $});return(N,$)=>(fr(),Zr(dt(wA),ha(M.value,{class:("cn"in N?N.cn:dt(ua))("fixed inset-0 z-50 bg-black/80",ht.class)}),null,16,["class"]))}}),HA=Dn({__name:"DrawerContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(yt,{emit:ht}){const M=yt,$=Wa(M,ht);return(l,w)=>(fr(),Zr(dt(eA),null,{default:qt(()=>[Tr(UA),Tr(dt(xA),ha(dt($),{class:("cn"in l?l.cn:dt(ua))("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",M.class)}),{default:qt(()=>[w[0]||(w[0]=Fn("div",{class:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"},null,-1)),qn(l.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),Oh=Dn({__name:"AvatarFallback",props:{delayMs:{},asChild:{type:Boolean},as:{}},setup(yt){const ht=yt;return(M,N)=>(fr(),Zr(dt(tA),ja(Xa(ht)),{default:qt(()=>[qn(M.$slots,"default")]),_:3},16))}}),GA=Dn({__name:"Collapsible",props:{defaultOpen:{type:Boolean},open:{type:Boolean},disabled:{type:Boolean},asChild:{type:Boolean},as:{}},emits:["update:open"],setup(yt,{emit:ht}){const $=Wa(yt,ht);return(l,w)=>(fr(),Zr(dt(rA),ja(Xa(dt($))),{default:qt(({open:A})=>[qn(l.$slots,"default",{open:A})]),_:3},16))}}),VA=Dn({__name:"CollapsibleTrigger",props:{asChild:{type:Boolean},as:{}},setup(yt){const ht=yt;return(M,N)=>(fr(),Zr(dt(nA),ja(Xa(ht)),{default:qt(()=>[qn(M.$slots,"default")]),_:3},16))}}),zA=Dn({__name:"CollapsibleContent",props:{forceMount:{type:Boolean},asChild:{type:Boolean},as:{}},setup(yt){const ht=yt;return(M,N)=>(fr(),Zr(dt(iA),ha(ht,{class:"overflow-hidden transition-all data-[state=closed]:animate-collapsible-up data-[state=open]:animate-collapsible-down"}),{default:qt(()=>[qn(M.$slots,"default")]),_:3},16))}}),WA=Dn({__name:"Tooltip",props:{defaultOpen:{type:Boolean},open:{type:Boolean},delayDuration:{},disableHoverableContent:{type:Boolean},disableClosingTrigger:{type:Boolean},disabled:{type:Boolean},ignoreNonKeyboardFocus:{type:Boolean}},emits:["update:open"],setup(yt,{emit:ht}){const $=Wa(yt,ht);return(l,w)=>(fr(),Zr(dt(aA),ja(Xa(dt($))),{default:qt(()=>[qn(l.$slots,"default")]),_:3},16))}}),jA=Dn({inheritAttrs:!1,__name:"TooltipContent",props:{forceMount:{type:Boolean},ariaLabel:{},asChild:{type:Boolean},as:{},side:{},sideOffset:{default:4},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},class:{}},emits:["escapeKeyDown","pointerDownOutside"],setup(yt,{emit:ht}){const M=yt,N=ht,$=Eo(()=>{const{class:w,...A}=M;return A}),l=Wa($,N);return(w,A)=>(fr(),Zr(dt(sA),null,{default:qt(()=>[Tr(dt(oA),ha({...dt(l),...w.$attrs},{class:("cn"in w?w.cn:dt(ua))("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",M.class)}),{default:qt(()=>[qn(w.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),XA=Dn({__name:"TooltipTrigger",props:{asChild:{type:Boolean},as:{}},setup(yt){const ht=yt;return(M,N)=>(fr(),Zr(dt(lA),ja(Xa(ht)),{default:qt(()=>[qn(M.$slots,"default")]),_:3},16))}}),YA=Dn({__name:"TooltipProvider",props:{delayDuration:{},skipDelayDuration:{},disableHoverableContent:{type:Boolean},disableClosingTrigger:{type:Boolean},disabled:{type:Boolean},ignoreNonKeyboardFocus:{type:Boolean}},setup(yt){const ht=yt;return(M,N)=>(fr(),Zr(dt(cA),ja(Xa(ht)),{default:qt(()=>[qn(M.$slots,"default")]),_:3},16))}}),QA={class:"overflow-y-auto overflow-x-hidden dark:[color-scheme:dark]"},qA=["id"],JA={class:"flex items-center justify-start gap-2"},ZA={key:1,class:"text-xs"},KA={key:1,class:"text-xs font-light"},$A=Dn({__name:"nav",props:{pages:{},pagesModifiers:{},collapsed:{type:Boolean},collapsedModifiers:{}},emits:["update:pages","update:collapsed"],setup(yt){const ht=$f(),{currentPageInfo:M,navState:N}=Cl(ht),$=nu(yt,"pages"),l=nu(yt,"collapsed"),w=async A=>{if(A.action){await A.action(),N.value.open=!1;return}if(A.sub)l.value=!1;else{await ht.navigatePage(A),N.value.open=!1;return}A.isCollapsed=l.value?!1:!A.isCollapsed};return(A,E)=>{const d=Ih,v=Q1;return fr(),ki("nav",QA,[(fr(!0),ki(Lh,null,Rh($.value,f=>(fr(),ki("div",{id:`tour-${f.uid}`},[f.hideMobile===!0&&!A.$viewport.isGreaterOrEquals("md")?ji("",!0):(fr(),Zr(dt(YA),{key:0,disabled:!l.value,"delay-duration":150},{default:qt(()=>[Tr(dt(WA),null,{default:qt(()=>[Tr(dt(XA),{"as-child":""},{default:qt(()=>[Tr(dt(GA),{open:!f.isCollapsed,class:"w-full"},{default:qt(()=>{var m;return[Tr(dt(bo),{variant:"ghost",class:ca(["flex h-6 w-[90%] items-center justify-between space-x-4 px-4 font-normal",((m=dt(M))==null?void 0:m.uid)===f.uid?"bg-accent":""]),onClick:u=>w(f)},{default:qt(()=>[Tr(dt(VA),{"as-child":""},{default:qt(()=>[Fn("div",JA,[f.icon?(fr(),Zr(d,{key:0,class:"text-[1.125rem]",name:f.icon},null,8,["name"])):ji("",!0),l.value?ji("",!0):(fr(),ki("div",ZA,_a(A.$t(f.title??"")),1))]),f.sub&&!l.value?(fr(),Zr(dt(bo),{key:0,variant:"ghost",size:"sm",class:"w-9 p-0"},{default:qt(()=>[Tr(d,{name:"line-md:chevron-right",class:ca(["h-4 w-4 rotate-90 transition-transform",f.isCollapsed?"rotate-90":"rotate-[-90deg]"])},null,8,["class"]),E[0]||(E[0]=Fn("span",{class:"sr-only"},"Toggle",-1))]),_:2},1024)):ji("",!0)]),_:2},1024)]),_:2},1032,["class","onClick"]),l.value?ji("",!0):(fr(),Zr(dt(zA),{key:0,class:"flex flex-col items-baseline space-y-1"},{default:qt(()=>[(fr(!0),ki(Lh,null,Rh(f.sub,u=>{var b;return fr(),Zr(dt(bo),{onClick:g=>w(u),variant:"ghost",key:u.title,class:ca(["ml-4 flex h-5 w-full items-center justify-start gap-2 border-l-2 border-current",((b=dt(M))==null?void 0:b.uid)===u.uid?"bg-accent":""])},{default:qt(()=>[u.icon?(fr(),Zr(d,{key:0,class:"text-[1.125rem]",name:u.icon},null,8,["name"])):ji("",!0),l.value?ji("",!0):(fr(),ki("div",KA,_a(u.title),1))]),_:2},1032,["onClick","class"])}),128))]),_:2},1024))]}),_:2},1032,["open"]),f.sidebarSeperator==!0?(fr(),Zr(v,{key:0,label:"",class:"pointer-events-none mb-2 mt-2"})):ji("",!0)]),_:2},1024),Tr(dt(jA),{side:"right",class:"pointer-events-none"},{default:qt(()=>[Os(_a(f.title),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["disabled"]))],8,qA))),256))])}}}),eb={__name:"layout",props:{fadedBelow:{type:Boolean,default:!1},fixedHeight:{type:Boolean,default:!1}},setup(yt){return(ht,M)=>(fr(),ki("div",ha({class:["relative flex h-full w-full flex-col",yt.fadedBelow&&"after:pointer-events-none after:absolute after:bottom-0 after:left-0 after:hidden after:h-32 after:w-full after:bg-[linear-gradient(180deg,_transparent_10%,_hsl(var(--background))_70%)] after:md:block",yt.fixedHeight&&"md:h-svh",ht.$attrs.class]},ht.$attrs),[qn(ht.$slots,"default")],16))}};function Ds(yt){return Zf.find(ht=>ht.uid===yt)??Zf[0]}function tb(yt,ht="left"){const M=yt.actions,N=yt.ids.map(A=>document.getElementById(`tour-${A}`)),$={attachTo:{element:N[0],on:ht},title:Ds(yt.ids[0]).title,text:Ds(yt.ids[0]).tourDesc??"",buttons:[{action(){return M.complete()},secondary:!0,text:qo.skip},{action(){return M.next()},text:qo.next}]},l=N.slice(1,-1).map((A,E)=>({attachTo:{element:A,on:ht},title:Ds(yt.ids[E+1]).title,text:Ds(yt.ids[E+1]).tourDesc??"",buttons:[{action(){return M.complete()},secondary:!0,text:qo.skip},{action(){return M.back()},secondary:!0,text:qo.back},{action(){return M.next()},text:qo.next}]})),w={attachTo:{element:N[N.length-1],on:ht},title:Ds(yt.ids[N.length-1]).title,text:Ds(yt.ids[N.length-1]).tourDesc??"",buttons:[{action(){return M.back()},secondary:!0,text:qo.back},{action(){return M.complete()},text:qo.exit}]};return[$,...l,w]}const rb=()=>tb(Cl(ep()).tours.value.sidebar),nb={sidebarTourSetup:rb};function ib(yt,ht=[],M=!1,N=1e3){const $=Cl(ep()).tours.value[yt].actions;return ht.length!==0&&($.flushSteps(),$.addSteps(ht)),vA(mA[yt].key).value!==!0&&M&&setTimeout(()=>{$.start()},N),$.start}const ab={class:"sticky top-0 flex flex-none items-center justify-between bg-background p-4 px-4 py-3 shadow"},ob={class:"font-medium"},sb={class:"text-xs"},lb=Dn({__name:"sidebar",props:{open:{type:Boolean},openModifiers:{},collapsed:{type:Boolean},collapsedModifiers:{}},emits:["update:open","update:collapsed"],setup(yt){const ht=bA(),M=nu(yt,"open"),N=nu(yt,"collapsed"),$=rp();return gA($.breakpoint,(l,w)=>{l=="sm"&&w=="md"&&(N.value=!1)}),tp(()=>{$.isGreaterOrEquals("tablet")&&ib("sidebar",nb.sidebarTourSetup(),!0)}),(l,w)=>{const A=Ih,E=$A,d=eb;return fr(),ki("aside",{class:ca(["md:h-]svh fixed left-0 right-0 top-0 z-50 w-full border-r-2 border-r-muted transition-[width] md:bottom-0 md:right-auto",,N.value?"md:w-14":"md:w-60"])},[Tr(d,null,{default:qt(()=>[Fn("section",ab,[Fn("div",{class:ca(["flex items-center",N.value?"":"gap-2"])},[Tr(dt(Ph),{class:ca(["transition-all",N.value?"h-6 w-6":"h-8 w-8"])},{default:qt(()=>[dt(ht).sidebar.logo?(fr(),Zr(dt(Dh),{key:0,src:dt(ht).sidebar.logo,alt:"logo"},null,8,["src"])):ji("",!0),dt(ht).sidebar.logoFallback?(fr(),Zr(dt(Oh),{key:1},{default:qt(()=>[Os(_a(dt(ht).sidebar.logoFallback),1)]),_:1})):ji("",!0)]),_:1},8,["class"]),Fn("div",{class:ca(["ml-3 flex flex-col justify-end truncate",N.value?"invisible w-0":"visible w-auto"])},[Fn("span",ob,_a(l.$t(dt(ht).sidebar.title??"")),1),Fn("span",sb,_a(dt(ht).sidebar.desc),1)],2)],2),Tr(dt(bo),{variant:"ghost",size:"icon",class:"md:hidden","aria-label":"Toggle Navigation","aria-controls":"dashboard-menu","aria-expanded":M.value.toString(),onClick:w[0]||(w[0]=v=>M.value=!M.value)},{default:qt(()=>[M.value?(fr(),Zr(A,{key:1,size:"1.5rem",name:"line-md:close"})):(fr(),Zr(A,{key:0,size:"1.5rem",name:"line-md:close-to-menu-alt-transition"}))]),_:1},8,["aria-expanded"])]),Tr(E,{id:"dashboard-menu",class:ca(("cn"in l?l.cn:dt(ua))("h-full flex-1 overflow-y-auto overflow-x-hidden bg-white transition-[max-height] dark:bg-[#0A0A0A]",M.value?"max-h-screen":"max-h-1 overflow-hidden py-0 md:max-h-screen md:py-2")),collapsed:N.value,"onUpdate:collapsed":w[1]||(w[1]=v=>N.value=v),pages:dt(ht).sidebar.pages,"onUpdate:pages":w[2]||(w[2]=v=>dt(ht).sidebar.pages=v)},null,8,["class","collapsed","pages"]),Tr(dt(bo),{onClick:w[3]||(w[3]=v=>N.value=!N.value),size:"icon",variant:"outline",class:"absolute -right-5 top-1/2 hidden rounded-full md:inline-flex"},{default:qt(()=>[(fr(),Zr(A,{size:"1.25rem",key:`${N.value}`,name:N.value?"line-md:chevron-small-double-right":"line-md:chevron-small-double-left"},null,8,["name"]))]),_:1})]),_:1})],2)}}}),cb={class:"flex items-center space-x-4"},ub={class:"mt-4 border-t"},hb=Dn({__name:"lang-select",setup(yt){const{locale:ht,locales:M,setLocale:N}=yA(),[$,l]=MA(),w=rp(),A=AA(!1);function E(d){N(d),A.value=!1}return(d,v)=>{const f=Ih;return fr(),ki("div",cb,[Tr(dt($),null,{default:qt(()=>[Tr(dt(RA),null,{default:qt(()=>[Tr(dt(IA),{class:"h-4",placeholder:"Search..."}),Tr(dt(NA),null,{default:qt(()=>[Tr(dt(DA),null,{default:qt(()=>v[2]||(v[2]=[Os("No results found.")])),_:1}),(fr(!0),ki(Lh,null,Rh(dt(M),m=>(fr(),Zr(dt(BA),{class:ca(dt(ht)==m.code?"bg-accent":""),key:m.code,value:m.name,onSelect:u=>E(m.code)},{default:qt(()=>[Tr(f,{class:"mr-2",name:`circle-flags:${m.code}`},null,8,["name"]),Os(" "+_a(m.name)+" ",1),Tr(f,{name:"line-md:confirm",class:ca(("cn"in d?d.cn:dt(ua))("ml-auto h-4 w-4",dt(ht)==m.code?"opacity-100":"opacity-0"))},null,8,["class"])]),_:2},1032,["class","value","onSelect"]))),128))]),_:1})]),_:1})]),_:1}),dt(w).isGreaterOrEquals("md")?(fr(),Zr(dt(_A),{key:0,open:A.value,"onUpdate:open":v[0]||(v[0]=m=>A.value=m)},{default:qt(()=>[Tr(dt(TA),{"as-child":""},{default:qt(()=>[Tr(dt(bo),{variant:"ghost",class:"relative rounded-full",size:"icon"},{default:qt(()=>[Tr(f,{size:"1.2rem",name:`circle-flags:${dt(ht)}`},null,8,["name"])]),_:1})]),_:1}),Tr(dt(SA),{class:"w-32 p-0",align:"start"},{default:qt(()=>[Tr(dt(l))]),_:1})]),_:1},8,["open"])):(fr(),Zr(dt(kA),{key:1,open:A.value,"onUpdate:open":v[1]||(v[1]=m=>A.value=m)},{default:qt(()=>[Tr(dt(uA),{"as-child":""},{default:qt(()=>[Tr(dt(bo),{variant:"outline",class:"relative rounded-full",size:"icon"},{default:qt(()=>[Tr(f,{size:"1.2rem",name:`circle-flags:${dt(ht)}`},null,8,["name"])]),_:1})]),_:1}),Tr(dt(HA),null,{default:qt(()=>[Fn("div",ub,[Tr(dt(l))])]),_:1})]),_:1},8,["open"]))])}}}),db=Dn({__name:"HoverCard",props:{defaultOpen:{type:Boolean},open:{type:Boolean},openDelay:{},closeDelay:{}},emits:["update:open"],setup(yt,{emit:ht}){const $=Wa(yt,ht);return(l,w)=>(fr(),Zr(dt(hA),ja(Xa(dt($))),{default:qt(()=>[qn(l.$slots,"default")]),_:3},16))}}),fb=Dn({__name:"HoverCardTrigger",props:{asChild:{type:Boolean},as:{}},setup(yt){const ht=yt;return(M,N)=>(fr(),Zr(dt(dA),ja(Xa(ht)),{default:qt(()=>[qn(M.$slots,"default")]),_:3},16))}}),pb=Dn({__name:"HoverCardContent",props:{forceMount:{type:Boolean},side:{},sideOffset:{default:4},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(yt){const ht=yt,M=Eo(()=>{const{class:$,...l}=ht;return l}),N=Kf(M);return($,l)=>(fr(),Zr(dt(pA),null,{default:qt(()=>[Tr(dt(fA),ha(dt(N),{class:("cn"in $?$.cn:dt(ua))("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",ht.class)}),{default:qt(()=>[qn($.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),vb={class:"flex justify-between space-x-4"},mb={class:"space-y-1"},gb={class:"text-sm font-semibold"},yb=Dn({__name:"profile-button",setup(yt){const ht=LA(),{account:M}=Cl(ht);return(N,$)=>(fr(),Zr(dt(db),null,{default:qt(()=>[Tr(dt(fb),{"as-child":""},{default:qt(()=>[Tr(dt(bo),{size:"icon",class:"rounded-full",variant:"ghost"},{default:qt(()=>[Tr(dt(Ph),null,{default:qt(()=>[Tr(dt(Dh),{src:dt(M).avatar},null,8,["src"]),dt(M).avatarFallback?(fr(),Zr(dt(Oh),{key:0},{default:qt(()=>[Os(_a(dt(M).avatarFallback),1)]),_:1})):ji("",!0)]),_:1})]),_:1})]),_:1}),Tr(dt(pb),null,{default:qt(()=>[Fn("div",vb,[Tr(dt(Ph),null,{default:qt(()=>[Tr(dt(Dh),{src:dt(M).avatar},null,8,["src"]),dt(M).avatarFallback?(fr(),Zr(dt(Oh),{key:0},{default:qt(()=>[Os(_a(dt(M).avatarFallback),1)]),_:1})):ji("",!0)]),_:1}),Fn("div",mb,[Fn("h4",gb,_a(dt(M).displayName),1),$[0]||($[0]=Fn("p",{class:"text-sm"}," Lorem ipsum dolor sit, amet consectetur adipisicing non. ",-1)),$[1]||($[1]=Fn("div",{class:"flex items-center pt-2"},[Fn("span",{class:"text-xs text-muted-foreground"}," Joined June 2024 ")],-1))])])]),_:1})]),_:1}))}});var Sa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ip(yt){return yt&&yt.__esModule&&Object.prototype.hasOwnProperty.call(yt,"default")?yt.default:yt}function ru(yt){throw new Error('Could not dynamically require "'+yt+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ap={exports:{}};(function(yt,ht){(function(M){yt.exports=M()})(function(){return function(){function M(N,$,l){function w(d,v){if(!$[d]){if(!N[d]){var f=typeof ru=="function"&&ru;if(!v&&f)return f(d,!0);if(A)return A(d,!0);var m=new Error("Cannot find module '"+d+"'");throw m.code="MODULE_NOT_FOUND",m}var u=$[d]={exports:{}};N[d][0].call(u.exports,function(b){var g=N[d][1][b];return w(g||b)},u,u.exports,M,N,$,l)}return $[d].exports}for(var A=typeof ru=="function"&&ru,E=0;E<l.length;E++)w(l[E]);return w}return M}()({1:[function(M,N,$){var l=Object.prototype.toString;N.exports=w;function w(A){return A.BYTES_PER_ELEMENT&&l.call(A.buffer)==="[object ArrayBuffer]"||Array.isArray(A)}},{}],2:[function(M,N,$){N.exports=function(w,A){return typeof w=="number"?w:typeof A=="number"?A:0}},{}],3:[function(M,N,$){$.byteLength=m,$.toByteArray=b,$.fromByteArray=x;for(var l=[],w=[],A=typeof Uint8Array<"u"?Uint8Array:Array,E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,v=E.length;d<v;++d)l[d]=E[d],w[E.charCodeAt(d)]=d;w[45]=62,w[95]=63;function f(L){var T=L.length;if(T%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var R=L.indexOf("=");R===-1&&(R=T);var O=R===T?0:4-R%4;return[R,O]}function m(L){var T=f(L),R=T[0],O=T[1];return(R+O)*3/4-O}function u(L,T,R){return(T+R)*3/4-R}function b(L){for(var T,R=f(L),O=R[0],F=R[1],z=new A(u(L,O,F)),re=0,Y=F>0?O-4:O,ee=0;ee<Y;ee+=4)T=w[L.charCodeAt(ee)]<<18|w[L.charCodeAt(ee+1)]<<12|w[L.charCodeAt(ee+2)]<<6|w[L.charCodeAt(ee+3)],z[re++]=T>>16&255,z[re++]=T>>8&255,z[re++]=T&255;return F===2&&(T=w[L.charCodeAt(ee)]<<2|w[L.charCodeAt(ee+1)]>>4,z[re++]=T&255),F===1&&(T=w[L.charCodeAt(ee)]<<10|w[L.charCodeAt(ee+1)]<<4|w[L.charCodeAt(ee+2)]>>2,z[re++]=T>>8&255,z[re++]=T&255),z}function g(L){return l[L>>18&63]+l[L>>12&63]+l[L>>6&63]+l[L&63]}function y(L,T,R){for(var O,F=[],z=T;z<R;z+=3)O=(L[z]<<16&16711680)+(L[z+1]<<8&65280)+(L[z+2]&255),F.push(g(O));return F.join("")}function x(L){for(var T,R=L.length,O=R%3,F=[],z=16383,re=0,Y=R-O;re<Y;re+=z)F.push(y(L,re,re+z>Y?Y:re+z));return O===1?(T=L[R-1],F.push(l[T>>2]+l[T<<4&63]+"==")):O===2&&(T=(L[R-2]<<8)+L[R-1],F.push(l[T>>10]+l[T>>4&63]+l[T<<2&63]+"=")),F.join("")}},{}],4:[function(M,N,$){N.exports={createLink:function(l,w){var A=document.head||document.getElementsByTagName("head")[0],E=document.createElement("link");E.href=l,E.rel="stylesheet";for(var d in w)if(w.hasOwnProperty(d)){var v=w[d];E.setAttribute("data-"+d,v)}A.appendChild(E)},createStyle:function(l,w){var A=document.head||document.getElementsByTagName("head")[0],E=document.createElement("style");E.type="text/css";for(var d in w)if(w.hasOwnProperty(d)){var v=w[d];E.setAttribute("data-"+d,v)}E.sheet?(E.innerHTML=l,E.sheet.cssText=l,A.appendChild(E)):E.styleSheet?(A.appendChild(E),E.styleSheet.cssText=l):(E.appendChild(document.createTextNode(l)),A.appendChild(E))}}},{}],5:[function(M,N,$){var l=M("buffer").Buffer;N.exports=function(w,A){if(l.isBuffer(w)&&l.isBuffer(A)){if(typeof w.equals=="function")return w.equals(A);if(w.length!==A.length)return!1;for(var E=0;E<w.length;E++)if(w[E]!==A[E])return!1;return!0}}},{buffer:6}],6:[function(M,N,$){(function(l,u){var A=M("base64-js"),E=M("ieee754"),d=M("isarray");$.Buffer=u,$.SlowBuffer=z,$.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=l.TYPED_ARRAY_SUPPORT!==void 0?l.TYPED_ARRAY_SUPPORT:v(),$.kMaxLength=f();function v(){try{var ne=new Uint8Array(1);return ne.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},ne.foo()===42&&typeof ne.subarray=="function"&&ne.subarray(1,1).byteLength===0}catch{return!1}}function f(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function m(ne,U){if(f()<U)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(ne=new Uint8Array(U),ne.__proto__=u.prototype):(ne===null&&(ne=new u(U)),ne.length=U),ne}function u(ne,U,V){if(!u.TYPED_ARRAY_SUPPORT&&!(this instanceof u))return new u(ne,U,V);if(typeof ne=="number"){if(typeof U=="string")throw new Error("If encoding is specified then the first argument must be a string");return x(this,ne)}return b(this,ne,U,V)}u.poolSize=8192,u._augment=function(ne){return ne.__proto__=u.prototype,ne};function b(ne,U,V,ue){if(typeof U=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&U instanceof ArrayBuffer?R(ne,U,V,ue):typeof U=="string"?L(ne,U,V):O(ne,U)}u.from=function(ne,U,V){return b(null,ne,U,V)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0}));function g(ne){if(typeof ne!="number")throw new TypeError('"size" argument must be a number');if(ne<0)throw new RangeError('"size" argument must not be negative')}function y(ne,U,V,ue){return g(U),U<=0?m(ne,U):V!==void 0?typeof ue=="string"?m(ne,U).fill(V,ue):m(ne,U).fill(V):m(ne,U)}u.alloc=function(ne,U,V){return y(null,ne,U,V)};function x(ne,U){if(g(U),ne=m(ne,U<0?0:F(U)|0),!u.TYPED_ARRAY_SUPPORT)for(var V=0;V<U;++V)ne[V]=0;return ne}u.allocUnsafe=function(ne){return x(null,ne)},u.allocUnsafeSlow=function(ne){return x(null,ne)};function L(ne,U,V){if((typeof V!="string"||V==="")&&(V="utf8"),!u.isEncoding(V))throw new TypeError('"encoding" must be a valid string encoding');var ue=re(U,V)|0;ne=m(ne,ue);var De=ne.write(U,V);return De!==ue&&(ne=ne.slice(0,De)),ne}function T(ne,U){var V=U.length<0?0:F(U.length)|0;ne=m(ne,V);for(var ue=0;ue<V;ue+=1)ne[ue]=U[ue]&255;return ne}function R(ne,U,V,ue){if(U.byteLength,V<0||U.byteLength<V)throw new RangeError("'offset' is out of bounds");if(U.byteLength<V+(ue||0))throw new RangeError("'length' is out of bounds");return V===void 0&&ue===void 0?U=new Uint8Array(U):ue===void 0?U=new Uint8Array(U,V):U=new Uint8Array(U,V,ue),u.TYPED_ARRAY_SUPPORT?(ne=U,ne.__proto__=u.prototype):ne=T(ne,U),ne}function O(ne,U){if(u.isBuffer(U)){var V=F(U.length)|0;return ne=m(ne,V),ne.length===0||U.copy(ne,0,0,V),ne}if(U){if(typeof ArrayBuffer<"u"&&U.buffer instanceof ArrayBuffer||"length"in U)return typeof U.length!="number"||xt(U.length)?m(ne,0):T(ne,U);if(U.type==="Buffer"&&d(U.data))return T(ne,U.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function F(ne){if(ne>=f())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f().toString(16)+" bytes");return ne|0}function z(ne){return+ne!=ne&&(ne=0),u.alloc(+ne)}u.isBuffer=function(U){return!!(U!=null&&U._isBuffer)},u.compare=function(U,V){if(!u.isBuffer(U)||!u.isBuffer(V))throw new TypeError("Arguments must be Buffers");if(U===V)return 0;for(var ue=U.length,De=V.length,Je=0,tt=Math.min(ue,De);Je<tt;++Je)if(U[Je]!==V[Je]){ue=U[Je],De=V[Je];break}return ue<De?-1:De<ue?1:0},u.isEncoding=function(U){switch(String(U).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(U,V){if(!d(U))throw new TypeError('"list" argument must be an Array of Buffers');if(U.length===0)return u.alloc(0);var ue;if(V===void 0)for(V=0,ue=0;ue<U.length;++ue)V+=U[ue].length;var De=u.allocUnsafe(V),Je=0;for(ue=0;ue<U.length;++ue){var tt=U[ue];if(!u.isBuffer(tt))throw new TypeError('"list" argument must be an Array of Buffers');tt.copy(De,Je),Je+=tt.length}return De};function re(ne,U){if(u.isBuffer(ne))return ne.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(ne)||ne instanceof ArrayBuffer))return ne.byteLength;typeof ne!="string"&&(ne=""+ne);var V=ne.length;if(V===0)return 0;for(var ue=!1;;)switch(U){case"ascii":case"latin1":case"binary":return V;case"utf8":case"utf-8":case void 0:return Fe(ne).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V*2;case"hex":return V>>>1;case"base64":return ct(ne).length;default:if(ue)return Fe(ne).length;U=(""+U).toLowerCase(),ue=!0}}u.byteLength=re;function Y(ne,U,V){var ue=!1;if((U===void 0||U<0)&&(U=0),U>this.length||((V===void 0||V>this.length)&&(V=this.length),V<=0)||(V>>>=0,U>>>=0,V<=U))return"";for(ne||(ne="utf8");;)switch(ne){case"hex":return nr(this,U,V);case"utf8":case"utf-8":return it(this,U,V);case"ascii":return Rt(this,U,V);case"latin1":case"binary":return Wt(this,U,V);case"base64":return ke(this,U,V);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Dr(this,U,V);default:if(ue)throw new TypeError("Unknown encoding: "+ne);ne=(ne+"").toLowerCase(),ue=!0}}u.prototype._isBuffer=!0;function ee(ne,U,V){var ue=ne[U];ne[U]=ne[V],ne[V]=ue}u.prototype.swap16=function(){var U=this.length;if(U%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var V=0;V<U;V+=2)ee(this,V,V+1);return this},u.prototype.swap32=function(){var U=this.length;if(U%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var V=0;V<U;V+=4)ee(this,V,V+3),ee(this,V+1,V+2);return this},u.prototype.swap64=function(){var U=this.length;if(U%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var V=0;V<U;V+=8)ee(this,V,V+7),ee(this,V+1,V+6),ee(this,V+2,V+5),ee(this,V+3,V+4);return this},u.prototype.toString=function(){var U=this.length|0;return U===0?"":arguments.length===0?it(this,0,U):Y.apply(this,arguments)},u.prototype.equals=function(U){if(!u.isBuffer(U))throw new TypeError("Argument must be a Buffer");return this===U?!0:u.compare(this,U)===0},u.prototype.inspect=function(){var U="",V=$.INSPECT_MAX_BYTES;return this.length>0&&(U=this.toString("hex",0,V).match(/.{2}/g).join(" "),this.length>V&&(U+=" ... ")),"<Buffer "+U+">"},u.prototype.compare=function(U,V,ue,De,Je){if(!u.isBuffer(U))throw new TypeError("Argument must be a Buffer");if(V===void 0&&(V=0),ue===void 0&&(ue=U?U.length:0),De===void 0&&(De=0),Je===void 0&&(Je=this.length),V<0||ue>U.length||De<0||Je>this.length)throw new RangeError("out of range index");if(De>=Je&&V>=ue)return 0;if(De>=Je)return-1;if(V>=ue)return 1;if(V>>>=0,ue>>>=0,De>>>=0,Je>>>=0,this===U)return 0;for(var tt=Je-De,jt=ue-V,wr=Math.min(tt,jt),Ar=this.slice(De,Je),Jt=U.slice(V,ue),ir=0;ir<wr;++ir)if(Ar[ir]!==Jt[ir]){tt=Ar[ir],jt=Jt[ir];break}return tt<jt?-1:jt<tt?1:0};function J(ne,U,V,ue,De){if(ne.length===0)return-1;if(typeof V=="string"?(ue=V,V=0):V>2147483647?V=2147483647:V<-2147483648&&(V=-2147483648),V=+V,isNaN(V)&&(V=De?0:ne.length-1),V<0&&(V=ne.length+V),V>=ne.length){if(De)return-1;V=ne.length-1}else if(V<0)if(De)V=0;else return-1;if(typeof U=="string"&&(U=u.from(U,ue)),u.isBuffer(U))return U.length===0?-1:ce(ne,U,V,ue,De);if(typeof U=="number")return U=U&255,u.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?De?Uint8Array.prototype.indexOf.call(ne,U,V):Uint8Array.prototype.lastIndexOf.call(ne,U,V):ce(ne,[U],V,ue,De);throw new TypeError("val must be string, number or Buffer")}function ce(ne,U,V,ue,De){var Je=1,tt=ne.length,jt=U.length;if(ue!==void 0&&(ue=String(ue).toLowerCase(),ue==="ucs2"||ue==="ucs-2"||ue==="utf16le"||ue==="utf-16le")){if(ne.length<2||U.length<2)return-1;Je=2,tt/=2,jt/=2,V/=2}function wr(yn,Ln){return Je===1?yn[Ln]:yn.readUInt16BE(Ln*Je)}var Ar;if(De){var Jt=-1;for(Ar=V;Ar<tt;Ar++)if(wr(ne,Ar)===wr(U,Jt===-1?0:Ar-Jt)){if(Jt===-1&&(Jt=Ar),Ar-Jt+1===jt)return Jt*Je}else Jt!==-1&&(Ar-=Ar-Jt),Jt=-1}else for(V+jt>tt&&(V=tt-jt),Ar=V;Ar>=0;Ar--){for(var ir=!0,ar=0;ar<jt;ar++)if(wr(ne,Ar+ar)!==wr(U,ar)){ir=!1;break}if(ir)return Ar}return-1}u.prototype.includes=function(U,V,ue){return this.indexOf(U,V,ue)!==-1},u.prototype.indexOf=function(U,V,ue){return J(this,U,V,ue,!0)},u.prototype.lastIndexOf=function(U,V,ue){return J(this,U,V,ue,!1)};function j(ne,U,V,ue){V=Number(V)||0;var De=ne.length-V;ue?(ue=Number(ue),ue>De&&(ue=De)):ue=De;var Je=U.length;if(Je%2!==0)throw new TypeError("Invalid hex string");ue>Je/2&&(ue=Je/2);for(var tt=0;tt<ue;++tt){var jt=parseInt(U.substr(tt*2,2),16);if(isNaN(jt))return tt;ne[V+tt]=jt}return tt}function oe(ne,U,V,ue){return mt(Fe(U,ne.length-V),ne,V,ue)}function Z(ne,U,V,ue){return mt(Ye(U),ne,V,ue)}function ye(ne,U,V,ue){return Z(ne,U,V,ue)}function Ne(ne,U,V,ue){return mt(ct(U),ne,V,ue)}function je(ne,U,V,ue){return mt(ot(U,ne.length-V),ne,V,ue)}u.prototype.write=function(U,V,ue,De){if(V===void 0)De="utf8",ue=this.length,V=0;else if(ue===void 0&&typeof V=="string")De=V,ue=this.length,V=0;else if(isFinite(V))V=V|0,isFinite(ue)?(ue=ue|0,De===void 0&&(De="utf8")):(De=ue,ue=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Je=this.length-V;if((ue===void 0||ue>Je)&&(ue=Je),U.length>0&&(ue<0||V<0)||V>this.length)throw new RangeError("Attempt to write outside buffer bounds");De||(De="utf8");for(var tt=!1;;)switch(De){case"hex":return j(this,U,V,ue);case"utf8":case"utf-8":return oe(this,U,V,ue);case"ascii":return Z(this,U,V,ue);case"latin1":case"binary":return ye(this,U,V,ue);case"base64":return Ne(this,U,V,ue);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return je(this,U,V,ue);default:if(tt)throw new TypeError("Unknown encoding: "+De);De=(""+De).toLowerCase(),tt=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ke(ne,U,V){return U===0&&V===ne.length?A.fromByteArray(ne):A.fromByteArray(ne.slice(U,V))}function it(ne,U,V){V=Math.min(ne.length,V);for(var ue=[],De=U;De<V;){var Je=ne[De],tt=null,jt=Je>239?4:Je>223?3:Je>191?2:1;if(De+jt<=V){var wr,Ar,Jt,ir;switch(jt){case 1:Je<128&&(tt=Je);break;case 2:wr=ne[De+1],(wr&192)===128&&(ir=(Je&31)<<6|wr&63,ir>127&&(tt=ir));break;case 3:wr=ne[De+1],Ar=ne[De+2],(wr&192)===128&&(Ar&192)===128&&(ir=(Je&15)<<12|(wr&63)<<6|Ar&63,ir>2047&&(ir<55296||ir>57343)&&(tt=ir));break;case 4:wr=ne[De+1],Ar=ne[De+2],Jt=ne[De+3],(wr&192)===128&&(Ar&192)===128&&(Jt&192)===128&&(ir=(Je&15)<<18|(wr&63)<<12|(Ar&63)<<6|Jt&63,ir>65535&&ir<1114112&&(tt=ir))}}tt===null?(tt=65533,jt=1):tt>65535&&(tt-=65536,ue.push(tt>>>10&1023|55296),tt=56320|tt&1023),ue.push(tt),De+=jt}return Mt(ue)}var rt=4096;function Mt(ne){var U=ne.length;if(U<=rt)return String.fromCharCode.apply(String,ne);for(var V="",ue=0;ue<U;)V+=String.fromCharCode.apply(String,ne.slice(ue,ue+=rt));return V}function Rt(ne,U,V){var ue="";V=Math.min(ne.length,V);for(var De=U;De<V;++De)ue+=String.fromCharCode(ne[De]&127);return ue}function Wt(ne,U,V){var ue="";V=Math.min(ne.length,V);for(var De=U;De<V;++De)ue+=String.fromCharCode(ne[De]);return ue}function nr(ne,U,V){var ue=ne.length;(!U||U<0)&&(U=0),(!V||V<0||V>ue)&&(V=ue);for(var De="",Je=U;Je<V;++Je)De+=Oe(ne[Je]);return De}function Dr(ne,U,V){for(var ue=ne.slice(U,V),De="",Je=0;Je<ue.length;Je+=2)De+=String.fromCharCode(ue[Je]+ue[Je+1]*256);return De}u.prototype.slice=function(U,V){var ue=this.length;U=~~U,V=V===void 0?ue:~~V,U<0?(U+=ue,U<0&&(U=0)):U>ue&&(U=ue),V<0?(V+=ue,V<0&&(V=0)):V>ue&&(V=ue),V<U&&(V=U);var De;if(u.TYPED_ARRAY_SUPPORT)De=this.subarray(U,V),De.__proto__=u.prototype;else{var Je=V-U;De=new u(Je,void 0);for(var tt=0;tt<Je;++tt)De[tt]=this[tt+U]}return De};function wt(ne,U,V){if(ne%1!==0||ne<0)throw new RangeError("offset is not uint");if(ne+U>V)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUIntLE=function(U,V,ue){U=U|0,V=V|0,ue||wt(U,V,this.length);for(var De=this[U],Je=1,tt=0;++tt<V&&(Je*=256);)De+=this[U+tt]*Je;return De},u.prototype.readUIntBE=function(U,V,ue){U=U|0,V=V|0,ue||wt(U,V,this.length);for(var De=this[U+--V],Je=1;V>0&&(Je*=256);)De+=this[U+--V]*Je;return De},u.prototype.readUInt8=function(U,V){return V||wt(U,1,this.length),this[U]},u.prototype.readUInt16LE=function(U,V){return V||wt(U,2,this.length),this[U]|this[U+1]<<8},u.prototype.readUInt16BE=function(U,V){return V||wt(U,2,this.length),this[U]<<8|this[U+1]},u.prototype.readUInt32LE=function(U,V){return V||wt(U,4,this.length),(this[U]|this[U+1]<<8|this[U+2]<<16)+this[U+3]*16777216},u.prototype.readUInt32BE=function(U,V){return V||wt(U,4,this.length),this[U]*16777216+(this[U+1]<<16|this[U+2]<<8|this[U+3])},u.prototype.readIntLE=function(U,V,ue){U=U|0,V=V|0,ue||wt(U,V,this.length);for(var De=this[U],Je=1,tt=0;++tt<V&&(Je*=256);)De+=this[U+tt]*Je;return Je*=128,De>=Je&&(De-=Math.pow(2,8*V)),De},u.prototype.readIntBE=function(U,V,ue){U=U|0,V=V|0,ue||wt(U,V,this.length);for(var De=V,Je=1,tt=this[U+--De];De>0&&(Je*=256);)tt+=this[U+--De]*Je;return Je*=128,tt>=Je&&(tt-=Math.pow(2,8*V)),tt},u.prototype.readInt8=function(U,V){return V||wt(U,1,this.length),this[U]&128?(255-this[U]+1)*-1:this[U]},u.prototype.readInt16LE=function(U,V){V||wt(U,2,this.length);var ue=this[U]|this[U+1]<<8;return ue&32768?ue|4294901760:ue},u.prototype.readInt16BE=function(U,V){V||wt(U,2,this.length);var ue=this[U+1]|this[U]<<8;return ue&32768?ue|4294901760:ue},u.prototype.readInt32LE=function(U,V){return V||wt(U,4,this.length),this[U]|this[U+1]<<8|this[U+2]<<16|this[U+3]<<24},u.prototype.readInt32BE=function(U,V){return V||wt(U,4,this.length),this[U]<<24|this[U+1]<<16|this[U+2]<<8|this[U+3]},u.prototype.readFloatLE=function(U,V){return V||wt(U,4,this.length),E.read(this,U,!0,23,4)},u.prototype.readFloatBE=function(U,V){return V||wt(U,4,this.length),E.read(this,U,!1,23,4)},u.prototype.readDoubleLE=function(U,V){return V||wt(U,8,this.length),E.read(this,U,!0,52,8)},u.prototype.readDoubleBE=function(U,V){return V||wt(U,8,this.length),E.read(this,U,!1,52,8)};function yr(ne,U,V,ue,De,Je){if(!u.isBuffer(ne))throw new TypeError('"buffer" argument must be a Buffer instance');if(U>De||U<Je)throw new RangeError('"value" argument is out of bounds');if(V+ue>ne.length)throw new RangeError("Index out of range")}u.prototype.writeUIntLE=function(U,V,ue,De){if(U=+U,V=V|0,ue=ue|0,!De){var Je=Math.pow(2,8*ue)-1;yr(this,U,V,ue,Je,0)}var tt=1,jt=0;for(this[V]=U&255;++jt<ue&&(tt*=256);)this[V+jt]=U/tt&255;return V+ue},u.prototype.writeUIntBE=function(U,V,ue,De){if(U=+U,V=V|0,ue=ue|0,!De){var Je=Math.pow(2,8*ue)-1;yr(this,U,V,ue,Je,0)}var tt=ue-1,jt=1;for(this[V+tt]=U&255;--tt>=0&&(jt*=256);)this[V+tt]=U/jt&255;return V+ue},u.prototype.writeUInt8=function(U,V,ue){return U=+U,V=V|0,ue||yr(this,U,V,1,255,0),u.TYPED_ARRAY_SUPPORT||(U=Math.floor(U)),this[V]=U&255,V+1};function ln(ne,U,V,ue){U<0&&(U=65535+U+1);for(var De=0,Je=Math.min(ne.length-V,2);De<Je;++De)ne[V+De]=(U&255<<8*(ue?De:1-De))>>>(ue?De:1-De)*8}u.prototype.writeUInt16LE=function(U,V,ue){return U=+U,V=V|0,ue||yr(this,U,V,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[V]=U&255,this[V+1]=U>>>8):ln(this,U,V,!0),V+2},u.prototype.writeUInt16BE=function(U,V,ue){return U=+U,V=V|0,ue||yr(this,U,V,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[V]=U>>>8,this[V+1]=U&255):ln(this,U,V,!1),V+2};function kt(ne,U,V,ue){U<0&&(U=4294967295+U+1);for(var De=0,Je=Math.min(ne.length-V,4);De<Je;++De)ne[V+De]=U>>>(ue?De:3-De)*8&255}u.prototype.writeUInt32LE=function(U,V,ue){return U=+U,V=V|0,ue||yr(this,U,V,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[V+3]=U>>>24,this[V+2]=U>>>16,this[V+1]=U>>>8,this[V]=U&255):kt(this,U,V,!0),V+4},u.prototype.writeUInt32BE=function(U,V,ue){return U=+U,V=V|0,ue||yr(this,U,V,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[V]=U>>>24,this[V+1]=U>>>16,this[V+2]=U>>>8,this[V+3]=U&255):kt(this,U,V,!1),V+4},u.prototype.writeIntLE=function(U,V,ue,De){if(U=+U,V=V|0,!De){var Je=Math.pow(2,8*ue-1);yr(this,U,V,ue,Je-1,-Je)}var tt=0,jt=1,wr=0;for(this[V]=U&255;++tt<ue&&(jt*=256);)U<0&&wr===0&&this[V+tt-1]!==0&&(wr=1),this[V+tt]=(U/jt>>0)-wr&255;return V+ue},u.prototype.writeIntBE=function(U,V,ue,De){if(U=+U,V=V|0,!De){var Je=Math.pow(2,8*ue-1);yr(this,U,V,ue,Je-1,-Je)}var tt=ue-1,jt=1,wr=0;for(this[V+tt]=U&255;--tt>=0&&(jt*=256);)U<0&&wr===0&&this[V+tt+1]!==0&&(wr=1),this[V+tt]=(U/jt>>0)-wr&255;return V+ue},u.prototype.writeInt8=function(U,V,ue){return U=+U,V=V|0,ue||yr(this,U,V,1,127,-128),u.TYPED_ARRAY_SUPPORT||(U=Math.floor(U)),U<0&&(U=255+U+1),this[V]=U&255,V+1},u.prototype.writeInt16LE=function(U,V,ue){return U=+U,V=V|0,ue||yr(this,U,V,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[V]=U&255,this[V+1]=U>>>8):ln(this,U,V,!0),V+2},u.prototype.writeInt16BE=function(U,V,ue){return U=+U,V=V|0,ue||yr(this,U,V,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[V]=U>>>8,this[V+1]=U&255):ln(this,U,V,!1),V+2},u.prototype.writeInt32LE=function(U,V,ue){return U=+U,V=V|0,ue||yr(this,U,V,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[V]=U&255,this[V+1]=U>>>8,this[V+2]=U>>>16,this[V+3]=U>>>24):kt(this,U,V,!0),V+4},u.prototype.writeInt32BE=function(U,V,ue){return U=+U,V=V|0,ue||yr(this,U,V,4,2147483647,-2147483648),U<0&&(U=4294967295+U+1),u.TYPED_ARRAY_SUPPORT?(this[V]=U>>>24,this[V+1]=U>>>16,this[V+2]=U>>>8,this[V+3]=U&255):kt(this,U,V,!1),V+4};function ie(ne,U,V,ue,De,Je){if(V+ue>ne.length)throw new RangeError("Index out of range");if(V<0)throw new RangeError("Index out of range")}function ae(ne,U,V,ue,De){return De||ie(ne,U,V,4),E.write(ne,U,V,ue,23,4),V+4}u.prototype.writeFloatLE=function(U,V,ue){return ae(this,U,V,!0,ue)},u.prototype.writeFloatBE=function(U,V,ue){return ae(this,U,V,!1,ue)};function ge(ne,U,V,ue,De){return De||ie(ne,U,V,8),E.write(ne,U,V,ue,52,8),V+8}u.prototype.writeDoubleLE=function(U,V,ue){return ge(this,U,V,!0,ue)},u.prototype.writeDoubleBE=function(U,V,ue){return ge(this,U,V,!1,ue)},u.prototype.copy=function(U,V,ue,De){if(ue||(ue=0),!De&&De!==0&&(De=this.length),V>=U.length&&(V=U.length),V||(V=0),De>0&&De<ue&&(De=ue),De===ue||U.length===0||this.length===0)return 0;if(V<0)throw new RangeError("targetStart out of bounds");if(ue<0||ue>=this.length)throw new RangeError("sourceStart out of bounds");if(De<0)throw new RangeError("sourceEnd out of bounds");De>this.length&&(De=this.length),U.length-V<De-ue&&(De=U.length-V+ue);var Je=De-ue,tt;if(this===U&&ue<V&&V<De)for(tt=Je-1;tt>=0;--tt)U[tt+V]=this[tt+ue];else if(Je<1e3||!u.TYPED_ARRAY_SUPPORT)for(tt=0;tt<Je;++tt)U[tt+V]=this[tt+ue];else Uint8Array.prototype.set.call(U,this.subarray(ue,ue+Je),V);return Je},u.prototype.fill=function(U,V,ue,De){if(typeof U=="string"){if(typeof V=="string"?(De=V,V=0,ue=this.length):typeof ue=="string"&&(De=ue,ue=this.length),U.length===1){var Je=U.charCodeAt(0);Je<256&&(U=Je)}if(De!==void 0&&typeof De!="string")throw new TypeError("encoding must be a string");if(typeof De=="string"&&!u.isEncoding(De))throw new TypeError("Unknown encoding: "+De)}else typeof U=="number"&&(U=U&255);if(V<0||this.length<V||this.length<ue)throw new RangeError("Out of range index");if(ue<=V)return this;V=V>>>0,ue=ue===void 0?this.length:ue>>>0,U||(U=0);var tt;if(typeof U=="number")for(tt=V;tt<ue;++tt)this[tt]=U;else{var jt=u.isBuffer(U)?U:Fe(new u(U,De).toString()),wr=jt.length;for(tt=0;tt<ue-V;++tt)this[tt+V]=jt[tt%wr]}return this};var ve=/[^+\/0-9A-Za-z-_]/g;function we(ne){if(ne=Ie(ne).replace(ve,""),ne.length<2)return"";for(;ne.length%4!==0;)ne=ne+"=";return ne}function Ie(ne){return ne.trim?ne.trim():ne.replace(/^\s+|\s+$/g,"")}function Oe(ne){return ne<16?"0"+ne.toString(16):ne.toString(16)}function Fe(ne,U){U=U||1/0;for(var V,ue=ne.length,De=null,Je=[],tt=0;tt<ue;++tt){if(V=ne.charCodeAt(tt),V>55295&&V<57344){if(!De){if(V>56319){(U-=3)>-1&&Je.push(239,191,189);continue}else if(tt+1===ue){(U-=3)>-1&&Je.push(239,191,189);continue}De=V;continue}if(V<56320){(U-=3)>-1&&Je.push(239,191,189),De=V;continue}V=(De-55296<<10|V-56320)+65536}else De&&(U-=3)>-1&&Je.push(239,191,189);if(De=null,V<128){if((U-=1)<0)break;Je.push(V)}else if(V<2048){if((U-=2)<0)break;Je.push(V>>6|192,V&63|128)}else if(V<65536){if((U-=3)<0)break;Je.push(V>>12|224,V>>6&63|128,V&63|128)}else if(V<1114112){if((U-=4)<0)break;Je.push(V>>18|240,V>>12&63|128,V>>6&63|128,V&63|128)}else throw new Error("Invalid code point")}return Je}function Ye(ne){for(var U=[],V=0;V<ne.length;++V)U.push(ne.charCodeAt(V)&255);return U}function ot(ne,U){for(var V,ue,De,Je=[],tt=0;tt<ne.length&&!((U-=2)<0);++tt)V=ne.charCodeAt(tt),ue=V>>8,De=V%256,Je.push(De),Je.push(ue);return Je}function ct(ne){return A.toByteArray(we(ne))}function mt(ne,U,V,ue){for(var De=0;De<ue&&!(De+V>=U.length||De>=ne.length);++De)U[De+V]=ne[De];return De}function xt(ne){return ne!==ne}}).call(this,typeof Sa<"u"?Sa:typeof self<"u"?self:typeof window<"u"?window:{},M("buffer").Buffer)},{"base64-js":3,buffer:6,ieee754:29,isarray:35}],7:[function(M,N,$){(function(){if(!(typeof window>"u"))try{var l=new window.CustomEvent("test",{cancelable:!0});if(l.preventDefault(),l.defaultPrevented!==!0)throw new Error("Could not prevent default")}catch{var w=function(E,d){var v,f;return d=d||{},d.bubbles=!!d.bubbles,d.cancelable=!!d.cancelable,v=document.createEvent("CustomEvent"),v.initCustomEvent(E,d.bubbles,d.cancelable,d.detail),f=v.preventDefault,v.preventDefault=function(){f.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch{this.defaultPrevented=!0}},v};w.prototype=window.Event.prototype,window.CustomEvent=w}})()},{}],8:[function(M,N,$){$=N.exports=M("./debug"),$.log=A,$.formatArgs=w,$.save=E,$.load=d,$.useColors=l,$.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:v(),$.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function l(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}$.formatters.j=function(f){return JSON.stringify(f)};function w(){var f=arguments,m=this.useColors;if(f[0]=(m?"%c":"")+this.namespace+(m?" %c":" ")+f[0]+(m?"%c ":" "),!m)return f;var u="color: "+this.color;f=[f[0],u,"color: inherit"].concat(Array.prototype.slice.call(f,1));var b=0,g=0;return f[0].replace(/%[a-z%]/g,function(y){y!=="%%"&&(b++,y==="%c"&&(g=b))}),f.splice(g,0,u),f}function A(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function E(f){try{f==null?$.storage.removeItem("debug"):$.storage.debug=f}catch{}}function d(){var f;try{f=$.storage.debug}catch{}return f}$.enable(d());function v(){try{return window.localStorage}catch{}}},{"./debug":9}],9:[function(M,N,$){$=N.exports=A,$.coerce=f,$.disable=d,$.enable=E,$.enabled=v,$.names=[],$.skips=[],$.formatters={};var l=0;function w(){return $.colors[l++%$.colors.length]}function A(m){function u(){}u.enabled=!1;function b(){var y=b;y.useColors==null&&(y.useColors=$.useColors()),y.color==null&&y.useColors&&(y.color=w());var x=Array.prototype.slice.call(arguments);x[0]=$.coerce(x[0]),typeof x[0]!="string"&&(x=["%o"].concat(x));var L=0;x[0]=x[0].replace(/%([a-z%])/g,function(R,O){if(R==="%%")return R;L++;var F=$.formatters[O];if(typeof F=="function"){var z=x[L];R=F.call(y,z),x.splice(L,1),L--}return R}),typeof $.formatArgs=="function"&&(x=$.formatArgs.apply(y,x));var T=b.log||$.log||console.log.bind(console);T.apply(y,x)}b.enabled=!0;var g=$.enabled(m)?b:u;return g.namespace=m,g}function E(m){$.save(m);for(var u=(m||"").split(/[\s,]+/),b=u.length,g=0;g<b;g++)u[g]&&(m=u[g].replace(/\*/g,".*?"),m[0]==="-"?$.skips.push(new RegExp("^"+m.substr(1)+"$")):$.names.push(new RegExp("^"+m+"$")))}function d(){$.enable("")}function v(m){var u,b;for(u=0,b=$.skips.length;u<b;u++)if($.skips[u].test(m))return!1;for(u=0,b=$.names.length;u<b;u++)if($.names[u].test(m))return!0;return!1}function f(m){return m instanceof Error?m.stack||m.message:m}},{}],10:[function(M,N,$){var l=M("is-obj"),w=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;function E(f){if(f==null)throw new TypeError("Sources cannot be null or undefined");return Object(f)}function d(f,m,u){var b=m[u];if(b!=null){if(w.call(f,u)&&(f[u]===void 0||f[u]===null))throw new TypeError("Cannot convert undefined or null to object ("+u+")");!w.call(f,u)||!l(b)?f[u]=b:f[u]=v(Object(f[u]),m[u])}}function v(f,m){if(f===m)return f;m=Object(m);for(var u in m)w.call(m,u)&&d(f,m,u);if(Object.getOwnPropertySymbols)for(var b=Object.getOwnPropertySymbols(m),g=0;g<b.length;g++)A.call(m,b[g])&&d(f,m,b[g]);return f}N.exports=function(m){m=E(m);for(var u=1;u<arguments.length;u++)v(m,arguments[u]);return m}},{"is-obj":34}],11:[function(M,N,$){var l=M("object-keys"),w=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",A=Object.prototype.toString,E=Array.prototype.concat,d=Object.defineProperty,v=function(g){return typeof g=="function"&&A.call(g)==="[object Function]"},f=function(){var g={};try{d(g,"x",{enumerable:!1,value:g});for(var y in g)return!1;return g.x===g}catch{return!1}},m=d&&f(),u=function(g,y,x,L){y in g&&(!v(L)||!L())||(m?d(g,y,{configurable:!0,enumerable:!1,value:x,writable:!0}):g[y]=x)},b=function(g,y){var x=arguments.length>2?arguments[2]:{},L=l(y);w&&(L=E.call(L,Object.getOwnPropertySymbols(y)));for(var T=0;T<L.length;T+=1)u(g,L[T],y[L[T]],x[L[T]])};b.supportsDescriptors=!!m,N.exports=b},{"object-keys":41}],12:[function(M,N,$){/*! (C) WebReflection Mit Style License */(function(l,w,A,E){function d(at,nt){for(var Et=0,$t=at.length;Et<$t;Et++)O(at[Et],nt)}function v(at){for(var nt=0,Et=at.length,$t;nt<Et;nt++)$t=at[nt],An($t,rt[m($t)])}function f(at){return function(nt){Ye(nt)&&(O(nt,at),d(nt.querySelectorAll(Mt),at))}}function m(at){var nt=mt.call(at,"is"),Et=at.nodeName.toUpperCase(),$t=Wt.call(it,nt?Ne+nt.toUpperCase():ye+Et);return nt&&-1<$t&&!u(Et,nt)?-1:$t}function u(at,nt){return-1<Mt.indexOf(at+'[is="'+nt+'"]')}function b(at){var nt=at.currentTarget,Et=at.attrChange,$t=at.attrName,or=at.target;Ar&&(!or||or===nt)&&nt.attributeChangedCallback&&$t!=="style"&&at.prevValue!==at.newValue&&nt.attributeChangedCallback($t,Et===at[ee]?null:at.prevValue,Et===at[ce]?null:at.newValue)}function g(at){var nt=f(at);return function(Et){De.push(nt,Et.target)}}function y(at){wr&&(wr=!1,at.currentTarget.removeEventListener(oe,y)),d((at.target||w).querySelectorAll(Mt),at.detail===re?re:z),Fe&&T()}function x(at,nt){var Et=this;xt.call(Et,at,nt),Jt.call(Et,{target:Et})}function L(at,nt){we(at,nt),yn?yn.observe(at,V):(jt&&(at.setAttribute=x,at[F]=ar(at),at.addEventListener(Z,Jt)),at.addEventListener(j,b)),at.createdCallback&&Ar&&(at.created=!0,at.createdCallback(),at.created=!1)}function T(){for(var at,nt=0,Et=ot.length;nt<Et;nt++)at=ot[nt],Rt.contains(at)||(Et--,ot.splice(nt--,1),O(at,re))}function R(at){throw new Error("A "+at+" type is already registered")}function O(at,nt){var Et,$t=m(at);-1<$t&&(Ln(at,rt[$t]),$t=0,nt===z&&!at[z]?(at[re]=!1,at[z]=!0,$t=1,Fe&&Wt.call(ot,at)<0&&ot.push(at)):nt===re&&!at[re]&&(at[z]=!1,at[re]=!0,$t=1),$t&&(Et=at[nt+"Callback"])&&Et.call(at))}if(!(E in w)){var F="__"+E+(Math.random()*1e5>>0),z="attached",re="detached",Y="extends",ee="ADDITION",J="MODIFICATION",ce="REMOVAL",j="DOMAttrModified",oe="DOMContentLoaded",Z="DOMSubtreeModified",ye="<",Ne="=",je=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,ke=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],it=[],rt=[],Mt="",Rt=w.documentElement,Wt=it.indexOf||function(at){for(var nt=this.length;nt--&&this[nt]!==at;);return nt},nr=A.prototype,Dr=nr.hasOwnProperty,wt=nr.isPrototypeOf,yr=A.defineProperty,ln=A.getOwnPropertyDescriptor,kt=A.getOwnPropertyNames,ie=A.getPrototypeOf,ae=A.setPrototypeOf,ge=!!A.__proto__,ve=A.create||function at(nt){return nt?(at.prototype=nt,new at):this},we=ae||(ge?function(at,nt){return at.__proto__=nt,at}:kt&&ln?function(){function at(nt,Et){for(var $t,or=kt(Et),pr=0,cr=or.length;pr<cr;pr++)$t=or[pr],Dr.call(nt,$t)||yr(nt,$t,ln(Et,$t))}return function(nt,Et){do at(nt,Et);while((Et=ie(Et))&&!wt.call(Et,nt));return nt}}():function(at,nt){for(var Et in nt)at[Et]=nt[Et];return at}),Ie=l.MutationObserver||l.WebKitMutationObserver,Oe=(l.HTMLElement||l.Element||l.Node).prototype,Fe=!wt.call(Oe,Rt),Ye=Fe?function(at){return at.nodeType===1}:function(at){return wt.call(Oe,at)},ot=Fe&&[],ct=Oe.cloneNode,mt=Oe.getAttribute,xt=Oe.setAttribute,ne=Oe.removeAttribute,U=w.createElement,V=Ie&&{attributes:!0,characterData:!0,attributeOldValue:!0},ue=Ie||function(at){jt=!1,Rt.removeEventListener(j,ue)},De,Je=l.requestAnimationFrame||l.webkitRequestAnimationFrame||l.mozRequestAnimationFrame||l.msRequestAnimationFrame||function(at){setTimeout(at,10)},tt=!1,jt=!0,wr=!0,Ar=!0,Jt,ir,ar,yn,Ln,An;ae||ge?(Ln=function(at,nt){wt.call(nt,at)||L(at,nt)},An=L):(Ln=function(at,nt){at[F]||(at[F]=A(!0),L(at,nt))},An=Ln),Fe?(jt=!1,function(){var at=ln(Oe,"addEventListener"),nt=at.value,Et=function(pr){var cr=new CustomEvent(j,{bubbles:!0});cr.attrName=pr,cr.prevValue=mt.call(this,pr),cr.newValue=null,cr[ce]=cr.attrChange=2,ne.call(this,pr),this.dispatchEvent(cr)},$t=function(pr,cr){var Pr=this.hasAttribute(pr),$r=Pr&&mt.call(this,pr);e=new CustomEvent(j,{bubbles:!0}),xt.call(this,pr,cr),e.attrName=pr,e.prevValue=Pr?$r:null,e.newValue=cr,Pr?e[J]=e.attrChange=1:e[ee]=e.attrChange=0,this.dispatchEvent(e)},or=function(pr){var cr=pr.currentTarget,Pr=cr[F],$r=pr.propertyName,Hr;Pr.hasOwnProperty($r)&&(Pr=Pr[$r],Hr=new CustomEvent(j,{bubbles:!0}),Hr.attrName=Pr.name,Hr.prevValue=Pr.value||null,Hr.newValue=Pr.value=cr[$r]||null,Hr.prevValue==null?Hr[ee]=Hr.attrChange=0:Hr[J]=Hr.attrChange=1,cr.dispatchEvent(Hr))};at.value=function(pr,cr,Pr){pr===j&&this.attributeChangedCallback&&this.setAttribute!==$t&&(this[F]={className:{name:"class",value:this.className}},this.setAttribute=$t,this.removeAttribute=Et,nt.call(this,"propertychange",or)),nt.call(this,pr,cr,Pr)},yr(Oe,"addEventListener",at)}()):Ie||(Rt.addEventListener(j,ue),Rt.setAttribute(F,1),Rt.removeAttribute(F),jt&&(Jt=function(at){var nt=this,Et,$t,or;if(nt===at.target){Et=nt[F],nt[F]=$t=ar(nt);for(or in $t){if(!(or in Et))return ir(0,nt,or,Et[or],$t[or],ee);if($t[or]!==Et[or])return ir(1,nt,or,Et[or],$t[or],J)}for(or in Et)if(!(or in $t))return ir(2,nt,or,Et[or],$t[or],ce)}},ir=function(at,nt,Et,$t,or,pr){var cr={attrChange:at,currentTarget:nt,attrName:Et,prevValue:$t,newValue:or};cr[pr]=at,b(cr)},ar=function(at){for(var nt,Et,$t={},or=at.attributes,pr=0,cr=or.length;pr<cr;pr++)nt=or[pr],Et=nt.name,Et!=="setAttribute"&&($t[Et]=nt.value);return $t})),w[E]=function(at,nt){if(cr=at.toUpperCase(),tt||(tt=!0,Ie?(yn=function($r,Hr){function Xn(en,Xr){for(var fn=0,Mi=en.length;fn<Mi;Xr(en[fn++]));}return new Ie(function(en){for(var Xr,fn,Mi,ai=0,rn=en.length;ai<rn;ai++)Xr=en[ai],Xr.type==="childList"?(Xn(Xr.addedNodes,$r),Xn(Xr.removedNodes,Hr)):(fn=Xr.target,Ar&&fn.attributeChangedCallback&&Xr.attributeName!=="style"&&(Mi=mt.call(fn,Xr.attributeName),Mi!==Xr.oldValue&&fn.attributeChangedCallback(Xr.attributeName,Xr.oldValue,Mi)))})}(f(z),f(re)),yn.observe(w,{childList:!0,subtree:!0})):(De=[],Je(function $r(){for(;De.length;)De.shift().call(null,De.shift());Je($r)}),w.addEventListener("DOMNodeInserted",g(z)),w.addEventListener("DOMNodeRemoved",g(re))),w.addEventListener(oe,y),w.addEventListener("readystatechange",y),w.createElement=function($r,Hr){var Xn=U.apply(w,arguments),en=""+$r,Xr=Wt.call(it,(Hr?Ne:ye)+(Hr||en).toUpperCase()),fn=-1<Xr;return Hr&&(Xn.setAttribute("is",Hr=Hr.toLowerCase()),fn&&(fn=u(en.toUpperCase(),Hr))),Ar=!w.createElement.innerHTMLHelper,fn&&An(Xn,rt[Xr]),Xn},Oe.cloneNode=function($r){var Hr=ct.call(this,!!$r),Xn=m(Hr);return-1<Xn&&An(Hr,rt[Xn]),$r&&v(Hr.querySelectorAll(Mt)),Hr}),-2<Wt.call(it,Ne+cr)+Wt.call(it,ye+cr)&&R(at),!je.test(cr)||-1<Wt.call(ke,cr))throw new Error("The type "+at+" is invalid");var Et=function(){return or?w.createElement(pr,cr):w.createElement(pr)},$t=nt||nr,or=Dr.call($t,Y),pr=or?nt[Y].toUpperCase():cr,cr,Pr;return or&&-1<Wt.call(it,ye+pr)&&R(pr),Pr=it.push((or?Ne:ye)+cr)-1,Mt=Mt.concat(Mt.length?",":"",or?pr+'[is="'+at.toLowerCase()+'"]':pr),Et.prototype=rt[Pr]=Dr.call($t,"prototype")?$t.prototype:ve(Oe),d(w.querySelectorAll(Mt),z),Et}}})(window,document,Object,"registerElement")},{}],13:[function(M,N,$){N.exports=function(l){switch(l){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],14:[function(M,N,$){var l,w=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",E=Object.getPrototypeOf||function(b){return b.__proto__},d=l,v=l,f=l,m=typeof Uint8Array>"u"?l:E(Uint8Array),u={"$ %Array%":Array,"$ %ArrayBuffer%":typeof ArrayBuffer>"u"?l:ArrayBuffer,"$ %ArrayBufferPrototype%":typeof ArrayBuffer>"u"?l:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":A?E([][Symbol.iterator]()):l,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":l,"$ %AsyncFunction%":v,"$ %AsyncFunctionPrototype%":l,"$ %AsyncGenerator%":l,"$ %AsyncGeneratorFunction%":f,"$ %AsyncGeneratorPrototype%":l,"$ %AsyncIteratorPrototype%":l,"$ %Atomics%":typeof Atomics>"u"?l:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":typeof DataView>"u"?l:DataView,"$ %DataViewPrototype%":typeof DataView>"u"?l:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":typeof Float32Array>"u"?l:Float32Array,"$ %Float32ArrayPrototype%":typeof Float32Array>"u"?l:Float32Array.prototype,"$ %Float64Array%":typeof Float64Array>"u"?l:Float64Array,"$ %Float64ArrayPrototype%":typeof Float64Array>"u"?l:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":l,"$ %GeneratorFunction%":d,"$ %GeneratorPrototype%":l,"$ %Int8Array%":typeof Int8Array>"u"?l:Int8Array,"$ %Int8ArrayPrototype%":typeof Int8Array>"u"?l:Int8Array.prototype,"$ %Int16Array%":typeof Int16Array>"u"?l:Int16Array,"$ %Int16ArrayPrototype%":typeof Int16Array>"u"?l:Int8Array.prototype,"$ %Int32Array%":typeof Int32Array>"u"?l:Int32Array,"$ %Int32ArrayPrototype%":typeof Int32Array>"u"?l:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":A?E(E([][Symbol.iterator]())):l,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":typeof Map>"u"?l:Map,"$ %MapIteratorPrototype%":typeof Map>"u"||!A?l:E(new Map()[Symbol.iterator]()),"$ %MapPrototype%":typeof Map>"u"?l:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":typeof Promise>"u"?l:Promise,"$ %PromisePrototype%":typeof Promise>"u"?l:Promise.prototype,"$ %PromiseProto_then%":typeof Promise>"u"?l:Promise.prototype.then,"$ %Promise_all%":typeof Promise>"u"?l:Promise.all,"$ %Promise_reject%":typeof Promise>"u"?l:Promise.reject,"$ %Promise_resolve%":typeof Promise>"u"?l:Promise.resolve,"$ %Proxy%":typeof Proxy>"u"?l:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":typeof Reflect>"u"?l:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":typeof Set>"u"?l:Set,"$ %SetIteratorPrototype%":typeof Set>"u"||!A?l:E(new Set()[Symbol.iterator]()),"$ %SetPrototype%":typeof Set>"u"?l:Set.prototype,"$ %SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?l:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":typeof SharedArrayBuffer>"u"?l:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":A?E(""[Symbol.iterator]()):l,"$ %StringPrototype%":String.prototype,"$ %Symbol%":A?Symbol:l,"$ %SymbolPrototype%":A?Symbol.prototype:l,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":w,"$ %TypedArray%":m,"$ %TypedArrayPrototype%":m?m.prototype:l,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":typeof Uint8Array>"u"?l:Uint8Array,"$ %Uint8ArrayPrototype%":typeof Uint8Array>"u"?l:Uint8Array.prototype,"$ %Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?l:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":typeof Uint8ClampedArray>"u"?l:Uint8ClampedArray.prototype,"$ %Uint16Array%":typeof Uint16Array>"u"?l:Uint16Array,"$ %Uint16ArrayPrototype%":typeof Uint16Array>"u"?l:Uint16Array.prototype,"$ %Uint32Array%":typeof Uint32Array>"u"?l:Uint32Array,"$ %Uint32ArrayPrototype%":typeof Uint32Array>"u"?l:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":typeof WeakMap>"u"?l:WeakMap,"$ %WeakMapPrototype%":typeof WeakMap>"u"?l:WeakMap.prototype,"$ %WeakSet%":typeof WeakSet>"u"?l:WeakSet,"$ %WeakSetPrototype%":typeof WeakSet>"u"?l:WeakSet.prototype};N.exports=function(g,y){if(arguments.length>1&&typeof y!="boolean")throw new TypeError('"allowMissing" argument must be a boolean');var x="$ "+g;if(!(x in u))throw new SyntaxError("intrinsic "+g+" does not exist!");if(typeof u[x]>"u"&&!y)throw new TypeError("intrinsic "+g+" exists, but is not available. Please file an issue!");return u[x]}},{}],15:[function(M,N,$){var l=M("./GetIntrinsic"),w=l("%Object%"),A=l("%TypeError%"),E=l("%String%"),d=M("./helpers/assertRecord"),v=M("./helpers/isNaN"),f=M("./helpers/isFinite"),m=M("./helpers/sign"),u=M("./helpers/mod"),b=M("is-callable"),g=M("es-to-primitive/es5"),y=M("has"),x={ToPrimitive:g,ToBoolean:function(T){return!!T},ToNumber:function(T){return+T},ToInteger:function(T){var R=this.ToNumber(T);return v(R)?0:R===0||!f(R)?R:m(R)*Math.floor(Math.abs(R))},ToInt32:function(T){return this.ToNumber(T)>>0},ToUint32:function(T){return this.ToNumber(T)>>>0},ToUint16:function(T){var R=this.ToNumber(T);if(v(R)||R===0||!f(R))return 0;var O=m(R)*Math.floor(Math.abs(R));return u(O,65536)},ToString:function(T){return E(T)},ToObject:function(T){return this.CheckObjectCoercible(T),w(T)},CheckObjectCoercible:function(T,R){if(T==null)throw new A(R||"Cannot call method on "+T);return T},IsCallable:b,SameValue:function(T,R){return T===R?T===0?1/T===1/R:!0:v(T)&&v(R)},Type:function(T){if(T===null)return"Null";if(typeof T>"u")return"Undefined";if(typeof T=="function"||typeof T=="object")return"Object";if(typeof T=="number")return"Number";if(typeof T=="boolean")return"Boolean";if(typeof T=="string")return"String"},IsPropertyDescriptor:function(T){if(this.Type(T)!=="Object")return!1;var R={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var O in T)if(y(T,O)&&!R[O])return!1;var F=y(T,"[[Value]]"),z=y(T,"[[Get]]")||y(T,"[[Set]]");if(F&&z)throw new A("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(T){return!(typeof T>"u"||(d(this,"Property Descriptor","Desc",T),!y(T,"[[Get]]")&&!y(T,"[[Set]]")))},IsDataDescriptor:function(T){return!(typeof T>"u"||(d(this,"Property Descriptor","Desc",T),!y(T,"[[Value]]")&&!y(T,"[[Writable]]")))},IsGenericDescriptor:function(T){return typeof T>"u"?!1:(d(this,"Property Descriptor","Desc",T),!this.IsAccessorDescriptor(T)&&!this.IsDataDescriptor(T))},FromPropertyDescriptor:function(T){if(typeof T>"u")return T;if(d(this,"Property Descriptor","Desc",T),this.IsDataDescriptor(T))return{value:T["[[Value]]"],writable:!!T["[[Writable]]"],enumerable:!!T["[[Enumerable]]"],configurable:!!T["[[Configurable]]"]};if(this.IsAccessorDescriptor(T))return{get:T["[[Get]]"],set:T["[[Set]]"],enumerable:!!T["[[Enumerable]]"],configurable:!!T["[[Configurable]]"]};throw new A("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(T){if(this.Type(T)!=="Object")throw new A("ToPropertyDescriptor requires an object");var R={};if(y(T,"enumerable")&&(R["[[Enumerable]]"]=this.ToBoolean(T.enumerable)),y(T,"configurable")&&(R["[[Configurable]]"]=this.ToBoolean(T.configurable)),y(T,"value")&&(R["[[Value]]"]=T.value),y(T,"writable")&&(R["[[Writable]]"]=this.ToBoolean(T.writable)),y(T,"get")){var O=T.get;if(typeof O<"u"&&!this.IsCallable(O))throw new TypeError("getter must be a function");R["[[Get]]"]=O}if(y(T,"set")){var F=T.set;if(typeof F<"u"&&!this.IsCallable(F))throw new A("setter must be a function");R["[[Set]]"]=F}if((y(R,"[[Get]]")||y(R,"[[Set]]"))&&(y(R,"[[Value]]")||y(R,"[[Writable]]")))throw new A("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return R}};N.exports=x},{"./GetIntrinsic":14,"./helpers/assertRecord":16,"./helpers/isFinite":17,"./helpers/isNaN":18,"./helpers/mod":19,"./helpers/sign":20,"es-to-primitive/es5":21,has:28,"is-callable":32}],16:[function(M,N,$){var l=M("../GetIntrinsic"),w=l("%TypeError%"),A=l("%SyntaxError%"),E=M("has"),d={"Property Descriptor":function(f,m){if(f.Type(m)!=="Object")return!1;var u={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var b in m)if(E(m,b)&&!u[b])return!1;var g=E(m,"[[Value]]"),y=E(m,"[[Get]]")||E(m,"[[Set]]");if(g&&y)throw new w("Property Descriptors may not be both accessor and data descriptors");return!0}};N.exports=function(f,m,u,b){var g=d[m];if(typeof g!="function")throw new A("unknown record type: "+m);if(!g(f,b))throw new w(u+" must be a "+m);console.log(g(f,b),b)}},{"../GetIntrinsic":14,has:28}],17:[function(M,N,$){var l=Number.isNaN||function(w){return w!==w};N.exports=Number.isFinite||function(w){return typeof w=="number"&&!l(w)&&w!==1/0&&w!==-1/0}},{}],18:[function(M,N,$){N.exports=Number.isNaN||function(w){return w!==w}},{}],19:[function(M,N,$){N.exports=function(w,A){var E=w%A;return Math.floor(E>=0?E:E+A)}},{}],20:[function(M,N,$){N.exports=function(w){return w>=0?1:-1}},{}],21:[function(M,N,$){var l=Object.prototype.toString,w=M("./helpers/isPrimitive"),A=M("is-callable"),E={"[[DefaultValue]]":function(d){var v;if(arguments.length>1?v=arguments[1]:v=l.call(d)==="[object Date]"?String:Number,v===String||v===Number){var f=v===String?["toString","valueOf"]:["valueOf","toString"],m,u;for(u=0;u<f.length;++u)if(A(d[f[u]])&&(m=d[f[u]](),w(m)))return m;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")}};N.exports=function(v){return w(v)?v:arguments.length>1?E["[[DefaultValue]]"](v,arguments[1]):E["[[DefaultValue]]"](v)}},{"./helpers/isPrimitive":22,"is-callable":32}],22:[function(M,N,$){N.exports=function(w){return w===null||typeof w!="function"&&typeof w!="object"}},{}],23:[function(M,N,$){var l=M("dtype");N.exports=w;function w(A,E,d){if(!A)throw new TypeError("must specify data as first parameter");if(d=+(d||0)|0,Array.isArray(A)&&A[0]&&typeof A[0][0]=="number"){var v=A[0].length,f=A.length*v,m,u,b,g;(!E||typeof E=="string")&&(E=new(l(E||"float32"))(f+d));var y=E.length-d;if(f!==y)throw new Error("source length "+f+" ("+v+"x"+A.length+") does not match destination length "+y);for(m=0,b=d;m<A.length;m++)for(u=0;u<v;u++)E[b++]=A[m][u]===null?NaN:A[m][u]}else if(!E||typeof E=="string"){var x=l(E||"float32");if(Array.isArray(A)||E==="array")for(E=new x(A.length+d),m=0,b=d,g=E.length;b<g;b++,m++)E[b]=A[m]===null?NaN:A[m];else d===0?E=new x(A):(E=new x(A.length+d),E.set(A,d))}else E.set(A,d);return E}},{dtype:13}],24:[function(M,N,$){var l=M("is-callable"),w=Object.prototype.toString,A=Object.prototype.hasOwnProperty,E=function(u,b,g){for(var y=0,x=u.length;y<x;y++)A.call(u,y)&&(g==null?b(u[y],y,u):b.call(g,u[y],y,u))},d=function(u,b,g){for(var y=0,x=u.length;y<x;y++)g==null?b(u.charAt(y),y,u):b.call(g,u.charAt(y),y,u)},v=function(u,b,g){for(var y in u)A.call(u,y)&&(g==null?b(u[y],y,u):b.call(g,u[y],y,u))},f=function(u,b,g){if(!l(b))throw new TypeError("iterator must be a function");var y;arguments.length>=3&&(y=g),w.call(u)==="[object Array]"?E(u,b,y):typeof u=="string"?d(u,b,y):v(u,b,y)};N.exports=f},{"is-callable":32}],25:[function(M,N,$){var l="Function.prototype.bind called on incompatible ",w=Array.prototype.slice,A=Object.prototype.toString,E="[object Function]";N.exports=function(v){var f=this;if(typeof f!="function"||A.call(f)!==E)throw new TypeError(l+f);for(var m=w.call(arguments,1),u,b=function(){if(this instanceof u){var T=f.apply(this,m.concat(w.call(arguments)));return Object(T)===T?T:this}else return f.apply(v,m.concat(w.call(arguments)))},g=Math.max(0,f.length-m.length),y=[],x=0;x<g;x++)y.push("$"+x);if(u=Function("binder","return function ("+y.join(",")+"){ return binder.apply(this,arguments); }")(b),f.prototype){var L=function(){};L.prototype=f.prototype,u.prototype=new L,L.prototype=null}return u}},{}],26:[function(M,N,$){var l=M("./implementation");N.exports=Function.prototype.bind||l},{"./implementation":25}],27:[function(M,N,$){(function(l){var w;typeof window<"u"?w=window:typeof l<"u"?w=l:typeof self<"u"?w=self:w={},N.exports=w}).call(this,typeof Sa<"u"?Sa:typeof self<"u"?self:typeof window<"u"?window:{})},{}],28:[function(M,N,$){var l=M("function-bind");N.exports=l.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":26}],29:[function(M,N,$){$.read=function(l,w,A,E,d){var v,f,m=d*8-E-1,u=(1<<m)-1,b=u>>1,g=-7,y=A?d-1:0,x=A?-1:1,L=l[w+y];for(y+=x,v=L&(1<<-g)-1,L>>=-g,g+=m;g>0;v=v*256+l[w+y],y+=x,g-=8);for(f=v&(1<<-g)-1,v>>=-g,g+=E;g>0;f=f*256+l[w+y],y+=x,g-=8);if(v===0)v=1-b;else{if(v===u)return f?NaN:(L?-1:1)*(1/0);f=f+Math.pow(2,E),v=v-b}return(L?-1:1)*f*Math.pow(2,v-E)},$.write=function(l,w,A,E,d,v){var f,m,u,b=v*8-d-1,g=(1<<b)-1,y=g>>1,x=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,L=E?0:v-1,T=E?1:-1,R=w<0||w===0&&1/w<0?1:0;for(w=Math.abs(w),isNaN(w)||w===1/0?(m=isNaN(w)?1:0,f=g):(f=Math.floor(Math.log(w)/Math.LN2),w*(u=Math.pow(2,-f))<1&&(f--,u*=2),f+y>=1?w+=x/u:w+=x*Math.pow(2,1-y),w*u>=2&&(f++,u/=2),f+y>=g?(m=0,f=g):f+y>=1?(m=(w*u-1)*Math.pow(2,d),f=f+y):(m=w*Math.pow(2,y-1)*Math.pow(2,d),f=0));d>=8;l[A+L]=m&255,L+=T,m/=256,d-=8);for(f=f<<d|m,b+=d;b>0;l[A+L]=f&255,L+=T,f/=256,b-=8);l[A+L-T]|=R*128}},{}],30:[function(M,N,$){typeof Object.create=="function"?N.exports=function(w,A){A&&(w.super_=A,w.prototype=Object.create(A.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}))}:N.exports=function(w,A){if(A){w.super_=A;var E=function(){};E.prototype=A.prototype,w.prototype=new E,w.prototype.constructor=w}}},{}],31:[function(M,N,$){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */N.exports=function(A){return A!=null&&(l(A)||w(A)||!!A._isBuffer)};function l(A){return!!A.constructor&&typeof A.constructor.isBuffer=="function"&&A.constructor.isBuffer(A)}function w(A){return typeof A.readFloatLE=="function"&&typeof A.slice=="function"&&l(A.slice(0,0))}},{}],32:[function(M,N,$){var l=Function.prototype.toString,w=/^\s*class\b/,A=function(b){try{var g=l.call(b);return w.test(g)}catch{return!1}},E=function(b){try{return A(b)?!1:(l.call(b),!0)}catch{return!1}},d=Object.prototype.toString,v="[object Function]",f="[object GeneratorFunction]",m=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol";N.exports=function(b){if(!b||typeof b!="function"&&typeof b!="object")return!1;if(typeof b=="function"&&!b.prototype)return!0;if(m)return E(b);if(A(b))return!1;var g=d.call(b);return g===v||g===f}},{}],33:[function(M,N,$){N.exports=w;var l=Object.prototype.toString;function w(A){var E=l.call(A);return E==="[object Function]"||typeof A=="function"&&E!=="[object RegExp]"||typeof window<"u"&&(A===window.setTimeout||A===window.alert||A===window.confirm||A===window.prompt)}},{}],34:[function(M,N,$){N.exports=function(l){var w=typeof l;return l!==null&&(w==="object"||w==="function")}},{}],35:[function(M,N,$){var l={}.toString;N.exports=Array.isArray||function(w){return l.call(w)=="[object Array]"}},{}],36:[function(M,N,$){var l=M("word-wrapper"),w=M("xtend"),A=M("as-number"),E=["x","e","a","o","n","s","r","c","u","m","v","w","z"],d=["m","w"],v=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],f=9,m=32,u=0,b=1,g=2;N.exports=function(J){return new y(J)};function y(ee){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(ee)}y.prototype.update=function(ee){if(ee=w({measure:this._measure},ee),this._opt=ee,this._opt.tabSize=A(this._opt.tabSize,4),!ee.font)throw new Error("must provide a valid bitmap font");var J=this.glyphs,ce=ee.text||"",j=ee.font;this._setupSpaceGlyphs(j);var oe=l.lines(ce,ee),Z=ee.width||0;J.length=0;var ye=oe.reduce(function(Dr,wt){return Math.max(Dr,wt.width,Z)},0),Ne=0,je=0,ke=A(ee.lineHeight,j.common.lineHeight),it=j.common.base,rt=ke-it,Mt=ee.letterSpacing||0,Rt=ke*oe.length-rt,Wt=re(this._opt.align);je-=Rt,this._width=ye,this._height=Rt,this._descender=ke-it,this._baseline=it,this._xHeight=R(j),this._capHeight=F(j),this._lineHeight=ke,this._ascender=ke-rt-this._xHeight;var nr=this;oe.forEach(function(Dr,wt){for(var yr=Dr.start,ln=Dr.end,kt=Dr.width,ie,ae=yr;ae<ln;ae++){var ge=ce.charCodeAt(ae),ve=nr.getGlyph(j,ge);if(ve){ie&&(Ne+=z(j,ie.id,ve.id));var we=Ne;Wt===b?we+=(ye-kt)/2:Wt===g&&(we+=ye-kt),J.push({position:[we,je],data:ve,index:ae,line:wt}),Ne+=ve.xadvance+Mt,ie=ve}}je+=ke,Ne=0}),this._linesTotal=oe.length},y.prototype._setupSpaceGlyphs=function(ee){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,!(!ee.chars||ee.chars.length===0)){var J=T(ee,m)||O(ee)||ee.chars[0],ce=this._opt.tabSize*J.xadvance;this._fallbackSpaceGlyph=J,this._fallbackTabGlyph=w(J,{x:0,y:0,xadvance:ce,id:f,xoffset:0,yoffset:0,width:0,height:0})}},y.prototype.getGlyph=function(ee,J){var ce=T(ee,J);return ce||(J===f?this._fallbackTabGlyph:J===m?this._fallbackSpaceGlyph:null)},y.prototype.computeMetrics=function(ee,J,ce,j){var oe=this._opt.letterSpacing||0,Z=this._opt.font,ye=0,Ne=0,je=0,ke,it;if(!Z.chars||Z.chars.length===0)return{start:J,end:J,width:0};ce=Math.min(ee.length,ce);for(var rt=J;rt<ce;rt++){var Mt=ee.charCodeAt(rt),ke=this.getGlyph(Z,Mt);if(ke){ke.xoffset;var Rt=it?z(Z,it.id,ke.id):0;ye+=Rt;var Wt=ye+ke.xadvance+oe,nr=ye+ke.width;if(nr>=j||Wt>=j)break;ye=Wt,Ne=nr,it=ke}je++}return it&&(Ne+=it.xoffset),{start:J,end:J+je,width:Ne}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(x);function x(ee){Object.defineProperty(y.prototype,ee,{get:L(ee),configurable:!0})}function L(ee){return new Function(["return function "+ee+"() {","  return this._"+ee,"}"].join(`
`))()}function T(ee,J){if(!ee.chars||ee.chars.length===0)return null;var ce=Y(ee.chars,J);return ce>=0?ee.chars[ce]:null}function R(ee){for(var J=0;J<E.length;J++){var ce=E[J].charCodeAt(0),j=Y(ee.chars,ce);if(j>=0)return ee.chars[j].height}return 0}function O(ee){for(var J=0;J<d.length;J++){var ce=d[J].charCodeAt(0),j=Y(ee.chars,ce);if(j>=0)return ee.chars[j]}return 0}function F(ee){for(var J=0;J<v.length;J++){var ce=v[J].charCodeAt(0),j=Y(ee.chars,ce);if(j>=0)return ee.chars[j].height}return 0}function z(ee,J,ce){if(!ee.kernings||ee.kernings.length===0)return 0;for(var j=ee.kernings,oe=0;oe<j.length;oe++){var Z=j[oe];if(Z.first===J&&Z.second===ce)return Z.amount}return 0}function re(ee){return ee==="center"?b:ee==="right"?g:u}function Y(ee,J,ce){ce=ce||0;for(var j=ce;j<ee.length;j++)if(ee[j].id===J)return j;return-1}},{"as-number":2,"word-wrapper":69,xtend:72}],37:[function(M,N,$){(function(l){var w=M("xhr"),A=function(){},E=M("parse-bmfont-ascii"),d=M("parse-bmfont-xml"),v=M("parse-bmfont-binary"),f=M("./lib/is-binary"),m=M("xtend"),u=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();N.exports=function(y,x){x=typeof x=="function"?x:A,typeof y=="string"?y={uri:y}:y||(y={});var L=y.binary;L&&(y=g(y)),w(y,function(T,R,O){if(T)return x(T);if(!/^2/.test(R.statusCode))return x(new Error("http status code: "+R.statusCode));if(!O)return x(new Error("no body result"));var F=!1;if(b(O)){var z=new Uint8Array(O);O=new l(z,"binary")}f(O)&&(F=!0,typeof O=="string"&&(O=new l(O,"binary"))),F||(l.isBuffer(O)&&(O=O.toString(y.encoding)),O=O.trim());var re;try{var Y=R.headers["content-type"];F?re=v(O):/json/.test(Y)||O.charAt(0)==="{"?re=JSON.parse(O):/xml/.test(Y)||O.charAt(0)==="<"?re=d(O):re=E(O)}catch(ee){x(new Error("error parsing font "+ee.message)),x=A}x(null,re)})};function b(y){var x=Object.prototype.toString;return x.call(y)==="[object ArrayBuffer]"}function g(y){if(u)return m(y,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest>"u")throw new Error("your browser does not support XHR loading");var x=new self.XMLHttpRequest;return x.overrideMimeType("text/plain; charset=x-user-defined"),m({xhr:x},y)}}).call(this,M("buffer").Buffer)},{"./lib/is-binary":38,buffer:6,"parse-bmfont-ascii":43,"parse-bmfont-binary":44,"parse-bmfont-xml":45,xhr:70,xtend:72}],38:[function(M,N,$){(function(l){var w=M("buffer-equal"),A=new l([66,77,70,3]);N.exports=function(E){return typeof E=="string"?E.substring(0,3)==="BMF":E.length>4&&w(E.slice(0,4),A)}}).call(this,M("buffer").Buffer)},{buffer:6,"buffer-equal":5}],39:[function(M,N,$){var l=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;function E(v){if(v==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(v)}function d(){try{if(!Object.assign)return!1;var v=new String("abc");if(v[5]="de",Object.getOwnPropertyNames(v)[0]==="5")return!1;for(var f={},m=0;m<10;m++)f["_"+String.fromCharCode(m)]=m;var u=Object.getOwnPropertyNames(f).map(function(g){return f[g]});if(u.join("")!=="0123456789")return!1;var b={};return"abcdefghijklmnopqrst".split("").forEach(function(g){b[g]=g}),Object.keys(Object.assign({},b)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}N.exports=d()?Object.assign:function(v,f){for(var m,u=E(v),b,g=1;g<arguments.length;g++){m=Object(arguments[g]);for(var y in m)w.call(m,y)&&(u[y]=m[y]);if(l){b=l(m);for(var x=0;x<b.length;x++)A.call(m,b[x])&&(u[b[x]]=m[b[x]])}}return u}},{}],40:[function(M,N,$){var l;if(!Object.keys){var w=Object.prototype.hasOwnProperty,A=Object.prototype.toString,E=M("./isArguments"),d=Object.prototype.propertyIsEnumerable,v=!d.call({toString:null},"toString"),f=d.call(function(){},"prototype"),m=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],u=function(x){var L=x.constructor;return L&&L.prototype===x},b={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},g=function(){if(typeof window>"u")return!1;for(var x in window)try{if(!b["$"+x]&&w.call(window,x)&&window[x]!==null&&typeof window[x]=="object")try{u(window[x])}catch{return!0}}catch{return!0}return!1}(),y=function(x){if(typeof window>"u"||!g)return u(x);try{return u(x)}catch{return!1}};l=function(L){var T=L!==null&&typeof L=="object",R=A.call(L)==="[object Function]",O=E(L),F=T&&A.call(L)==="[object String]",z=[];if(!T&&!R&&!O)throw new TypeError("Object.keys called on a non-object");var re=f&&R;if(F&&L.length>0&&!w.call(L,0))for(var Y=0;Y<L.length;++Y)z.push(String(Y));if(O&&L.length>0)for(var ee=0;ee<L.length;++ee)z.push(String(ee));else for(var J in L)!(re&&J==="prototype")&&w.call(L,J)&&z.push(String(J));if(v)for(var ce=y(L),j=0;j<m.length;++j)!(ce&&m[j]==="constructor")&&w.call(L,m[j])&&z.push(m[j]);return z}}N.exports=l},{"./isArguments":42}],41:[function(M,N,$){var l=Array.prototype.slice,w=M("./isArguments"),A=Object.keys,E=A?function(f){return A(f)}:M("./implementation"),d=Object.keys;E.shim=function(){if(Object.keys){var f=function(){var m=Object.keys(arguments);return m&&m.length===arguments.length}(1,2);f||(Object.keys=function(u){return w(u)?d(l.call(u)):d(u)})}else Object.keys=E;return Object.keys||E},N.exports=E},{"./implementation":40,"./isArguments":42}],42:[function(M,N,$){var l=Object.prototype.toString;N.exports=function(A){var E=l.call(A),d=E==="[object Arguments]";return d||(d=E!=="[object Array]"&&A!==null&&typeof A=="object"&&typeof A.length=="number"&&A.length>=0&&l.call(A.callee)==="[object Function]"),d}},{}],43:[function(M,N,$){N.exports=function(d){if(!d)throw new Error("no data provided");d=d.toString().trim();var v={pages:[],chars:[],kernings:[]},f=d.split(/\r\n?|\n/g);if(f.length===0)throw new Error("no data in BMFont file");for(var m=0;m<f.length;m++){var u=l(f[m],m);if(u)if(u.key==="page"){if(typeof u.data.id!="number")throw new Error("malformed file at line "+m+" -- needs page id=N");if(typeof u.data.file!="string")throw new Error("malformed file at line "+m+' -- needs page file="path"');v.pages[u.data.id]=u.data.file}else u.key==="chars"||u.key==="kernings"||(u.key==="char"?v.chars.push(u.data):u.key==="kerning"?v.kernings.push(u.data):v[u.key]=u.data)}return v};function l(E,d){if(E=E.replace(/\t+/g," ").trim(),!E)return null;var v=E.indexOf(" ");if(v===-1)throw new Error("no named row at line "+d);var f=E.substring(0,v);E=E.substring(v+1),E=E.replace(/letter=[\'\"]\S+[\'\"]/gi,""),E=E.split("="),E=E.map(function(y){return y.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var m=[],u=0;u<E.length;u++){var b=E[u];u===0?m.push({key:b[0],data:""}):u===E.length-1?m[m.length-1].data=w(b[0]):(m[m.length-1].data=w(b[0]),m.push({key:b[1],data:""}))}var g={key:f,data:{}};return m.forEach(function(y){g.data[y.key]=y.data}),g}function w(E){return!E||E.length===0?"":E.indexOf('"')===0||E.indexOf("'")===0?E.substring(1,E.length-1):E.indexOf(",")!==-1?A(E):parseInt(E,10)}function A(E){return E.split(",").map(function(d){return parseInt(d,10)})}},{}],44:[function(M,N,$){var l=[66,77,70];N.exports=function(g){if(g.length<6)throw new Error("invalid buffer length for BMFont");var y=l.every(function(O,F){return g.readUInt8(F)===O});if(!y)throw new Error("BMFont missing BMF byte header");var x=3,L=g.readUInt8(x++);if(L>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var T={kernings:[],chars:[]},R=0;R<5;R++)x+=w(T,g,x);return T};function w(b,g,y){if(y>g.length-1)return 0;var x=g.readUInt8(y++),L=g.readInt32LE(y);switch(y+=4,x){case 1:b.info=A(g,y);break;case 2:b.common=E(g,y);break;case 3:b.pages=d(g,y,L);break;case 4:b.chars=v(g,y,L);break;case 5:b.kernings=f(g,y,L);break}return 5+L}function A(b,g){var y={};y.size=b.readInt16LE(g);var x=b.readUInt8(g+2);return y.smooth=x>>7&1,y.unicode=x>>6&1,y.italic=x>>5&1,y.bold=x>>4&1,x>>3&1&&(y.fixedHeight=1),y.charset=b.readUInt8(g+3)||"",y.stretchH=b.readUInt16LE(g+4),y.aa=b.readUInt8(g+6),y.padding=[b.readInt8(g+7),b.readInt8(g+8),b.readInt8(g+9),b.readInt8(g+10)],y.spacing=[b.readInt8(g+11),b.readInt8(g+12)],y.outline=b.readUInt8(g+13),y.face=u(b,g+14),y}function E(b,g){var y={};return y.lineHeight=b.readUInt16LE(g),y.base=b.readUInt16LE(g+2),y.scaleW=b.readUInt16LE(g+4),y.scaleH=b.readUInt16LE(g+6),y.pages=b.readUInt16LE(g+8),b.readUInt8(g+10),y.packed=0,y.alphaChnl=b.readUInt8(g+11),y.redChnl=b.readUInt8(g+12),y.greenChnl=b.readUInt8(g+13),y.blueChnl=b.readUInt8(g+14),y}function d(b,g,y){for(var x=[],L=m(b,g),T=L.length+1,R=y/T,O=0;O<R;O++)x[O]=b.slice(g,g+L.length).toString("utf8"),g+=T;return x}function v(b,g,y){for(var x=[],L=y/20,T=0;T<L;T++){var R={},O=T*20;R.id=b.readUInt32LE(g+0+O),R.x=b.readUInt16LE(g+4+O),R.y=b.readUInt16LE(g+6+O),R.width=b.readUInt16LE(g+8+O),R.height=b.readUInt16LE(g+10+O),R.xoffset=b.readInt16LE(g+12+O),R.yoffset=b.readInt16LE(g+14+O),R.xadvance=b.readInt16LE(g+16+O),R.page=b.readUInt8(g+18+O),R.chnl=b.readUInt8(g+19+O),x[T]=R}return x}function f(b,g,y){for(var x=[],L=y/10,T=0;T<L;T++){var R={},O=T*10;R.first=b.readUInt32LE(g+0+O),R.second=b.readUInt32LE(g+4+O),R.amount=b.readInt16LE(g+8+O),x[T]=R}return x}function m(b,g){for(var y=g;y<b.length&&b[y]!==0;y++);return b.slice(g,y)}function u(b,g){return m(b,g).toString("utf8")}},{}],45:[function(M,N,$){var l=M("./parse-attribs"),w=M("xml-parse-from-string"),A={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};N.exports=function(m){m=m.toString();var u=w(m),b={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(O){var F=u.getElementsByTagName(O)[0];F&&(b[O]=l(E(F)))});var g=u.getElementsByTagName("pages")[0];if(!g)throw new Error("malformed file -- no <pages> element");for(var y=g.getElementsByTagName("page"),x=0;x<y.length;x++){var L=y[x],T=parseInt(L.getAttribute("id"),10),R=L.getAttribute("file");if(isNaN(T))throw new Error('malformed file -- page "id" attribute is NaN');if(!R)throw new Error('malformed file -- needs page "file" attribute');b.pages[parseInt(T,10)]=R}return["chars","kernings"].forEach(function(O){var F=u.getElementsByTagName(O)[0];if(F)for(var z=O.substring(0,O.length-1),re=F.getElementsByTagName(z),Y=0;Y<re.length;Y++){var ee=re[Y];b[O].push(l(E(ee)))}}),b};function E(f){var m=d(f);return m.reduce(function(u,b){var g=v(b.nodeName);return u[g]=b.nodeValue,u},{})}function d(f){for(var m=[],u=0;u<f.attributes.length;u++)m.push(f.attributes[u]);return m}function v(f){return A[f.toLowerCase()]||f}},{"./parse-attribs":46,"xml-parse-from-string":71}],46:[function(M,N,$){var l="chasrset";N.exports=function(E){l in E&&(E.charset=E[l],delete E[l]);for(var d in E)d==="face"||d==="charset"||(d==="padding"||d==="spacing"?E[d]=w(E[d]):E[d]=parseInt(E[d],10));return E};function w(A){return A.split(",").map(function(E){return parseInt(E,10)})}},{}],47:[function(M,N,$){var l=M("string.prototype.trim"),w=M("for-each"),A=function(E){return Object.prototype.toString.call(E)==="[object Array]"};N.exports=function(E){if(!E)return{};var d={};return w(l(E).split(`
`),function(v){var f=v.indexOf(":"),m=l(v.slice(0,f)).toLowerCase(),u=l(v.slice(f+1));typeof d[m]>"u"?d[m]=u:A(d[m])?d[m].push(u):d[m]=[d[m],u]}),d}},{"for-each":24,"string.prototype.trim":53}],48:[function(M,N,$){(function(l){var w=l.performance||{},A=function(){for(var E=["now","webkitNow","msNow","mozNow","oNow"];E.length;){var d=E.shift();if(d in w)return w[d].bind(w)}var v=Date.now||function(){return new Date().getTime()},f=(w.timing||{}).navigationStart||v();return function(){return v()-f}}();A.performanceNow=w.now,A.noConflict=function(){w.now=A.performanceNow},A.conflict=function(){w.now=A},A.conflict(),N.exports=A}).call(this,typeof Sa<"u"?Sa:typeof self<"u"?self:typeof window<"u"?window:{})},{}],49:[function(M,N,$){var l=N.exports={},w,A;function E(){throw new Error("setTimeout has not been defined")}function d(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?w=setTimeout:w=E}catch{w=E}try{typeof clearTimeout=="function"?A=clearTimeout:A=d}catch{A=d}})();function v(R){if(w===setTimeout)return setTimeout(R,0);if((w===E||!w)&&setTimeout)return w=setTimeout,setTimeout(R,0);try{return w(R,0)}catch{try{return w.call(null,R,0)}catch{return w.call(this,R,0)}}}function f(R){if(A===clearTimeout)return clearTimeout(R);if((A===d||!A)&&clearTimeout)return A=clearTimeout,clearTimeout(R);try{return A(R)}catch{try{return A.call(null,R)}catch{return A.call(this,R)}}}var m=[],u=!1,b,g=-1;function y(){!u||!b||(u=!1,b.length?m=b.concat(m):g=-1,m.length&&x())}function x(){if(!u){var R=v(y);u=!0;for(var O=m.length;O;){for(b=m,m=[];++g<O;)b&&b[g].run();g=-1,O=m.length}b=null,u=!1,f(R)}}l.nextTick=function(R){var O=new Array(arguments.length-1);if(arguments.length>1)for(var F=1;F<arguments.length;F++)O[F-1]=arguments[F];m.push(new L(R,O)),m.length===1&&!u&&v(x)};function L(R,O){this.fun=R,this.array=O}L.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={};function T(){}l.on=T,l.addListener=T,l.once=T,l.off=T,l.removeListener=T,l.removeAllListeners=T,l.emit=T,l.prependListener=T,l.prependOnceListener=T,l.listeners=function(R){return[]},l.binding=function(R){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(R){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],50:[function(M,N,$){(function(l){(function(w){var A=setTimeout,E=typeof l=="function"&&l||function(L){A(L,1)};function d(L,T){return function(){L.apply(T,arguments)}}var v=Array.isArray||function(L){return Object.prototype.toString.call(L)==="[object Array]"};function f(L){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof L!="function")throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],x(L,d(u,this),d(b,this))}function m(L){var T=this;if(this._state===null){this._deferreds.push(L);return}E(function(){var R=T._state?L.onFulfilled:L.onRejected;if(R===null){(T._state?L.resolve:L.reject)(T._value);return}var O;try{O=R(T._value)}catch(F){L.reject(F);return}L.resolve(O)})}function u(L){try{if(L===this)throw new TypeError("A promise cannot be resolved with itself.");if(L&&(typeof L=="object"||typeof L=="function")){var T=L.then;if(typeof T=="function"){x(d(T,L),d(u,this),d(b,this));return}}this._state=!0,this._value=L,g.call(this)}catch(R){b.call(this,R)}}function b(L){this._state=!1,this._value=L,g.call(this)}function g(){for(var L=0,T=this._deferreds.length;L<T;L++)m.call(this,this._deferreds[L]);this._deferreds=null}function y(L,T,R,O){this.onFulfilled=typeof L=="function"?L:null,this.onRejected=typeof T=="function"?T:null,this.resolve=R,this.reject=O}function x(L,T,R){var O=!1;try{L(function(F){O||(O=!0,T(F))},function(F){O||(O=!0,R(F))})}catch(F){if(O)return;O=!0,R(F)}}f.prototype.catch=function(L){return this.then(null,L)},f.prototype.then=function(L,T){var R=this;return new f(function(O,F){m.call(R,new y(L,T,O,F))})},f.all=function(){var L=Array.prototype.slice.call(arguments.length===1&&v(arguments[0])?arguments[0]:arguments);return new f(function(T,R){if(L.length===0)return T([]);var O=L.length;function F(re,Y){try{if(Y&&(typeof Y=="object"||typeof Y=="function")){var ee=Y.then;if(typeof ee=="function"){ee.call(Y,function(J){F(re,J)},R);return}}L[re]=Y,--O===0&&T(L)}catch(J){R(J)}}for(var z=0;z<L.length;z++)F(z,L[z])})},f.resolve=function(L){return L&&typeof L=="object"&&L.constructor===f?L:new f(function(T){T(L)})},f.reject=function(L){return new f(function(T,R){R(L)})},f.race=function(L){return new f(function(T,R){for(var O=0,F=L.length;O<F;O++)L[O].then(T,R)})},f._setImmediateFn=function(T){E=T},typeof N<"u"&&N.exports?N.exports=f:w.Promise||(w.Promise=f)})(this)}).call(this,M("timers").setImmediate)},{timers:67}],51:[function(M,N,$){var l=M("dtype"),w=M("an-array"),A=M("is-buffer"),E=[0,2,3],d=[2,1,3];N.exports=function(f,m){(!f||!(w(f)||A(f)))&&(m=f||{},f=null),typeof m=="number"?m={count:m}:m=m||{};for(var u=typeof m.type=="string"?m.type:"uint16",b=typeof m.count=="number"?m.count:1,g=m.start||0,y=m.clockwise!==!1?E:d,x=y[0],L=y[1],T=y[2],R=b*6,O=f||new(l(u))(R),F=0,z=0;F<R;F+=6,z+=4){var re=F+g;O[re+0]=z+0,O[re+1]=z+1,O[re+2]=z+2,O[re+3]=z+x,O[re+4]=z+L,O[re+5]=z+T}return O}},{"an-array":1,dtype:13,"is-buffer":31}],52:[function(M,N,$){var l=M("function-bind"),w=M("es-abstract/es5"),A=l.call(Function.call,String.prototype.replace),E=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,d=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;N.exports=function(){var f=w.ToString(w.CheckObjectCoercible(this));return A(A(f,E,""),d,"")}},{"es-abstract/es5":15,"function-bind":26}],53:[function(M,N,$){var l=M("function-bind"),w=M("define-properties"),A=M("./implementation"),E=M("./polyfill"),d=M("./shim"),v=l.call(Function.call,E());w(v,{getPolyfill:E,implementation:A,shim:d}),N.exports=v},{"./implementation":52,"./polyfill":54,"./shim":55,"define-properties":11,"function-bind":26}],54:[function(M,N,$){var l=M("./implementation"),w="";N.exports=function(){return String.prototype.trim&&w.trim()===w?String.prototype.trim:l}},{"./implementation":52}],55:[function(M,N,$){var l=M("define-properties"),w=M("./polyfill");N.exports=function(){var E=w();return l(String.prototype,{trim:E},{trim:function(){return String.prototype.trim!==E}}),E}},{"./polyfill":54,"define-properties":11}],56:[function(M,N,$){var l={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},w={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},A=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],E={CSS:{},springs:{}};function d(se,be,Ve){return Math.min(Math.max(se,be),Ve)}function v(se,be){return se.indexOf(be)>-1}function f(se,be){return se.apply(null,be)}var m=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,u=/^rgb/,b=/^hsl/,g={arr:function(se){return Array.isArray(se)},obj:function(se){return v(Object.prototype.toString.call(se),"Object")},pth:function(se){return g.obj(se)&&se.hasOwnProperty("totalLength")},svg:function(se){return se instanceof SVGElement},inp:function(se){return se instanceof HTMLInputElement},dom:function(se){return se.nodeType||g.svg(se)},str:function(se){return typeof se=="string"},fnc:function(se){return typeof se=="function"},und:function(se){return typeof se>"u"},hex:function(se){return m.test(se)},rgb:function(se){return u.test(se)},hsl:function(se){return b.test(se)},col:function(se){return g.hex(se)||g.rgb(se)||g.hsl(se)},key:function(se){return!l.hasOwnProperty(se)&&!w.hasOwnProperty(se)&&se!=="targets"&&se!=="keyframes"}},y=/\(([^)]+)\)/;function x(se){var be=y.exec(se);return be?be[1].split(",").map(function(Ve){return parseFloat(Ve)}):[]}function L(se,be){var Ve=x(se),$e=d(g.und(Ve[0])?1:Ve[0],.1,100),Xe=d(g.und(Ve[1])?100:Ve[1],.1,100),ft=d(g.und(Ve[2])?10:Ve[2],.1,100),Tt=d(g.und(Ve[3])?0:Ve[3],.1,100),Gt=Math.sqrt(Xe/$e),Ct=ft/(2*Math.sqrt(Xe*$e)),ut=Ct<1?Gt*Math.sqrt(1-Ct*Ct):0,Xt=1,Kt=Ct<1?(Ct*Gt+-Tt)/ut:-Tt+Gt;function vr(Gr){var Cr=be?be*Gr/1e3:Gr;return Ct<1?Cr=Math.exp(-Cr*Ct*Gt)*(Xt*Math.cos(ut*Cr)+Kt*Math.sin(ut*Cr)):Cr=(Xt+Kt*Cr)*Math.exp(-Cr*Gt),Gr===0||Gr===1?Gr:1-Cr}function bn(){var Gr=E.springs[se];if(Gr)return Gr;for(var Cr=1/6,Yr=0,Tn=0;;)if(Yr+=Cr,vr(Yr)===1){if(Tn++,Tn>=16)break}else Tn=0;var Jn=Yr*Cr*1e3;return E.springs[se]=Jn,Jn}return be?vr:bn}function T(se,be){se===void 0&&(se=1),be===void 0&&(be=.5);var Ve=d(se,1,10),$e=d(be,.1,2);return function(Xe){return Xe===0||Xe===1?Xe:-Ve*Math.pow(2,10*(Xe-1))*Math.sin((Xe-1-$e/(Math.PI*2)*Math.asin(1/Ve))*(Math.PI*2)/$e)}}function R(se){return se===void 0&&(se=10),function(be){return Math.round(be*se)*(1/se)}}var O=function(){var se=11,be=1/(se-1);function Ve(Xt,Kt){return 1-3*Kt+3*Xt}function $e(Xt,Kt){return 3*Kt-6*Xt}function Xe(Xt){return 3*Xt}function ft(Xt,Kt,vr){return((Ve(Kt,vr)*Xt+$e(Kt,vr))*Xt+Xe(Kt))*Xt}function Tt(Xt,Kt,vr){return 3*Ve(Kt,vr)*Xt*Xt+2*$e(Kt,vr)*Xt+Xe(Kt)}function Gt(Xt,Kt,vr,bn,Gr){var Cr,Yr,Tn=0;do Yr=Kt+(vr-Kt)/2,Cr=ft(Yr,bn,Gr)-Xt,Cr>0?vr=Yr:Kt=Yr;while(Math.abs(Cr)>1e-7&&++Tn<10);return Yr}function Ct(Xt,Kt,vr,bn){for(var Gr=0;Gr<4;++Gr){var Cr=Tt(Kt,vr,bn);if(Cr===0)return Kt;var Yr=ft(Kt,vr,bn)-Xt;Kt-=Yr/Cr}return Kt}function ut(Xt,Kt,vr,bn){if(!(0<=Xt&&Xt<=1&&0<=vr&&vr<=1))return;var Gr=new Float32Array(se);if(Xt!==Kt||vr!==bn)for(var Cr=0;Cr<se;++Cr)Gr[Cr]=ft(Cr*be,Xt,vr);function Yr(Tn){for(var Jn=0,mr=1,Ir=se-1;mr!==Ir&&Gr[mr]<=Tn;++mr)Jn+=be;--mr;var Br=(Tn-Gr[mr])/(Gr[mr+1]-Gr[mr]),gi=Jn+Br*be,pn=Tt(gi,Xt,vr);return pn>=.001?Ct(Tn,gi,Xt,vr):pn===0?gi:Gt(Tn,Jn,Jn+be,Xt,vr)}return function(Tn){return Xt===Kt&&vr===bn||Tn===0||Tn===1?Tn:ft(Yr(Tn),Kt,bn)}}return ut}(),F=function(){var se=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],be={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],T],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(Tt,Gt){return function(Ct){return 1-T(Tt,Gt)(1-Ct)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(Tt,Gt){return function(Ct){return Ct<.5?T(Tt,Gt)(Ct*2)/2:1-T(Tt,Gt)(Ct*-2+2)/2}}]},Ve={linear:[.25,.25,.75,.75]};for(var $e in be)for(var Xe=0,ft=be[$e].length;Xe<ft;Xe++)Ve["ease"+$e+se[Xe]]=be[$e][Xe];return Ve}();function z(se,be){if(g.fnc(se))return se;var Ve=se.split("(")[0],$e=F[Ve],Xe=x(se);switch(Ve){case"spring":return L(se,be);case"cubicBezier":return f(O,Xe);case"steps":return f(R,Xe);default:return g.fnc($e)?f($e,Xe):f(O,$e)}}function re(se){try{var be=document.querySelectorAll(se);return be}catch{return}}var Y=[];function ee(se,be){for(var Ve=Y,$e=se.length,Xe=arguments.length>=2?arguments[1]:void 0,ft=0;ft<$e;ft++)if(ft in se){var Tt=se[ft];be.call(Xe,Tt,ft,se)&&Ve.push(Tt)}return Y=se,Y.length=0,Ve}function J(se,be){be||(be=[]);for(var Ve=0,$e=se.length;Ve<$e;Ve++){var Xe=se[Ve];Array.isArray(Xe)?J(Xe,be):be.push(Xe)}return be}function ce(se){return g.arr(se)?se:(g.str(se)&&(se=re(se)||se),se instanceof NodeList||se instanceof HTMLCollection?[].slice.call(se):[se])}function j(se,be){return se.some(function(Ve){return Ve===be})}function oe(se){var be={};for(var Ve in se)be[Ve]=se[Ve];return be}function Z(se,be){var Ve=oe(se);for(var $e in se)Ve[$e]=be.hasOwnProperty($e)?be[$e]:se[$e];return Ve}function ye(se,be){var Ve=oe(se);for(var $e in be)Ve[$e]=g.und(se[$e])?be[$e]:se[$e];return Ve}var Ne=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function je(se){var be=Ne.exec(se);return be?"rgba("+be[1]+",1)":se}var ke=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,it=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function rt(se){var be=se.replace(ke,function(Tt,Gt,Ct,ut){return Gt+Gt+Ct+Ct+ut+ut}),Ve=it.exec(be),$e=parseInt(Ve[1],16),Xe=parseInt(Ve[2],16),ft=parseInt(Ve[3],16);return"rgba("+$e+","+Xe+","+ft+",1)"}var Mt=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,Rt=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function Wt(se){var be=Mt.exec(se)||Rt.exec(se),Ve=parseInt(be[1],10)/360,$e=parseInt(be[2],10)/100,Xe=parseInt(be[3],10)/100,ft=be[4]||1;function Tt(vr,bn,Gr){return Gr<0&&(Gr+=1),Gr>1&&(Gr-=1),Gr<1/6?vr+(bn-vr)*6*Gr:Gr<1/2?bn:Gr<2/3?vr+(bn-vr)*(2/3-Gr)*6:vr}var Gt,Ct,ut;if($e==0)Gt=Ct=ut=Xe;else{var Xt=Xe<.5?Xe*(1+$e):Xe+$e-Xe*$e,Kt=2*Xe-Xt;Gt=Tt(Kt,Xt,Ve+1/3),Ct=Tt(Kt,Xt,Ve),ut=Tt(Kt,Xt,Ve-1/3)}return"rgba("+Gt*255+","+Ct*255+","+ut*255+","+ft+")"}function nr(se){if(g.rgb(se))return je(se);if(g.hex(se))return rt(se);if(g.hsl(se))return Wt(se)}var Dr=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function wt(se){var be=Dr.exec(se);if(be)return be[2]}function yr(se){if(v(se,"translate")||se==="perspective")return"px";if(v(se,"rotate")||v(se,"skew"))return"deg"}function ln(se,be){return g.fnc(se)?se(be.target,be.id,be.total):se}function kt(se,be){return se.getAttribute(be)}function ie(se,be,Ve){var $e=wt(be);if(j([Ve,"deg","rad","turn"],$e))return be;var Xe=E.CSS[be+Ve];if(!g.und(Xe))return Xe;var ft=100,Tt=document.createElement(se.tagName),Gt=se.parentNode&&se.parentNode!==document?se.parentNode:document.body;Gt.appendChild(Tt),Tt.style.position="absolute",Tt.style.width=ft+Ve;var Ct=ft/Tt.offsetWidth;Gt.removeChild(Tt);var ut=Ct*parseFloat(be);return E.CSS[be+Ve]=ut,ut}function ae(se,be,Ve){if(be in se.style){var $e=be.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Xe=se.style[be]||getComputedStyle(se).getPropertyValue($e)||"0";return Ve?ie(se,Xe,Ve):Xe}}function ge(se,be){if(g.dom(se)&&!g.inp(se)&&(kt(se,be)||g.svg(se)&&se[be]))return"attribute";if(g.dom(se)&&j(A,be))return"transform";if(g.dom(se)&&be!=="transform"&&ae(se,be))return"css";if(se[be]!=null)return"object"}var ve=/(\w+)\(([^)]*)\)/g;function we(se){if(g.dom(se)){for(var be=se.style.transform||"",Ve=new Map,$e;$e=ve.exec(be);)Ve.set($e[1],$e[2]);return Ve}}function Ie(se,be,Ve,$e){var Xe=v(be,"scale")?1:0+yr(be),ft=we(se).get(be)||Xe;return Ve&&(Ve.transforms.list.set(be,ft),Ve.transforms.last=be),$e?ie(se,ft,$e):ft}function Oe(se,be,Ve,$e){switch(ge(se,be)){case"transform":return Ie(se,be,$e,Ve);case"css":return ae(se,be,Ve);case"attribute":return kt(se,be);default:return se[be]||0}}var Fe=/^(\*=|\+=|-=)/;function Ye(se,be){var Ve=Fe.exec(se);if(!Ve)return se;var $e=wt(se)||0,Xe=parseFloat(be),ft=parseFloat(se.replace(Ve[0],""));switch(Ve[0][0]){case"+":return Xe+ft+$e;case"-":return Xe-ft+$e;case"*":return Xe*ft+$e}}var ot=/\s/g;function ct(se,be){if(g.col(se))return nr(se);var Ve=wt(se),$e=Ve?se.substr(0,se.length-Ve.length):se;return be&&!ot.test(se)?$e+be:$e}function mt(se,be){return Math.sqrt(Math.pow(be.x-se.x,2)+Math.pow(be.y-se.y,2))}function xt(se){return Math.PI*2*kt(se,"r")}function ne(se){return kt(se,"width")*2+kt(se,"height")*2}function U(se){return mt({x:kt(se,"x1"),y:kt(se,"y1")},{x:kt(se,"x2"),y:kt(se,"y2")})}function V(se){for(var be=se.points,Ve=0,$e,Xe=0;Xe<be.numberOfItems;Xe++){var ft=be.getItem(Xe);Xe>0&&(Ve+=mt($e,ft)),$e=ft}return Ve}function ue(se){var be=se.points;return V(se)+mt(be.getItem(be.numberOfItems-1),be.getItem(0))}function De(se){if(se.getTotalLength)return se.getTotalLength();switch(se.tagName.toLowerCase()){case"circle":return xt(se);case"rect":return ne(se);case"line":return U(se);case"polyline":return V(se);case"polygon":return ue(se)}}function Je(se){var be=De(se);return se.setAttribute("stroke-dasharray",be),be}function tt(se){for(var be=se.parentNode;g.svg(be)&&(be=be.parentNode,!!g.svg(be.parentNode)););return be}function jt(se,be){var Ve=be||{},$e=Ve.el||tt(se),Xe=$e.getBoundingClientRect(),ft=kt($e,"viewBox"),Tt=Xe.width,Gt=Xe.height,Ct=Ve.viewBox||(ft?ft.split(" "):[0,0,Tt,Gt]);return{el:$e,viewBox:Ct,x:Ct[0]/1,y:Ct[1]/1,w:Tt/Ct[2],h:Gt/Ct[3]}}function wr(se,be){var Ve=g.str(se)?re(se)[0]:se,$e=be||100;return function(Xe){return{property:Xe,el:Ve,svg:jt(Ve),totalLength:De(Ve)*($e/100)}}}function Ar(se,be){function Ve(Gt){Gt===void 0&&(Gt=0);var Ct=be+Gt>=1?be+Gt:0;return se.el.getPointAtLength(Ct)}var $e=jt(se.el,se.svg),Xe=Ve(),ft=Ve(-1),Tt=Ve(1);switch(se.property){case"x":return(Xe.x-$e.x)*$e.w;case"y":return(Xe.y-$e.y)*$e.h;case"angle":return Math.atan2(Tt.y-ft.y,Tt.x-ft.x)*180/Math.PI}}var Jt=/-?\d*\.?\d+/g;function ir(se,be){var Ve=ct(g.pth(se)?se.totalLength:se,be)+"";return{original:Ve,numbers:Ve.match(Jt)?Ve.match(Jt).map(Number):[0],strings:g.str(se)||be?Ve.split(Jt):[]}}function ar(se){var be=se?J(g.arr(se)?se.map(ce):ce(se)):[];return ee(be,function(Ve,$e,Xe){return Xe.indexOf(Ve)===$e})}function yn(se){var be=ar(se);return be.map(function(Ve,$e){return{target:Ve,id:$e,total:be.length,transforms:{list:we(Ve)}}})}var Ln=/^spring/;function An(se,be){var Ve=oe(be);if(Ln.test(Ve.easing)&&(Ve.duration=L(Ve.easing)),g.arr(se)){var $e=se.length,Xe=$e===2&&!g.obj(se[0]);Xe?se={value:se}:g.fnc(be.duration)||(Ve.duration=be.duration/$e)}var ft=g.arr(se)?se:[se];return ft.map(function(Tt,Gt){var Ct=g.obj(Tt)&&!g.pth(Tt)?Tt:{value:Tt};return g.und(Ct.delay)&&(Ct.delay=Gt?0:be.delay),g.und(Ct.endDelay)&&(Ct.endDelay=Gt===ft.length-1?be.endDelay:0),Ct}).map(function(Tt){return ye(Tt,Ve)})}function at(se){for(var be=ee(J(se.map(function(ft){return Object.keys(ft)})),function(ft){return g.key(ft)}).reduce(function(ft,Tt){return ft.indexOf(Tt)<0&&ft.push(Tt),ft},[]),Ve={},$e=function(ft){var Tt=be[ft];Ve[Tt]=se.map(function(Gt){var Ct={};for(var ut in Gt)g.key(ut)?ut==Tt&&(Ct.value=Gt[ut]):Ct[ut]=Gt[ut];return Ct})},Xe=0;Xe<be.length;Xe++)$e(Xe);return Ve}function nt(se,be){var Ve=[],$e=be.keyframes;$e&&(be=ye(at($e),be));for(var Xe in be)g.key(Xe)&&Ve.push({name:Xe,tweens:An(be[Xe],se)});return Ve}function Et(se,be){var Ve={};for(var $e in se){var Xe=ln(se[$e],be);g.arr(Xe)&&(Xe=Xe.map(function(ft){return ln(ft,be)}),Xe.length===1&&(Xe=Xe[0])),Ve[$e]=Xe}return Ve.duration=parseFloat(Ve.duration),Ve.delay=parseFloat(Ve.delay),Ve}function $t(se,be){var Ve;return se.tweens.map(function($e){var Xe=Et($e,be),ft=Xe.value,Tt=g.arr(ft)?ft[1]:ft,Gt=wt(Tt),Ct=Oe(be.target,se.name,Gt,be),ut=Ve?Ve.to.original:Ct,Xt=g.arr(ft)?ft[0]:ut,Kt=wt(Xt)||wt(Ct),vr=Gt||Kt;return g.und(Tt)&&(Tt=ut),Xe.from=ir(Xt,vr),Xe.to=ir(Ye(Tt,Xt),vr),Xe.start=Ve?Ve.end:0,Xe.end=Xe.start+Xe.delay+Xe.duration+Xe.endDelay,Xe.easing=z(Xe.easing,Xe.duration),Xe.isPath=g.pth(ft),Xe.isColor=g.col(Xe.from.original),Xe.isColor&&(Xe.round=1),Ve=Xe,Xe})}var or={css:function(se,be,Ve){return se.style[be]=Ve},attribute:function(se,be,Ve){return se.setAttribute(be,Ve)},object:function(se,be,Ve){return se[be]=Ve},transform:function(se,be,Ve,$e,Xe){if($e.list.set(be,Ve),be===$e.last||Xe){var ft="";$e.list.forEach(function(Tt,Gt){ft+=Gt+"("+Tt+") "}),se.style.transform=ft}}};function pr(se,be){for(var Ve=yn(se),$e=0,Xe=Ve.length;$e<Xe;$e++){var ft=Ve[$e];for(var Tt in be){var Gt=ln(be[Tt],ft),Ct=ft.target,ut=wt(Gt),Xt=Oe(Ct,Tt,ut,ft),Kt=ut||wt(Xt),vr=Ye(ct(Gt,Kt),Xt),bn=ge(Ct,Tt);or[bn](Ct,Tt,vr,ft.transforms,!0)}}}function cr(se,be){var Ve=ge(se.target,be.name);if(Ve){var $e=$t(be,se),Xe=$e[$e.length-1];return{type:Ve,property:be.name,animatable:se,tweens:$e,duration:Xe.end,delay:$e[0].delay,endDelay:Xe.endDelay}}}function Pr(se,be){return ee(J(se.map(function(Ve){return be.map(function($e){return cr(Ve,$e)})})),function(Ve){return!g.und(Ve)})}function $r(se,be){var Ve=se.length,$e=function(ft){return ft.timelineOffset?ft.timelineOffset:0},Xe={};return Xe.duration=Ve?Math.max.apply(Math,se.map(function(ft){return $e(ft)+ft.duration})):be.duration,Xe.delay=Ve?Math.min.apply(Math,se.map(function(ft){return $e(ft)+ft.delay})):be.delay,Xe.endDelay=Ve?Xe.duration-Math.max.apply(Math,se.map(function(ft){return $e(ft)+ft.duration-ft.endDelay})):be.endDelay,Xe}var Hr=0;function Xn(se){var be=Z(l,se),Ve=Z(w,se),$e=nt(Ve,se),Xe=yn(se.targets),ft=Pr(Xe,$e),Tt=$r(ft,Ve),Gt=Hr;return Hr++,ye(be,{id:Gt,children:[],animatables:Xe,animations:ft,duration:Tt.duration,delay:Tt.delay,endDelay:Tt.endDelay})}var en=[],Xr=[],fn,Mi=function(){function se(){fn=requestAnimationFrame(be)}function be(Ve){var $e=en.length;if($e){for(var Xe=0;Xe<$e;){var ft=en[Xe];if(!ft.paused)ft.tick(Ve);else{var Tt=en.indexOf(ft);Tt>-1&&(en.splice(Tt,1),$e=en.length)}Xe++}se()}else fn=cancelAnimationFrame(fn)}return se}();function ai(){if(document.hidden){for(var se=0,be=en.length;se<be;se++)activeInstance[se].pause();Xr=en.slice(0),en=[]}else for(var Ve=0,$e=Xr.length;Ve<$e;Ve++)Xr[Ve].play()}document.addEventListener("visibilitychange",ai);function rn(se){se===void 0&&(se={});var be=0,Ve=0,$e=0,Xe,ft=0,Tt=null;function Gt(){return window.Promise&&new Promise(function(mr){return Tt=mr})}var Ct=Gt(),ut=Xn(se);function Xt(){ut.reversed=!ut.reversed;for(var mr=0,Ir=Xe.length;mr<Ir;mr++)Xe[mr].reversed=ut.reversed}function Kt(mr){return ut.reversed?ut.duration-mr:mr}function vr(){be=0,Ve=Kt(ut.currentTime)*(1/rn.speed)}function bn(mr,Ir){Ir&&Ir.seek(mr-Ir.timelineOffset)}function Gr(mr){if(ut.reversePlayback)for(var Br=ft;Br--;)bn(mr,Xe[Br]);else for(var Ir=0;Ir<ft;Ir++)bn(mr,Xe[Ir])}function Cr(mr){for(var Ir=0,Br=ut.animations,gi=Br.length;Ir<gi;){var pn=Br[Ir],En=pn.animatable,I=pn.tweens,k=I.length-1,X=I[k];k&&(X=ee(I,function(cn){return mr<cn.end})[0]||X);for(var q=d(mr-X.start-X.delay,0,X.duration)/X.duration,de=isNaN(q)?1:X.easing(q),Re=X.to.strings,Ge=X.round,vt=[],pt=X.to.numbers.length,We=void 0,et=0;et<pt;et++){var At=void 0,Ut=X.to.numbers[et],Yt=X.from.numbers[et]||0;X.isPath?At=Ar(X.value,de*Ut):At=Yt+de*(Ut-Yt),Ge&&(X.isColor&&et>2||(At=Math.round(At*Ge)/Ge)),vt.push(At)}var er=Re.length;if(!er)We=vt[0];else{We=Re[0];for(var Lr=0;Lr<er;Lr++){Re[Lr];var br=Re[Lr+1],ur=vt[Lr];isNaN(ur)||(br?We+=ur+br:We+=ur+" ")}}or[pn.type](En.target,pn.property,We,En.transforms),pn.currentValue=We,Ir++}}function Yr(mr){ut[mr]&&!ut.passThrough&&ut[mr](ut)}function Tn(){ut.remaining&&ut.remaining!==!0&&ut.remaining--}function Jn(mr){var Ir=ut.duration,Br=ut.delay,gi=Ir-ut.endDelay,pn=Kt(mr);ut.progress=d(pn/Ir*100,0,100),ut.reversePlayback=pn<ut.currentTime,Xe&&Gr(pn),!ut.began&&ut.currentTime>0&&(ut.began=!0,Yr("begin"),Yr("loopBegin")),pn<=Br&&ut.currentTime!==0&&Cr(0),(pn>=gi&&ut.currentTime!==Ir||!Ir)&&Cr(Ir),pn>Br&&pn<gi?(ut.changeBegan||(ut.changeBegan=!0,ut.changeCompleted=!1,Yr("changeBegin")),Yr("change"),Cr(pn)):ut.changeBegan&&(ut.changeCompleted=!0,ut.changeBegan=!1,Yr("changeComplete")),ut.currentTime=d(pn,0,Ir),ut.began&&Yr("update"),mr>=Ir&&(Ve=0,Tn(),ut.remaining?(be=$e,Yr("loopComplete"),Yr("loopBegin"),ut.direction==="alternate"&&Xt()):(ut.paused=!0,ut.completed||(ut.completed=!0,Yr("loopComplete"),Yr("complete"),"Promise"in window&&(Tt(),Ct=Gt()))))}return ut.reset=function(){var mr=ut.direction;ut.passThrough=!1,ut.currentTime=0,ut.progress=0,ut.paused=!0,ut.began=!1,ut.changeBegan=!1,ut.completed=!1,ut.changeCompleted=!1,ut.reversePlayback=!1,ut.reversed=mr==="reverse",ut.remaining=ut.loop,Xe=ut.children,ft=Xe.length;for(var Ir=ft;Ir--;)ut.children[Ir].reset();(ut.reversed&&ut.loop!==!0||mr==="alternate"&&ut.loop===1)&&ut.remaining++,Cr(0)},ut.set=function(mr,Ir){return pr(mr,Ir),ut},ut.tick=function(mr){$e=mr,be||(be=$e),Jn(($e+(Ve-be))*rn.speed)},ut.seek=function(mr){Jn(Kt(mr))},ut.pause=function(){ut.paused=!0,vr()},ut.play=function(){ut.paused&&(ut.paused=!1,en.push(ut),vr(),fn||Mi())},ut.reverse=function(){Xt(),vr()},ut.restart=function(){ut.reset(),ut.play()},ut.finished=Ct,ut.reset(),ut.autoplay&&ut.play(),ut}function Ui(se,be){for(var Ve=be.length;Ve--;)j(se,be[Ve].animatable.target)&&be.splice(Ve,1)}function ei(se){for(var be=ar(se),Ve=en.length;Ve--;){var $e=en[Ve],Xe=$e.animations,ft=$e.children;Ui(be,Xe);for(var Tt=ft.length;Tt--;){var Gt=ft[Tt],Ct=Gt.animations;Ui(be,Ct),!Ct.length&&!Gt.children.length&&ft.splice(Tt,1)}!Xe.length&&!ft.length&&$e.pause()}}function Hi(se,be){be===void 0&&(be={});var Ve=be.direction||"normal",$e=be.easing?z(be.easing):null,Xe=be.grid,ft=be.axis,Tt=be.from||0,Gt=Tt==="first",Ct=Tt==="center",ut=Tt==="last",Xt=g.arr(se),Kt=parseFloat(Xt?se[0]:se),vr=Xt?parseFloat(se[1]):0,bn=wt(Xt?se[1]:se)||0,Gr=be.start||0+(Xt?Kt:0),Cr=[],Yr=0;return function(Tn,Jn,mr){if(Gt&&(Tt=0),Ct&&(Tt=(mr-1)/2),ut&&(Tt=mr-1),!Cr.length){for(var Ir=0;Ir<mr;Ir++){if(!Xe)Cr.push(Math.abs(Tt-Ir));else{var Br=Ct?(Xe[0]-1)/2:Tt%Xe[0],gi=Ct?(Xe[1]-1)/2:Math.floor(Tt/Xe[0]),pn=Ir%Xe[0],En=Math.floor(Ir/Xe[0]),I=Br-pn,k=gi-En,X=Math.sqrt(I*I+k*k);ft==="x"&&(X=-I),ft==="y"&&(X=-k),Cr.push(X)}Yr=Math.max.apply(Math,Cr)}$e&&(Cr=Cr.map(function(de){return $e(de/Yr)*Yr})),Ve==="reverse"&&(Cr=Cr.map(function(de){return ft?de<0?de*-1:-de:Math.abs(Yr-de)}))}var q=Xt?(vr-Kt)/Yr:Kt;return Gr+q*(Math.round(Cr[Jn]*100)/100)+bn}}function ti(se){se===void 0&&(se={});var be=rn(se);return be.duration=0,be.add=function(Ve,$e){var Xe=en.indexOf(be),ft=be.children;Xe>-1&&en.splice(Xe,1);function Tt(vr){vr.passThrough=!0}for(var Gt=0;Gt<ft.length;Gt++)Tt(ft[Gt]);var Ct=ye(Ve,Z(w,se));Ct.targets=Ct.targets||se.targets;var ut=be.duration;Ct.autoplay=!1,Ct.direction=be.direction,Ct.timelineOffset=g.und($e)?ut:Ye($e,ut),Tt(be),be.seek(Ct.timelineOffset);var Xt=rn(Ct);Tt(Xt),ft.push(Xt);var Kt=$r(ft,se);return be.delay=Kt.delay,be.endDelay=Kt.endDelay,be.duration=Kt.duration,be.seek(0),be.reset(),be.autoplay&&be.play(),be},be}rn.version="3.0.0",rn.speed=1,rn.running=en,rn.remove=ei,rn.get=Oe,rn.set=pr,rn.convertPx=ie,rn.path=wr,rn.setDashoffset=Je,rn.stagger=Hi,rn.timeline=ti,rn.easing=z,rn.penner=F,rn.random=function(se,be){return Math.floor(Math.random()*(be-se+1))+se},N.exports=rn},{}],57:[function(M,N,$){(function(l,w){w(typeof $=="object"&&typeof N<"u"?$:globalThis.THREE={})})(this,function(l){Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(a){return typeof a=="number"&&isFinite(a)&&Math.floor(a)===a}),Math.sign===void 0&&(Math.sign=function(a){return a<0?-1:a>0?1:+a}),"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&(Object.assign=function(a){if(a==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(a),i=1;i<arguments.length;i++){var r=arguments[i];if(r!=null)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t});var w=function(a){var t=Object.prototype,i=t.hasOwnProperty,r,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";function h(Te,me,Ue){return Object.defineProperty(Te,me,{value:Ue,enumerable:!0,configurable:!0,writable:!0}),Te[me]}try{h({},"")}catch{h=function(Ue,He,Qe){return Ue[He]=Qe}}function p(Te,me,Ue,He){var Qe=me&&me.prototype instanceof W?me:W,qe=Object.create(Qe.prototype),gt=new Ae(He||[]);return qe._invoke=xe(Te,Ue,gt),qe}a.wrap=p;function C(Te,me,Ue){try{return{type:"normal",arg:Te.call(me,Ue)}}catch(He){return{type:"throw",arg:He}}}var _="suspendedStart",S="suspendedYield",D="executing",P="completed",H={};function W(){}function G(){}function B(){}var te={};te[o]=function(){return this};var he=Object.getPrototypeOf,K=he&&he(he(Be([])));K&&K!==t&&i.call(K,o)&&(te=K);var Q=B.prototype=W.prototype=Object.create(te);G.prototype=Q.constructor=B,B.constructor=G,G.displayName=h(B,c,"GeneratorFunction");function le(Te){["next","throw","return"].forEach(function(me){h(Te,me,function(Ue){return this._invoke(me,Ue)})})}a.isGeneratorFunction=function(Te){var me=typeof Te=="function"&&Te.constructor;return me?me===G||(me.displayName||me.name)==="GeneratorFunction":!1},a.mark=function(Te){return Object.setPrototypeOf?Object.setPrototypeOf(Te,B):(Te.__proto__=B,h(Te,c,"GeneratorFunction")),Te.prototype=Object.create(Q),Te},a.awrap=function(Te){return{__await:Te}};function Me(Te,me){function Ue(qe,gt,St,Vt){var Ke=C(Te[qe],Te,gt);if(Ke.type==="throw")Vt(Ke.arg);else{var rr=Ke.arg,Bt=rr.value;return Bt&&typeof Bt=="object"&&i.call(Bt,"__await")?me.resolve(Bt.__await).then(function(sr){Ue("next",sr,St,Vt)},function(sr){Ue("throw",sr,St,Vt)}):me.resolve(Bt).then(function(sr){rr.value=sr,St(rr)},function(sr){return Ue("throw",sr,St,Vt)})}}var He;function Qe(qe,gt){function St(){return new me(function(Vt,Ke){Ue(qe,gt,Vt,Ke)})}return He=He?He.then(St,St):St()}this._invoke=Qe}le(Me.prototype),Me.prototype[s]=function(){return this},a.AsyncIterator=Me,a.async=function(Te,me,Ue,He,Qe){Qe===void 0&&(Qe=Promise);var qe=new Me(p(Te,me,Ue,He),Qe);return a.isGeneratorFunction(me)?qe:qe.next().then(function(gt){return gt.done?gt.value:qe.next()})};function xe(Te,me,Ue){var He=_;return function(qe,gt){if(He===D)throw new Error("Generator is already running");if(He===P){if(qe==="throw")throw gt;return Se()}for(Ue.method=qe,Ue.arg=gt;;){var St=Ue.delegate;if(St){var Vt=_e(St,Ue);if(Vt){if(Vt===H)continue;return Vt}}if(Ue.method==="next")Ue.sent=Ue._sent=Ue.arg;else if(Ue.method==="throw"){if(He===_)throw He=P,Ue.arg;Ue.dispatchException(Ue.arg)}else Ue.method==="return"&&Ue.abrupt("return",Ue.arg);He=D;var Ke=C(Te,me,Ue);if(Ke.type==="normal"){if(He=Ue.done?P:S,Ke.arg===H)continue;return{value:Ke.arg,done:Ue.done}}else Ke.type==="throw"&&(He=P,Ue.method="throw",Ue.arg=Ke.arg)}}}function _e(Te,me){var Ue=Te.iterator[me.method];if(Ue===r){if(me.delegate=null,me.method==="throw"){if(Te.iterator.return&&(me.method="return",me.arg=r,_e(Te,me),me.method==="throw"))return H;me.method="throw",me.arg=new TypeError("The iterator does not provide a 'throw' method")}return H}var He=C(Ue,Te.iterator,me.arg);if(He.type==="throw")return me.method="throw",me.arg=He.arg,me.delegate=null,H;var Qe=He.arg;if(!Qe)return me.method="throw",me.arg=new TypeError("iterator result is not an object"),me.delegate=null,H;if(Qe.done)me[Te.resultName]=Qe.value,me.next=Te.nextLoc,me.method!=="return"&&(me.method="next",me.arg=r);else return Qe;return me.delegate=null,H}le(Q),h(Q,c,"Generator"),Q[o]=function(){return this},Q.toString=function(){return"[object Generator]"};function Pe(Te){var me={tryLoc:Te[0]};1 in Te&&(me.catchLoc=Te[1]),2 in Te&&(me.finallyLoc=Te[2],me.afterLoc=Te[3]),this.tryEntries.push(me)}function Ce(Te){var me=Te.completion||{};me.type="normal",delete me.arg,Te.completion=me}function Ae(Te){this.tryEntries=[{tryLoc:"root"}],Te.forEach(Pe,this),this.reset(!0)}a.keys=function(Te){var me=[];for(var Ue in Te)me.push(Ue);return me.reverse(),function He(){for(;me.length;){var Qe=me.pop();if(Qe in Te)return He.value=Qe,He.done=!1,He}return He.done=!0,He}};function Be(Te){if(Te){var me=Te[o];if(me)return me.call(Te);if(typeof Te.next=="function")return Te;if(!isNaN(Te.length)){var Ue=-1,He=function Qe(){for(;++Ue<Te.length;)if(i.call(Te,Ue))return Qe.value=Te[Ue],Qe.done=!1,Qe;return Qe.value=r,Qe.done=!0,Qe};return He.next=He}}return{next:Se}}a.values=Be;function Se(){return{value:r,done:!0}}return Ae.prototype={constructor:Ae,reset:function(me){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(Ce),!me)for(var Ue in this)Ue.charAt(0)==="t"&&i.call(this,Ue)&&!isNaN(+Ue.slice(1))&&(this[Ue]=r)},stop:function(){this.done=!0;var me=this.tryEntries[0],Ue=me.completion;if(Ue.type==="throw")throw Ue.arg;return this.rval},dispatchException:function(me){if(this.done)throw me;var Ue=this;function He(Ke,rr){return gt.type="throw",gt.arg=me,Ue.next=Ke,rr&&(Ue.method="next",Ue.arg=r),!!rr}for(var Qe=this.tryEntries.length-1;Qe>=0;--Qe){var qe=this.tryEntries[Qe],gt=qe.completion;if(qe.tryLoc==="root")return He("end");if(qe.tryLoc<=this.prev){var St=i.call(qe,"catchLoc"),Vt=i.call(qe,"finallyLoc");if(St&&Vt){if(this.prev<qe.catchLoc)return He(qe.catchLoc,!0);if(this.prev<qe.finallyLoc)return He(qe.finallyLoc)}else if(St){if(this.prev<qe.catchLoc)return He(qe.catchLoc,!0)}else if(Vt){if(this.prev<qe.finallyLoc)return He(qe.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(me,Ue){for(var He=this.tryEntries.length-1;He>=0;--He){var Qe=this.tryEntries[He];if(Qe.tryLoc<=this.prev&&i.call(Qe,"finallyLoc")&&this.prev<Qe.finallyLoc){var qe=Qe;break}}qe&&(me==="break"||me==="continue")&&qe.tryLoc<=Ue&&Ue<=qe.finallyLoc&&(qe=null);var gt=qe?qe.completion:{};return gt.type=me,gt.arg=Ue,qe?(this.method="next",this.next=qe.finallyLoc,H):this.complete(gt)},complete:function(me,Ue){if(me.type==="throw")throw me.arg;return me.type==="break"||me.type==="continue"?this.next=me.arg:me.type==="return"?(this.rval=this.arg=me.arg,this.method="return",this.next="end"):me.type==="normal"&&Ue&&(this.next=Ue),H},finish:function(me){for(var Ue=this.tryEntries.length-1;Ue>=0;--Ue){var He=this.tryEntries[Ue];if(He.finallyLoc===me)return this.complete(He.completion,He.afterLoc),Ce(He),H}},catch:function(me){for(var Ue=this.tryEntries.length-1;Ue>=0;--Ue){var He=this.tryEntries[Ue];if(He.tryLoc===me){var Qe=He.completion;if(Qe.type==="throw"){var qe=Qe.arg;Ce(He)}return qe}}throw new Error("illegal catch attempt")},delegateYield:function(me,Ue,He){return this.delegate={iterator:Be(me),resultName:Ue,nextLoc:He},this.method==="next"&&(this.arg=r),H}},a}(typeof N=="object"?N.exports:{});try{regeneratorRuntime=w}catch{Function("r","regeneratorRuntime = r")(w)}var A="125",E={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},d={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},v=0,f=1,m=2,u=3,b=0,g=1,y=2,x=3,L=0,T=1,R=2,O=1,F=2,z=0,re=1,Y=2,ee=3,J=4,ce=5,j=100,oe=101,Z=102,ye=103,Ne=104,je=200,ke=201,it=202,rt=203,Mt=204,Rt=205,Wt=206,nr=207,Dr=208,wt=209,yr=210,ln=0,kt=1,ie=2,ae=3,ge=4,ve=5,we=6,Ie=7,Oe=0,Fe=1,Ye=2,ot=0,ct=1,mt=2,xt=3,ne=4,U=5,V=300,ue=301,De=302,Je=303,tt=304,jt=306,wr=307,Ar=1e3,Jt=1001,ir=1002,ar=1003,yn=1004,Ln=1004,An=1005,at=1005,nt=1006,Et=1007,$t=1007,or=1008,pr=1008,cr=1009,Pr=1010,$r=1011,Hr=1012,Xn=1013,en=1014,Xr=1015,fn=1016,Mi=1017,ai=1018,rn=1019,Ui=1020,ei=1021,Hi=1022,ti=1023,se=1024,be=1025,Ve=ti,$e=1026,Xe=1027,ft=1028,Tt=1029,Gt=1030,Ct=1031,ut=1032,Xt=1033,Kt=33776,vr=33777,bn=33778,Gr=33779,Cr=35840,Yr=35841,Tn=35842,Jn=35843,mr=36196,Ir=37492,Br=37496,gi=37808,pn=37809,En=37810,I=37811,k=37812,X=37813,q=37814,de=37815,Re=37816,Ge=37817,vt=37818,pt=37819,We=37820,et=37821,At=36492,Ut=37840,Yt=37841,er=37842,Lr=37843,br=37844,ur=37845,cn=37846,On=37847,Hn=37848,Sn=37849,Qn=37850,oi=37851,si=37852,li=37853,ci=2200,Xi=2201,Ya=2202,Yi=2300,Qi=2301,da=2302,Ti=2400,Si=2401,qi=2402,fa=2500,Ca=2501,Qa=0,wo=1,Gn=2,yi=3e3,Is=3001,Ll=3007,Rl=3002,Bh=3003,iu=3004,au=3005,ou=3006,Fh=3200,Nh=3201,xo=0,kh=1,lp=0,Pl=7680,cp=7681,up=7682,hp=7683,dp=34055,fp=34056,pp=5386,vp=512,mp=513,gp=514,yp=515,Ap=516,bp=517,Ep=518,Uh=519,Bs=35044,Mo=35048,wp=35040,xp=35045,Mp=35049,Tp=35041,Sp=35046,_p=35050,Cp=35042,Lp="100",su="300 es";function Hh(a,t,i,r,n,o,s){try{var c=a[o](s),h=c.value}catch(p){i(p);return}c.done?t(h):Promise.resolve(h).then(r,n)}function Rp(a){return function(){var t=this,i=arguments;return new Promise(function(r,n){var o=a.apply(t,i);function s(h){Hh(o,r,n,s,c,"next",h)}function c(h){Hh(o,r,n,s,c,"throw",h)}s(void 0)})}}function Pp(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Dl(a,t,i){return t&&Pp(a.prototype,t),a}function Or(a,t){a.prototype=Object.create(t.prototype),a.prototype.constructor=a,a.__proto__=t}function Ji(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Dp(a,t){if(a){if(typeof a=="string")return Gh(a,t);var i=Object.prototype.toString.call(a).slice(8,-1);if(i==="Object"&&a.constructor&&(i=a.constructor.name),i==="Map"||i==="Set")return Array.from(a);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Gh(a,t)}}function Gh(a,t){(t==null||t>a.length)&&(t=a.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=a[i];return r}function Op(a,t){var i;if(typeof Symbol>"u"||a[Symbol.iterator]==null){if(Array.isArray(a)||(i=Dp(a))||t){i&&(a=i);var r=0;return function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return i=a[Symbol.iterator](),i.next.bind(i)}function pa(){}Object.assign(pa.prototype,{addEventListener:function(t,i){this._listeners===void 0&&(this._listeners={});var r=this._listeners;r[t]===void 0&&(r[t]=[]),r[t].indexOf(i)===-1&&r[t].push(i)},hasEventListener:function(t,i){if(this._listeners===void 0)return!1;var r=this._listeners;return r[t]!==void 0&&r[t].indexOf(i)!==-1},removeEventListener:function(t,i){if(this._listeners!==void 0){var r=this._listeners,n=r[t];if(n!==void 0){var o=n.indexOf(i);o!==-1&&n.splice(o,1)}}},dispatchEvent:function(t){if(this._listeners!==void 0){var i=this._listeners,r=i[t.type];if(r!==void 0){t.target=this;for(var n=r.slice(0),o=0,s=n.length;o<s;o++)n[o].call(this,t)}}}});for(var ri=[],Fs=0;Fs<256;Fs++)ri[Fs]=(Fs<16?"0":"")+Fs.toString(16);var Ol=1234567,gr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=Math.random()*4294967295|0,i=Math.random()*4294967295|0,r=Math.random()*4294967295|0,n=Math.random()*4294967295|0,o=ri[t&255]+ri[t>>8&255]+ri[t>>16&255]+ri[t>>24&255]+"-"+ri[i&255]+ri[i>>8&255]+"-"+ri[i>>16&15|64]+ri[i>>24&255]+"-"+ri[r&63|128]+ri[r>>8&255]+"-"+ri[r>>16&255]+ri[r>>24&255]+ri[n&255]+ri[n>>8&255]+ri[n>>16&255]+ri[n>>24&255];return o.toUpperCase()},clamp:function(t,i,r){return Math.max(i,Math.min(r,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,r,n,o){return n+(t-i)*(o-n)/(r-i)},lerp:function(t,i,r){return(1-r)*t+r*i},damp:function(t,i,r,n){return gr.lerp(t,i,1-Math.exp(-r*n))},pingpong:function(t,i){return i===void 0&&(i=1),i-Math.abs(gr.euclideanModulo(t,i*2)-i)},smoothstep:function(t,i,r){return t<=i?0:t>=r?1:(t=(t-i)/(r-i),t*t*(3-2*t))},smootherstep:function(t,i,r){return t<=i?0:t>=r?1:(t=(t-i)/(r-i),t*t*t*(t*(t*6-15)+10))},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return t!==void 0&&(Ol=t%2147483647),Ol=Ol*16807%2147483647,(Ol-1)/2147483646},degToRad:function(t){return t*gr.DEG2RAD},radToDeg:function(t){return t*gr.RAD2DEG},isPowerOfTwo:function(t){return(t&t-1)===0&&t!==0},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,i,r,n,o){var s=Math.cos,c=Math.sin,h=s(r/2),p=c(r/2),C=s((i+n)/2),_=c((i+n)/2),S=s((i-n)/2),D=c((i-n)/2),P=s((n-i)/2),H=c((n-i)/2);switch(o){case"XYX":t.set(h*_,p*S,p*D,h*C);break;case"YZY":t.set(p*D,h*_,p*S,h*C);break;case"ZXZ":t.set(p*S,p*D,h*_,h*C);break;case"XZX":t.set(h*_,p*H,p*P,h*C);break;case"YXY":t.set(p*P,h*_,p*H,h*C);break;case"ZYZ":t.set(p*H,p*P,h*_,h*C);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+o)}}},bt=function(){function a(i,r){i===void 0&&(i=0),r===void 0&&(r=0),Object.defineProperty(this,"isVector2",{value:!0}),this.x=i,this.y=r}var t=a.prototype;return t.set=function(r,n){return this.x=r,this.y=n,this},t.setScalar=function(r){return this.x=r,this.y=r,this},t.setX=function(r){return this.x=r,this},t.setY=function(r){return this.y=r,this},t.setComponent=function(r,n){switch(r){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+r)}return this},t.getComponent=function(r){switch(r){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+r)}},t.clone=function(){return new this.constructor(this.x,this.y)},t.copy=function(r){return this.x=r.x,this.y=r.y,this},t.add=function(r,n){return n!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(r,n)):(this.x+=r.x,this.y+=r.y,this)},t.addScalar=function(r){return this.x+=r,this.y+=r,this},t.addVectors=function(r,n){return this.x=r.x+n.x,this.y=r.y+n.y,this},t.addScaledVector=function(r,n){return this.x+=r.x*n,this.y+=r.y*n,this},t.sub=function(r,n){return n!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(r,n)):(this.x-=r.x,this.y-=r.y,this)},t.subScalar=function(r){return this.x-=r,this.y-=r,this},t.subVectors=function(r,n){return this.x=r.x-n.x,this.y=r.y-n.y,this},t.multiply=function(r){return this.x*=r.x,this.y*=r.y,this},t.multiplyScalar=function(r){return this.x*=r,this.y*=r,this},t.divide=function(r){return this.x/=r.x,this.y/=r.y,this},t.divideScalar=function(r){return this.multiplyScalar(1/r)},t.applyMatrix3=function(r){var n=this.x,o=this.y,s=r.elements;return this.x=s[0]*n+s[3]*o+s[6],this.y=s[1]*n+s[4]*o+s[7],this},t.min=function(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this},t.max=function(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this},t.clamp=function(r,n){return this.x=Math.max(r.x,Math.min(n.x,this.x)),this.y=Math.max(r.y,Math.min(n.y,this.y)),this},t.clampScalar=function(r,n){return this.x=Math.max(r,Math.min(n,this.x)),this.y=Math.max(r,Math.min(n,this.y)),this},t.clampLength=function(r,n){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(r,Math.min(n,o)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.dot=function(r){return this.x*r.x+this.y*r.y},t.cross=function(r){return this.x*r.y-this.y*r.x},t.lengthSq=function(){return this.x*this.x+this.y*this.y},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.angle=function(){var r=Math.atan2(-this.y,-this.x)+Math.PI;return r},t.distanceTo=function(r){return Math.sqrt(this.distanceToSquared(r))},t.distanceToSquared=function(r){var n=this.x-r.x,o=this.y-r.y;return n*n+o*o},t.manhattanDistanceTo=function(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)},t.setLength=function(r){return this.normalize().multiplyScalar(r)},t.lerp=function(r,n){return this.x+=(r.x-this.x)*n,this.y+=(r.y-this.y)*n,this},t.lerpVectors=function(r,n,o){return this.x=r.x+(n.x-r.x)*o,this.y=r.y+(n.y-r.y)*o,this},t.equals=function(r){return r.x===this.x&&r.y===this.y},t.fromArray=function(r,n){return n===void 0&&(n=0),this.x=r[n],this.y=r[n+1],this},t.toArray=function(r,n){return r===void 0&&(r=[]),n===void 0&&(n=0),r[n]=this.x,r[n+1]=this.y,r},t.fromBufferAttribute=function(r,n,o){return o!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=r.getX(n),this.y=r.getY(n),this},t.rotateAround=function(r,n){var o=Math.cos(n),s=Math.sin(n),c=this.x-r.x,h=this.y-r.y;return this.x=c*o-h*s+r.x,this.y=c*s+h*o+r.y,this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this},Dl(a,[{key:"width",get:function(){return this.x},set:function(r){this.x=r}},{key:"height",get:function(){return this.y},set:function(r){this.y=r}}]),a}(),_i=function(){function a(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var t=a.prototype;return t.set=function(r,n,o,s,c,h,p,C,_){var S=this.elements;return S[0]=r,S[1]=s,S[2]=p,S[3]=n,S[4]=c,S[5]=C,S[6]=o,S[7]=h,S[8]=_,this},t.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},t.clone=function(){return new this.constructor().fromArray(this.elements)},t.copy=function(r){var n=this.elements,o=r.elements;return n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=o[3],n[4]=o[4],n[5]=o[5],n[6]=o[6],n[7]=o[7],n[8]=o[8],this},t.extractBasis=function(r,n,o){return r.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),o.setFromMatrix3Column(this,2),this},t.setFromMatrix4=function(r){var n=r.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this},t.multiply=function(r){return this.multiplyMatrices(this,r)},t.premultiply=function(r){return this.multiplyMatrices(r,this)},t.multiplyMatrices=function(r,n){var o=r.elements,s=n.elements,c=this.elements,h=o[0],p=o[3],C=o[6],_=o[1],S=o[4],D=o[7],P=o[2],H=o[5],W=o[8],G=s[0],B=s[3],te=s[6],he=s[1],K=s[4],Q=s[7],le=s[2],Me=s[5],xe=s[8];return c[0]=h*G+p*he+C*le,c[3]=h*B+p*K+C*Me,c[6]=h*te+p*Q+C*xe,c[1]=_*G+S*he+D*le,c[4]=_*B+S*K+D*Me,c[7]=_*te+S*Q+D*xe,c[2]=P*G+H*he+W*le,c[5]=P*B+H*K+W*Me,c[8]=P*te+H*Q+W*xe,this},t.multiplyScalar=function(r){var n=this.elements;return n[0]*=r,n[3]*=r,n[6]*=r,n[1]*=r,n[4]*=r,n[7]*=r,n[2]*=r,n[5]*=r,n[8]*=r,this},t.determinant=function(){var r=this.elements,n=r[0],o=r[1],s=r[2],c=r[3],h=r[4],p=r[5],C=r[6],_=r[7],S=r[8];return n*h*S-n*p*_-o*c*S+o*p*C+s*c*_-s*h*C},t.invert=function(){var r=this.elements,n=r[0],o=r[1],s=r[2],c=r[3],h=r[4],p=r[5],C=r[6],_=r[7],S=r[8],D=S*h-p*_,P=p*C-S*c,H=_*c-h*C,W=n*D+o*P+s*H;if(W===0)return this.set(0,0,0,0,0,0,0,0,0);var G=1/W;return r[0]=D*G,r[1]=(s*_-S*o)*G,r[2]=(p*o-s*h)*G,r[3]=P*G,r[4]=(S*n-s*C)*G,r[5]=(s*c-p*n)*G,r[6]=H*G,r[7]=(o*C-_*n)*G,r[8]=(h*n-o*c)*G,this},t.transpose=function(){var r,n=this.elements;return r=n[1],n[1]=n[3],n[3]=r,r=n[2],n[2]=n[6],n[6]=r,r=n[5],n[5]=n[7],n[7]=r,this},t.getNormalMatrix=function(r){return this.setFromMatrix4(r).copy(this).invert().transpose()},t.transposeIntoArray=function(r){var n=this.elements;return r[0]=n[0],r[1]=n[3],r[2]=n[6],r[3]=n[1],r[4]=n[4],r[5]=n[7],r[6]=n[2],r[7]=n[5],r[8]=n[8],this},t.setUvTransform=function(r,n,o,s,c,h,p){var C=Math.cos(c),_=Math.sin(c);return this.set(o*C,o*_,-o*(C*h+_*p)+h+r,-s*_,s*C,-s*(-_*h+C*p)+p+n,0,0,1),this},t.scale=function(r,n){var o=this.elements;return o[0]*=r,o[3]*=r,o[6]*=r,o[1]*=n,o[4]*=n,o[7]*=n,this},t.rotate=function(r){var n=Math.cos(r),o=Math.sin(r),s=this.elements,c=s[0],h=s[3],p=s[6],C=s[1],_=s[4],S=s[7];return s[0]=n*c+o*C,s[3]=n*h+o*_,s[6]=n*p+o*S,s[1]=-o*c+n*C,s[4]=-o*h+n*_,s[7]=-o*p+n*S,this},t.translate=function(r,n){var o=this.elements;return o[0]+=r*o[2],o[3]+=r*o[5],o[6]+=r*o[8],o[1]+=n*o[2],o[4]+=n*o[5],o[7]+=n*o[8],this},t.equals=function(r){for(var n=this.elements,o=r.elements,s=0;s<9;s++)if(n[s]!==o[s])return!1;return!0},t.fromArray=function(r,n){n===void 0&&(n=0);for(var o=0;o<9;o++)this.elements[o]=r[o+n];return this},t.toArray=function(r,n){r===void 0&&(r=[]),n===void 0&&(n=0);var o=this.elements;return r[n]=o[0],r[n+1]=o[1],r[n+2]=o[2],r[n+3]=o[3],r[n+4]=o[4],r[n+5]=o[5],r[n+6]=o[6],r[n+7]=o[7],r[n+8]=o[8],r},a}(),Jo,To={getDataURL:function(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;var i;if(t instanceof HTMLCanvasElement)i=t;else{Jo===void 0&&(Jo=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Jo.width=t.width,Jo.height=t.height;var r=Jo.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height),i=Jo}return i.width>2048||i.height>2048?i.toDataURL("image/jpeg",.6):i.toDataURL("image/png")}},Ip=0;function vn(a,t,i,r,n,o,s,c,h,p){a===void 0&&(a=vn.DEFAULT_IMAGE),t===void 0&&(t=vn.DEFAULT_MAPPING),i===void 0&&(i=Jt),r===void 0&&(r=Jt),n===void 0&&(n=nt),o===void 0&&(o=or),s===void 0&&(s=ti),c===void 0&&(c=cr),h===void 0&&(h=1),p===void 0&&(p=yi),Object.defineProperty(this,"id",{value:Ip++}),this.uuid=gr.generateUUID(),this.name="",this.image=a,this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=r,this.magFilter=n,this.minFilter=o,this.anisotropy=h,this.format=s,this.internalFormat=null,this.type=c,this.offset=new bt(0,0),this.repeat=new bt(1,1),this.center=new bt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new _i,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=p,this.version=0,this.onUpdate=null}vn.DEFAULT_IMAGE=void 0,vn.DEFAULT_MAPPING=V,vn.prototype=Object.assign(Object.create(pa.prototype),{constructor:vn,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var i=t===void 0||typeof t=="string";if(!i&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var n=this.image;if(n.uuid===void 0&&(n.uuid=gr.generateUUID()),!i&&t.images[n.uuid]===void 0){var o;if(Array.isArray(n)){o=[];for(var s=0,c=n.length;s<c;s++)n[s].isDataTexture?o.push(lu(n[s].image)):o.push(lu(n[s]))}else o=lu(n);t.images[n.uuid]={uuid:n.uuid,url:o}}r.image=n.uuid}return i||(t.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==V)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ar:t.x=t.x-Math.floor(t.x);break;case Jt:t.x=t.x<0?0:1;break;case ir:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Ar:t.y=t.y-Math.floor(t.y);break;case Jt:t.y=t.y<0?0:1;break;case ir:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(vn.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}});function lu(a){return typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&a instanceof ImageBitmap?To.getDataURL(a):a.data?{data:Array.prototype.slice.call(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var un=function(){function a(i,r,n,o){i===void 0&&(i=0),r===void 0&&(r=0),n===void 0&&(n=0),o===void 0&&(o=1),Object.defineProperty(this,"isVector4",{value:!0}),this.x=i,this.y=r,this.z=n,this.w=o}var t=a.prototype;return t.set=function(r,n,o,s){return this.x=r,this.y=n,this.z=o,this.w=s,this},t.setScalar=function(r){return this.x=r,this.y=r,this.z=r,this.w=r,this},t.setX=function(r){return this.x=r,this},t.setY=function(r){return this.y=r,this},t.setZ=function(r){return this.z=r,this},t.setW=function(r){return this.w=r,this},t.setComponent=function(r,n){switch(r){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+r)}return this},t.getComponent=function(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+r)}},t.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},t.copy=function(r){return this.x=r.x,this.y=r.y,this.z=r.z,this.w=r.w!==void 0?r.w:1,this},t.add=function(r,n){return n!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(r,n)):(this.x+=r.x,this.y+=r.y,this.z+=r.z,this.w+=r.w,this)},t.addScalar=function(r){return this.x+=r,this.y+=r,this.z+=r,this.w+=r,this},t.addVectors=function(r,n){return this.x=r.x+n.x,this.y=r.y+n.y,this.z=r.z+n.z,this.w=r.w+n.w,this},t.addScaledVector=function(r,n){return this.x+=r.x*n,this.y+=r.y*n,this.z+=r.z*n,this.w+=r.w*n,this},t.sub=function(r,n){return n!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(r,n)):(this.x-=r.x,this.y-=r.y,this.z-=r.z,this.w-=r.w,this)},t.subScalar=function(r){return this.x-=r,this.y-=r,this.z-=r,this.w-=r,this},t.subVectors=function(r,n){return this.x=r.x-n.x,this.y=r.y-n.y,this.z=r.z-n.z,this.w=r.w-n.w,this},t.multiply=function(r){return this.x*=r.x,this.y*=r.y,this.z*=r.z,this.w*=r.w,this},t.multiplyScalar=function(r){return this.x*=r,this.y*=r,this.z*=r,this.w*=r,this},t.applyMatrix4=function(r){var n=this.x,o=this.y,s=this.z,c=this.w,h=r.elements;return this.x=h[0]*n+h[4]*o+h[8]*s+h[12]*c,this.y=h[1]*n+h[5]*o+h[9]*s+h[13]*c,this.z=h[2]*n+h[6]*o+h[10]*s+h[14]*c,this.w=h[3]*n+h[7]*o+h[11]*s+h[15]*c,this},t.divideScalar=function(r){return this.multiplyScalar(1/r)},t.setAxisAngleFromQuaternion=function(r){this.w=2*Math.acos(r.w);var n=Math.sqrt(1-r.w*r.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=r.x/n,this.y=r.y/n,this.z=r.z/n),this},t.setAxisAngleFromRotationMatrix=function(r){var n,o,s,c,h=.01,p=.1,C=r.elements,_=C[0],S=C[4],D=C[8],P=C[1],H=C[5],W=C[9],G=C[2],B=C[6],te=C[10];if(Math.abs(S-P)<h&&Math.abs(D-G)<h&&Math.abs(W-B)<h){if(Math.abs(S+P)<p&&Math.abs(D+G)<p&&Math.abs(W+B)<p&&Math.abs(_+H+te-3)<p)return this.set(1,0,0,0),this;n=Math.PI;var he=(_+1)/2,K=(H+1)/2,Q=(te+1)/2,le=(S+P)/4,Me=(D+G)/4,xe=(W+B)/4;return he>K&&he>Q?he<h?(o=0,s=.707106781,c=.707106781):(o=Math.sqrt(he),s=le/o,c=Me/o):K>Q?K<h?(o=.707106781,s=0,c=.707106781):(s=Math.sqrt(K),o=le/s,c=xe/s):Q<h?(o=.707106781,s=.707106781,c=0):(c=Math.sqrt(Q),o=Me/c,s=xe/c),this.set(o,s,c,n),this}var _e=Math.sqrt((B-W)*(B-W)+(D-G)*(D-G)+(P-S)*(P-S));return Math.abs(_e)<.001&&(_e=1),this.x=(B-W)/_e,this.y=(D-G)/_e,this.z=(P-S)/_e,this.w=Math.acos((_+H+te-1)/2),this},t.min=function(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this.w=Math.min(this.w,r.w),this},t.max=function(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this.w=Math.max(this.w,r.w),this},t.clamp=function(r,n){return this.x=Math.max(r.x,Math.min(n.x,this.x)),this.y=Math.max(r.y,Math.min(n.y,this.y)),this.z=Math.max(r.z,Math.min(n.z,this.z)),this.w=Math.max(r.w,Math.min(n.w,this.w)),this},t.clampScalar=function(r,n){return this.x=Math.max(r,Math.min(n,this.x)),this.y=Math.max(r,Math.min(n,this.y)),this.z=Math.max(r,Math.min(n,this.z)),this.w=Math.max(r,Math.min(n,this.w)),this},t.clampLength=function(r,n){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(r,Math.min(n,o)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},t.dot=function(r){return this.x*r.x+this.y*r.y+this.z*r.z+this.w*r.w},t.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.setLength=function(r){return this.normalize().multiplyScalar(r)},t.lerp=function(r,n){return this.x+=(r.x-this.x)*n,this.y+=(r.y-this.y)*n,this.z+=(r.z-this.z)*n,this.w+=(r.w-this.w)*n,this},t.lerpVectors=function(r,n,o){return this.x=r.x+(n.x-r.x)*o,this.y=r.y+(n.y-r.y)*o,this.z=r.z+(n.z-r.z)*o,this.w=r.w+(n.w-r.w)*o,this},t.equals=function(r){return r.x===this.x&&r.y===this.y&&r.z===this.z&&r.w===this.w},t.fromArray=function(r,n){return n===void 0&&(n=0),this.x=r[n],this.y=r[n+1],this.z=r[n+2],this.w=r[n+3],this},t.toArray=function(r,n){return r===void 0&&(r=[]),n===void 0&&(n=0),r[n]=this.x,r[n+1]=this.y,r[n+2]=this.z,r[n+3]=this.w,r},t.fromBufferAttribute=function(r,n,o){return o!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=r.getX(n),this.y=r.getY(n),this.z=r.getZ(n),this.w=r.getW(n),this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},Dl(a,[{key:"width",get:function(){return this.z},set:function(r){this.z=r}},{key:"height",get:function(){return this.w},set:function(r){this.w=r}}]),a}(),qa=function(a){Or(t,a);function t(r,n,o){var s;return s=a.call(this)||this,Object.defineProperty(Ji(s),"isWebGLRenderTarget",{value:!0}),s.width=r,s.height=n,s.scissor=new un(0,0,r,n),s.scissorTest=!1,s.viewport=new un(0,0,r,n),o=o||{},s.texture=new vn(void 0,o.mapping,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.encoding),s.texture.image={},s.texture.image.width=r,s.texture.image.height=n,s.texture.generateMipmaps=o.generateMipmaps!==void 0?o.generateMipmaps:!1,s.texture.minFilter=o.minFilter!==void 0?o.minFilter:nt,s.depthBuffer=o.depthBuffer!==void 0?o.depthBuffer:!0,s.stencilBuffer=o.stencilBuffer!==void 0?o.stencilBuffer:!1,s.depthTexture=o.depthTexture!==void 0?o.depthTexture:null,s}var i=t.prototype;return i.setSize=function(n,o){(this.width!==n||this.height!==o)&&(this.width=n,this.height=o,this.texture.image.width=n,this.texture.image.height=o,this.dispose()),this.viewport.set(0,0,n,o),this.scissor.set(0,0,n,o)},i.clone=function(){return new this.constructor().copy(this)},i.copy=function(n){return this.width=n.width,this.height=n.height,this.viewport.copy(n.viewport),this.texture=n.texture.clone(),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.depthTexture=n.depthTexture,this},i.dispose=function(){this.dispatchEvent({type:"dispose"})},t}(pa),Bp=function(a){Or(t,a);function t(r,n,o){var s;return s=a.call(this,r,n,o)||this,Object.defineProperty(Ji(s),"isWebGLMultisampleRenderTarget",{value:!0}),s.samples=4,s}var i=t.prototype;return i.copy=function(n){return a.prototype.copy.call(this,n),this.samples=n.samples,this},t}(qa),ni=function(){function a(i,r,n,o){i===void 0&&(i=0),r===void 0&&(r=0),n===void 0&&(n=0),o===void 0&&(o=1),Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=i,this._y=r,this._z=n,this._w=o}a.slerp=function(r,n,o,s){return o.copy(r).slerp(n,s)},a.slerpFlat=function(r,n,o,s,c,h,p){var C=o[s+0],_=o[s+1],S=o[s+2],D=o[s+3],P=c[h+0],H=c[h+1],W=c[h+2],G=c[h+3];if(D!==G||C!==P||_!==H||S!==W){var B=1-p,te=C*P+_*H+S*W+D*G,he=te>=0?1:-1,K=1-te*te;if(K>Number.EPSILON){var Q=Math.sqrt(K),le=Math.atan2(Q,te*he);B=Math.sin(B*le)/Q,p=Math.sin(p*le)/Q}var Me=p*he;if(C=C*B+P*Me,_=_*B+H*Me,S=S*B+W*Me,D=D*B+G*Me,B===1-p){var xe=1/Math.sqrt(C*C+_*_+S*S+D*D);C*=xe,_*=xe,S*=xe,D*=xe}}r[n]=C,r[n+1]=_,r[n+2]=S,r[n+3]=D},a.multiplyQuaternionsFlat=function(r,n,o,s,c,h){var p=o[s],C=o[s+1],_=o[s+2],S=o[s+3],D=c[h],P=c[h+1],H=c[h+2],W=c[h+3];return r[n]=p*W+S*D+C*H-_*P,r[n+1]=C*W+S*P+_*D-p*H,r[n+2]=_*W+S*H+p*P-C*D,r[n+3]=S*W-p*D-C*P-_*H,r};var t=a.prototype;return t.set=function(r,n,o,s){return this._x=r,this._y=n,this._z=o,this._w=s,this._onChangeCallback(),this},t.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},t.copy=function(r){return this._x=r.x,this._y=r.y,this._z=r.z,this._w=r.w,this._onChangeCallback(),this},t.setFromEuler=function(r,n){if(!(r&&r.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var o=r._x,s=r._y,c=r._z,h=r._order,p=Math.cos,C=Math.sin,_=p(o/2),S=p(s/2),D=p(c/2),P=C(o/2),H=C(s/2),W=C(c/2);switch(h){case"XYZ":this._x=P*S*D+_*H*W,this._y=_*H*D-P*S*W,this._z=_*S*W+P*H*D,this._w=_*S*D-P*H*W;break;case"YXZ":this._x=P*S*D+_*H*W,this._y=_*H*D-P*S*W,this._z=_*S*W-P*H*D,this._w=_*S*D+P*H*W;break;case"ZXY":this._x=P*S*D-_*H*W,this._y=_*H*D+P*S*W,this._z=_*S*W+P*H*D,this._w=_*S*D-P*H*W;break;case"ZYX":this._x=P*S*D-_*H*W,this._y=_*H*D+P*S*W,this._z=_*S*W-P*H*D,this._w=_*S*D+P*H*W;break;case"YZX":this._x=P*S*D+_*H*W,this._y=_*H*D+P*S*W,this._z=_*S*W-P*H*D,this._w=_*S*D-P*H*W;break;case"XZY":this._x=P*S*D-_*H*W,this._y=_*H*D-P*S*W,this._z=_*S*W+P*H*D,this._w=_*S*D+P*H*W;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+h)}return n!==!1&&this._onChangeCallback(),this},t.setFromAxisAngle=function(r,n){var o=n/2,s=Math.sin(o);return this._x=r.x*s,this._y=r.y*s,this._z=r.z*s,this._w=Math.cos(o),this._onChangeCallback(),this},t.setFromRotationMatrix=function(r){var n=r.elements,o=n[0],s=n[4],c=n[8],h=n[1],p=n[5],C=n[9],_=n[2],S=n[6],D=n[10],P=o+p+D;if(P>0){var H=.5/Math.sqrt(P+1);this._w=.25/H,this._x=(S-C)*H,this._y=(c-_)*H,this._z=(h-s)*H}else if(o>p&&o>D){var W=2*Math.sqrt(1+o-p-D);this._w=(S-C)/W,this._x=.25*W,this._y=(s+h)/W,this._z=(c+_)/W}else if(p>D){var G=2*Math.sqrt(1+p-o-D);this._w=(c-_)/G,this._x=(s+h)/G,this._y=.25*G,this._z=(C+S)/G}else{var B=2*Math.sqrt(1+D-o-p);this._w=(h-s)/B,this._x=(c+_)/B,this._y=(C+S)/B,this._z=.25*B}return this._onChangeCallback(),this},t.setFromUnitVectors=function(r,n){var o=1e-6,s=r.dot(n)+1;return s<o?(s=0,Math.abs(r.x)>Math.abs(r.z)?(this._x=-r.y,this._y=r.x,this._z=0,this._w=s):(this._x=0,this._y=-r.z,this._z=r.y,this._w=s)):(this._x=r.y*n.z-r.z*n.y,this._y=r.z*n.x-r.x*n.z,this._z=r.x*n.y-r.y*n.x,this._w=s),this.normalize()},t.angleTo=function(r){return 2*Math.acos(Math.abs(gr.clamp(this.dot(r),-1,1)))},t.rotateTowards=function(r,n){var o=this.angleTo(r);if(o===0)return this;var s=Math.min(1,n/o);return this.slerp(r,s),this},t.identity=function(){return this.set(0,0,0,1)},t.invert=function(){return this.conjugate()},t.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},t.dot=function(r){return this._x*r._x+this._y*r._y+this._z*r._z+this._w*r._w},t.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},t.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},t.normalize=function(){var r=this.length();return r===0?(this._x=0,this._y=0,this._z=0,this._w=1):(r=1/r,this._x=this._x*r,this._y=this._y*r,this._z=this._z*r,this._w=this._w*r),this._onChangeCallback(),this},t.multiply=function(r,n){return n!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(r,n)):this.multiplyQuaternions(this,r)},t.premultiply=function(r){return this.multiplyQuaternions(r,this)},t.multiplyQuaternions=function(r,n){var o=r._x,s=r._y,c=r._z,h=r._w,p=n._x,C=n._y,_=n._z,S=n._w;return this._x=o*S+h*p+s*_-c*C,this._y=s*S+h*C+c*p-o*_,this._z=c*S+h*_+o*C-s*p,this._w=h*S-o*p-s*C-c*_,this._onChangeCallback(),this},t.slerp=function(r,n){if(n===0)return this;if(n===1)return this.copy(r);var o=this._x,s=this._y,c=this._z,h=this._w,p=h*r._w+o*r._x+s*r._y+c*r._z;if(p<0?(this._w=-r._w,this._x=-r._x,this._y=-r._y,this._z=-r._z,p=-p):this.copy(r),p>=1)return this._w=h,this._x=o,this._y=s,this._z=c,this;var C=1-p*p;if(C<=Number.EPSILON){var _=1-n;return this._w=_*h+n*this._w,this._x=_*o+n*this._x,this._y=_*s+n*this._y,this._z=_*c+n*this._z,this.normalize(),this._onChangeCallback(),this}var S=Math.sqrt(C),D=Math.atan2(S,p),P=Math.sin((1-n)*D)/S,H=Math.sin(n*D)/S;return this._w=h*P+this._w*H,this._x=o*P+this._x*H,this._y=s*P+this._y*H,this._z=c*P+this._z*H,this._onChangeCallback(),this},t.equals=function(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._w===this._w},t.fromArray=function(r,n){return n===void 0&&(n=0),this._x=r[n],this._y=r[n+1],this._z=r[n+2],this._w=r[n+3],this._onChangeCallback(),this},t.toArray=function(r,n){return r===void 0&&(r=[]),n===void 0&&(n=0),r[n]=this._x,r[n+1]=this._y,r[n+2]=this._z,r[n+3]=this._w,r},t.fromBufferAttribute=function(r,n){return this._x=r.getX(n),this._y=r.getY(n),this._z=r.getZ(n),this._w=r.getW(n),this},t._onChange=function(r){return this._onChangeCallback=r,this},t._onChangeCallback=function(){},Dl(a,[{key:"x",get:function(){return this._x},set:function(r){this._x=r,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(r){this._y=r,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(r){this._z=r,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(r){this._w=r,this._onChangeCallback()}}]),a}(),fe=function(){function a(i,r,n){i===void 0&&(i=0),r===void 0&&(r=0),n===void 0&&(n=0),Object.defineProperty(this,"isVector3",{value:!0}),this.x=i,this.y=r,this.z=n}var t=a.prototype;return t.set=function(r,n,o){return o===void 0&&(o=this.z),this.x=r,this.y=n,this.z=o,this},t.setScalar=function(r){return this.x=r,this.y=r,this.z=r,this},t.setX=function(r){return this.x=r,this},t.setY=function(r){return this.y=r,this},t.setZ=function(r){return this.z=r,this},t.setComponent=function(r,n){switch(r){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+r)}return this},t.getComponent=function(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+r)}},t.clone=function(){return new this.constructor(this.x,this.y,this.z)},t.copy=function(r){return this.x=r.x,this.y=r.y,this.z=r.z,this},t.add=function(r,n){return n!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(r,n)):(this.x+=r.x,this.y+=r.y,this.z+=r.z,this)},t.addScalar=function(r){return this.x+=r,this.y+=r,this.z+=r,this},t.addVectors=function(r,n){return this.x=r.x+n.x,this.y=r.y+n.y,this.z=r.z+n.z,this},t.addScaledVector=function(r,n){return this.x+=r.x*n,this.y+=r.y*n,this.z+=r.z*n,this},t.sub=function(r,n){return n!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(r,n)):(this.x-=r.x,this.y-=r.y,this.z-=r.z,this)},t.subScalar=function(r){return this.x-=r,this.y-=r,this.z-=r,this},t.subVectors=function(r,n){return this.x=r.x-n.x,this.y=r.y-n.y,this.z=r.z-n.z,this},t.multiply=function(r,n){return n!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(r,n)):(this.x*=r.x,this.y*=r.y,this.z*=r.z,this)},t.multiplyScalar=function(r){return this.x*=r,this.y*=r,this.z*=r,this},t.multiplyVectors=function(r,n){return this.x=r.x*n.x,this.y=r.y*n.y,this.z=r.z*n.z,this},t.applyEuler=function(r){return r&&r.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Vh.setFromEuler(r))},t.applyAxisAngle=function(r,n){return this.applyQuaternion(Vh.setFromAxisAngle(r,n))},t.applyMatrix3=function(r){var n=this.x,o=this.y,s=this.z,c=r.elements;return this.x=c[0]*n+c[3]*o+c[6]*s,this.y=c[1]*n+c[4]*o+c[7]*s,this.z=c[2]*n+c[5]*o+c[8]*s,this},t.applyNormalMatrix=function(r){return this.applyMatrix3(r).normalize()},t.applyMatrix4=function(r){var n=this.x,o=this.y,s=this.z,c=r.elements,h=1/(c[3]*n+c[7]*o+c[11]*s+c[15]);return this.x=(c[0]*n+c[4]*o+c[8]*s+c[12])*h,this.y=(c[1]*n+c[5]*o+c[9]*s+c[13])*h,this.z=(c[2]*n+c[6]*o+c[10]*s+c[14])*h,this},t.applyQuaternion=function(r){var n=this.x,o=this.y,s=this.z,c=r.x,h=r.y,p=r.z,C=r.w,_=C*n+h*s-p*o,S=C*o+p*n-c*s,D=C*s+c*o-h*n,P=-c*n-h*o-p*s;return this.x=_*C+P*-c+S*-p-D*-h,this.y=S*C+P*-h+D*-c-_*-p,this.z=D*C+P*-p+_*-h-S*-c,this},t.project=function(r){return this.applyMatrix4(r.matrixWorldInverse).applyMatrix4(r.projectionMatrix)},t.unproject=function(r){return this.applyMatrix4(r.projectionMatrixInverse).applyMatrix4(r.matrixWorld)},t.transformDirection=function(r){var n=this.x,o=this.y,s=this.z,c=r.elements;return this.x=c[0]*n+c[4]*o+c[8]*s,this.y=c[1]*n+c[5]*o+c[9]*s,this.z=c[2]*n+c[6]*o+c[10]*s,this.normalize()},t.divide=function(r){return this.x/=r.x,this.y/=r.y,this.z/=r.z,this},t.divideScalar=function(r){return this.multiplyScalar(1/r)},t.min=function(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this},t.max=function(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this},t.clamp=function(r,n){return this.x=Math.max(r.x,Math.min(n.x,this.x)),this.y=Math.max(r.y,Math.min(n.y,this.y)),this.z=Math.max(r.z,Math.min(n.z,this.z)),this},t.clampScalar=function(r,n){return this.x=Math.max(r,Math.min(n,this.x)),this.y=Math.max(r,Math.min(n,this.y)),this.z=Math.max(r,Math.min(n,this.z)),this},t.clampLength=function(r,n){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(r,Math.min(n,o)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},t.dot=function(r){return this.x*r.x+this.y*r.y+this.z*r.z},t.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.setLength=function(r){return this.normalize().multiplyScalar(r)},t.lerp=function(r,n){return this.x+=(r.x-this.x)*n,this.y+=(r.y-this.y)*n,this.z+=(r.z-this.z)*n,this},t.lerpVectors=function(r,n,o){return this.x=r.x+(n.x-r.x)*o,this.y=r.y+(n.y-r.y)*o,this.z=r.z+(n.z-r.z)*o,this},t.cross=function(r,n){return n!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(r,n)):this.crossVectors(this,r)},t.crossVectors=function(r,n){var o=r.x,s=r.y,c=r.z,h=n.x,p=n.y,C=n.z;return this.x=s*C-c*p,this.y=c*h-o*C,this.z=o*p-s*h,this},t.projectOnVector=function(r){var n=r.lengthSq();if(n===0)return this.set(0,0,0);var o=r.dot(this)/n;return this.copy(r).multiplyScalar(o)},t.projectOnPlane=function(r){return cu.copy(this).projectOnVector(r),this.sub(cu)},t.reflect=function(r){return this.sub(cu.copy(r).multiplyScalar(2*this.dot(r)))},t.angleTo=function(r){var n=Math.sqrt(this.lengthSq()*r.lengthSq());if(n===0)return Math.PI/2;var o=this.dot(r)/n;return Math.acos(gr.clamp(o,-1,1))},t.distanceTo=function(r){return Math.sqrt(this.distanceToSquared(r))},t.distanceToSquared=function(r){var n=this.x-r.x,o=this.y-r.y,s=this.z-r.z;return n*n+o*o+s*s},t.manhattanDistanceTo=function(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)+Math.abs(this.z-r.z)},t.setFromSpherical=function(r){return this.setFromSphericalCoords(r.radius,r.phi,r.theta)},t.setFromSphericalCoords=function(r,n,o){var s=Math.sin(n)*r;return this.x=s*Math.sin(o),this.y=Math.cos(n)*r,this.z=s*Math.cos(o),this},t.setFromCylindrical=function(r){return this.setFromCylindricalCoords(r.radius,r.theta,r.y)},t.setFromCylindricalCoords=function(r,n,o){return this.x=r*Math.sin(n),this.y=o,this.z=r*Math.cos(n),this},t.setFromMatrixPosition=function(r){var n=r.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this},t.setFromMatrixScale=function(r){var n=this.setFromMatrixColumn(r,0).length(),o=this.setFromMatrixColumn(r,1).length(),s=this.setFromMatrixColumn(r,2).length();return this.x=n,this.y=o,this.z=s,this},t.setFromMatrixColumn=function(r,n){return this.fromArray(r.elements,n*4)},t.setFromMatrix3Column=function(r,n){return this.fromArray(r.elements,n*3)},t.equals=function(r){return r.x===this.x&&r.y===this.y&&r.z===this.z},t.fromArray=function(r,n){return n===void 0&&(n=0),this.x=r[n],this.y=r[n+1],this.z=r[n+2],this},t.toArray=function(r,n){return r===void 0&&(r=[]),n===void 0&&(n=0),r[n]=this.x,r[n+1]=this.y,r[n+2]=this.z,r},t.fromBufferAttribute=function(r,n,o){return o!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=r.getX(n),this.y=r.getY(n),this.z=r.getZ(n),this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},a}(),cu=new fe,Vh=new ni,La=function(){function a(i,r){Object.defineProperty(this,"isBox3",{value:!0}),this.min=i!==void 0?i:new fe(1/0,1/0,1/0),this.max=r!==void 0?r:new fe(-1/0,-1/0,-1/0)}var t=a.prototype;return t.set=function(r,n){return this.min.copy(r),this.max.copy(n),this},t.setFromArray=function(r){for(var n=1/0,o=1/0,s=1/0,c=-1/0,h=-1/0,p=-1/0,C=0,_=r.length;C<_;C+=3){var S=r[C],D=r[C+1],P=r[C+2];S<n&&(n=S),D<o&&(o=D),P<s&&(s=P),S>c&&(c=S),D>h&&(h=D),P>p&&(p=P)}return this.min.set(n,o,s),this.max.set(c,h,p),this},t.setFromBufferAttribute=function(r){for(var n=1/0,o=1/0,s=1/0,c=-1/0,h=-1/0,p=-1/0,C=0,_=r.count;C<_;C++){var S=r.getX(C),D=r.getY(C),P=r.getZ(C);S<n&&(n=S),D<o&&(o=D),P<s&&(s=P),S>c&&(c=S),D>h&&(h=D),P>p&&(p=P)}return this.min.set(n,o,s),this.max.set(c,h,p),this},t.setFromPoints=function(r){this.makeEmpty();for(var n=0,o=r.length;n<o;n++)this.expandByPoint(r[n]);return this},t.setFromCenterAndSize=function(r,n){var o=Ns.copy(n).multiplyScalar(.5);return this.min.copy(r).sub(o),this.max.copy(r).add(o),this},t.setFromObject=function(r){return this.makeEmpty(),this.expandByObject(r)},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.min.copy(r.min),this.max.copy(r.max),this},t.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},t.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},t.getCenter=function(r){return r===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),r=new fe),this.isEmpty()?r.set(0,0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)},t.getSize=function(r){return r===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),r=new fe),this.isEmpty()?r.set(0,0,0):r.subVectors(this.max,this.min)},t.expandByPoint=function(r){return this.min.min(r),this.max.max(r),this},t.expandByVector=function(r){return this.min.sub(r),this.max.add(r),this},t.expandByScalar=function(r){return this.min.addScalar(-r),this.max.addScalar(r),this},t.expandByObject=function(r){r.updateWorldMatrix(!1,!1);var n=r.geometry;n!==void 0&&(n.boundingBox===null&&n.computeBoundingBox(),hu.copy(n.boundingBox),hu.applyMatrix4(r.matrixWorld),this.union(hu));for(var o=r.children,s=0,c=o.length;s<c;s++)this.expandByObject(o[s]);return this},t.containsPoint=function(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y||r.z<this.min.z||r.z>this.max.z)},t.containsBox=function(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y&&this.min.z<=r.min.z&&r.max.z<=this.max.z},t.getParameter=function(r,n){return n===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),n=new fe),n.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y),(r.z-this.min.z)/(this.max.z-this.min.z))},t.intersectsBox=function(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y||r.max.z<this.min.z||r.min.z>this.max.z)},t.intersectsSphere=function(r){return this.clampPoint(r.center,Ns),Ns.distanceToSquared(r.center)<=r.radius*r.radius},t.intersectsPlane=function(r){var n,o;return r.normal.x>0?(n=r.normal.x*this.min.x,o=r.normal.x*this.max.x):(n=r.normal.x*this.max.x,o=r.normal.x*this.min.x),r.normal.y>0?(n+=r.normal.y*this.min.y,o+=r.normal.y*this.max.y):(n+=r.normal.y*this.max.y,o+=r.normal.y*this.min.y),r.normal.z>0?(n+=r.normal.z*this.min.z,o+=r.normal.z*this.max.z):(n+=r.normal.z*this.max.z,o+=r.normal.z*this.min.z),n<=-r.constant&&o>=-r.constant},t.intersectsTriangle=function(r){if(this.isEmpty())return!1;this.getCenter(ks),Il.subVectors(this.max,ks),Zo.subVectors(r.a,ks),Ko.subVectors(r.b,ks),$o.subVectors(r.c,ks),Ja.subVectors(Ko,Zo),Za.subVectors($o,Ko),So.subVectors(Zo,$o);var n=[0,-Ja.z,Ja.y,0,-Za.z,Za.y,0,-So.z,So.y,Ja.z,0,-Ja.x,Za.z,0,-Za.x,So.z,0,-So.x,-Ja.y,Ja.x,0,-Za.y,Za.x,0,-So.y,So.x,0];return!uu(n,Zo,Ko,$o,Il)||(n=[1,0,0,0,1,0,0,0,1],!uu(n,Zo,Ko,$o,Il))?!1:(Bl.crossVectors(Ja,Za),n=[Bl.x,Bl.y,Bl.z],uu(n,Zo,Ko,$o,Il))},t.clampPoint=function(r,n){return n===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),n=new fe),n.copy(r).clamp(this.min,this.max)},t.distanceToPoint=function(r){var n=Ns.copy(r).clamp(this.min,this.max);return n.sub(r).length()},t.getBoundingSphere=function(r){return r===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(r.center),r.radius=this.getSize(Ns).length()*.5,r},t.intersect=function(r){return this.min.max(r.min),this.max.min(r.max),this.isEmpty()&&this.makeEmpty(),this},t.union=function(r){return this.min.min(r.min),this.max.max(r.max),this},t.applyMatrix4=function(r){return this.isEmpty()?this:(Ra[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(r),Ra[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(r),Ra[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(r),Ra[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(r),Ra[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(r),Ra[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(r),Ra[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(r),Ra[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(r),this.setFromPoints(Ra),this)},t.translate=function(r){return this.min.add(r),this.max.add(r),this},t.equals=function(r){return r.min.equals(this.min)&&r.max.equals(this.max)},a}();function uu(a,t,i,r,n){for(var o=0,s=a.length-3;o<=s;o+=3){_o.fromArray(a,o);var c=n.x*Math.abs(_o.x)+n.y*Math.abs(_o.y)+n.z*Math.abs(_o.z),h=t.dot(_o),p=i.dot(_o),C=r.dot(_o);if(Math.max(-Math.max(h,p,C),Math.min(h,p,C))>c)return!1}return!0}var Ra=[new fe,new fe,new fe,new fe,new fe,new fe,new fe,new fe],Ns=new fe,hu=new La,Zo=new fe,Ko=new fe,$o=new fe,Ja=new fe,Za=new fe,So=new fe,ks=new fe,Il=new fe,Bl=new fe,_o=new fe,Fp=new La,Ka=function(){function a(i,r){this.center=i!==void 0?i:new fe,this.radius=r!==void 0?r:-1}var t=a.prototype;return t.set=function(r,n){return this.center.copy(r),this.radius=n,this},t.setFromPoints=function(r,n){var o=this.center;n!==void 0?o.copy(n):Fp.setFromPoints(r).getCenter(o);for(var s=0,c=0,h=r.length;c<h;c++)s=Math.max(s,o.distanceToSquared(r[c]));return this.radius=Math.sqrt(s),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.center.copy(r.center),this.radius=r.radius,this},t.isEmpty=function(){return this.radius<0},t.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},t.containsPoint=function(r){return r.distanceToSquared(this.center)<=this.radius*this.radius},t.distanceToPoint=function(r){return r.distanceTo(this.center)-this.radius},t.intersectsSphere=function(r){var n=this.radius+r.radius;return r.center.distanceToSquared(this.center)<=n*n},t.intersectsBox=function(r){return r.intersectsSphere(this)},t.intersectsPlane=function(r){return Math.abs(r.distanceToPoint(this.center))<=this.radius},t.clampPoint=function(r,n){var o=this.center.distanceToSquared(r);return n===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),n=new fe),n.copy(r),o>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},t.getBoundingBox=function(r){return r===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),r=new La),this.isEmpty()?(r.makeEmpty(),r):(r.set(this.center,this.center),r.expandByScalar(this.radius),r)},t.applyMatrix4=function(r){return this.center.applyMatrix4(r),this.radius=this.radius*r.getMaxScaleOnAxis(),this},t.translate=function(r){return this.center.add(r),this},t.equals=function(r){return r.center.equals(this.center)&&r.radius===this.radius},a}(),Pa=new fe,du=new fe,Fl=new fe,$a=new fe,fu=new fe,Nl=new fe,pu=new fe,es=function(){function a(i,r){this.origin=i!==void 0?i:new fe,this.direction=r!==void 0?r:new fe(0,0,-1)}var t=a.prototype;return t.set=function(r,n){return this.origin.copy(r),this.direction.copy(n),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.origin.copy(r.origin),this.direction.copy(r.direction),this},t.at=function(r,n){return n===void 0&&(console.warn("THREE.Ray: .at() target is now required"),n=new fe),n.copy(this.direction).multiplyScalar(r).add(this.origin)},t.lookAt=function(r){return this.direction.copy(r).sub(this.origin).normalize(),this},t.recast=function(r){return this.origin.copy(this.at(r,Pa)),this},t.closestPointToPoint=function(r,n){n===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),n=new fe),n.subVectors(r,this.origin);var o=n.dot(this.direction);return o<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(o).add(this.origin)},t.distanceToPoint=function(r){return Math.sqrt(this.distanceSqToPoint(r))},t.distanceSqToPoint=function(r){var n=Pa.subVectors(r,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(r):(Pa.copy(this.direction).multiplyScalar(n).add(this.origin),Pa.distanceToSquared(r))},t.distanceSqToSegment=function(r,n,o,s){du.copy(r).add(n).multiplyScalar(.5),Fl.copy(n).sub(r).normalize(),$a.copy(this.origin).sub(du);var c=r.distanceTo(n)*.5,h=-this.direction.dot(Fl),p=$a.dot(this.direction),C=-$a.dot(Fl),_=$a.lengthSq(),S=Math.abs(1-h*h),D,P,H,W;if(S>0)if(D=h*C-p,P=h*p-C,W=c*S,D>=0)if(P>=-W)if(P<=W){var G=1/S;D*=G,P*=G,H=D*(D+h*P+2*p)+P*(h*D+P+2*C)+_}else P=c,D=Math.max(0,-(h*P+p)),H=-D*D+P*(P+2*C)+_;else P=-c,D=Math.max(0,-(h*P+p)),H=-D*D+P*(P+2*C)+_;else P<=-W?(D=Math.max(0,-(-h*c+p)),P=D>0?-c:Math.min(Math.max(-c,-C),c),H=-D*D+P*(P+2*C)+_):P<=W?(D=0,P=Math.min(Math.max(-c,-C),c),H=P*(P+2*C)+_):(D=Math.max(0,-(h*c+p)),P=D>0?c:Math.min(Math.max(-c,-C),c),H=-D*D+P*(P+2*C)+_);else P=h>0?-c:c,D=Math.max(0,-(h*P+p)),H=-D*D+P*(P+2*C)+_;return o&&o.copy(this.direction).multiplyScalar(D).add(this.origin),s&&s.copy(Fl).multiplyScalar(P).add(du),H},t.intersectSphere=function(r,n){Pa.subVectors(r.center,this.origin);var o=Pa.dot(this.direction),s=Pa.dot(Pa)-o*o,c=r.radius*r.radius;if(s>c)return null;var h=Math.sqrt(c-s),p=o-h,C=o+h;return p<0&&C<0?null:p<0?this.at(C,n):this.at(p,n)},t.intersectsSphere=function(r){return this.distanceSqToPoint(r.center)<=r.radius*r.radius},t.distanceToPlane=function(r){var n=r.normal.dot(this.direction);if(n===0)return r.distanceToPoint(this.origin)===0?0:null;var o=-(this.origin.dot(r.normal)+r.constant)/n;return o>=0?o:null},t.intersectPlane=function(r,n){var o=this.distanceToPlane(r);return o===null?null:this.at(o,n)},t.intersectsPlane=function(r){var n=r.distanceToPoint(this.origin);if(n===0)return!0;var o=r.normal.dot(this.direction);return o*n<0},t.intersectBox=function(r,n){var o,s,c,h,p,C,_=1/this.direction.x,S=1/this.direction.y,D=1/this.direction.z,P=this.origin;return _>=0?(o=(r.min.x-P.x)*_,s=(r.max.x-P.x)*_):(o=(r.max.x-P.x)*_,s=(r.min.x-P.x)*_),S>=0?(c=(r.min.y-P.y)*S,h=(r.max.y-P.y)*S):(c=(r.max.y-P.y)*S,h=(r.min.y-P.y)*S),o>h||c>s||((c>o||o!==o)&&(o=c),(h<s||s!==s)&&(s=h),D>=0?(p=(r.min.z-P.z)*D,C=(r.max.z-P.z)*D):(p=(r.max.z-P.z)*D,C=(r.min.z-P.z)*D),o>C||p>s)||((p>o||o!==o)&&(o=p),(C<s||s!==s)&&(s=C),s<0)?null:this.at(o>=0?o:s,n)},t.intersectsBox=function(r){return this.intersectBox(r,Pa)!==null},t.intersectTriangle=function(r,n,o,s,c){fu.subVectors(n,r),Nl.subVectors(o,r),pu.crossVectors(fu,Nl);var h=this.direction.dot(pu),p;if(h>0){if(s)return null;p=1}else if(h<0)p=-1,h=-h;else return null;$a.subVectors(this.origin,r);var C=p*this.direction.dot(Nl.crossVectors($a,Nl));if(C<0)return null;var _=p*this.direction.dot(fu.cross($a));if(_<0||C+_>h)return null;var S=-p*$a.dot(pu);return S<0?null:this.at(S/h,c)},t.applyMatrix4=function(r){return this.origin.applyMatrix4(r),this.direction.transformDirection(r),this},t.equals=function(r){return r.origin.equals(this.origin)&&r.direction.equals(this.direction)},a}(),kr=function(){function a(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var t=a.prototype;return t.set=function(r,n,o,s,c,h,p,C,_,S,D,P,H,W,G,B){var te=this.elements;return te[0]=r,te[4]=n,te[8]=o,te[12]=s,te[1]=c,te[5]=h,te[9]=p,te[13]=C,te[2]=_,te[6]=S,te[10]=D,te[14]=P,te[3]=H,te[7]=W,te[11]=G,te[15]=B,this},t.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},t.clone=function(){return new a().fromArray(this.elements)},t.copy=function(r){var n=this.elements,o=r.elements;return n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=o[3],n[4]=o[4],n[5]=o[5],n[6]=o[6],n[7]=o[7],n[8]=o[8],n[9]=o[9],n[10]=o[10],n[11]=o[11],n[12]=o[12],n[13]=o[13],n[14]=o[14],n[15]=o[15],this},t.copyPosition=function(r){var n=this.elements,o=r.elements;return n[12]=o[12],n[13]=o[13],n[14]=o[14],this},t.setFromMatrix3=function(r){var n=r.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this},t.extractBasis=function(r,n,o){return r.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this},t.makeBasis=function(r,n,o){return this.set(r.x,n.x,o.x,0,r.y,n.y,o.y,0,r.z,n.z,o.z,0,0,0,0,1),this},t.extractRotation=function(r){var n=this.elements,o=r.elements,s=1/ts.setFromMatrixColumn(r,0).length(),c=1/ts.setFromMatrixColumn(r,1).length(),h=1/ts.setFromMatrixColumn(r,2).length();return n[0]=o[0]*s,n[1]=o[1]*s,n[2]=o[2]*s,n[3]=0,n[4]=o[4]*c,n[5]=o[5]*c,n[6]=o[6]*c,n[7]=0,n[8]=o[8]*h,n[9]=o[9]*h,n[10]=o[10]*h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},t.makeRotationFromEuler=function(r){r&&r.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=this.elements,o=r.x,s=r.y,c=r.z,h=Math.cos(o),p=Math.sin(o),C=Math.cos(s),_=Math.sin(s),S=Math.cos(c),D=Math.sin(c);if(r.order==="XYZ"){var P=h*S,H=h*D,W=p*S,G=p*D;n[0]=C*S,n[4]=-C*D,n[8]=_,n[1]=H+W*_,n[5]=P-G*_,n[9]=-p*C,n[2]=G-P*_,n[6]=W+H*_,n[10]=h*C}else if(r.order==="YXZ"){var B=C*S,te=C*D,he=_*S,K=_*D;n[0]=B+K*p,n[4]=he*p-te,n[8]=h*_,n[1]=h*D,n[5]=h*S,n[9]=-p,n[2]=te*p-he,n[6]=K+B*p,n[10]=h*C}else if(r.order==="ZXY"){var Q=C*S,le=C*D,Me=_*S,xe=_*D;n[0]=Q-xe*p,n[4]=-h*D,n[8]=Me+le*p,n[1]=le+Me*p,n[5]=h*S,n[9]=xe-Q*p,n[2]=-h*_,n[6]=p,n[10]=h*C}else if(r.order==="ZYX"){var _e=h*S,Pe=h*D,Ce=p*S,Ae=p*D;n[0]=C*S,n[4]=Ce*_-Pe,n[8]=_e*_+Ae,n[1]=C*D,n[5]=Ae*_+_e,n[9]=Pe*_-Ce,n[2]=-_,n[6]=p*C,n[10]=h*C}else if(r.order==="YZX"){var Be=h*C,Se=h*_,Te=p*C,me=p*_;n[0]=C*S,n[4]=me-Be*D,n[8]=Te*D+Se,n[1]=D,n[5]=h*S,n[9]=-p*S,n[2]=-_*S,n[6]=Se*D+Te,n[10]=Be-me*D}else if(r.order==="XZY"){var Ue=h*C,He=h*_,Qe=p*C,qe=p*_;n[0]=C*S,n[4]=-D,n[8]=_*S,n[1]=Ue*D+qe,n[5]=h*S,n[9]=He*D-Qe,n[2]=Qe*D-He,n[6]=p*S,n[10]=qe*D+Ue}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},t.makeRotationFromQuaternion=function(r){return this.compose(Np,r,kp)},t.lookAt=function(r,n,o){var s=this.elements;return Ci.subVectors(r,n),Ci.lengthSq()===0&&(Ci.z=1),Ci.normalize(),eo.crossVectors(o,Ci),eo.lengthSq()===0&&(Math.abs(o.z)===1?Ci.x+=1e-4:Ci.z+=1e-4,Ci.normalize(),eo.crossVectors(o,Ci)),eo.normalize(),kl.crossVectors(Ci,eo),s[0]=eo.x,s[4]=kl.x,s[8]=Ci.x,s[1]=eo.y,s[5]=kl.y,s[9]=Ci.y,s[2]=eo.z,s[6]=kl.z,s[10]=Ci.z,this},t.multiply=function(r,n){return n!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(r,n)):this.multiplyMatrices(this,r)},t.premultiply=function(r){return this.multiplyMatrices(r,this)},t.multiplyMatrices=function(r,n){var o=r.elements,s=n.elements,c=this.elements,h=o[0],p=o[4],C=o[8],_=o[12],S=o[1],D=o[5],P=o[9],H=o[13],W=o[2],G=o[6],B=o[10],te=o[14],he=o[3],K=o[7],Q=o[11],le=o[15],Me=s[0],xe=s[4],_e=s[8],Pe=s[12],Ce=s[1],Ae=s[5],Be=s[9],Se=s[13],Te=s[2],me=s[6],Ue=s[10],He=s[14],Qe=s[3],qe=s[7],gt=s[11],St=s[15];return c[0]=h*Me+p*Ce+C*Te+_*Qe,c[4]=h*xe+p*Ae+C*me+_*qe,c[8]=h*_e+p*Be+C*Ue+_*gt,c[12]=h*Pe+p*Se+C*He+_*St,c[1]=S*Me+D*Ce+P*Te+H*Qe,c[5]=S*xe+D*Ae+P*me+H*qe,c[9]=S*_e+D*Be+P*Ue+H*gt,c[13]=S*Pe+D*Se+P*He+H*St,c[2]=W*Me+G*Ce+B*Te+te*Qe,c[6]=W*xe+G*Ae+B*me+te*qe,c[10]=W*_e+G*Be+B*Ue+te*gt,c[14]=W*Pe+G*Se+B*He+te*St,c[3]=he*Me+K*Ce+Q*Te+le*Qe,c[7]=he*xe+K*Ae+Q*me+le*qe,c[11]=he*_e+K*Be+Q*Ue+le*gt,c[15]=he*Pe+K*Se+Q*He+le*St,this},t.multiplyScalar=function(r){var n=this.elements;return n[0]*=r,n[4]*=r,n[8]*=r,n[12]*=r,n[1]*=r,n[5]*=r,n[9]*=r,n[13]*=r,n[2]*=r,n[6]*=r,n[10]*=r,n[14]*=r,n[3]*=r,n[7]*=r,n[11]*=r,n[15]*=r,this},t.determinant=function(){var r=this.elements,n=r[0],o=r[4],s=r[8],c=r[12],h=r[1],p=r[5],C=r[9],_=r[13],S=r[2],D=r[6],P=r[10],H=r[14],W=r[3],G=r[7],B=r[11],te=r[15];return W*(+c*C*D-s*_*D-c*p*P+o*_*P+s*p*H-o*C*H)+G*(+n*C*H-n*_*P+c*h*P-s*h*H+s*_*S-c*C*S)+B*(+n*_*D-n*p*H-c*h*D+o*h*H+c*p*S-o*_*S)+te*(-s*p*S-n*C*D+n*p*P+s*h*D-o*h*P+o*C*S)},t.transpose=function(){var r=this.elements,n;return n=r[1],r[1]=r[4],r[4]=n,n=r[2],r[2]=r[8],r[8]=n,n=r[6],r[6]=r[9],r[9]=n,n=r[3],r[3]=r[12],r[12]=n,n=r[7],r[7]=r[13],r[13]=n,n=r[11],r[11]=r[14],r[14]=n,this},t.setPosition=function(r,n,o){var s=this.elements;return r.isVector3?(s[12]=r.x,s[13]=r.y,s[14]=r.z):(s[12]=r,s[13]=n,s[14]=o),this},t.invert=function(){var r=this.elements,n=r[0],o=r[1],s=r[2],c=r[3],h=r[4],p=r[5],C=r[6],_=r[7],S=r[8],D=r[9],P=r[10],H=r[11],W=r[12],G=r[13],B=r[14],te=r[15],he=D*B*_-G*P*_+G*C*H-p*B*H-D*C*te+p*P*te,K=W*P*_-S*B*_-W*C*H+h*B*H+S*C*te-h*P*te,Q=S*G*_-W*D*_+W*p*H-h*G*H-S*p*te+h*D*te,le=W*D*C-S*G*C-W*p*P+h*G*P+S*p*B-h*D*B,Me=n*he+o*K+s*Q+c*le;if(Me===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var xe=1/Me;return r[0]=he*xe,r[1]=(G*P*c-D*B*c-G*s*H+o*B*H+D*s*te-o*P*te)*xe,r[2]=(p*B*c-G*C*c+G*s*_-o*B*_-p*s*te+o*C*te)*xe,r[3]=(D*C*c-p*P*c-D*s*_+o*P*_+p*s*H-o*C*H)*xe,r[4]=K*xe,r[5]=(S*B*c-W*P*c+W*s*H-n*B*H-S*s*te+n*P*te)*xe,r[6]=(W*C*c-h*B*c-W*s*_+n*B*_+h*s*te-n*C*te)*xe,r[7]=(h*P*c-S*C*c+S*s*_-n*P*_-h*s*H+n*C*H)*xe,r[8]=Q*xe,r[9]=(W*D*c-S*G*c-W*o*H+n*G*H+S*o*te-n*D*te)*xe,r[10]=(h*G*c-W*p*c+W*o*_-n*G*_-h*o*te+n*p*te)*xe,r[11]=(S*p*c-h*D*c-S*o*_+n*D*_+h*o*H-n*p*H)*xe,r[12]=le*xe,r[13]=(S*G*s-W*D*s+W*o*P-n*G*P-S*o*B+n*D*B)*xe,r[14]=(W*p*s-h*G*s-W*o*C+n*G*C+h*o*B-n*p*B)*xe,r[15]=(h*D*s-S*p*s+S*o*C-n*D*C-h*o*P+n*p*P)*xe,this},t.scale=function(r){var n=this.elements,o=r.x,s=r.y,c=r.z;return n[0]*=o,n[4]*=s,n[8]*=c,n[1]*=o,n[5]*=s,n[9]*=c,n[2]*=o,n[6]*=s,n[10]*=c,n[3]*=o,n[7]*=s,n[11]*=c,this},t.getMaxScaleOnAxis=function(){var r=this.elements,n=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],o=r[4]*r[4]+r[5]*r[5]+r[6]*r[6],s=r[8]*r[8]+r[9]*r[9]+r[10]*r[10];return Math.sqrt(Math.max(n,o,s))},t.makeTranslation=function(r,n,o){return this.set(1,0,0,r,0,1,0,n,0,0,1,o,0,0,0,1),this},t.makeRotationX=function(r){var n=Math.cos(r),o=Math.sin(r);return this.set(1,0,0,0,0,n,-o,0,0,o,n,0,0,0,0,1),this},t.makeRotationY=function(r){var n=Math.cos(r),o=Math.sin(r);return this.set(n,0,o,0,0,1,0,0,-o,0,n,0,0,0,0,1),this},t.makeRotationZ=function(r){var n=Math.cos(r),o=Math.sin(r);return this.set(n,-o,0,0,o,n,0,0,0,0,1,0,0,0,0,1),this},t.makeRotationAxis=function(r,n){var o=Math.cos(n),s=Math.sin(n),c=1-o,h=r.x,p=r.y,C=r.z,_=c*h,S=c*p;return this.set(_*h+o,_*p-s*C,_*C+s*p,0,_*p+s*C,S*p+o,S*C-s*h,0,_*C-s*p,S*C+s*h,c*C*C+o,0,0,0,0,1),this},t.makeScale=function(r,n,o){return this.set(r,0,0,0,0,n,0,0,0,0,o,0,0,0,0,1),this},t.makeShear=function(r,n,o){return this.set(1,n,o,0,r,1,o,0,r,n,1,0,0,0,0,1),this},t.compose=function(r,n,o){var s=this.elements,c=n._x,h=n._y,p=n._z,C=n._w,_=c+c,S=h+h,D=p+p,P=c*_,H=c*S,W=c*D,G=h*S,B=h*D,te=p*D,he=C*_,K=C*S,Q=C*D,le=o.x,Me=o.y,xe=o.z;return s[0]=(1-(G+te))*le,s[1]=(H+Q)*le,s[2]=(W-K)*le,s[3]=0,s[4]=(H-Q)*Me,s[5]=(1-(P+te))*Me,s[6]=(B+he)*Me,s[7]=0,s[8]=(W+K)*xe,s[9]=(B-he)*xe,s[10]=(1-(P+G))*xe,s[11]=0,s[12]=r.x,s[13]=r.y,s[14]=r.z,s[15]=1,this},t.decompose=function(r,n,o){var s=this.elements,c=ts.set(s[0],s[1],s[2]).length(),h=ts.set(s[4],s[5],s[6]).length(),p=ts.set(s[8],s[9],s[10]).length(),C=this.determinant();C<0&&(c=-c),r.x=s[12],r.y=s[13],r.z=s[14],Zi.copy(this);var _=1/c,S=1/h,D=1/p;return Zi.elements[0]*=_,Zi.elements[1]*=_,Zi.elements[2]*=_,Zi.elements[4]*=S,Zi.elements[5]*=S,Zi.elements[6]*=S,Zi.elements[8]*=D,Zi.elements[9]*=D,Zi.elements[10]*=D,n.setFromRotationMatrix(Zi),o.x=c,o.y=h,o.z=p,this},t.makePerspective=function(r,n,o,s,c,h){h===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var p=this.elements,C=2*c/(n-r),_=2*c/(o-s),S=(n+r)/(n-r),D=(o+s)/(o-s),P=-(h+c)/(h-c),H=-2*h*c/(h-c);return p[0]=C,p[4]=0,p[8]=S,p[12]=0,p[1]=0,p[5]=_,p[9]=D,p[13]=0,p[2]=0,p[6]=0,p[10]=P,p[14]=H,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this},t.makeOrthographic=function(r,n,o,s,c,h){var p=this.elements,C=1/(n-r),_=1/(o-s),S=1/(h-c),D=(n+r)*C,P=(o+s)*_,H=(h+c)*S;return p[0]=2*C,p[4]=0,p[8]=0,p[12]=-D,p[1]=0,p[5]=2*_,p[9]=0,p[13]=-P,p[2]=0,p[6]=0,p[10]=-2*S,p[14]=-H,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this},t.equals=function(r){for(var n=this.elements,o=r.elements,s=0;s<16;s++)if(n[s]!==o[s])return!1;return!0},t.fromArray=function(r,n){n===void 0&&(n=0);for(var o=0;o<16;o++)this.elements[o]=r[o+n];return this},t.toArray=function(r,n){r===void 0&&(r=[]),n===void 0&&(n=0);var o=this.elements;return r[n]=o[0],r[n+1]=o[1],r[n+2]=o[2],r[n+3]=o[3],r[n+4]=o[4],r[n+5]=o[5],r[n+6]=o[6],r[n+7]=o[7],r[n+8]=o[8],r[n+9]=o[9],r[n+10]=o[10],r[n+11]=o[11],r[n+12]=o[12],r[n+13]=o[13],r[n+14]=o[14],r[n+15]=o[15],r},a}(),ts=new fe,Zi=new kr,Np=new fe(0,0,0),kp=new fe(1,1,1),eo=new fe,kl=new fe,Ci=new fe,Ul=function(){function a(i,r,n,o){i===void 0&&(i=0),r===void 0&&(r=0),n===void 0&&(n=0),o===void 0&&(o=a.DefaultOrder),Object.defineProperty(this,"isEuler",{value:!0}),this._x=i,this._y=r,this._z=n,this._order=o}var t=a.prototype;return t.set=function(r,n,o,s){return this._x=r,this._y=n,this._z=o,this._order=s||this._order,this._onChangeCallback(),this},t.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},t.copy=function(r){return this._x=r._x,this._y=r._y,this._z=r._z,this._order=r._order,this._onChangeCallback(),this},t.setFromRotationMatrix=function(r,n,o){var s=gr.clamp,c=r.elements,h=c[0],p=c[4],C=c[8],_=c[1],S=c[5],D=c[9],P=c[2],H=c[6],W=c[10];switch(n=n||this._order,n){case"XYZ":this._y=Math.asin(s(C,-1,1)),Math.abs(C)<.9999999?(this._x=Math.atan2(-D,W),this._z=Math.atan2(-p,h)):(this._x=Math.atan2(H,S),this._z=0);break;case"YXZ":this._x=Math.asin(-s(D,-1,1)),Math.abs(D)<.9999999?(this._y=Math.atan2(C,W),this._z=Math.atan2(_,S)):(this._y=Math.atan2(-P,h),this._z=0);break;case"ZXY":this._x=Math.asin(s(H,-1,1)),Math.abs(H)<.9999999?(this._y=Math.atan2(-P,W),this._z=Math.atan2(-p,S)):(this._y=0,this._z=Math.atan2(_,h));break;case"ZYX":this._y=Math.asin(-s(P,-1,1)),Math.abs(P)<.9999999?(this._x=Math.atan2(H,W),this._z=Math.atan2(_,h)):(this._x=0,this._z=Math.atan2(-p,S));break;case"YZX":this._z=Math.asin(s(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(-D,S),this._y=Math.atan2(-P,h)):(this._x=0,this._y=Math.atan2(C,W));break;case"XZY":this._z=Math.asin(-s(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(H,S),this._y=Math.atan2(C,h)):(this._x=Math.atan2(-D,W),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,o!==!1&&this._onChangeCallback(),this},t.setFromQuaternion=function(r,n,o){return zh.makeRotationFromQuaternion(r),this.setFromRotationMatrix(zh,n,o)},t.setFromVector3=function(r,n){return this.set(r.x,r.y,r.z,n||this._order)},t.reorder=function(r){return Wh.setFromEuler(this),this.setFromQuaternion(Wh,r)},t.equals=function(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._order===this._order},t.fromArray=function(r){return this._x=r[0],this._y=r[1],this._z=r[2],r[3]!==void 0&&(this._order=r[3]),this._onChangeCallback(),this},t.toArray=function(r,n){return r===void 0&&(r=[]),n===void 0&&(n=0),r[n]=this._x,r[n+1]=this._y,r[n+2]=this._z,r[n+3]=this._order,r},t.toVector3=function(r){return r?r.set(this._x,this._y,this._z):new fe(this._x,this._y,this._z)},t._onChange=function(r){return this._onChangeCallback=r,this},t._onChangeCallback=function(){},Dl(a,[{key:"x",get:function(){return this._x},set:function(r){this._x=r,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(r){this._y=r,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(r){this._z=r,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(r){this._order=r,this._onChangeCallback()}}]),a}();Ul.DefaultOrder="XYZ",Ul.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var zh=new kr,Wh=new ni,vu=function(){function a(){this.mask=1}var t=a.prototype;return t.set=function(r){this.mask=1<<r|0},t.enable=function(r){this.mask|=1<<r|0},t.enableAll=function(){this.mask=-1},t.toggle=function(r){this.mask^=1<<r|0},t.disable=function(r){this.mask&=~(1<<r|0)},t.disableAll=function(){this.mask=0},t.test=function(r){return(this.mask&r.mask)!==0},a}(),Up=0,jh=new fe,rs=new ni,Da=new kr,Hl=new fe,Us=new fe,Hp=new fe,Gp=new ni,Xh=new fe(1,0,0),Yh=new fe(0,1,0),Qh=new fe(0,0,1),Vp={type:"added"},qh={type:"removed"};function Qt(){Object.defineProperty(this,"id",{value:Up++}),this.uuid=gr.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Qt.DefaultUp.clone();var a=new fe,t=new Ul,i=new ni,r=new fe(1,1,1);function n(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(n),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new kr},normalMatrix:{value:new _i}}),this.matrix=new kr,this.matrixWorld=new kr,this.matrixAutoUpdate=Qt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new vu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}Qt.DefaultUp=new fe(0,1,0),Qt.DefaultMatrixAutoUpdate=!0,Qt.prototype=Object.assign(Object.create(pa.prototype),{constructor:Qt,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,i){this.quaternion.setFromAxisAngle(t,i)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,i){return rs.setFromAxisAngle(t,i),this.quaternion.multiply(rs),this},rotateOnWorldAxis:function(t,i){return rs.setFromAxisAngle(t,i),this.quaternion.premultiply(rs),this},rotateX:function(t){return this.rotateOnAxis(Xh,t)},rotateY:function(t){return this.rotateOnAxis(Yh,t)},rotateZ:function(t){return this.rotateOnAxis(Qh,t)},translateOnAxis:function(t,i){return jh.copy(t).applyQuaternion(this.quaternion),this.position.add(jh.multiplyScalar(i)),this},translateX:function(t){return this.translateOnAxis(Xh,t)},translateY:function(t){return this.translateOnAxis(Yh,t)},translateZ:function(t){return this.translateOnAxis(Qh,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(Da.copy(this.matrixWorld).invert())},lookAt:function(t,i,r){t.isVector3?Hl.copy(t):Hl.set(t,i,r);var n=this.parent;this.updateWorldMatrix(!0,!1),Us.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Da.lookAt(Us,Hl,this.up):Da.lookAt(Hl,Us,this.up),this.quaternion.setFromRotationMatrix(Da),n&&(Da.extractRotation(n.matrixWorld),rs.setFromRotationMatrix(Da),this.quaternion.premultiply(rs.invert()))},add:function(t){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Vp)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}var r=this.children.indexOf(t);return r!==-1&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(qh)),this},clear:function(){for(var t=0;t<this.children.length;t++){var i=this.children[t];i.parent=null,i.dispatchEvent(qh)}return this.children.length=0,this},attach:function(t){return this.updateWorldMatrix(!0,!1),Da.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Da.multiply(t.parent.matrixWorld)),t.applyMatrix4(Da),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,i){if(this[t]===i)return this;for(var r=0,n=this.children.length;r<n;r++){var o=this.children[r],s=o.getObjectByProperty(t,i);if(s!==void 0)return s}},getWorldPosition:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new fe),this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new ni),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Us,t,Hp),t},getWorldScale:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new fe),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Us,Gp,t),t},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new fe),this.updateWorldMatrix(!0,!1);var i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var i=this.children,r=0,n=i.length;r<n;r++)i[r].traverse(t)},traverseVisible:function(t){if(this.visible!==!1){t(this);for(var i=this.children,r=0,n=i.length;r<n;r++)i[r].traverseVisible(t)}},traverseAncestors:function(t){var i=this.parent;i!==null&&(t(i),i.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var i=this.children,r=0,n=i.length;r<n;r++)i[r].updateMatrixWorld(t)},updateWorldMatrix:function(t,i){var r=this.parent;if(t===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0)for(var n=this.children,o=0,s=n.length;o<s;o++)n[o].updateWorldMatrix(!1,!0)},toJSON:function(t){var i=t===void 0||typeof t=="string",r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON());function o(xe,_e){return xe[_e.uuid]===void 0&&(xe[_e.uuid]=_e.toJSON(t)),_e.uuid}if(this.isMesh||this.isLine||this.isPoints){n.geometry=o(t.geometries,this.geometry);var s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){var c=s.shapes;if(Array.isArray(c))for(var h=0,p=c.length;h<p;h++){var C=c[h];o(t.shapes,C)}else o(t.shapes,c)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(t.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){for(var _=[],S=0,D=this.material.length;S<D;S++)_.push(o(t.materials,this.material[S]));n.material=_}else n.material=o(t.materials,this.material);if(this.children.length>0){n.children=[];for(var P=0;P<this.children.length;P++)n.children.push(this.children[P].toJSON(t).object)}if(this.animations.length>0){n.animations=[];for(var H=0;H<this.animations.length;H++){var W=this.animations[H];n.animations.push(o(t.animations,W))}}if(i){var G=Me(t.geometries),B=Me(t.materials),te=Me(t.textures),he=Me(t.images),K=Me(t.shapes),Q=Me(t.skeletons),le=Me(t.animations);G.length>0&&(r.geometries=G),B.length>0&&(r.materials=B),te.length>0&&(r.textures=te),he.length>0&&(r.images=he),K.length>0&&(r.shapes=K),Q.length>0&&(r.skeletons=Q),le.length>0&&(r.animations=le)}return r.object=n,r;function Me(xe){var _e=[];for(var Pe in xe){var Ce=xe[Pe];delete Ce.metadata,_e.push(Ce)}return _e}},clone:function(t){return new this.constructor().copy(this,t)},copy:function(t,i){if(i===void 0&&(i=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),i===!0)for(var r=0;r<t.children.length;r++){var n=t.children[r];this.add(n.clone())}return this}});var mu=new fe,zp=new fe,Wp=new _i,va=function(){function a(i,r){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=i!==void 0?i:new fe(1,0,0),this.constant=r!==void 0?r:0}var t=a.prototype;return t.set=function(r,n){return this.normal.copy(r),this.constant=n,this},t.setComponents=function(r,n,o,s){return this.normal.set(r,n,o),this.constant=s,this},t.setFromNormalAndCoplanarPoint=function(r,n){return this.normal.copy(r),this.constant=-n.dot(this.normal),this},t.setFromCoplanarPoints=function(r,n,o){var s=mu.subVectors(o,n).cross(zp.subVectors(r,n)).normalize();return this.setFromNormalAndCoplanarPoint(s,r),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.normal.copy(r.normal),this.constant=r.constant,this},t.normalize=function(){var r=1/this.normal.length();return this.normal.multiplyScalar(r),this.constant*=r,this},t.negate=function(){return this.constant*=-1,this.normal.negate(),this},t.distanceToPoint=function(r){return this.normal.dot(r)+this.constant},t.distanceToSphere=function(r){return this.distanceToPoint(r.center)-r.radius},t.projectPoint=function(r,n){return n===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),n=new fe),n.copy(this.normal).multiplyScalar(-this.distanceToPoint(r)).add(r)},t.intersectLine=function(r,n){n===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new fe);var o=r.delta(mu),s=this.normal.dot(o);if(s===0)return this.distanceToPoint(r.start)===0?n.copy(r.start):void 0;var c=-(r.start.dot(this.normal)+this.constant)/s;if(!(c<0||c>1))return n.copy(o).multiplyScalar(c).add(r.start)},t.intersectsLine=function(r){var n=this.distanceToPoint(r.start),o=this.distanceToPoint(r.end);return n<0&&o>0||o<0&&n>0},t.intersectsBox=function(r){return r.intersectsPlane(this)},t.intersectsSphere=function(r){return r.intersectsPlane(this)},t.coplanarPoint=function(r){return r===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),r=new fe),r.copy(this.normal).multiplyScalar(-this.constant)},t.applyMatrix4=function(r,n){var o=n||Wp.getNormalMatrix(r),s=this.coplanarPoint(mu).applyMatrix4(r),c=this.normal.applyMatrix3(o).normalize();return this.constant=-s.dot(c),this},t.translate=function(r){return this.constant-=r.dot(this.normal),this},t.equals=function(r){return r.normal.equals(this.normal)&&r.constant===this.constant},a}(),Ki=new fe,Oa=new fe,gu=new fe,Ia=new fe,ns=new fe,is=new fe,Jh=new fe,yu=new fe,Au=new fe,bu=new fe,ma=function(){function a(i,r,n){this.a=i!==void 0?i:new fe,this.b=r!==void 0?r:new fe,this.c=n!==void 0?n:new fe}a.getNormal=function(r,n,o,s){s===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),s=new fe),s.subVectors(o,n),Ki.subVectors(r,n),s.cross(Ki);var c=s.lengthSq();return c>0?s.multiplyScalar(1/Math.sqrt(c)):s.set(0,0,0)},a.getBarycoord=function(r,n,o,s,c){Ki.subVectors(s,n),Oa.subVectors(o,n),gu.subVectors(r,n);var h=Ki.dot(Ki),p=Ki.dot(Oa),C=Ki.dot(gu),_=Oa.dot(Oa),S=Oa.dot(gu),D=h*_-p*p;if(c===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),c=new fe),D===0)return c.set(-2,-1,-1);var P=1/D,H=(_*C-p*S)*P,W=(h*S-p*C)*P;return c.set(1-H-W,W,H)},a.containsPoint=function(r,n,o,s){return this.getBarycoord(r,n,o,s,Ia),Ia.x>=0&&Ia.y>=0&&Ia.x+Ia.y<=1},a.getUV=function(r,n,o,s,c,h,p,C){return this.getBarycoord(r,n,o,s,Ia),C.set(0,0),C.addScaledVector(c,Ia.x),C.addScaledVector(h,Ia.y),C.addScaledVector(p,Ia.z),C},a.isFrontFacing=function(r,n,o,s){return Ki.subVectors(o,n),Oa.subVectors(r,n),Ki.cross(Oa).dot(s)<0};var t=a.prototype;return t.set=function(r,n,o){return this.a.copy(r),this.b.copy(n),this.c.copy(o),this},t.setFromPointsAndIndices=function(r,n,o,s){return this.a.copy(r[n]),this.b.copy(r[o]),this.c.copy(r[s]),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.a.copy(r.a),this.b.copy(r.b),this.c.copy(r.c),this},t.getArea=function(){return Ki.subVectors(this.c,this.b),Oa.subVectors(this.a,this.b),Ki.cross(Oa).length()*.5},t.getMidpoint=function(r){return r===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),r=new fe),r.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},t.getNormal=function(r){return a.getNormal(this.a,this.b,this.c,r)},t.getPlane=function(r){return r===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),r=new va),r.setFromCoplanarPoints(this.a,this.b,this.c)},t.getBarycoord=function(r,n){return a.getBarycoord(r,this.a,this.b,this.c,n)},t.getUV=function(r,n,o,s,c){return a.getUV(r,this.a,this.b,this.c,n,o,s,c)},t.containsPoint=function(r){return a.containsPoint(r,this.a,this.b,this.c)},t.isFrontFacing=function(r){return a.isFrontFacing(this.a,this.b,this.c,r)},t.intersectsBox=function(r){return r.intersectsTriangle(this)},t.closestPointToPoint=function(r,n){n===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),n=new fe);var o=this.a,s=this.b,c=this.c,h,p;ns.subVectors(s,o),is.subVectors(c,o),yu.subVectors(r,o);var C=ns.dot(yu),_=is.dot(yu);if(C<=0&&_<=0)return n.copy(o);Au.subVectors(r,s);var S=ns.dot(Au),D=is.dot(Au);if(S>=0&&D<=S)return n.copy(s);var P=C*D-S*_;if(P<=0&&C>=0&&S<=0)return h=C/(C-S),n.copy(o).addScaledVector(ns,h);bu.subVectors(r,c);var H=ns.dot(bu),W=is.dot(bu);if(W>=0&&H<=W)return n.copy(c);var G=H*_-C*W;if(G<=0&&_>=0&&W<=0)return p=_/(_-W),n.copy(o).addScaledVector(is,p);var B=S*W-H*D;if(B<=0&&D-S>=0&&H-W>=0)return Jh.subVectors(c,s),p=(D-S)/(D-S+(H-W)),n.copy(s).addScaledVector(Jh,p);var te=1/(B+G+P);return h=G*te,p=P*te,n.copy(o).addScaledVector(ns,h).addScaledVector(is,p)},t.equals=function(r){return r.a.equals(this.a)&&r.b.equals(this.b)&&r.c.equals(this.c)},a}(),Zh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$i={h:0,s:0,l:0},Gl={h:0,s:0,l:0};function Eu(a,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?a+(t-a)*6*i:i<1/2?t:i<2/3?a+(t-a)*6*(2/3-i):a}function wu(a){return a<.04045?a*.0773993808:Math.pow(a*.9478672986+.0521327014,2.4)}function xu(a){return a<.0031308?a*12.92:1.055*Math.pow(a,.41666)-.055}var It=function(){function a(i,r,n){return Object.defineProperty(this,"isColor",{value:!0}),r===void 0&&n===void 0?this.set(i):this.setRGB(i,r,n)}var t=a.prototype;return t.set=function(r){return r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r),this},t.setScalar=function(r){return this.r=r,this.g=r,this.b=r,this},t.setHex=function(r){return r=Math.floor(r),this.r=(r>>16&255)/255,this.g=(r>>8&255)/255,this.b=(r&255)/255,this},t.setRGB=function(r,n,o){return this.r=r,this.g=n,this.b=o,this},t.setHSL=function(r,n,o){if(r=gr.euclideanModulo(r,1),n=gr.clamp(n,0,1),o=gr.clamp(o,0,1),n===0)this.r=this.g=this.b=o;else{var s=o<=.5?o*(1+n):o+n-o*n,c=2*o-s;this.r=Eu(c,s,r+1/3),this.g=Eu(c,s,r),this.b=Eu(c,s,r-1/3)}return this},t.setStyle=function(r){function n(P){P!==void 0&&parseFloat(P)<1&&console.warn("THREE.Color: Alpha component of "+r+" will be ignored.")}var o;if(o=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(r)){var s,c=o[1],h=o[2];switch(c){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,n(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,n(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h)){var p=parseFloat(s[1])/360,C=parseInt(s[2],10)/100,_=parseInt(s[3],10)/100;return n(s[4]),this.setHSL(p,C,_)}break}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(r)){var S=o[1],D=S.length;if(D===3)return this.r=parseInt(S.charAt(0)+S.charAt(0),16)/255,this.g=parseInt(S.charAt(1)+S.charAt(1),16)/255,this.b=parseInt(S.charAt(2)+S.charAt(2),16)/255,this;if(D===6)return this.r=parseInt(S.charAt(0)+S.charAt(1),16)/255,this.g=parseInt(S.charAt(2)+S.charAt(3),16)/255,this.b=parseInt(S.charAt(4)+S.charAt(5),16)/255,this}return r&&r.length>0?this.setColorName(r):this},t.setColorName=function(r){var n=Zh[r];return n!==void 0?this.setHex(n):console.warn("THREE.Color: Unknown color "+r),this},t.clone=function(){return new this.constructor(this.r,this.g,this.b)},t.copy=function(r){return this.r=r.r,this.g=r.g,this.b=r.b,this},t.copyGammaToLinear=function(r,n){return n===void 0&&(n=2),this.r=Math.pow(r.r,n),this.g=Math.pow(r.g,n),this.b=Math.pow(r.b,n),this},t.copyLinearToGamma=function(r,n){n===void 0&&(n=2);var o=n>0?1/n:1;return this.r=Math.pow(r.r,o),this.g=Math.pow(r.g,o),this.b=Math.pow(r.b,o),this},t.convertGammaToLinear=function(r){return this.copyGammaToLinear(this,r),this},t.convertLinearToGamma=function(r){return this.copyLinearToGamma(this,r),this},t.copySRGBToLinear=function(r){return this.r=wu(r.r),this.g=wu(r.g),this.b=wu(r.b),this},t.copyLinearToSRGB=function(r){return this.r=xu(r.r),this.g=xu(r.g),this.b=xu(r.b),this},t.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},t.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},t.getHex=function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},t.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},t.getHSL=function(r){r===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),r={h:0,s:0,l:0});var n=this.r,o=this.g,s=this.b,c=Math.max(n,o,s),h=Math.min(n,o,s),p,C,_=(h+c)/2;if(h===c)p=0,C=0;else{var S=c-h;switch(C=_<=.5?S/(c+h):S/(2-c-h),c){case n:p=(o-s)/S+(o<s?6:0);break;case o:p=(s-n)/S+2;break;case s:p=(n-o)/S+4;break}p/=6}return r.h=p,r.s=C,r.l=_,r},t.getStyle=function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},t.offsetHSL=function(r,n,o){return this.getHSL($i),$i.h+=r,$i.s+=n,$i.l+=o,this.setHSL($i.h,$i.s,$i.l),this},t.add=function(r){return this.r+=r.r,this.g+=r.g,this.b+=r.b,this},t.addColors=function(r,n){return this.r=r.r+n.r,this.g=r.g+n.g,this.b=r.b+n.b,this},t.addScalar=function(r){return this.r+=r,this.g+=r,this.b+=r,this},t.sub=function(r){return this.r=Math.max(0,this.r-r.r),this.g=Math.max(0,this.g-r.g),this.b=Math.max(0,this.b-r.b),this},t.multiply=function(r){return this.r*=r.r,this.g*=r.g,this.b*=r.b,this},t.multiplyScalar=function(r){return this.r*=r,this.g*=r,this.b*=r,this},t.lerp=function(r,n){return this.r+=(r.r-this.r)*n,this.g+=(r.g-this.g)*n,this.b+=(r.b-this.b)*n,this},t.lerpColors=function(r,n,o){return this.r=r.r+(n.r-r.r)*o,this.g=r.g+(n.g-r.g)*o,this.b=r.b+(n.b-r.b)*o,this},t.lerpHSL=function(r,n){this.getHSL($i),r.getHSL(Gl);var o=gr.lerp($i.h,Gl.h,n),s=gr.lerp($i.s,Gl.s,n),c=gr.lerp($i.l,Gl.l,n);return this.setHSL(o,s,c),this},t.equals=function(r){return r.r===this.r&&r.g===this.g&&r.b===this.b},t.fromArray=function(r,n){return n===void 0&&(n=0),this.r=r[n],this.g=r[n+1],this.b=r[n+2],this},t.toArray=function(r,n){return r===void 0&&(r=[]),n===void 0&&(n=0),r[n]=this.r,r[n+1]=this.g,r[n+2]=this.b,r},t.fromBufferAttribute=function(r,n){return this.r=r.getX(n),this.g=r.getY(n),this.b=r.getZ(n),r.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this},t.toJSON=function(){return this.getHex()},a}();It.NAMES=Zh,It.prototype.r=1,It.prototype.g=1,It.prototype.b=1;var Mu=function(){function a(i,r,n,o,s,c){c===void 0&&(c=0),this.a=i,this.b=r,this.c=n,this.normal=o&&o.isVector3?o:new fe,this.vertexNormals=Array.isArray(o)?o:[],this.color=s&&s.isColor?s:new It,this.vertexColors=Array.isArray(s)?s:[],this.materialIndex=c}var t=a.prototype;return t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){this.a=r.a,this.b=r.b,this.c=r.c,this.normal.copy(r.normal),this.color.copy(r.color),this.materialIndex=r.materialIndex;for(var n=0,o=r.vertexNormals.length;n<o;n++)this.vertexNormals[n]=r.vertexNormals[n].clone();for(var s=0,c=r.vertexColors.length;s<c;s++)this.vertexColors[s]=r.vertexColors[s].clone();return this},a}(),jp=0;function hr(){Object.defineProperty(this,"id",{value:jp++}),this.uuid=gr.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=re,this.side=L,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Mt,this.blendDst=Rt,this.blendEquation=j,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ae,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Uh,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Pl,this.stencilZFail=Pl,this.stencilZPass=Pl,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}hr.prototype=Object.assign(Object.create(pa.prototype),{constructor:hr,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(t!==void 0)for(var i in t){var r=t[i];if(r===void 0){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}if(i==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===O;continue}var n=this[i];if(n===void 0){console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.");continue}n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[i]=r}},toJSON:function(t){var i=t===void 0||typeof t=="string";i&&(t={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(r.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,r.reflectivity=this.reflectivity,r.refractionRatio=this.refractionRatio,this.combine!==void 0&&(r.combine=this.combine),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),this.size!==void 0&&(r.size=this.size),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==re&&(r.blending=this.blending),this.flatShading===!0&&(r.flatShading=this.flatShading),this.side!==L&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(r.morphTargets=!0),this.morphNormals===!0&&(r.morphNormals=!0),this.skinning===!0&&(r.skinning=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData);function n(c){var h=[];for(var p in c){var C=c[p];delete C.metadata,h.push(C)}return h}if(i){var o=n(t.textures),s=n(t.images);o.length>0&&(r.textures=o),s.length>0&&(r.images=s)}return r},clone:function(){return new this.constructor().copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var i=t.clippingPlanes,r=null;if(i!==null){var n=i.length;r=new Array(n);for(var o=0;o!==n;++o)r[o]=i[o].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(hr.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}});function Li(a){hr.call(this),this.type="MeshBasicMaterial",this.color=new It(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Oe,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(a)}Li.prototype=Object.create(hr.prototype),Li.prototype.constructor=Li,Li.prototype.isMeshBasicMaterial=!0,Li.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this};var wn=new fe,Vl=new bt;function dr(a,t,i){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=a,this.itemSize=t,this.count=a!==void 0?a.length/t:0,this.normalized=i===!0,this.usage=Bs,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(dr.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),Object.assign(dr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,i,r){t*=this.itemSize,r*=i.itemSize;for(var n=0,o=this.itemSize;n<o;n++)this.array[t+n]=i.array[r+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var i=this.array,r=0,n=0,o=t.length;n<o;n++){var s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),s=new It),i[r++]=s.r,i[r++]=s.g,i[r++]=s.b}return this},copyVector2sArray:function(t){for(var i=this.array,r=0,n=0,o=t.length;n<o;n++){var s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),s=new bt),i[r++]=s.x,i[r++]=s.y}return this},copyVector3sArray:function(t){for(var i=this.array,r=0,n=0,o=t.length;n<o;n++){var s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),s=new fe),i[r++]=s.x,i[r++]=s.y,i[r++]=s.z}return this},copyVector4sArray:function(t){for(var i=this.array,r=0,n=0,o=t.length;n<o;n++){var s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),s=new un),i[r++]=s.x,i[r++]=s.y,i[r++]=s.z,i[r++]=s.w}return this},applyMatrix3:function(t){if(this.itemSize===2)for(var i=0,r=this.count;i<r;i++)Vl.fromBufferAttribute(this,i),Vl.applyMatrix3(t),this.setXY(i,Vl.x,Vl.y);else if(this.itemSize===3)for(var n=0,o=this.count;n<o;n++)wn.fromBufferAttribute(this,n),wn.applyMatrix3(t),this.setXYZ(n,wn.x,wn.y,wn.z);return this},applyMatrix4:function(t){for(var i=0,r=this.count;i<r;i++)wn.x=this.getX(i),wn.y=this.getY(i),wn.z=this.getZ(i),wn.applyMatrix4(t),this.setXYZ(i,wn.x,wn.y,wn.z);return this},applyNormalMatrix:function(t){for(var i=0,r=this.count;i<r;i++)wn.x=this.getX(i),wn.y=this.getY(i),wn.z=this.getZ(i),wn.applyNormalMatrix(t),this.setXYZ(i,wn.x,wn.y,wn.z);return this},transformDirection:function(t){for(var i=0,r=this.count;i<r;i++)wn.x=this.getX(i),wn.y=this.getY(i),wn.z=this.getZ(i),wn.transformDirection(t),this.setXYZ(i,wn.x,wn.y,wn.z);return this},set:function(t,i){return i===void 0&&(i=0),this.array.set(t,i),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,i){return this.array[t*this.itemSize]=i,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,i){return this.array[t*this.itemSize+1]=i,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,i){return this.array[t*this.itemSize+2]=i,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,i){return this.array[t*this.itemSize+3]=i,this},setXY:function(t,i,r){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=r,this},setXYZ:function(t,i,r,n){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=r,this.array[t+2]=n,this},setXYZW:function(t,i,r,n,o){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=r,this.array[t+2]=n,this.array[t+3]=o,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function Hs(a,t,i){dr.call(this,new Int8Array(a),t,i)}Hs.prototype=Object.create(dr.prototype),Hs.prototype.constructor=Hs;function Gs(a,t,i){dr.call(this,new Uint8Array(a),t,i)}Gs.prototype=Object.create(dr.prototype),Gs.prototype.constructor=Gs;function Vs(a,t,i){dr.call(this,new Uint8ClampedArray(a),t,i)}Vs.prototype=Object.create(dr.prototype),Vs.prototype.constructor=Vs;function zs(a,t,i){dr.call(this,new Int16Array(a),t,i)}zs.prototype=Object.create(dr.prototype),zs.prototype.constructor=zs;function Co(a,t,i){dr.call(this,new Uint16Array(a),t,i)}Co.prototype=Object.create(dr.prototype),Co.prototype.constructor=Co;function Ws(a,t,i){dr.call(this,new Int32Array(a),t,i)}Ws.prototype=Object.create(dr.prototype),Ws.prototype.constructor=Ws;function Lo(a,t,i){dr.call(this,new Uint32Array(a),t,i)}Lo.prototype=Object.create(dr.prototype),Lo.prototype.constructor=Lo;function js(a,t,i){dr.call(this,new Uint16Array(a),t,i)}js.prototype=Object.create(dr.prototype),js.prototype.constructor=js,js.prototype.isFloat16BufferAttribute=!0;function Nt(a,t,i){dr.call(this,new Float32Array(a),t,i)}Nt.prototype=Object.create(dr.prototype),Nt.prototype.constructor=Nt;function Xs(a,t,i){dr.call(this,new Float64Array(a),t,i)}Xs.prototype=Object.create(dr.prototype),Xs.prototype.constructor=Xs;function Kh(a){if(a.length===0)return-1/0;for(var t=a[0],i=1,r=a.length;i<r;++i)a[i]>t&&(t=a[i]);return t}var Xp={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Ys(a,t){return new Xp[a](t)}var Yp=0,ga=new kr,Tu=new Qt,as=new fe,Ri=new La,Qs=new La,Zn=new fe;function tr(){Object.defineProperty(this,"id",{value:Yp++}),this.uuid=gr.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}tr.prototype=Object.assign(Object.create(pa.prototype),{constructor:tr,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){return Array.isArray(t)?this.index=new(Kh(t)>65535?Lo:Co)(t,1):this.index=t,this},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,i){return this.attributes[t]=i,this},deleteAttribute:function(t){return delete this.attributes[t],this},hasAttribute:function(t){return this.attributes[t]!==void 0},addGroup:function(t,i,r){r===void 0&&(r=0),this.groups.push({start:t,count:i,materialIndex:r})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,i){this.drawRange.start=t,this.drawRange.count=i},applyMatrix4:function(t){var i=this.attributes.position;i!==void 0&&(i.applyMatrix4(t),i.needsUpdate=!0);var r=this.attributes.normal;if(r!==void 0){var n=new _i().getNormalMatrix(t);r.applyNormalMatrix(n),r.needsUpdate=!0}var o=this.attributes.tangent;return o!==void 0&&(o.transformDirection(t),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(t){return ga.makeRotationX(t),this.applyMatrix4(ga),this},rotateY:function(t){return ga.makeRotationY(t),this.applyMatrix4(ga),this},rotateZ:function(t){return ga.makeRotationZ(t),this.applyMatrix4(ga),this},translate:function(t,i,r){return ga.makeTranslation(t,i,r),this.applyMatrix4(ga),this},scale:function(t,i,r){return ga.makeScale(t,i,r),this.applyMatrix4(ga),this},lookAt:function(t){return Tu.lookAt(t),Tu.updateMatrix(),this.applyMatrix4(Tu.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(as).negate(),this.translate(as.x,as.y,as.z),this},setFromPoints:function(t){for(var i=[],r=0,n=t.length;r<n;r++){var o=t[r];i.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new Nt(i,3)),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new La);var t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new fe(-1/0,-1/0,-1/0),new fe(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),i)for(var r=0,n=i.length;r<n;r++){var o=i[r];Ri.setFromBufferAttribute(o),this.morphTargetsRelative?(Zn.addVectors(this.boundingBox.min,Ri.min),this.boundingBox.expandByPoint(Zn),Zn.addVectors(this.boundingBox.max,Ri.max),this.boundingBox.expandByPoint(Zn)):(this.boundingBox.expandByPoint(Ri.min),this.boundingBox.expandByPoint(Ri.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Ka);var t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new fe,1/0);return}if(t){var r=this.boundingSphere.center;if(Ri.setFromBufferAttribute(t),i)for(var n=0,o=i.length;n<o;n++){var s=i[n];Qs.setFromBufferAttribute(s),this.morphTargetsRelative?(Zn.addVectors(Ri.min,Qs.min),Ri.expandByPoint(Zn),Zn.addVectors(Ri.max,Qs.max),Ri.expandByPoint(Zn)):(Ri.expandByPoint(Qs.min),Ri.expandByPoint(Qs.max))}Ri.getCenter(r);for(var c=0,h=0,p=t.count;h<p;h++)Zn.fromBufferAttribute(t,h),c=Math.max(c,r.distanceToSquared(Zn));if(i)for(var C=0,_=i.length;C<_;C++)for(var S=i[C],D=this.morphTargetsRelative,P=0,H=S.count;P<H;P++)Zn.fromBufferAttribute(S,P),D&&(as.fromBufferAttribute(t,P),Zn.add(as)),c=Math.max(c,r.distanceToSquared(Zn));this.boundingSphere.radius=Math.sqrt(c),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){var t=this.index,i=this.attributes;if(t===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}var r=t.array,n=i.position.array,o=i.normal.array,s=i.uv.array,c=n.length/3;i.tangent===void 0&&this.setAttribute("tangent",new dr(new Float32Array(4*c),4));for(var h=i.tangent.array,p=[],C=[],_=0;_<c;_++)p[_]=new fe,C[_]=new fe;var S=new fe,D=new fe,P=new fe,H=new bt,W=new bt,G=new bt,B=new fe,te=new fe;function he(Ke,rr,Bt){S.fromArray(n,Ke*3),D.fromArray(n,rr*3),P.fromArray(n,Bt*3),H.fromArray(s,Ke*2),W.fromArray(s,rr*2),G.fromArray(s,Bt*2),D.sub(S),P.sub(S),W.sub(H),G.sub(H);var sr=1/(W.x*G.y-G.x*W.y);isFinite(sr)&&(B.copy(D).multiplyScalar(G.y).addScaledVector(P,-W.y).multiplyScalar(sr),te.copy(P).multiplyScalar(W.x).addScaledVector(D,-G.x).multiplyScalar(sr),p[Ke].add(B),p[rr].add(B),p[Bt].add(B),C[Ke].add(te),C[rr].add(te),C[Bt].add(te))}var K=this.groups;K.length===0&&(K=[{start:0,count:r.length}]);for(var Q=0,le=K.length;Q<le;++Q)for(var Me=K[Q],xe=Me.start,_e=Me.count,Pe=xe,Ce=xe+_e;Pe<Ce;Pe+=3)he(r[Pe+0],r[Pe+1],r[Pe+2]);var Ae=new fe,Be=new fe,Se=new fe,Te=new fe;function me(Ke){Se.fromArray(o,Ke*3),Te.copy(Se);var rr=p[Ke];Ae.copy(rr),Ae.sub(Se.multiplyScalar(Se.dot(rr))).normalize(),Be.crossVectors(Te,rr);var Bt=Be.dot(C[Ke]),sr=Bt<0?-1:1;h[Ke*4]=Ae.x,h[Ke*4+1]=Ae.y,h[Ke*4+2]=Ae.z,h[Ke*4+3]=sr}for(var Ue=0,He=K.length;Ue<He;++Ue)for(var Qe=K[Ue],qe=Qe.start,gt=Qe.count,St=qe,Vt=qe+gt;St<Vt;St+=3)me(r[St+0]),me(r[St+1]),me(r[St+2])},computeVertexNormals:function(){var t=this.index,i=this.getAttribute("position");if(i!==void 0){var r=this.getAttribute("normal");if(r===void 0)r=new dr(new Float32Array(i.count*3),3),this.setAttribute("normal",r);else for(var n=0,o=r.count;n<o;n++)r.setXYZ(n,0,0,0);var s=new fe,c=new fe,h=new fe,p=new fe,C=new fe,_=new fe,S=new fe,D=new fe;if(t)for(var P=0,H=t.count;P<H;P+=3){var W=t.getX(P+0),G=t.getX(P+1),B=t.getX(P+2);s.fromBufferAttribute(i,W),c.fromBufferAttribute(i,G),h.fromBufferAttribute(i,B),S.subVectors(h,c),D.subVectors(s,c),S.cross(D),p.fromBufferAttribute(r,W),C.fromBufferAttribute(r,G),_.fromBufferAttribute(r,B),p.add(S),C.add(S),_.add(S),r.setXYZ(W,p.x,p.y,p.z),r.setXYZ(G,C.x,C.y,C.z),r.setXYZ(B,_.x,_.y,_.z)}else for(var te=0,he=i.count;te<he;te+=3)s.fromBufferAttribute(i,te+0),c.fromBufferAttribute(i,te+1),h.fromBufferAttribute(i,te+2),S.subVectors(h,c),D.subVectors(s,c),S.cross(D),r.setXYZ(te+0,S.x,S.y,S.z),r.setXYZ(te+1,S.x,S.y,S.z),r.setXYZ(te+2,S.x,S.y,S.z);this.normalizeNormals(),r.needsUpdate=!0}},merge:function(t,i){if(!(t&&t.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);return}i===void 0&&(i=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r=this.attributes;for(var n in r)if(t.attributes[n]!==void 0)for(var o=r[n],s=o.array,c=t.attributes[n],h=c.array,p=c.itemSize*i,C=Math.min(h.length,s.length-p),_=0,S=p;_<C;_++,S++)s[S]=h[_];return this},normalizeNormals:function(){for(var t=this.attributes.normal,i=0,r=t.count;i<r;i++)Zn.fromBufferAttribute(t,i),Zn.normalize(),t.setXYZ(i,Zn.x,Zn.y,Zn.z)},toNonIndexed:function(){function t(he,K){for(var Q=he.array,le=he.itemSize,Me=he.normalized,xe=new Q.constructor(K.length*le),_e=0,Pe=0,Ce=0,Ae=K.length;Ce<Ae;Ce++){_e=K[Ce]*le;for(var Be=0;Be<le;Be++)xe[Pe++]=Q[_e++]}return new dr(xe,le,Me)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var i=new tr,r=this.index.array,n=this.attributes;for(var o in n){var s=n[o],c=t(s,r);i.setAttribute(o,c)}var h=this.morphAttributes;for(var p in h){for(var C=[],_=h[p],S=0,D=_.length;S<D;S++){var P=_[S],H=t(P,r);C.push(H)}i.morphAttributes[p]=C}i.morphTargetsRelative=this.morphTargetsRelative;for(var W=this.groups,G=0,B=W.length;G<B;G++){var te=W[G];i.addGroup(te.start,te.count,te.materialIndex)}return i},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){var i=this.parameters;for(var r in i)i[r]!==void 0&&(t[r]=i[r]);return t}t.data={attributes:{}};var n=this.index;n!==null&&(t.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});var o=this.attributes;for(var s in o){var c=o[s],h=c.toJSON(t.data);c.name!==""&&(h.name=c.name),t.data.attributes[s]=h}var p={},C=!1;for(var _ in this.morphAttributes){for(var S=this.morphAttributes[_],D=[],P=0,H=S.length;P<H;P++){var W=S[P],G=W.toJSON(t.data);W.name!==""&&(G.name=W.name),D.push(G)}D.length>0&&(p[_]=D,C=!0)}C&&(t.data.morphAttributes=p,t.data.morphTargetsRelative=this.morphTargetsRelative);var B=this.groups;B.length>0&&(t.data.groups=JSON.parse(JSON.stringify(B)));var te=this.boundingSphere;return te!==null&&(t.data.boundingSphere={center:te.center.toArray(),radius:te.radius}),t},clone:function(){return new tr().copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var i={};this.name=t.name;var r=t.index;r!==null&&this.setIndex(r.clone(i));var n=t.attributes;for(var o in n){var s=n[o];this.setAttribute(o,s.clone(i))}var c=t.morphAttributes;for(var h in c){for(var p=[],C=c[h],_=0,S=C.length;_<S;_++)p.push(C[_].clone(i));this.morphAttributes[h]=p}this.morphTargetsRelative=t.morphTargetsRelative;for(var D=t.groups,P=0,H=D.length;P<H;P++){var W=D[P];this.addGroup(W.start,W.count,W.materialIndex)}var G=t.boundingBox;G!==null&&(this.boundingBox=G.clone());var B=t.boundingSphere;return B!==null&&(this.boundingSphere=B.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var $h=new kr,os=new es,Su=new Ka,to=new fe,ro=new fe,no=new fe,_u=new fe,Cu=new fe,Lu=new fe,zl=new fe,Wl=new fe,jl=new fe,Xl=new bt,Yl=new bt,Ql=new bt,Ru=new fe,ql=new fe;function xn(a,t){a===void 0&&(a=new tr),t===void 0&&(t=new Li),Qt.call(this),this.type="Mesh",this.geometry=a,this.material=t,this.updateMorphTargets()}xn.prototype=Object.assign(Object.create(Qt.prototype),{constructor:xn,isMesh:!0,copy:function(t){return Qt.prototype.copy.call(this,t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var i=t.morphAttributes,r=Object.keys(i);if(r.length>0){var n=i[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,s=n.length;o<s;o++){var c=n[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}else{var h=t.morphTargets;h!==void 0&&h.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,i){var r=this.geometry,n=this.material,o=this.matrixWorld;if(n!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),Su.copy(r.boundingSphere),Su.applyMatrix4(o),t.ray.intersectsSphere(Su)!==!1&&($h.copy(o).invert(),os.copy(t.ray).applyMatrix4($h),!(r.boundingBox!==null&&os.intersectsBox(r.boundingBox)===!1)))){var s;if(r.isBufferGeometry){var c=r.index,h=r.attributes.position,p=r.morphAttributes.position,C=r.morphTargetsRelative,_=r.attributes.uv,S=r.attributes.uv2,D=r.groups,P=r.drawRange;if(c!==null)if(Array.isArray(n))for(var H=0,W=D.length;H<W;H++)for(var G=D[H],B=n[G.materialIndex],te=Math.max(G.start,P.start),he=Math.min(G.start+G.count,P.start+P.count),K=te,Q=he;K<Q;K+=3){var le=c.getX(K),Me=c.getX(K+1),xe=c.getX(K+2);s=Jl(this,B,t,os,h,p,C,_,S,le,Me,xe),s&&(s.faceIndex=Math.floor(K/3),s.face.materialIndex=G.materialIndex,i.push(s))}else for(var _e=Math.max(0,P.start),Pe=Math.min(c.count,P.start+P.count),Ce=_e,Ae=Pe;Ce<Ae;Ce+=3){var Be=c.getX(Ce),Se=c.getX(Ce+1),Te=c.getX(Ce+2);s=Jl(this,n,t,os,h,p,C,_,S,Be,Se,Te),s&&(s.faceIndex=Math.floor(Ce/3),i.push(s))}else if(h!==void 0)if(Array.isArray(n))for(var me=0,Ue=D.length;me<Ue;me++)for(var He=D[me],Qe=n[He.materialIndex],qe=Math.max(He.start,P.start),gt=Math.min(He.start+He.count,P.start+P.count),St=qe,Vt=gt;St<Vt;St+=3){var Ke=St,rr=St+1,Bt=St+2;s=Jl(this,Qe,t,os,h,p,C,_,S,Ke,rr,Bt),s&&(s.faceIndex=Math.floor(St/3),s.face.materialIndex=He.materialIndex,i.push(s))}else for(var sr=Math.max(0,P.start),xr=Math.min(h.count,P.start+P.count),Fr=sr,Sr=xr;Fr<Sr;Fr+=3){var mn=Fr,Qr=Fr+1,hn=Fr+2;s=Jl(this,n,t,os,h,p,C,_,S,mn,Qr,hn),s&&(s.faceIndex=Math.floor(Fr/3),i.push(s))}}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function Qp(a,t,i,r,n,o,s,c){var h;if(t.side===T?h=r.intersectTriangle(s,o,n,!0,c):h=r.intersectTriangle(n,o,s,t.side!==R,c),h===null)return null;ql.copy(c),ql.applyMatrix4(a.matrixWorld);var p=i.ray.origin.distanceTo(ql);return p<i.near||p>i.far?null:{distance:p,point:ql.clone(),object:a}}function Jl(a,t,i,r,n,o,s,c,h,p,C,_){to.fromBufferAttribute(n,p),ro.fromBufferAttribute(n,C),no.fromBufferAttribute(n,_);var S=a.morphTargetInfluences;if(t.morphTargets&&o&&S){zl.set(0,0,0),Wl.set(0,0,0),jl.set(0,0,0);for(var D=0,P=o.length;D<P;D++){var H=S[D],W=o[D];H!==0&&(_u.fromBufferAttribute(W,p),Cu.fromBufferAttribute(W,C),Lu.fromBufferAttribute(W,_),s?(zl.addScaledVector(_u,H),Wl.addScaledVector(Cu,H),jl.addScaledVector(Lu,H)):(zl.addScaledVector(_u.sub(to),H),Wl.addScaledVector(Cu.sub(ro),H),jl.addScaledVector(Lu.sub(no),H)))}to.add(zl),ro.add(Wl),no.add(jl)}a.isSkinnedMesh&&(a.boneTransform(p,to),a.boneTransform(C,ro),a.boneTransform(_,no));var G=Qp(a,t,i,r,to,ro,no,Ru);if(G){c&&(Xl.fromBufferAttribute(c,p),Yl.fromBufferAttribute(c,C),Ql.fromBufferAttribute(c,_),G.uv=ma.getUV(Ru,to,ro,no,Xl,Yl,Ql,new bt)),h&&(Xl.fromBufferAttribute(h,p),Yl.fromBufferAttribute(h,C),Ql.fromBufferAttribute(h,_),G.uv2=ma.getUV(Ru,to,ro,no,Xl,Yl,Ql,new bt));var B=new Mu(p,C,_);ma.getNormal(to,ro,no,B.normal),G.face=B}return G}var Ro=function(a){Or(t,a);function t(i,r,n,o,s,c){var h;i===void 0&&(i=1),r===void 0&&(r=1),n===void 0&&(n=1),o===void 0&&(o=1),s===void 0&&(s=1),c===void 0&&(c=1),h=a.call(this)||this,h.type="BoxGeometry",h.parameters={width:i,height:r,depth:n,widthSegments:o,heightSegments:s,depthSegments:c};var p=Ji(h);o=Math.floor(o),s=Math.floor(s),c=Math.floor(c);var C=[],_=[],S=[],D=[],P=0,H=0;W("z","y","x",-1,-1,n,r,i,c,s,0),W("z","y","x",1,-1,n,r,-i,c,s,1),W("x","z","y",1,1,i,n,r,o,c,2),W("x","z","y",1,-1,i,n,-r,o,c,3),W("x","y","z",1,-1,i,r,n,o,s,4),W("x","y","z",-1,-1,i,r,-n,o,s,5),h.setIndex(C),h.setAttribute("position",new Nt(_,3)),h.setAttribute("normal",new Nt(S,3)),h.setAttribute("uv",new Nt(D,2));function W(G,B,te,he,K,Q,le,Me,xe,_e,Pe){for(var Ce=Q/xe,Ae=le/_e,Be=Q/2,Se=le/2,Te=Me/2,me=xe+1,Ue=_e+1,He=0,Qe=0,qe=new fe,gt=0;gt<Ue;gt++)for(var St=gt*Ae-Se,Vt=0;Vt<me;Vt++){var Ke=Vt*Ce-Be;qe[G]=Ke*he,qe[B]=St*K,qe[te]=Te,_.push(qe.x,qe.y,qe.z),qe[G]=0,qe[B]=0,qe[te]=Me>0?1:-1,S.push(qe.x,qe.y,qe.z),D.push(Vt/xe),D.push(1-gt/_e),He+=1}for(var rr=0;rr<_e;rr++)for(var Bt=0;Bt<xe;Bt++){var sr=P+Bt+me*rr,xr=P+Bt+me*(rr+1),Fr=P+(Bt+1)+me*(rr+1),Sr=P+(Bt+1)+me*rr;C.push(sr,xr,Sr),C.push(xr,Fr,Sr),Qe+=6}p.addGroup(H,Qe,Pe),H+=Qe,P+=He}return h}return t}(tr);function ss(a){var t={};for(var i in a){t[i]={};for(var r in a[i]){var n=a[i][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture)?t[i][r]=n.clone():Array.isArray(n)?t[i][r]=n.slice():t[i][r]=n}}return t}function ui(a){for(var t={},i=0;i<a.length;i++){var r=ss(a[i]);for(var n in r)t[n]=r[n]}return t}var ed={clone:ss,merge:ui},qp=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Jp=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function Ai(a){hr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=qp,this.fragmentShader=Jp,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,a!==void 0&&(a.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(a))}Ai.prototype=Object.create(hr.prototype),Ai.prototype.constructor=Ai,Ai.prototype.isShaderMaterial=!0,Ai.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.fragmentShader=a.fragmentShader,this.vertexShader=a.vertexShader,this.uniforms=ss(a.uniforms),this.defines=Object.assign({},a.defines),this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.lights=a.lights,this.clipping=a.clipping,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this.extensions=Object.assign({},a.extensions),this.glslVersion=a.glslVersion,this},Ai.prototype.toJSON=function(a){var t=hr.prototype.toJSON.call(this,a);t.glslVersion=this.glslVersion,t.uniforms={};for(var i in this.uniforms){var r=this.uniforms[i],n=r.value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(a).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var o={};for(var s in this.extensions)this.extensions[s]===!0&&(o[s]=!0);return Object.keys(o).length>0&&(t.extensions=o),t};function ya(){Qt.call(this),this.type="Camera",this.matrixWorldInverse=new kr,this.projectionMatrix=new kr,this.projectionMatrixInverse=new kr}ya.prototype=Object.assign(Object.create(Qt.prototype),{constructor:ya,isCamera:!0,copy:function(t,i){return Qt.prototype.copy.call(this,t,i),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new fe),this.updateWorldMatrix(!0,!1);var i=this.matrixWorld.elements;return t.set(-i[8],-i[9],-i[10]).normalize()},updateMatrixWorld:function(t){Qt.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(t,i){Qt.prototype.updateWorldMatrix.call(this,t,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return new this.constructor().copy(this)}});function Nn(a,t,i,r){a===void 0&&(a=50),t===void 0&&(t=1),i===void 0&&(i=.1),r===void 0&&(r=2e3),ya.call(this),this.type="PerspectiveCamera",this.fov=a,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Nn.prototype=Object.assign(Object.create(ya.prototype),{constructor:Nn,isPerspectiveCamera:!0,copy:function(t,i){return ya.prototype.copy.call(this,t,i),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var i=.5*this.getFilmHeight()/t;this.fov=gr.RAD2DEG*2*Math.atan(i),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(gr.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/t},getEffectiveFOV:function(){return gr.RAD2DEG*2*Math.atan(Math.tan(gr.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,i,r,n,o,s){this.aspect=t/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=r,this.view.offsetY=n,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,i=t*Math.tan(gr.DEG2RAD*.5*this.fov)/this.zoom,r=2*i,n=this.aspect*r,o=-.5*n,s=this.view;if(this.view!==null&&this.view.enabled){var c=s.fullWidth,h=s.fullHeight;o+=s.offsetX*n/c,i-=s.offsetY*r/h,n*=s.width/c,r*=s.height/h}var p=this.filmOffset;p!==0&&(o+=t*p/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+n,i,i-r,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){var i=Qt.prototype.toJSON.call(this,t);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}});var ls=90,cs=1;function Po(a,t,i){if(Qt.call(this),this.type="CubeCamera",i.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=i;var r=new Nn(ls,cs,a,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new fe(1,0,0)),this.add(r);var n=new Nn(ls,cs,a,t);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new fe(-1,0,0)),this.add(n);var o=new Nn(ls,cs,a,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new fe(0,1,0)),this.add(o);var s=new Nn(ls,cs,a,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(new fe(0,-1,0)),this.add(s);var c=new Nn(ls,cs,a,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new fe(0,0,1)),this.add(c);var h=new Nn(ls,cs,a,t);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new fe(0,0,-1)),this.add(h),this.update=function(p,C){this.parent===null&&this.updateMatrixWorld();var _=p.xr.enabled,S=p.getRenderTarget();p.xr.enabled=!1;var D=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,p.setRenderTarget(i,0),p.render(C,r),p.setRenderTarget(i,1),p.render(C,n),p.setRenderTarget(i,2),p.render(C,o),p.setRenderTarget(i,3),p.render(C,s),p.setRenderTarget(i,4),p.render(C,c),i.texture.generateMipmaps=D,p.setRenderTarget(i,5),p.render(C,h),p.setRenderTarget(S),p.xr.enabled=_}}Po.prototype=Object.create(Qt.prototype),Po.prototype.constructor=Po;function Aa(a,t,i,r,n,o,s,c,h,p){a=a!==void 0?a:[],t=t!==void 0?t:ue,s=s!==void 0?s:Hi,vn.call(this,a,t,i,r,n,o,s,c,h,p),this.flipY=!1,this._needsFlipEnvMap=!0}Aa.prototype=Object.create(vn.prototype),Aa.prototype.constructor=Aa,Aa.prototype.isCubeTexture=!0,Object.defineProperty(Aa.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var Pu=function(a){Or(t,a);function t(r,n,o){var s;return Number.isInteger(n)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),n=o),s=a.call(this,r,r,n)||this,Object.defineProperty(Ji(s),"isWebGLCubeRenderTarget",{value:!0}),n=n||{},s.texture=new Aa(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),s.texture._needsFlipEnvMap=!1,s}var i=t.prototype;return i.fromEquirectangularTexture=function(n,o){this.texture.type=o.type,this.texture.format=ti,this.texture.encoding=o.encoding,this.texture.generateMipmaps=o.generateMipmaps,this.texture.minFilter=o.minFilter,this.texture.magFilter=o.magFilter;var s={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},c=new Ro(5,5,5),h=new Ai({name:"CubemapFromEquirect",uniforms:ss(s.uniforms),vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,side:T,blending:z});h.uniforms.tEquirect.value=o;var p=new xn(c,h),C=o.minFilter;o.minFilter===or&&(o.minFilter=nt);var _=new Po(1,10,this);return _.update(n,p),o.minFilter=C,p.geometry.dispose(),p.material.dispose(),this},i.clear=function(n,o,s,c){for(var h=n.getRenderTarget(),p=0;p<6;p++)n.setRenderTarget(this,p),n.clear(o,s,c);n.setRenderTarget(h)},t}(qa);function Ba(a,t,i,r,n,o,s,c,h,p,C,_){vn.call(this,null,o,s,c,h,p,r,n,C,_),this.image={data:a||null,width:t||1,height:i||1},this.magFilter=h!==void 0?h:ar,this.minFilter=p!==void 0?p:ar,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Ba.prototype=Object.create(vn.prototype),Ba.prototype.constructor=Ba,Ba.prototype.isDataTexture=!0;var us=new Ka,Zl=new fe,qs=function(){function a(i,r,n,o,s,c){this.planes=[i!==void 0?i:new va,r!==void 0?r:new va,n!==void 0?n:new va,o!==void 0?o:new va,s!==void 0?s:new va,c!==void 0?c:new va]}var t=a.prototype;return t.set=function(r,n,o,s,c,h){var p=this.planes;return p[0].copy(r),p[1].copy(n),p[2].copy(o),p[3].copy(s),p[4].copy(c),p[5].copy(h),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){for(var n=this.planes,o=0;o<6;o++)n[o].copy(r.planes[o]);return this},t.setFromProjectionMatrix=function(r){var n=this.planes,o=r.elements,s=o[0],c=o[1],h=o[2],p=o[3],C=o[4],_=o[5],S=o[6],D=o[7],P=o[8],H=o[9],W=o[10],G=o[11],B=o[12],te=o[13],he=o[14],K=o[15];return n[0].setComponents(p-s,D-C,G-P,K-B).normalize(),n[1].setComponents(p+s,D+C,G+P,K+B).normalize(),n[2].setComponents(p+c,D+_,G+H,K+te).normalize(),n[3].setComponents(p-c,D-_,G-H,K-te).normalize(),n[4].setComponents(p-h,D-S,G-W,K-he).normalize(),n[5].setComponents(p+h,D+S,G+W,K+he).normalize(),this},t.intersectsObject=function(r){var n=r.geometry;return n.boundingSphere===null&&n.computeBoundingSphere(),us.copy(n.boundingSphere).applyMatrix4(r.matrixWorld),this.intersectsSphere(us)},t.intersectsSprite=function(r){return us.center.set(0,0,0),us.radius=.7071067811865476,us.applyMatrix4(r.matrixWorld),this.intersectsSphere(us)},t.intersectsSphere=function(r){for(var n=this.planes,o=r.center,s=-r.radius,c=0;c<6;c++){var h=n[c].distanceToPoint(o);if(h<s)return!1}return!0},t.intersectsBox=function(r){for(var n=this.planes,o=0;o<6;o++){var s=n[o];if(Zl.x=s.normal.x>0?r.max.x:r.min.x,Zl.y=s.normal.y>0?r.max.y:r.min.y,Zl.z=s.normal.z>0?r.max.z:r.min.z,s.distanceToPoint(Zl)<0)return!1}return!0},t.containsPoint=function(r){for(var n=this.planes,o=0;o<6;o++)if(n[o].distanceToPoint(r)<0)return!1;return!0},a}();function Du(){var a=null,t=!1,i=null,r=null;function n(o,s){i(o,s),r=a.requestAnimationFrame(n)}return{start:function(){t!==!0&&i!==null&&(r=a.requestAnimationFrame(n),t=!0)},stop:function(){a.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(s){i=s},setContext:function(s){a=s}}}function Zp(a,t){var i=t.isWebGL2,r=new WeakMap;function n(p,C){var _=p.array,S=p.usage,D=a.createBuffer();a.bindBuffer(C,D),a.bufferData(C,_,S),p.onUploadCallback();var P=5126;return _ instanceof Float32Array?P=5126:_ instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):_ instanceof Uint16Array?p.isFloat16BufferAttribute?i?P=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):P=5123:_ instanceof Int16Array?P=5122:_ instanceof Uint32Array?P=5125:_ instanceof Int32Array?P=5124:_ instanceof Int8Array?P=5120:_ instanceof Uint8Array&&(P=5121),{buffer:D,type:P,bytesPerElement:_.BYTES_PER_ELEMENT,version:p.version}}function o(p,C,_){var S=C.array,D=C.updateRange;a.bindBuffer(_,p),D.count===-1?a.bufferSubData(_,0,S):(i?a.bufferSubData(_,D.offset*S.BYTES_PER_ELEMENT,S,D.offset,D.count):a.bufferSubData(_,D.offset*S.BYTES_PER_ELEMENT,S.subarray(D.offset,D.offset+D.count)),D.count=-1)}function s(p){return p.isInterleavedBufferAttribute&&(p=p.data),r.get(p)}function c(p){p.isInterleavedBufferAttribute&&(p=p.data);var C=r.get(p);C&&(a.deleteBuffer(C.buffer),r.delete(p))}function h(p,C){if(p.isGLBufferAttribute){var _=r.get(p);(!_||_.version<p.version)&&r.set(p,{buffer:p.buffer,type:p.type,bytesPerElement:p.elementSize,version:p.version});return}p.isInterleavedBufferAttribute&&(p=p.data);var S=r.get(p);S===void 0?r.set(p,n(p,C)):S.version<p.version&&(o(S.buffer,p,C),S.version=p.version)}return{get:s,remove:c,update:h}}var Js=function(a){Or(t,a);function t(i,r,n,o){var s;i===void 0&&(i=1),r===void 0&&(r=1),n===void 0&&(n=1),o===void 0&&(o=1),s=a.call(this)||this,s.type="PlaneGeometry",s.parameters={width:i,height:r,widthSegments:n,heightSegments:o};for(var c=i/2,h=r/2,p=Math.floor(n),C=Math.floor(o),_=p+1,S=C+1,D=i/p,P=r/C,H=[],W=[],G=[],B=[],te=0;te<S;te++)for(var he=te*P-h,K=0;K<_;K++){var Q=K*D-c;W.push(Q,-he,0),G.push(0,0,1),B.push(K/p),B.push(1-te/C)}for(var le=0;le<C;le++)for(var Me=0;Me<p;Me++){var xe=Me+_*le,_e=Me+_*(le+1),Pe=Me+1+_*(le+1),Ce=Me+1+_*le;H.push(xe,_e,Ce),H.push(_e,Pe,Ce)}return s.setIndex(H),s.setAttribute("position",new Nt(W,3)),s.setAttribute("normal",new Nt(G,3)),s.setAttribute("uv",new Nt(B,2)),s}return t}(tr),Kp=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,$p=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,ev=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,tv=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,rv=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,nv="vec3 transformed = vec3( position );",iv=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,av=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,ov=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,sv=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,lv=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,cv=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,uv=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,hv=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,dv=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,fv=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,pv=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor.xyz *= color.xyz;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,vv=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,mv=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,gv=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,yv=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Av=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,bv=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Ev=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,wv="gl_FragColor = linearToOutputTexel( gl_FragColor );",xv=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,Mv=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Tv=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Sv=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,_v=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Cv=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Lv=`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,Rv=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,Pv=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Dv=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Ov=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,Iv=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,Bv=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Fv=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,Nv=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,kv=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,Uv=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Hv=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,Gv=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Vv=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,zv=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,Wv=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(		0, 1,		0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,jv=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Xv=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,Yv=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Qv=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,qv=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Jv=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Zv=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Kv=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,$v=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,em=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,tm=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,rm=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,nm=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,im=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,am=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,om=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,sm=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,lm=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,cm=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,um=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,hm=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,dm=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,fm=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,pm=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,vm=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,mm=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,gm=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,ym=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Am=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,bm=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
							f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
							f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Em=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,wm=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,xm=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Mm=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Tm=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,Sm=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,_m=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Cm=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Lm=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Rm=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Pm=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,	1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Dm=`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,Om=`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,Im=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,Bm=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,Fm=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,Nm=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,km=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,Um=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,Hm=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,Gm=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Vm=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,zm=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Wm=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,jm=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Xm=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Ym=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Qm=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,qm=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Jm=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Zm=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Km=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,$m=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,eg=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,tg=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rg=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ng=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ig=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,ag=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,og=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sg=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lg=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cg=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ug=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,hg=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,dg=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fg=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,pg=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,vg=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,mg=`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,gg=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,yg=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Wr={alphamap_fragment:Kp,alphamap_pars_fragment:$p,alphatest_fragment:ev,aomap_fragment:tv,aomap_pars_fragment:rv,begin_vertex:nv,beginnormal_vertex:iv,bsdfs:av,bumpmap_pars_fragment:ov,clipping_planes_fragment:sv,clipping_planes_pars_fragment:lv,clipping_planes_pars_vertex:cv,clipping_planes_vertex:uv,color_fragment:hv,color_pars_fragment:dv,color_pars_vertex:fv,color_vertex:pv,common:vv,cube_uv_reflection_fragment:mv,defaultnormal_vertex:gv,displacementmap_pars_vertex:yv,displacementmap_vertex:Av,emissivemap_fragment:bv,emissivemap_pars_fragment:Ev,encodings_fragment:wv,encodings_pars_fragment:xv,envmap_fragment:Mv,envmap_common_pars_fragment:Tv,envmap_pars_fragment:Sv,envmap_pars_vertex:_v,envmap_physical_pars_fragment:kv,envmap_vertex:Cv,fog_vertex:Lv,fog_pars_vertex:Rv,fog_fragment:Pv,fog_pars_fragment:Dv,gradientmap_pars_fragment:Ov,lightmap_fragment:Iv,lightmap_pars_fragment:Bv,lights_lambert_vertex:Fv,lights_pars_begin:Nv,lights_toon_fragment:Uv,lights_toon_pars_fragment:Hv,lights_phong_fragment:Gv,lights_phong_pars_fragment:Vv,lights_physical_fragment:zv,lights_physical_pars_fragment:Wv,lights_fragment_begin:jv,lights_fragment_maps:Xv,lights_fragment_end:Yv,logdepthbuf_fragment:Qv,logdepthbuf_pars_fragment:qv,logdepthbuf_pars_vertex:Jv,logdepthbuf_vertex:Zv,map_fragment:Kv,map_pars_fragment:$v,map_particle_fragment:em,map_particle_pars_fragment:tm,metalnessmap_fragment:rm,metalnessmap_pars_fragment:nm,morphnormal_vertex:im,morphtarget_pars_vertex:am,morphtarget_vertex:om,normal_fragment_begin:sm,normal_fragment_maps:lm,normalmap_pars_fragment:cm,clearcoat_normal_fragment_begin:um,clearcoat_normal_fragment_maps:hm,clearcoat_pars_fragment:dm,packing:fm,premultiplied_alpha_fragment:pm,project_vertex:vm,dithering_fragment:mm,dithering_pars_fragment:gm,roughnessmap_fragment:ym,roughnessmap_pars_fragment:Am,shadowmap_pars_fragment:bm,shadowmap_pars_vertex:Em,shadowmap_vertex:wm,shadowmask_pars_fragment:xm,skinbase_vertex:Mm,skinning_pars_vertex:Tm,skinning_vertex:Sm,skinnormal_vertex:_m,specularmap_fragment:Cm,specularmap_pars_fragment:Lm,tonemapping_fragment:Rm,tonemapping_pars_fragment:Pm,transmissionmap_fragment:Dm,transmissionmap_pars_fragment:Om,uv_pars_fragment:Im,uv_pars_vertex:Bm,uv_vertex:Fm,uv2_pars_fragment:Nm,uv2_pars_vertex:km,uv2_vertex:Um,worldpos_vertex:Hm,background_frag:Gm,background_vert:Vm,cube_frag:zm,cube_vert:Wm,depth_frag:jm,depth_vert:Xm,distanceRGBA_frag:Ym,distanceRGBA_vert:Qm,equirect_frag:qm,equirect_vert:Jm,linedashed_frag:Zm,linedashed_vert:Km,meshbasic_frag:$m,meshbasic_vert:eg,meshlambert_frag:tg,meshlambert_vert:rg,meshmatcap_frag:ng,meshmatcap_vert:ig,meshtoon_frag:ag,meshtoon_vert:og,meshphong_frag:sg,meshphong_vert:lg,meshphysical_frag:cg,meshphysical_vert:ug,normal_frag:hg,normal_vert:dg,points_frag:fg,points_vert:pg,shadow_frag:vg,shadow_vert:mg,sprite_frag:gg,sprite_vert:yg},Pt={common:{diffuse:{value:new It(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new _i},uv2Transform:{value:new _i},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new bt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new It(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new It(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new _i}},sprite:{diffuse:{value:new It(15658734)},opacity:{value:1},center:{value:new bt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new _i}}},ea={basic:{uniforms:ui([Pt.common,Pt.specularmap,Pt.envmap,Pt.aomap,Pt.lightmap,Pt.fog]),vertexShader:Wr.meshbasic_vert,fragmentShader:Wr.meshbasic_frag},lambert:{uniforms:ui([Pt.common,Pt.specularmap,Pt.envmap,Pt.aomap,Pt.lightmap,Pt.emissivemap,Pt.fog,Pt.lights,{emissive:{value:new It(0)}}]),vertexShader:Wr.meshlambert_vert,fragmentShader:Wr.meshlambert_frag},phong:{uniforms:ui([Pt.common,Pt.specularmap,Pt.envmap,Pt.aomap,Pt.lightmap,Pt.emissivemap,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,Pt.fog,Pt.lights,{emissive:{value:new It(0)},specular:{value:new It(1118481)},shininess:{value:30}}]),vertexShader:Wr.meshphong_vert,fragmentShader:Wr.meshphong_frag},standard:{uniforms:ui([Pt.common,Pt.envmap,Pt.aomap,Pt.lightmap,Pt.emissivemap,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,Pt.roughnessmap,Pt.metalnessmap,Pt.fog,Pt.lights,{emissive:{value:new It(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Wr.meshphysical_vert,fragmentShader:Wr.meshphysical_frag},toon:{uniforms:ui([Pt.common,Pt.aomap,Pt.lightmap,Pt.emissivemap,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,Pt.gradientmap,Pt.fog,Pt.lights,{emissive:{value:new It(0)}}]),vertexShader:Wr.meshtoon_vert,fragmentShader:Wr.meshtoon_frag},matcap:{uniforms:ui([Pt.common,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,Pt.fog,{matcap:{value:null}}]),vertexShader:Wr.meshmatcap_vert,fragmentShader:Wr.meshmatcap_frag},points:{uniforms:ui([Pt.points,Pt.fog]),vertexShader:Wr.points_vert,fragmentShader:Wr.points_frag},dashed:{uniforms:ui([Pt.common,Pt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Wr.linedashed_vert,fragmentShader:Wr.linedashed_frag},depth:{uniforms:ui([Pt.common,Pt.displacementmap]),vertexShader:Wr.depth_vert,fragmentShader:Wr.depth_frag},normal:{uniforms:ui([Pt.common,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,{opacity:{value:1}}]),vertexShader:Wr.normal_vert,fragmentShader:Wr.normal_frag},sprite:{uniforms:ui([Pt.sprite,Pt.fog]),vertexShader:Wr.sprite_vert,fragmentShader:Wr.sprite_frag},background:{uniforms:{uvTransform:{value:new _i},t2D:{value:null}},vertexShader:Wr.background_vert,fragmentShader:Wr.background_frag},cube:{uniforms:ui([Pt.envmap,{opacity:{value:1}}]),vertexShader:Wr.cube_vert,fragmentShader:Wr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Wr.equirect_vert,fragmentShader:Wr.equirect_frag},distanceRGBA:{uniforms:ui([Pt.common,Pt.displacementmap,{referencePosition:{value:new fe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Wr.distanceRGBA_vert,fragmentShader:Wr.distanceRGBA_frag},shadow:{uniforms:ui([Pt.lights,Pt.fog,{color:{value:new It(0)},opacity:{value:1}}]),vertexShader:Wr.shadow_vert,fragmentShader:Wr.shadow_frag}};ea.physical={uniforms:ui([ea.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new bt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new It(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Wr.meshphysical_vert,fragmentShader:Wr.meshphysical_frag};function Ag(a,t,i,r,n){var o=new It(0),s=0,c,h,p=null,C=0,_=null;function S(P,H,W,G){var B=H.isScene===!0?H.background:null;B&&B.isTexture&&(B=t.get(B));var te=a.xr,he=te.getSession&&te.getSession();he&&he.environmentBlendMode==="additive"&&(B=null),B===null?D(o,s):B&&B.isColor&&(D(B,1),G=!0),(a.autoClear||G)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),B&&(B.isCubeTexture||B.isWebGLCubeRenderTarget||B.mapping===jt)?(h===void 0&&(h=new xn(new Ro(1,1,1),new Ai({name:"BackgroundCubeMaterial",uniforms:ss(ea.cube.uniforms),vertexShader:ea.cube.vertexShader,fragmentShader:ea.cube.fragmentShader,side:T,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(K,Q,le){this.matrixWorld.copyPosition(le.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),B.isWebGLCubeRenderTarget&&(B=B.texture),h.material.uniforms.envMap.value=B,h.material.uniforms.flipEnvMap.value=B.isCubeTexture&&B._needsFlipEnvMap?-1:1,(p!==B||C!==B.version||_!==a.toneMapping)&&(h.material.needsUpdate=!0,p=B,C=B.version,_=a.toneMapping),P.unshift(h,h.geometry,h.material,0,0,null)):B&&B.isTexture&&(c===void 0&&(c=new xn(new Js(2,2),new Ai({name:"BackgroundMaterial",uniforms:ss(ea.background.uniforms),vertexShader:ea.background.vertexShader,fragmentShader:ea.background.fragmentShader,side:L,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=B,B.matrixAutoUpdate===!0&&B.updateMatrix(),c.material.uniforms.uvTransform.value.copy(B.matrix),(p!==B||C!==B.version||_!==a.toneMapping)&&(c.material.needsUpdate=!0,p=B,C=B.version,_=a.toneMapping),P.unshift(c,c.geometry,c.material,0,0,null))}function D(P,H){i.buffers.color.setClear(P.r,P.g,P.b,H,n)}return{getClearColor:function(){return o},setClearColor:function(H,W){W===void 0&&(W=1),o.set(H),s=W,D(o,s)},getClearAlpha:function(){return s},setClearAlpha:function(H){s=H,D(o,s)},render:S}}function bg(a,t,i,r){var n=a.getParameter(34921),o=r.isWebGL2?null:t.get("OES_vertex_array_object"),s=r.isWebGL2||o!==null,c={},h=H(null),p=h;function C(Ae,Be,Se,Te,me){var Ue=!1;if(s){var He=P(Te,Se,Be);p!==He&&(p=He,S(p.object)),Ue=W(Te,me),Ue&&G(Te,me)}else{var Qe=Be.wireframe===!0;(p.geometry!==Te.id||p.program!==Se.id||p.wireframe!==Qe)&&(p.geometry=Te.id,p.program=Se.id,p.wireframe=Qe,Ue=!0)}Ae.isInstancedMesh===!0&&(Ue=!0),me!==null&&i.update(me,34963),Ue&&(le(Ae,Be,Se,Te),me!==null&&a.bindBuffer(34963,i.get(me).buffer))}function _(){return r.isWebGL2?a.createVertexArray():o.createVertexArrayOES()}function S(Ae){return r.isWebGL2?a.bindVertexArray(Ae):o.bindVertexArrayOES(Ae)}function D(Ae){return r.isWebGL2?a.deleteVertexArray(Ae):o.deleteVertexArrayOES(Ae)}function P(Ae,Be,Se){var Te=Se.wireframe===!0,me=c[Ae.id];me===void 0&&(me={},c[Ae.id]=me);var Ue=me[Be.id];Ue===void 0&&(Ue={},me[Be.id]=Ue);var He=Ue[Te];return He===void 0&&(He=H(_()),Ue[Te]=He),He}function H(Ae){for(var Be=[],Se=[],Te=[],me=0;me<n;me++)Be[me]=0,Se[me]=0,Te[me]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Be,enabledAttributes:Se,attributeDivisors:Te,object:Ae,attributes:{},index:null}}function W(Ae,Be){var Se=p.attributes,Te=Ae.attributes,me=0;for(var Ue in Te){var He=Se[Ue],Qe=Te[Ue];if(He===void 0||He.attribute!==Qe||He.data!==Qe.data)return!0;me++}return p.attributesNum!==me||p.index!==Be}function G(Ae,Be){var Se={},Te=Ae.attributes,me=0;for(var Ue in Te){var He=Te[Ue],Qe={};Qe.attribute=He,He.data&&(Qe.data=He.data),Se[Ue]=Qe,me++}p.attributes=Se,p.attributesNum=me,p.index=Be}function B(){for(var Ae=p.newAttributes,Be=0,Se=Ae.length;Be<Se;Be++)Ae[Be]=0}function te(Ae){he(Ae,0)}function he(Ae,Be){var Se=p.newAttributes,Te=p.enabledAttributes,me=p.attributeDivisors;if(Se[Ae]=1,Te[Ae]===0&&(a.enableVertexAttribArray(Ae),Te[Ae]=1),me[Ae]!==Be){var Ue=r.isWebGL2?a:t.get("ANGLE_instanced_arrays");Ue[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ae,Be),me[Ae]=Be}}function K(){for(var Ae=p.newAttributes,Be=p.enabledAttributes,Se=0,Te=Be.length;Se<Te;Se++)Be[Se]!==Ae[Se]&&(a.disableVertexAttribArray(Se),Be[Se]=0)}function Q(Ae,Be,Se,Te,me,Ue){r.isWebGL2===!0&&(Se===5124||Se===5125)?a.vertexAttribIPointer(Ae,Be,Se,me,Ue):a.vertexAttribPointer(Ae,Be,Se,Te,me,Ue)}function le(Ae,Be,Se,Te){if(!(r.isWebGL2===!1&&(Ae.isInstancedMesh||Te.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)){B();var me=Te.attributes,Ue=Se.getAttributes(),He=Be.defaultAttributeValues;for(var Qe in Ue){var qe=Ue[Qe];if(qe>=0){var gt=me[Qe];if(gt!==void 0){var St=gt.normalized,Vt=gt.itemSize,Ke=i.get(gt);if(Ke===void 0)continue;var rr=Ke.buffer,Bt=Ke.type,sr=Ke.bytesPerElement;if(gt.isInterleavedBufferAttribute){var xr=gt.data,Fr=xr.stride,Sr=gt.offset;xr&&xr.isInstancedInterleavedBuffer?(he(qe,xr.meshPerAttribute),Te._maxInstanceCount===void 0&&(Te._maxInstanceCount=xr.meshPerAttribute*xr.count)):te(qe),a.bindBuffer(34962,rr),Q(qe,Vt,Bt,St,Fr*sr,Sr*sr)}else gt.isInstancedBufferAttribute?(he(qe,gt.meshPerAttribute),Te._maxInstanceCount===void 0&&(Te._maxInstanceCount=gt.meshPerAttribute*gt.count)):te(qe),a.bindBuffer(34962,rr),Q(qe,Vt,Bt,St,0,0)}else if(Qe==="instanceMatrix"){var mn=i.get(Ae.instanceMatrix);if(mn===void 0)continue;var Qr=mn.buffer,hn=mn.type;he(qe+0,1),he(qe+1,1),he(qe+2,1),he(qe+3,1),a.bindBuffer(34962,Qr),a.vertexAttribPointer(qe+0,4,hn,!1,64,0),a.vertexAttribPointer(qe+1,4,hn,!1,64,16),a.vertexAttribPointer(qe+2,4,hn,!1,64,32),a.vertexAttribPointer(qe+3,4,hn,!1,64,48)}else if(Qe==="instanceColor"){var zn=i.get(Ae.instanceColor);if(zn===void 0)continue;var fi=zn.buffer,Kn=zn.type;he(qe,1),a.bindBuffer(34962,fi),a.vertexAttribPointer(qe,3,Kn,!1,12,0)}else if(He!==void 0){var Un=He[Qe];if(Un!==void 0)switch(Un.length){case 2:a.vertexAttrib2fv(qe,Un);break;case 3:a.vertexAttrib3fv(qe,Un);break;case 4:a.vertexAttrib4fv(qe,Un);break;default:a.vertexAttrib1fv(qe,Un)}}}}K()}}function Me(){Pe();for(var Ae in c){var Be=c[Ae];for(var Se in Be){var Te=Be[Se];for(var me in Te)D(Te[me].object),delete Te[me];delete Be[Se]}delete c[Ae]}}function xe(Ae){if(c[Ae.id]!==void 0){var Be=c[Ae.id];for(var Se in Be){var Te=Be[Se];for(var me in Te)D(Te[me].object),delete Te[me];delete Be[Se]}delete c[Ae.id]}}function _e(Ae){for(var Be in c){var Se=c[Be];if(Se[Ae.id]!==void 0){var Te=Se[Ae.id];for(var me in Te)D(Te[me].object),delete Te[me];delete Se[Ae.id]}}}function Pe(){Ce(),p!==h&&(p=h,S(p.object))}function Ce(){h.geometry=null,h.program=null,h.wireframe=!1}return{setup:C,reset:Pe,resetDefaultState:Ce,dispose:Me,releaseStatesOfGeometry:xe,releaseStatesOfProgram:_e,initAttributes:B,enableAttribute:te,disableUnusedAttributes:K}}function Eg(a,t,i,r){var n=r.isWebGL2,o;function s(p){o=p}function c(p,C){a.drawArrays(o,p,C),i.update(C,o,1)}function h(p,C,_){if(_!==0){var S,D;if(n)S=a,D="drawArraysInstanced";else if(S=t.get("ANGLE_instanced_arrays"),D="drawArraysInstancedANGLE",S===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}S[D](o,p,C,_),i.update(C,o,_)}}this.setMode=s,this.render=c,this.renderInstances=h}function wg(a,t,i){var r;function n(){if(r!==void 0)return r;var Q=t.get("EXT_texture_filter_anisotropic");return Q!==null?r=a.getParameter(Q.MAX_TEXTURE_MAX_ANISOTROPY_EXT):r=0,r}function o(Q){if(Q==="highp"){if(a.getShaderPrecisionFormat(35633,36338).precision>0&&a.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";Q="mediump"}return Q==="mediump"&&a.getShaderPrecisionFormat(35633,36337).precision>0&&a.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var s=typeof WebGL2RenderingContext<"u"&&a instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&a instanceof WebGL2ComputeRenderingContext,c=i.precision!==void 0?i.precision:"highp",h=o(c);h!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",h,"instead."),c=h);var p=i.logarithmicDepthBuffer===!0,C=a.getParameter(34930),_=a.getParameter(35660),S=a.getParameter(3379),D=a.getParameter(34076),P=a.getParameter(34921),H=a.getParameter(36347),W=a.getParameter(36348),G=a.getParameter(36349),B=_>0,te=s||!!t.get("OES_texture_float"),he=B&&te,K=s?a.getParameter(36183):0;return{isWebGL2:s,getMaxAnisotropy:n,getMaxPrecision:o,precision:c,logarithmicDepthBuffer:p,maxTextures:C,maxVertexTextures:_,maxTextureSize:S,maxCubemapSize:D,maxAttributes:P,maxVertexUniforms:H,maxVaryings:W,maxFragmentUniforms:G,vertexTextures:B,floatFragmentTextures:te,floatVertexTextures:he,maxSamples:K}}function xg(a){var t=this,i=null,r=0,n=!1,o=!1,s=new va,c=new _i,h={value:null,needsUpdate:!1};this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(_,S,D){var P=_.length!==0||S||r!==0||n;return n=S,i=C(_,D,0),r=_.length,P},this.beginShadows=function(){o=!0,C(null)},this.endShadows=function(){o=!1,p()},this.setState=function(_,S,D){var P=_.clippingPlanes,H=_.clipIntersection,W=_.clipShadows,G=a.get(_);if(!n||P===null||P.length===0||o&&!W)o?C(null):p();else{var B=o?0:r,te=B*4,he=G.clippingState||null;h.value=he,he=C(P,S,te,D);for(var K=0;K!==te;++K)he[K]=i[K];G.clippingState=he,this.numIntersection=H?this.numPlanes:0,this.numPlanes+=B}};function p(){h.value!==i&&(h.value=i,h.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function C(_,S,D,P){var H=_!==null?_.length:0,W=null;if(H!==0){if(W=h.value,P!==!0||W===null){var G=D+H*4,B=S.matrixWorldInverse;c.getNormalMatrix(B),(W===null||W.length<G)&&(W=new Float32Array(G));for(var te=0,he=D;te!==H;++te,he+=4)s.copy(_[te]).applyMatrix4(B,c),s.normal.toArray(W,he),W[he+3]=s.constant}h.value=W,h.needsUpdate=!0}return t.numPlanes=H,t.numIntersection=0,W}}function Mg(a){var t=new WeakMap;function i(s,c){return c===Je?s.mapping=ue:c===tt&&(s.mapping=De),s}function r(s){if(s&&s.isTexture){var c=s.mapping;if(c===Je||c===tt)if(t.has(s)){var h=t.get(s).texture;return i(h,s.mapping)}else{var p=s.image;if(p&&p.height>0){var C=a.getRenderList(),_=a.getRenderTarget(),S=new Pu(p.height/2);return S.fromEquirectangularTexture(a,s),t.set(s,S),a.setRenderTarget(_),a.setRenderList(C),s.addEventListener("dispose",n),i(S.texture,s.mapping)}else return null}}return s}function n(s){var c=s.target;c.removeEventListener("dispose",n);var h=t.get(c);h!==void 0&&(t.delete(c),h.dispose())}function o(){t=new WeakMap}return{get:r,dispose:o}}function Tg(a){var t={};function i(r){if(t[r]!==void 0)return t[r];var n;switch(r){case"WEBGL_depth_texture":n=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=a.getExtension(r)}return t[r]=n,n}return{has:function(n){return i(n)!==null},init:function(n){n.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float")},get:function(n){var o=i(n);return o===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),o}}}function Sg(a,t,i,r){var n={},o=new WeakMap;function s(_){var S=_.target;S.index!==null&&t.remove(S.index);for(var D in S.attributes)t.remove(S.attributes[D]);S.removeEventListener("dispose",s),delete n[S.id];var P=o.get(S);P&&(t.remove(P),o.delete(S)),r.releaseStatesOfGeometry(S),S.isInstancedBufferGeometry===!0&&delete S._maxInstanceCount,i.memory.geometries--}function c(_,S){return n[S.id]===!0||(S.addEventListener("dispose",s),n[S.id]=!0,i.memory.geometries++),S}function h(_){var S=_.attributes;for(var D in S)t.update(S[D],34962);var P=_.morphAttributes;for(var H in P)for(var W=P[H],G=0,B=W.length;G<B;G++)t.update(W[G],34962)}function p(_){var S=[],D=_.index,P=_.attributes.position,H=0;if(D!==null){var W=D.array;H=D.version;for(var G=0,B=W.length;G<B;G+=3){var te=W[G+0],he=W[G+1],K=W[G+2];S.push(te,he,he,K,K,te)}}else{var Q=P.array;H=P.version;for(var le=0,Me=Q.length/3-1;le<Me;le+=3){var xe=le+0,_e=le+1,Pe=le+2;S.push(xe,_e,_e,Pe,Pe,xe)}}var Ce=new(Kh(S)>65535?Lo:Co)(S,1);Ce.version=H;var Ae=o.get(_);Ae&&t.remove(Ae),o.set(_,Ce)}function C(_){var S=o.get(_);if(S){var D=_.index;D!==null&&S.version<D.version&&p(_)}else p(_);return o.get(_)}return{get:c,update:h,getWireframeAttribute:C}}function _g(a,t,i,r){var n=r.isWebGL2,o;function s(S){o=S}var c,h;function p(S){c=S.type,h=S.bytesPerElement}function C(S,D){a.drawElements(o,D,c,S*h),i.update(D,o,1)}function _(S,D,P){if(P!==0){var H,W;if(n)H=a,W="drawElementsInstanced";else if(H=t.get("ANGLE_instanced_arrays"),W="drawElementsInstancedANGLE",H===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}H[W](o,D,c,S*h,P),i.update(D,o,P)}}this.setMode=s,this.setIndex=p,this.render=C,this.renderInstances=_}function Cg(a){var t={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function r(o,s,c){switch(i.calls++,s){case 4:i.triangles+=c*(o/3);break;case 1:i.lines+=c*(o/2);break;case 3:i.lines+=c*(o-1);break;case 2:i.lines+=c*o;break;case 0:i.points+=c*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s);break}}function n(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:t,render:i,programs:null,autoReset:!0,reset:n,update:r}}function Lg(a,t){return a[0]-t[0]}function Rg(a,t){return Math.abs(t[1])-Math.abs(a[1])}function Pg(a){for(var t={},i=new Float32Array(8),r=[],n=0;n<8;n++)r[n]=[n,0];function o(s,c,h,p){var C=s.morphTargetInfluences,_=C===void 0?0:C.length,S=t[c.id];if(S===void 0){S=[];for(var D=0;D<_;D++)S[D]=[D,0];t[c.id]=S}for(var P=0;P<_;P++){var H=S[P];H[0]=P,H[1]=C[P]}S.sort(Rg);for(var W=0;W<8;W++)W<_&&S[W][1]?(r[W][0]=S[W][0],r[W][1]=S[W][1]):(r[W][0]=Number.MAX_SAFE_INTEGER,r[W][1]=0);r.sort(Lg);for(var G=h.morphTargets&&c.morphAttributes.position,B=h.morphNormals&&c.morphAttributes.normal,te=0,he=0;he<8;he++){var K=r[he],Q=K[0],le=K[1];Q!==Number.MAX_SAFE_INTEGER&&le?(G&&c.getAttribute("morphTarget"+he)!==G[Q]&&c.setAttribute("morphTarget"+he,G[Q]),B&&c.getAttribute("morphNormal"+he)!==B[Q]&&c.setAttribute("morphNormal"+he,B[Q]),i[he]=le,te+=le):(G&&c.hasAttribute("morphTarget"+he)===!0&&c.deleteAttribute("morphTarget"+he),B&&c.hasAttribute("morphNormal"+he)===!0&&c.deleteAttribute("morphNormal"+he),i[he]=0)}var Me=c.morphTargetsRelative?1:1-te;p.getUniforms().setValue(a,"morphTargetBaseInfluence",Me),p.getUniforms().setValue(a,"morphTargetInfluences",i)}return{update:o}}function Dg(a,t,i,r){var n=new WeakMap;function o(h){var p=r.render.frame,C=h.geometry,_=t.get(h,C);return n.get(_)!==p&&(t.update(_),n.set(_,p)),h.isInstancedMesh&&(h.hasEventListener("dispose",c)===!1&&h.addEventListener("dispose",c),i.update(h.instanceMatrix,34962),h.instanceColor!==null&&i.update(h.instanceColor,34962)),_}function s(){n=new WeakMap}function c(h){var p=h.target;p.removeEventListener("dispose",c),i.remove(p.instanceMatrix),p.instanceColor!==null&&i.remove(p.instanceColor)}return{update:o,dispose:s}}function hs(a,t,i,r){a===void 0&&(a=null),t===void 0&&(t=1),i===void 0&&(i=1),r===void 0&&(r=1),vn.call(this,null),this.image={data:a,width:t,height:i,depth:r},this.magFilter=ar,this.minFilter=ar,this.wrapR=Jt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}hs.prototype=Object.create(vn.prototype),hs.prototype.constructor=hs,hs.prototype.isDataTexture2DArray=!0;function ds(a,t,i,r){a===void 0&&(a=null),t===void 0&&(t=1),i===void 0&&(i=1),r===void 0&&(r=1),vn.call(this,null),this.image={data:a,width:t,height:i,depth:r},this.magFilter=ar,this.minFilter=ar,this.wrapR=Jt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}ds.prototype=Object.create(vn.prototype),ds.prototype.constructor=ds,ds.prototype.isDataTexture3D=!0;var td=new vn,Og=new hs,Ig=new ds,rd=new Aa,nd=[],id=[],ad=new Float32Array(16),od=new Float32Array(9),sd=new Float32Array(4);function fs(a,t,i){var r=a[0];if(r<=0||r>0)return a;var n=t*i,o=nd[n];if(o===void 0&&(o=new Float32Array(n),nd[n]=o),t!==0){r.toArray(o,0);for(var s=1,c=0;s!==t;++s)c+=i,a[s].toArray(o,c)}return o}function Gi(a,t){if(a.length!==t.length)return!1;for(var i=0,r=a.length;i<r;i++)if(a[i]!==t[i])return!1;return!0}function Pi(a,t){for(var i=0,r=t.length;i<r;i++)a[i]=t[i]}function ld(a,t){var i=id[t];i===void 0&&(i=new Int32Array(t),id[t]=i);for(var r=0;r!==t;++r)i[r]=a.allocateTextureUnit();return i}function Bg(a,t){var i=this.cache;i[0]!==t&&(a.uniform1f(this.addr,t),i[0]=t)}function Fg(a,t){var i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(a.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Gi(i,t))return;a.uniform2fv(this.addr,t),Pi(i,t)}}function Ng(a,t){var i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(a.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(t.r!==void 0)(i[0]!==t.r||i[1]!==t.g||i[2]!==t.b)&&(a.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(Gi(i,t))return;a.uniform3fv(this.addr,t),Pi(i,t)}}function kg(a,t){var i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(a.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Gi(i,t))return;a.uniform4fv(this.addr,t),Pi(i,t)}}function Ug(a,t){var i=this.cache,r=t.elements;if(r===void 0){if(Gi(i,t))return;a.uniformMatrix2fv(this.addr,!1,t),Pi(i,t)}else{if(Gi(i,r))return;sd.set(r),a.uniformMatrix2fv(this.addr,!1,sd),Pi(i,r)}}function Hg(a,t){var i=this.cache,r=t.elements;if(r===void 0){if(Gi(i,t))return;a.uniformMatrix3fv(this.addr,!1,t),Pi(i,t)}else{if(Gi(i,r))return;od.set(r),a.uniformMatrix3fv(this.addr,!1,od),Pi(i,r)}}function Gg(a,t){var i=this.cache,r=t.elements;if(r===void 0){if(Gi(i,t))return;a.uniformMatrix4fv(this.addr,!1,t),Pi(i,t)}else{if(Gi(i,r))return;ad.set(r),a.uniformMatrix4fv(this.addr,!1,ad),Pi(i,r)}}function Vg(a,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(a.uniform1i(this.addr,n),r[0]=n),i.safeSetTexture2D(t||td,n)}function zg(a,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(a.uniform1i(this.addr,n),r[0]=n),i.setTexture2DArray(t||Og,n)}function Wg(a,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(a.uniform1i(this.addr,n),r[0]=n),i.setTexture3D(t||Ig,n)}function jg(a,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(a.uniform1i(this.addr,n),r[0]=n),i.safeSetTextureCube(t||rd,n)}function Xg(a,t){var i=this.cache;i[0]!==t&&(a.uniform1i(this.addr,t),i[0]=t)}function Yg(a,t){var i=this.cache;Gi(i,t)||(a.uniform2iv(this.addr,t),Pi(i,t))}function Qg(a,t){var i=this.cache;Gi(i,t)||(a.uniform3iv(this.addr,t),Pi(i,t))}function qg(a,t){var i=this.cache;Gi(i,t)||(a.uniform4iv(this.addr,t),Pi(i,t))}function Jg(a,t){var i=this.cache;i[0]!==t&&(a.uniform1ui(this.addr,t),i[0]=t)}function Zg(a){switch(a){case 5126:return Bg;case 35664:return Fg;case 35665:return Ng;case 35666:return kg;case 35674:return Ug;case 35675:return Hg;case 35676:return Gg;case 5124:case 35670:return Xg;case 35667:case 35671:return Yg;case 35668:case 35672:return Qg;case 35669:case 35673:return qg;case 5125:return Jg;case 35678:case 36198:case 36298:case 36306:case 35682:return Vg;case 35679:case 36299:case 36307:return Wg;case 35680:case 36300:case 36308:case 36293:return jg;case 36289:case 36303:case 36311:case 36292:return zg}}function Kg(a,t){a.uniform1fv(this.addr,t)}function $g(a,t){a.uniform1iv(this.addr,t)}function e0(a,t){a.uniform2iv(this.addr,t)}function t0(a,t){a.uniform3iv(this.addr,t)}function r0(a,t){a.uniform4iv(this.addr,t)}function n0(a,t){var i=fs(t,this.size,2);a.uniform2fv(this.addr,i)}function i0(a,t){var i=fs(t,this.size,3);a.uniform3fv(this.addr,i)}function a0(a,t){var i=fs(t,this.size,4);a.uniform4fv(this.addr,i)}function o0(a,t){var i=fs(t,this.size,4);a.uniformMatrix2fv(this.addr,!1,i)}function s0(a,t){var i=fs(t,this.size,9);a.uniformMatrix3fv(this.addr,!1,i)}function l0(a,t){var i=fs(t,this.size,16);a.uniformMatrix4fv(this.addr,!1,i)}function c0(a,t,i){var r=t.length,n=ld(i,r);a.uniform1iv(this.addr,n);for(var o=0;o!==r;++o)i.safeSetTexture2D(t[o]||td,n[o])}function u0(a,t,i){var r=t.length,n=ld(i,r);a.uniform1iv(this.addr,n);for(var o=0;o!==r;++o)i.safeSetTextureCube(t[o]||rd,n[o])}function h0(a){switch(a){case 5126:return Kg;case 35664:return n0;case 35665:return i0;case 35666:return a0;case 35674:return o0;case 35675:return s0;case 35676:return l0;case 5124:case 35670:return $g;case 35667:case 35671:return e0;case 35668:case 35672:return t0;case 35669:case 35673:return r0;case 35678:case 36198:case 36298:case 36306:case 35682:return c0;case 35680:case 36300:case 36308:case 36293:return u0}}function d0(a,t,i){this.id=a,this.addr=i,this.cache=[],this.setValue=Zg(t.type)}function cd(a,t,i){this.id=a,this.addr=i,this.cache=[],this.size=t.size,this.setValue=h0(t.type)}cd.prototype.updateCache=function(a){var t=this.cache;a instanceof Float32Array&&t.length!==a.length&&(this.cache=new Float32Array(a.length)),Pi(t,a)};function ud(a){this.id=a,this.seq=[],this.map={}}ud.prototype.setValue=function(a,t,i){for(var r=this.seq,n=0,o=r.length;n!==o;++n){var s=r[n];s.setValue(a,t[s.id],i)}};var Ou=/(\w+)(\])?(\[|\.)?/g;function hd(a,t){a.seq.push(t),a.map[t.id]=t}function f0(a,t,i){var r=a.name,n=r.length;for(Ou.lastIndex=0;;){var o=Ou.exec(r),s=Ou.lastIndex,c=o[1],h=o[2]==="]",p=o[3];if(h&&(c=c|0),p===void 0||p==="["&&s+2===n){hd(i,p===void 0?new d0(c,a,t):new cd(c,a,t));break}else{var C=i.map,_=C[c];_===void 0&&(_=new ud(c),hd(i,_)),i=_}}}function io(a,t){this.seq=[],this.map={};for(var i=a.getProgramParameter(t,35718),r=0;r<i;++r){var n=a.getActiveUniform(t,r),o=a.getUniformLocation(t,n.name);f0(n,o,this)}}io.prototype.setValue=function(a,t,i,r){var n=this.map[t];n!==void 0&&n.setValue(a,i,r)},io.prototype.setOptional=function(a,t,i){var r=t[i];r!==void 0&&this.setValue(a,i,r)},io.upload=function(a,t,i,r){for(var n=0,o=t.length;n!==o;++n){var s=t[n],c=i[s.id];c.needsUpdate!==!1&&s.setValue(a,c.value,r)}},io.seqWithValue=function(a,t){for(var i=[],r=0,n=a.length;r!==n;++r){var o=a[r];o.id in t&&i.push(o)}return i};function dd(a,t,i){var r=a.createShader(t);return a.shaderSource(r,i),a.compileShader(r),r}var p0=0;function v0(a){for(var t=a.split(`
`),i=0;i<t.length;i++)t[i]=i+1+": "+t[i];return t.join(`
`)}function fd(a){switch(a){case yi:return["Linear","( value )"];case Is:return["sRGB","( value )"];case Rl:return["RGBE","( value )"];case iu:return["RGBM","( value, 7.0 )"];case au:return["RGBM","( value, 16.0 )"];case ou:return["RGBD","( value, 256.0 )"];case Ll:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Bh:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",a),["Linear","( value )"]}}function pd(a,t,i){var r=a.getShaderParameter(t,35713),n=a.getShaderInfoLog(t).trim();if(r&&n==="")return"";var o=a.getShaderSource(t);return"THREE.WebGLShader: gl.getShaderInfoLog() "+i+`
`+n+v0(o)}function Zs(a,t){var i=fd(t);return"vec4 "+a+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function m0(a,t){var i=fd(t);return"vec4 "+a+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function g0(a,t){var i;switch(t){case ct:i="Linear";break;case mt:i="Reinhard";break;case xt:i="OptimizedCineon";break;case ne:i="ACESFilmic";break;case U:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),i="Linear"}return"vec3 "+a+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function y0(a){var t=[a.extensionDerivatives||a.envMapCubeUV||a.bumpMap||a.tangentSpaceNormalMap||a.clearcoatNormalMap||a.flatShading||a.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(a.extensionFragDepth||a.logarithmicDepthBuffer)&&a.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",a.extensionDrawBuffers&&a.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(a.extensionShaderTextureLOD||a.envMap)&&a.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return t.filter(Ks).join(`
`)}function A0(a){var t=[];for(var i in a){var r=a[i];r!==!1&&t.push("#define "+i+" "+r)}return t.join(`
`)}function b0(a,t){for(var i={},r=a.getProgramParameter(t,35721),n=0;n<r;n++){var o=a.getActiveAttrib(t,n),s=o.name;i[s]=a.getAttribLocation(t,s)}return i}function Ks(a){return a!==""}function vd(a,t){return a.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function md(a,t){return a.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var E0=/^[ \t]*#include +<([\w\d./]+)>/gm;function Iu(a){return a.replace(E0,w0)}function w0(a,t){var i=Wr[t];if(i===void 0)throw new Error("Can not resolve #include <"+t+">");return Iu(i)}var x0=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,M0=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function gd(a){return a.replace(M0,yd).replace(x0,T0)}function T0(a,t,i,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),yd(a,t,i,r)}function yd(a,t,i,r){for(var n="",o=parseInt(t);o<parseInt(i);o++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return n}function Ad(a){var t="precision "+a.precision+` float;
precision `+a.precision+" int;";return a.precision==="highp"?t+=`
#define HIGH_PRECISION`:a.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:a.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function S0(a){var t="SHADOWMAP_TYPE_BASIC";return a.shadowMapType===g?t="SHADOWMAP_TYPE_PCF":a.shadowMapType===y?t="SHADOWMAP_TYPE_PCF_SOFT":a.shadowMapType===x&&(t="SHADOWMAP_TYPE_VSM"),t}function _0(a){var t="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case ue:case De:t="ENVMAP_TYPE_CUBE";break;case jt:case wr:t="ENVMAP_TYPE_CUBE_UV";break}return t}function C0(a){var t="ENVMAP_MODE_REFLECTION";if(a.envMap)switch(a.envMapMode){case De:case wr:t="ENVMAP_MODE_REFRACTION";break}return t}function L0(a){var t="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case Oe:t="ENVMAP_BLENDING_MULTIPLY";break;case Fe:t="ENVMAP_BLENDING_MIX";break;case Ye:t="ENVMAP_BLENDING_ADD";break}return t}function R0(a,t,i,r){var n=a.getContext(),o=i.defines,s=i.vertexShader,c=i.fragmentShader,h=S0(i),p=_0(i),C=C0(i),_=L0(i),S=a.gammaFactor>0?a.gammaFactor:1,D=i.isWebGL2?"":y0(i),P=A0(o),H=n.createProgram(),W,G,B=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(W=[P].filter(Ks).join(`
`),W.length>0&&(W+=`
`),G=[D,P].filter(Ks).join(`
`),G.length>0&&(G+=`
`)):(W=[Ad(i),"#define SHADER_NAME "+i.shaderName,P,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+S,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+C:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+h:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ks).join(`
`),G=[D,Ad(i),"#define SHADER_NAME "+i.shaderName,P,i.alphaTest?"#define ALPHATEST "+i.alphaTest+(i.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+S,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+p:"",i.envMap?"#define "+C:"",i.envMap?"#define "+_:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.sheen?"#define USE_SHEEN":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+h:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==ot?"#define TONE_MAPPING":"",i.toneMapping!==ot?Wr.tonemapping_pars_fragment:"",i.toneMapping!==ot?g0("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",Wr.encodings_pars_fragment,i.map?Zs("mapTexelToLinear",i.mapEncoding):"",i.matcap?Zs("matcapTexelToLinear",i.matcapEncoding):"",i.envMap?Zs("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMap?Zs("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.lightMap?Zs("lightMapTexelToLinear",i.lightMapEncoding):"",m0("linearToOutputTexel",i.outputEncoding),i.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Ks).join(`
`)),s=Iu(s),s=vd(s,i),s=md(s,i),c=Iu(c),c=vd(c,i),c=md(c,i),s=gd(s),c=gd(c),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(B=`#version 300 es
`,W=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+W,G=["#define varying in",i.glslVersion===su?"":"out highp vec4 pc_fragColor;",i.glslVersion===su?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+G);var te=B+W+s,he=B+G+c,K=dd(n,35633,te),Q=dd(n,35632,he);if(n.attachShader(H,K),n.attachShader(H,Q),i.index0AttributeName!==void 0?n.bindAttribLocation(H,0,i.index0AttributeName):i.morphTargets===!0&&n.bindAttribLocation(H,0,"position"),n.linkProgram(H),a.debug.checkShaderErrors){var le=n.getProgramInfoLog(H).trim(),Me=n.getShaderInfoLog(K).trim(),xe=n.getShaderInfoLog(Q).trim(),_e=!0,Pe=!0;if(n.getProgramParameter(H,35714)===!1){_e=!1;var Ce=pd(n,K,"vertex"),Ae=pd(n,Q,"fragment");console.error("THREE.WebGLProgram: shader error: ",n.getError(),"35715",n.getProgramParameter(H,35715),"gl.getProgramInfoLog",le,Ce,Ae)}else le!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",le):(Me===""||xe==="")&&(Pe=!1);Pe&&(this.diagnostics={runnable:_e,programLog:le,vertexShader:{log:Me,prefix:W},fragmentShader:{log:xe,prefix:G}})}n.deleteShader(K),n.deleteShader(Q);var Be;this.getUniforms=function(){return Be===void 0&&(Be=new io(n,H)),Be};var Se;return this.getAttributes=function(){return Se===void 0&&(Se=b0(n,H)),Se},this.destroy=function(){r.releaseStatesOfProgram(this),n.deleteProgram(H),this.program=void 0},this.name=i.shaderName,this.id=p0++,this.cacheKey=t,this.usedTimes=1,this.program=H,this.vertexShader=K,this.fragmentShader=Q,this}function P0(a,t,i,r,n,o){var s=[],c=r.isWebGL2,h=r.logarithmicDepthBuffer,p=r.floatVertexTextures,C=r.maxVertexUniforms,_=r.vertexTextures,S=r.precision,D={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},P=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function H(Q){var le=Q.skeleton,Me=le.bones;if(p)return 1024;var xe=C,_e=Math.floor((xe-20)/4),Pe=Math.min(_e,Me.length);return Pe<Me.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Me.length+" bones. This GPU supports "+Pe+"."),0):Pe}function W(Q){var le;return Q&&Q.isTexture?le=Q.encoding:Q&&Q.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),le=Q.texture.encoding):le=yi,le}function G(Q,le,Me,xe,_e){var Pe=xe.fog,Ce=Q.isMeshStandardMaterial?xe.environment:null,Ae=t.get(Q.envMap||Ce),Be=D[Q.type],Se=_e.isSkinnedMesh?H(_e):0;Q.precision!==null&&(S=r.getMaxPrecision(Q.precision),S!==Q.precision&&console.warn("THREE.WebGLProgram.getParameters:",Q.precision,"not supported, using",S,"instead."));var Te,me;if(Be){var Ue=ea[Be];Te=Ue.vertexShader,me=Ue.fragmentShader}else Te=Q.vertexShader,me=Q.fragmentShader;var He=a.getRenderTarget(),Qe={isWebGL2:c,shaderID:Be,shaderName:Q.type,vertexShader:Te,fragmentShader:me,defines:Q.defines,isRawShaderMaterial:Q.isRawShaderMaterial===!0,glslVersion:Q.glslVersion,precision:S,instancing:_e.isInstancedMesh===!0,instancingColor:_e.isInstancedMesh===!0&&_e.instanceColor!==null,supportsVertexTextures:_,outputEncoding:He!==null?W(He.texture):a.outputEncoding,map:!!Q.map,mapEncoding:W(Q.map),matcap:!!Q.matcap,matcapEncoding:W(Q.matcap),envMap:!!Ae,envMapMode:Ae&&Ae.mapping,envMapEncoding:W(Ae),envMapCubeUV:!!Ae&&(Ae.mapping===jt||Ae.mapping===wr),lightMap:!!Q.lightMap,lightMapEncoding:W(Q.lightMap),aoMap:!!Q.aoMap,emissiveMap:!!Q.emissiveMap,emissiveMapEncoding:W(Q.emissiveMap),bumpMap:!!Q.bumpMap,normalMap:!!Q.normalMap,objectSpaceNormalMap:Q.normalMapType===kh,tangentSpaceNormalMap:Q.normalMapType===xo,clearcoatMap:!!Q.clearcoatMap,clearcoatRoughnessMap:!!Q.clearcoatRoughnessMap,clearcoatNormalMap:!!Q.clearcoatNormalMap,displacementMap:!!Q.displacementMap,roughnessMap:!!Q.roughnessMap,metalnessMap:!!Q.metalnessMap,specularMap:!!Q.specularMap,alphaMap:!!Q.alphaMap,gradientMap:!!Q.gradientMap,sheen:!!Q.sheen,transmissionMap:!!Q.transmissionMap,combine:Q.combine,vertexTangents:Q.normalMap&&Q.vertexTangents,vertexColors:Q.vertexColors,vertexUvs:!!Q.map||!!Q.bumpMap||!!Q.normalMap||!!Q.specularMap||!!Q.alphaMap||!!Q.emissiveMap||!!Q.roughnessMap||!!Q.metalnessMap||!!Q.clearcoatMap||!!Q.clearcoatRoughnessMap||!!Q.clearcoatNormalMap||!!Q.displacementMap||!!Q.transmissionMap,uvsVertexOnly:!(Q.map||Q.bumpMap||Q.normalMap||Q.specularMap||Q.alphaMap||Q.emissiveMap||Q.roughnessMap||Q.metalnessMap||Q.clearcoatNormalMap||Q.transmissionMap)&&!!Q.displacementMap,fog:!!Pe,useFog:Q.fog,fogExp2:Pe&&Pe.isFogExp2,flatShading:Q.flatShading,sizeAttenuation:Q.sizeAttenuation,logarithmicDepthBuffer:h,skinning:Q.skinning&&Se>0,maxBones:Se,useVertexTexture:p,morphTargets:Q.morphTargets,morphNormals:Q.morphNormals,maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,numDirLights:le.directional.length,numPointLights:le.point.length,numSpotLights:le.spot.length,numRectAreaLights:le.rectArea.length,numHemiLights:le.hemi.length,numDirLightShadows:le.directionalShadowMap.length,numPointLightShadows:le.pointShadowMap.length,numSpotLightShadows:le.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:Q.dithering,shadowMapEnabled:a.shadowMap.enabled&&Me.length>0,shadowMapType:a.shadowMap.type,toneMapping:Q.toneMapped?a.toneMapping:ot,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:Q.premultipliedAlpha,alphaTest:Q.alphaTest,doubleSided:Q.side===R,flipSided:Q.side===T,depthPacking:Q.depthPacking!==void 0?Q.depthPacking:!1,index0AttributeName:Q.index0AttributeName,extensionDerivatives:Q.extensions&&Q.extensions.derivatives,extensionFragDepth:Q.extensions&&Q.extensions.fragDepth,extensionDrawBuffers:Q.extensions&&Q.extensions.drawBuffers,extensionShaderTextureLOD:Q.extensions&&Q.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||i.has("EXT_shader_texture_lod"),customProgramCacheKey:Q.customProgramCacheKey()};return Qe}function B(Q){var le=[];if(Q.shaderID?le.push(Q.shaderID):(le.push(Q.fragmentShader),le.push(Q.vertexShader)),Q.defines!==void 0)for(var Me in Q.defines)le.push(Me),le.push(Q.defines[Me]);if(Q.isRawShaderMaterial===!1){for(var xe=0;xe<P.length;xe++)le.push(Q[P[xe]]);le.push(a.outputEncoding),le.push(a.gammaFactor)}return le.push(Q.customProgramCacheKey),le.join()}function te(Q){var le=D[Q.type],Me;if(le){var xe=ea[le];Me=ed.clone(xe.uniforms)}else Me=Q.uniforms;return Me}function he(Q,le){for(var Me,xe=0,_e=s.length;xe<_e;xe++){var Pe=s[xe];if(Pe.cacheKey===le){Me=Pe,++Me.usedTimes;break}}return Me===void 0&&(Me=new R0(a,le,Q,n),s.push(Me)),Me}function K(Q){if(--Q.usedTimes===0){var le=s.indexOf(Q);s[le]=s[s.length-1],s.pop(),Q.destroy()}}return{getParameters:G,getProgramCacheKey:B,getUniforms:te,acquireProgram:he,releaseProgram:K,programs:s}}function D0(){var a=new WeakMap;function t(o){var s=a.get(o);return s===void 0&&(s={},a.set(o,s)),s}function i(o){a.delete(o)}function r(o,s,c){a.get(o)[s]=c}function n(){a=new WeakMap}return{get:t,remove:i,update:r,dispose:n}}function O0(a,t){return a.groupOrder!==t.groupOrder?a.groupOrder-t.groupOrder:a.renderOrder!==t.renderOrder?a.renderOrder-t.renderOrder:a.program!==t.program?a.program.id-t.program.id:a.material.id!==t.material.id?a.material.id-t.material.id:a.z!==t.z?a.z-t.z:a.id-t.id}function I0(a,t){return a.groupOrder!==t.groupOrder?a.groupOrder-t.groupOrder:a.renderOrder!==t.renderOrder?a.renderOrder-t.renderOrder:a.z!==t.z?t.z-a.z:a.id-t.id}function bd(a){var t=[],i=0,r=[],n=[],o={id:-1};function s(){i=0,r.length=0,n.length=0}function c(S,D,P,H,W,G){var B=t[i],te=a.get(P);return B===void 0?(B={id:S.id,object:S,geometry:D,material:P,program:te.program||o,groupOrder:H,renderOrder:S.renderOrder,z:W,group:G},t[i]=B):(B.id=S.id,B.object=S,B.geometry=D,B.material=P,B.program=te.program||o,B.groupOrder=H,B.renderOrder=S.renderOrder,B.z=W,B.group=G),i++,B}function h(S,D,P,H,W,G){var B=c(S,D,P,H,W,G);(P.transparent===!0?n:r).push(B)}function p(S,D,P,H,W,G){var B=c(S,D,P,H,W,G);(P.transparent===!0?n:r).unshift(B)}function C(S,D){r.length>1&&r.sort(S||O0),n.length>1&&n.sort(D||I0)}function _(){for(var S=i,D=t.length;S<D;S++){var P=t[S];if(P.id===null)break;P.id=null,P.object=null,P.geometry=null,P.material=null,P.program=null,P.group=null}}return{opaque:r,transparent:n,init:s,push:h,unshift:p,finish:_,sort:C}}function B0(a){var t=new WeakMap;function i(n,o){var s=t.get(n),c;return s===void 0?(c=new bd(a),t.set(n,new WeakMap),t.get(n).set(o,c)):(c=s.get(o),c===void 0&&(c=new bd(a),s.set(o,c))),c}function r(){t=new WeakMap}return{get:i,dispose:r}}function F0(){var a={};return{get:function(i){if(a[i.id]!==void 0)return a[i.id];var r;switch(i.type){case"DirectionalLight":r={direction:new fe,color:new It};break;case"SpotLight":r={position:new fe,direction:new fe,color:new It,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new fe,color:new It,distance:0,decay:0};break;case"HemisphereLight":r={direction:new fe,skyColor:new It,groundColor:new It};break;case"RectAreaLight":r={color:new It,position:new fe,halfWidth:new fe,halfHeight:new fe};break}return a[i.id]=r,r}}}function N0(){var a={};return{get:function(i){if(a[i.id]!==void 0)return a[i.id];var r;switch(i.type){case"DirectionalLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bt};break;case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bt};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bt,shadowCameraNear:1,shadowCameraFar:1e3};break}return a[i.id]=r,r}}}var k0=0;function U0(a,t){return(t.castShadow?1:0)-(a.castShadow?1:0)}function H0(a,t){for(var i=new F0,r=N0(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},o=0;o<9;o++)n.probe.push(new fe);var s=new fe,c=new kr,h=new kr;function p(_){for(var S=0,D=0,P=0,H=0;H<9;H++)n.probe[H].set(0,0,0);var W=0,G=0,B=0,te=0,he=0,K=0,Q=0,le=0;_.sort(U0);for(var Me=0,xe=_.length;Me<xe;Me++){var _e=_[Me],Pe=_e.color,Ce=_e.intensity,Ae=_e.distance,Be=_e.shadow&&_e.shadow.map?_e.shadow.map.texture:null;if(_e.isAmbientLight)S+=Pe.r*Ce,D+=Pe.g*Ce,P+=Pe.b*Ce;else if(_e.isLightProbe)for(var Se=0;Se<9;Se++)n.probe[Se].addScaledVector(_e.sh.coefficients[Se],Ce);else if(_e.isDirectionalLight){var Te=i.get(_e);if(Te.color.copy(_e.color).multiplyScalar(_e.intensity),_e.castShadow){var me=_e.shadow,Ue=r.get(_e);Ue.shadowBias=me.bias,Ue.shadowNormalBias=me.normalBias,Ue.shadowRadius=me.radius,Ue.shadowMapSize=me.mapSize,n.directionalShadow[W]=Ue,n.directionalShadowMap[W]=Be,n.directionalShadowMatrix[W]=_e.shadow.matrix,K++}n.directional[W]=Te,W++}else if(_e.isSpotLight){var He=i.get(_e);if(He.position.setFromMatrixPosition(_e.matrixWorld),He.color.copy(Pe).multiplyScalar(Ce),He.distance=Ae,He.coneCos=Math.cos(_e.angle),He.penumbraCos=Math.cos(_e.angle*(1-_e.penumbra)),He.decay=_e.decay,_e.castShadow){var Qe=_e.shadow,qe=r.get(_e);qe.shadowBias=Qe.bias,qe.shadowNormalBias=Qe.normalBias,qe.shadowRadius=Qe.radius,qe.shadowMapSize=Qe.mapSize,n.spotShadow[B]=qe,n.spotShadowMap[B]=Be,n.spotShadowMatrix[B]=_e.shadow.matrix,le++}n.spot[B]=He,B++}else if(_e.isRectAreaLight){var gt=i.get(_e);gt.color.copy(Pe).multiplyScalar(Ce),gt.halfWidth.set(_e.width*.5,0,0),gt.halfHeight.set(0,_e.height*.5,0),n.rectArea[te]=gt,te++}else if(_e.isPointLight){var St=i.get(_e);if(St.color.copy(_e.color).multiplyScalar(_e.intensity),St.distance=_e.distance,St.decay=_e.decay,_e.castShadow){var Vt=_e.shadow,Ke=r.get(_e);Ke.shadowBias=Vt.bias,Ke.shadowNormalBias=Vt.normalBias,Ke.shadowRadius=Vt.radius,Ke.shadowMapSize=Vt.mapSize,Ke.shadowCameraNear=Vt.camera.near,Ke.shadowCameraFar=Vt.camera.far,n.pointShadow[G]=Ke,n.pointShadowMap[G]=Be,n.pointShadowMatrix[G]=_e.shadow.matrix,Q++}n.point[G]=St,G++}else if(_e.isHemisphereLight){var rr=i.get(_e);rr.skyColor.copy(_e.color).multiplyScalar(Ce),rr.groundColor.copy(_e.groundColor).multiplyScalar(Ce),n.hemi[he]=rr,he++}}te>0&&(t.isWebGL2||a.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Pt.LTC_FLOAT_1,n.rectAreaLTC2=Pt.LTC_FLOAT_2):a.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=Pt.LTC_HALF_1,n.rectAreaLTC2=Pt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=S,n.ambient[1]=D,n.ambient[2]=P;var Bt=n.hash;(Bt.directionalLength!==W||Bt.pointLength!==G||Bt.spotLength!==B||Bt.rectAreaLength!==te||Bt.hemiLength!==he||Bt.numDirectionalShadows!==K||Bt.numPointShadows!==Q||Bt.numSpotShadows!==le)&&(n.directional.length=W,n.spot.length=B,n.rectArea.length=te,n.point.length=G,n.hemi.length=he,n.directionalShadow.length=K,n.directionalShadowMap.length=K,n.pointShadow.length=Q,n.pointShadowMap.length=Q,n.spotShadow.length=le,n.spotShadowMap.length=le,n.directionalShadowMatrix.length=K,n.pointShadowMatrix.length=Q,n.spotShadowMatrix.length=le,Bt.directionalLength=W,Bt.pointLength=G,Bt.spotLength=B,Bt.rectAreaLength=te,Bt.hemiLength=he,Bt.numDirectionalShadows=K,Bt.numPointShadows=Q,Bt.numSpotShadows=le,n.version=k0++)}function C(_,S){for(var D=0,P=0,H=0,W=0,G=0,B=S.matrixWorldInverse,te=0,he=_.length;te<he;te++){var K=_[te];if(K.isDirectionalLight){var Q=n.directional[D];Q.direction.setFromMatrixPosition(K.matrixWorld),s.setFromMatrixPosition(K.target.matrixWorld),Q.direction.sub(s),Q.direction.transformDirection(B),D++}else if(K.isSpotLight){var le=n.spot[H];le.position.setFromMatrixPosition(K.matrixWorld),le.position.applyMatrix4(B),le.direction.setFromMatrixPosition(K.matrixWorld),s.setFromMatrixPosition(K.target.matrixWorld),le.direction.sub(s),le.direction.transformDirection(B),H++}else if(K.isRectAreaLight){var Me=n.rectArea[W];Me.position.setFromMatrixPosition(K.matrixWorld),Me.position.applyMatrix4(B),h.identity(),c.copy(K.matrixWorld),c.premultiply(B),h.extractRotation(c),Me.halfWidth.set(K.width*.5,0,0),Me.halfHeight.set(0,K.height*.5,0),Me.halfWidth.applyMatrix4(h),Me.halfHeight.applyMatrix4(h),W++}else if(K.isPointLight){var xe=n.point[P];xe.position.setFromMatrixPosition(K.matrixWorld),xe.position.applyMatrix4(B),P++}else if(K.isHemisphereLight){var _e=n.hemi[G];_e.direction.setFromMatrixPosition(K.matrixWorld),_e.direction.transformDirection(B),_e.direction.normalize(),G++}}}return{setup:p,setupView:C,state:n}}function Ed(a,t){var i=new H0(a,t),r=[],n=[];function o(){r.length=0,n.length=0}function s(_){r.push(_)}function c(_){n.push(_)}function h(){i.setup(r)}function p(_){i.setupView(r,_)}var C={lightsArray:r,shadowsArray:n,lights:i};return{init:o,state:C,setupLights:h,setupLightsView:p,pushLight:s,pushShadow:c}}function G0(a,t){var i=new WeakMap;function r(o,s){s===void 0&&(s=0);var c;return i.has(o)===!1?(c=new Ed(a,t),i.set(o,[]),i.get(o).push(c)):s>=i.get(o).length?(c=new Ed(a,t),i.get(o).push(c)):c=i.get(o)[s],c}function n(){i=new WeakMap}return{get:r,dispose:n}}function ao(a){hr.call(this),this.type="MeshDepthMaterial",this.depthPacking=Fh,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(a)}ao.prototype=Object.create(hr.prototype),ao.prototype.constructor=ao,ao.prototype.isMeshDepthMaterial=!0,ao.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.depthPacking=a.depthPacking,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this};function oo(a){hr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new fe,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(a)}oo.prototype=Object.create(hr.prototype),oo.prototype.constructor=oo,oo.prototype.isMeshDistanceMaterial=!0,oo.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.referencePosition.copy(a.referencePosition),this.nearDistance=a.nearDistance,this.farDistance=a.farDistance,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this};var V0=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,z0=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function wd(a,t,i){var r=new qs,n=new bt,o=new bt,s=new un,c=[],h=[],p={},C={0:T,1:L,2:R},_=new Ai({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new bt},radius:{value:4}},vertexShader:z0,fragmentShader:V0}),S=_.clone();S.defines.HORIZONTAL_PASS=1;var D=new tr;D.setAttribute("position",new dr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var P=new xn(D,_),H=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=g,this.render=function(K,Q,le){if(H.enabled!==!1&&!(H.autoUpdate===!1&&H.needsUpdate===!1)&&K.length!==0){var Me=a.getRenderTarget(),xe=a.getActiveCubeFace(),_e=a.getActiveMipmapLevel(),Pe=a.state;Pe.setBlending(z),Pe.buffers.color.setClear(1,1,1,1),Pe.buffers.depth.setTest(!0),Pe.setScissorTest(!1);for(var Ce=0,Ae=K.length;Ce<Ae;Ce++){var Be=K[Ce],Se=Be.shadow;if(Se===void 0){console.warn("THREE.WebGLShadowMap:",Be,"has no shadow.");continue}if(!(Se.autoUpdate===!1&&Se.needsUpdate===!1)){n.copy(Se.mapSize);var Te=Se.getFrameExtents();if(n.multiply(Te),o.copy(Se.mapSize),(n.x>i||n.y>i)&&(n.x>i&&(o.x=Math.floor(i/Te.x),n.x=o.x*Te.x,Se.mapSize.x=o.x),n.y>i&&(o.y=Math.floor(i/Te.y),n.y=o.y*Te.y,Se.mapSize.y=o.y)),Se.map===null&&!Se.isPointLightShadow&&this.type===x){var me={minFilter:nt,magFilter:nt,format:ti};Se.map=new qa(n.x,n.y,me),Se.map.texture.name=Be.name+".shadowMap",Se.mapPass=new qa(n.x,n.y,me),Se.camera.updateProjectionMatrix()}if(Se.map===null){var Ue={minFilter:ar,magFilter:ar,format:ti};Se.map=new qa(n.x,n.y,Ue),Se.map.texture.name=Be.name+".shadowMap",Se.camera.updateProjectionMatrix()}a.setRenderTarget(Se.map),a.clear();for(var He=Se.getViewportCount(),Qe=0;Qe<He;Qe++){var qe=Se.getViewport(Qe);s.set(o.x*qe.x,o.y*qe.y,o.x*qe.z,o.y*qe.w),Pe.viewport(s),Se.updateMatrices(Be,Qe),r=Se.getFrustum(),he(Q,le,Se.camera,Be,this.type)}!Se.isPointLightShadow&&this.type===x&&W(Se,le),Se.needsUpdate=!1}}H.needsUpdate=!1,a.setRenderTarget(Me,xe,_e)}};function W(K,Q){var le=t.update(P);_.uniforms.shadow_pass.value=K.map.texture,_.uniforms.resolution.value=K.mapSize,_.uniforms.radius.value=K.radius,a.setRenderTarget(K.mapPass),a.clear(),a.renderBufferDirect(Q,null,le,_,P,null),S.uniforms.shadow_pass.value=K.mapPass.texture,S.uniforms.resolution.value=K.mapSize,S.uniforms.radius.value=K.radius,a.setRenderTarget(K.map),a.clear(),a.renderBufferDirect(Q,null,le,S,P,null)}function G(K,Q,le){var Me=K<<0|Q<<1|le<<2,xe=c[Me];return xe===void 0&&(xe=new ao({depthPacking:Nh,morphTargets:K,skinning:Q}),c[Me]=xe),xe}function B(K,Q,le){var Me=K<<0|Q<<1|le<<2,xe=h[Me];return xe===void 0&&(xe=new oo({morphTargets:K,skinning:Q}),h[Me]=xe),xe}function te(K,Q,le,Me,xe,_e,Pe){var Ce=null,Ae=G,Be=K.customDepthMaterial;if(Me.isPointLight===!0&&(Ae=B,Be=K.customDistanceMaterial),Be===void 0){var Se=!1;le.morphTargets===!0&&(Se=Q.morphAttributes&&Q.morphAttributes.position&&Q.morphAttributes.position.length>0);var Te=!1;K.isSkinnedMesh===!0&&(le.skinning===!0?Te=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",K));var me=K.isInstancedMesh===!0;Ce=Ae(Se,Te,me)}else Ce=Be;if(a.localClippingEnabled&&le.clipShadows===!0&&le.clippingPlanes.length!==0){var Ue=Ce.uuid,He=le.uuid,Qe=p[Ue];Qe===void 0&&(Qe={},p[Ue]=Qe);var qe=Qe[He];qe===void 0&&(qe=Ce.clone(),Qe[He]=qe),Ce=qe}return Ce.visible=le.visible,Ce.wireframe=le.wireframe,Pe===x?Ce.side=le.shadowSide!==null?le.shadowSide:le.side:Ce.side=le.shadowSide!==null?le.shadowSide:C[le.side],Ce.clipShadows=le.clipShadows,Ce.clippingPlanes=le.clippingPlanes,Ce.clipIntersection=le.clipIntersection,Ce.wireframeLinewidth=le.wireframeLinewidth,Ce.linewidth=le.linewidth,Me.isPointLight===!0&&Ce.isMeshDistanceMaterial===!0&&(Ce.referencePosition.setFromMatrixPosition(Me.matrixWorld),Ce.nearDistance=xe,Ce.farDistance=_e),Ce}function he(K,Q,le,Me,xe){if(K.visible!==!1){var _e=K.layers.test(Q.layers);if(_e&&(K.isMesh||K.isLine||K.isPoints)&&(K.castShadow||K.receiveShadow&&xe===x)&&(!K.frustumCulled||r.intersectsObject(K))){K.modelViewMatrix.multiplyMatrices(le.matrixWorldInverse,K.matrixWorld);var Pe=t.update(K),Ce=K.material;if(Array.isArray(Ce))for(var Ae=Pe.groups,Be=0,Se=Ae.length;Be<Se;Be++){var Te=Ae[Be],me=Ce[Te.materialIndex];if(me&&me.visible){var Ue=te(K,Pe,me,Me,le.near,le.far,xe);a.renderBufferDirect(le,null,Pe,Ue,K,Te)}}else if(Ce.visible){var He=te(K,Pe,Ce,Me,le.near,le.far,xe);a.renderBufferDirect(le,null,Pe,He,K,null)}}for(var Qe=K.children,qe=0,gt=Qe.length;qe<gt;qe++)he(Qe[qe],Q,le,Me,xe)}}}function W0(a,t,i){var r,n,o=i.isWebGL2;function s(){var ze=!1,zt=new un,Ht=null,lr=new un(0,0,0,0);return{setMask:function(_t){Ht!==_t&&!ze&&(a.colorMask(_t,_t,_t,_t),Ht=_t)},setLocked:function(_t){ze=_t},setClear:function(_t,_r,Nr,Bn,gn){gn===!0&&(_t*=Bn,_r*=Bn,Nr*=Bn),zt.set(_t,_r,Nr,Bn),lr.equals(zt)===!1&&(a.clearColor(_t,_r,Nr,Bn),lr.copy(zt))},reset:function(){ze=!1,Ht=null,lr.set(-1,0,0,0)}}}function c(){var ze=!1,zt=null,Ht=null,lr=null;return{setTest:function(_t){_t?gt(2929):St(2929)},setMask:function(_t){zt!==_t&&!ze&&(a.depthMask(_t),zt=_t)},setFunc:function(_t){if(Ht!==_t){if(_t)switch(_t){case ln:a.depthFunc(512);break;case kt:a.depthFunc(519);break;case ie:a.depthFunc(513);break;case ae:a.depthFunc(515);break;case ge:a.depthFunc(514);break;case ve:a.depthFunc(518);break;case we:a.depthFunc(516);break;case Ie:a.depthFunc(517);break;default:a.depthFunc(515)}else a.depthFunc(515);Ht=_t}},setLocked:function(_t){ze=_t},setClear:function(_t){lr!==_t&&(a.clearDepth(_t),lr=_t)},reset:function(){ze=!1,zt=null,Ht=null,lr=null}}}function h(){var ze=!1,zt=null,Ht=null,lr=null,Ft=null,_t=null,_r=null,Nr=null,Bn=null;return{setTest:function(tn){ze||(tn?gt(2960):St(2960))},setMask:function(tn){zt!==tn&&!ze&&(a.stencilMask(tn),zt=tn)},setFunc:function(tn,on,Wn){(Ht!==tn||lr!==on||Ft!==Wn)&&(a.stencilFunc(tn,on,Wn),Ht=tn,lr=on,Ft=Wn)},setOp:function(tn,on,Wn){(_t!==tn||_r!==on||Nr!==Wn)&&(a.stencilOp(tn,on,Wn),_t=tn,_r=on,Nr=Wn)},setLocked:function(tn){ze=tn},setClear:function(tn){Bn!==tn&&(a.clearStencil(tn),Bn=tn)},reset:function(){ze=!1,zt=null,Ht=null,lr=null,Ft=null,_t=null,_r=null,Nr=null,Bn=null}}}var p=new s,C=new c,_=new h,S={},D=null,P=null,H=null,W=null,G=null,B=null,te=null,he=null,K=null,Q=!1,le=null,Me=null,xe=null,_e=null,Pe=null,Ce=a.getParameter(35661),Ae=!1,Be=0,Se=a.getParameter(7938);Se.indexOf("WebGL")!==-1?(Be=parseFloat(/^WebGL (\d)/.exec(Se)[1]),Ae=Be>=1):Se.indexOf("OpenGL ES")!==-1&&(Be=parseFloat(/^OpenGL ES (\d)/.exec(Se)[1]),Ae=Be>=2);var Te=null,me={},Ue=new un,He=new un;function Qe(ze,zt,Ht){var lr=new Uint8Array(4),Ft=a.createTexture();a.bindTexture(ze,Ft),a.texParameteri(ze,10241,9728),a.texParameteri(ze,10240,9728);for(var _t=0;_t<Ht;_t++)a.texImage2D(zt+_t,0,6408,1,1,0,6408,5121,lr);return Ft}var qe={};qe[3553]=Qe(3553,3553,1),qe[34067]=Qe(34067,34069,6),p.setClear(0,0,0,1),C.setClear(1),_.setClear(0),gt(2929),C.setFunc(ae),Fr(!1),Sr(f),gt(2884),sr(z);function gt(ze){S[ze]!==!0&&(a.enable(ze),S[ze]=!0)}function St(ze){S[ze]!==!1&&(a.disable(ze),S[ze]=!1)}function Vt(ze){return D!==ze?(a.useProgram(ze),D=ze,!0):!1}var Ke=(r={},r[j]=32774,r[oe]=32778,r[Z]=32779,r);if(o)Ke[ye]=32775,Ke[Ne]=32776;else{var rr=t.get("EXT_blend_minmax");rr!==null&&(Ke[ye]=rr.MIN_EXT,Ke[Ne]=rr.MAX_EXT)}var Bt=(n={},n[je]=0,n[ke]=1,n[it]=768,n[Mt]=770,n[yr]=776,n[Dr]=774,n[Wt]=772,n[rt]=769,n[Rt]=771,n[wt]=775,n[nr]=773,n);function sr(ze,zt,Ht,lr,Ft,_t,_r,Nr){if(ze===z){P&&(St(3042),P=!1);return}if(P||(gt(3042),P=!0),ze!==ce){if(ze!==H||Nr!==Q){if((W!==j||te!==j)&&(a.blendEquation(32774),W=j,te=j),Nr)switch(ze){case re:a.blendFuncSeparate(1,771,1,771);break;case Y:a.blendFunc(1,1);break;case ee:a.blendFuncSeparate(0,0,769,771);break;case J:a.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ze);break}else switch(ze){case re:a.blendFuncSeparate(770,771,1,771);break;case Y:a.blendFunc(770,1);break;case ee:a.blendFunc(0,769);break;case J:a.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ze);break}G=null,B=null,he=null,K=null,H=ze,Q=Nr}return}Ft=Ft||zt,_t=_t||Ht,_r=_r||lr,(zt!==W||Ft!==te)&&(a.blendEquationSeparate(Ke[zt],Ke[Ft]),W=zt,te=Ft),(Ht!==G||lr!==B||_t!==he||_r!==K)&&(a.blendFuncSeparate(Bt[Ht],Bt[lr],Bt[_t],Bt[_r]),G=Ht,B=lr,he=_t,K=_r),H=ze,Q=null}function xr(ze,zt){ze.side===R?St(2884):gt(2884);var Ht=ze.side===T;zt&&(Ht=!Ht),Fr(Ht),ze.blending===re&&ze.transparent===!1?sr(z):sr(ze.blending,ze.blendEquation,ze.blendSrc,ze.blendDst,ze.blendEquationAlpha,ze.blendSrcAlpha,ze.blendDstAlpha,ze.premultipliedAlpha),C.setFunc(ze.depthFunc),C.setTest(ze.depthTest),C.setMask(ze.depthWrite),p.setMask(ze.colorWrite);var lr=ze.stencilWrite;_.setTest(lr),lr&&(_.setMask(ze.stencilWriteMask),_.setFunc(ze.stencilFunc,ze.stencilRef,ze.stencilFuncMask),_.setOp(ze.stencilFail,ze.stencilZFail,ze.stencilZPass)),Qr(ze.polygonOffset,ze.polygonOffsetFactor,ze.polygonOffsetUnits)}function Fr(ze){le!==ze&&(ze?a.frontFace(2304):a.frontFace(2305),le=ze)}function Sr(ze){ze!==v?(gt(2884),ze!==Me&&(ze===f?a.cullFace(1029):ze===m?a.cullFace(1028):a.cullFace(1032))):St(2884),Me=ze}function mn(ze){ze!==xe&&(Ae&&a.lineWidth(ze),xe=ze)}function Qr(ze,zt,Ht){ze?(gt(32823),(_e!==zt||Pe!==Ht)&&(a.polygonOffset(zt,Ht),_e=zt,Pe=Ht)):St(32823)}function hn(ze){ze?gt(3089):St(3089)}function zn(ze){ze===void 0&&(ze=33984+Ce-1),Te!==ze&&(a.activeTexture(ze),Te=ze)}function fi(ze,zt){Te===null&&zn();var Ht=me[Te];Ht===void 0&&(Ht={type:void 0,texture:void 0},me[Te]=Ht),(Ht.type!==ze||Ht.texture!==zt)&&(a.bindTexture(ze,zt||qe[ze]),Ht.type=ze,Ht.texture=zt)}function Kn(){var ze=me[Te];ze!==void 0&&ze.type!==void 0&&(a.bindTexture(ze.type,null),ze.type=void 0,ze.texture=void 0)}function Un(){try{a.compressedTexImage2D.apply(a,arguments)}catch(ze){console.error("THREE.WebGLState:",ze)}}function Le(){try{a.texImage2D.apply(a,arguments)}catch(ze){console.error("THREE.WebGLState:",ze)}}function Ee(){try{a.texImage3D.apply(a,arguments)}catch(ze){console.error("THREE.WebGLState:",ze)}}function Ot(ze){Ue.equals(ze)===!1&&(a.scissor(ze.x,ze.y,ze.z,ze.w),Ue.copy(ze))}function Lt(ze){He.equals(ze)===!1&&(a.viewport(ze.x,ze.y,ze.z,ze.w),He.copy(ze))}function Er(){S={},Te=null,me={},D=null,P=null,H=null,W=null,G=null,B=null,te=null,he=null,K=null,Q=!1,le=null,Me=null,xe=null,_e=null,Pe=null,p.reset(),C.reset(),_.reset()}return{buffers:{color:p,depth:C,stencil:_},enable:gt,disable:St,useProgram:Vt,setBlending:sr,setMaterial:xr,setFlipSided:Fr,setCullFace:Sr,setLineWidth:mn,setPolygonOffset:Qr,setScissorTest:hn,activeTexture:zn,bindTexture:fi,unbindTexture:Kn,compressedTexImage2D:Un,texImage2D:Le,texImage3D:Ee,scissor:Ot,viewport:Lt,reset:Er}}function j0(a,t,i,r,n,o,s){var c,h,p=n.isWebGL2,C=n.maxTextures,_=n.maxCubemapSize,S=n.maxTextureSize,D=n.maxSamples,P=new WeakMap,H,W=!1;try{W=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function G(Le,Ee){return W?new OffscreenCanvas(Le,Ee):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function B(Le,Ee,Ot,Lt){var Er=1;if((Le.width>Lt||Le.height>Lt)&&(Er=Lt/Math.max(Le.width,Le.height)),Er<1||Ee===!0)if(typeof HTMLImageElement<"u"&&Le instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Le instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Le instanceof ImageBitmap){var ze=Ee?gr.floorPowerOfTwo:Math.floor,zt=ze(Er*Le.width),Ht=ze(Er*Le.height);H===void 0&&(H=G(zt,Ht));var lr=Ot?G(zt,Ht):H;lr.width=zt,lr.height=Ht;var Ft=lr.getContext("2d");return Ft.drawImage(Le,0,0,zt,Ht),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Le.width+"x"+Le.height+") to ("+zt+"x"+Ht+")."),lr}else return"data"in Le&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Le.width+"x"+Le.height+")."),Le;return Le}function te(Le){return gr.isPowerOfTwo(Le.width)&&gr.isPowerOfTwo(Le.height)}function he(Le){return p?!1:Le.wrapS!==Jt||Le.wrapT!==Jt||Le.minFilter!==ar&&Le.minFilter!==nt}function K(Le,Ee){return Le.generateMipmaps&&Ee&&Le.minFilter!==ar&&Le.minFilter!==nt}function Q(Le,Ee,Ot,Lt){a.generateMipmap(Le);var Er=r.get(Ee);Er.__maxMipLevel=Math.log(Math.max(Ot,Lt))*Math.LOG2E}function le(Le,Ee,Ot){if(p===!1)return Ee;if(Le!==null){if(a[Le]!==void 0)return a[Le];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Le+"'")}var Lt=Ee;return Ee===6403&&(Ot===5126&&(Lt=33326),Ot===5131&&(Lt=33325),Ot===5121&&(Lt=33321)),Ee===6407&&(Ot===5126&&(Lt=34837),Ot===5131&&(Lt=34843),Ot===5121&&(Lt=32849)),Ee===6408&&(Ot===5126&&(Lt=34836),Ot===5131&&(Lt=34842),Ot===5121&&(Lt=32856)),(Lt===33325||Lt===33326||Lt===34842||Lt===34836)&&t.get("EXT_color_buffer_float"),Lt}function Me(Le){return Le===ar||Le===yn||Le===An?9728:9729}function xe(Le){var Ee=Le.target;Ee.removeEventListener("dispose",xe),Pe(Ee),Ee.isVideoTexture&&P.delete(Ee),s.memory.textures--}function _e(Le){var Ee=Le.target;Ee.removeEventListener("dispose",_e),Ce(Ee),s.memory.textures--}function Pe(Le){var Ee=r.get(Le);Ee.__webglInit!==void 0&&(a.deleteTexture(Ee.__webglTexture),r.remove(Le))}function Ce(Le){var Ee=r.get(Le),Ot=r.get(Le.texture);if(Le){if(Ot.__webglTexture!==void 0&&a.deleteTexture(Ot.__webglTexture),Le.depthTexture&&Le.depthTexture.dispose(),Le.isWebGLCubeRenderTarget)for(var Lt=0;Lt<6;Lt++)a.deleteFramebuffer(Ee.__webglFramebuffer[Lt]),Ee.__webglDepthbuffer&&a.deleteRenderbuffer(Ee.__webglDepthbuffer[Lt]);else a.deleteFramebuffer(Ee.__webglFramebuffer),Ee.__webglDepthbuffer&&a.deleteRenderbuffer(Ee.__webglDepthbuffer),Ee.__webglMultisampledFramebuffer&&a.deleteFramebuffer(Ee.__webglMultisampledFramebuffer),Ee.__webglColorRenderbuffer&&a.deleteRenderbuffer(Ee.__webglColorRenderbuffer),Ee.__webglDepthRenderbuffer&&a.deleteRenderbuffer(Ee.__webglDepthRenderbuffer);r.remove(Le.texture),r.remove(Le)}}var Ae=0;function Be(){Ae=0}function Se(){var Le=Ae;return Le>=C&&console.warn("THREE.WebGLTextures: Trying to use "+Le+" texture units while this GPU supports only "+C),Ae+=1,Le}function Te(Le,Ee){var Ot=r.get(Le);if(Le.isVideoTexture&&hn(Le),Le.version>0&&Ot.__version!==Le.version){var Lt=Le.image;if(Lt===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(Lt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Vt(Ot,Le,Ee);return}}i.activeTexture(33984+Ee),i.bindTexture(3553,Ot.__webglTexture)}function me(Le,Ee){var Ot=r.get(Le);if(Le.version>0&&Ot.__version!==Le.version){Vt(Ot,Le,Ee);return}i.activeTexture(33984+Ee),i.bindTexture(35866,Ot.__webglTexture)}function Ue(Le,Ee){var Ot=r.get(Le);if(Le.version>0&&Ot.__version!==Le.version){Vt(Ot,Le,Ee);return}i.activeTexture(33984+Ee),i.bindTexture(32879,Ot.__webglTexture)}function He(Le,Ee){var Ot=r.get(Le);if(Le.version>0&&Ot.__version!==Le.version){Ke(Ot,Le,Ee);return}i.activeTexture(33984+Ee),i.bindTexture(34067,Ot.__webglTexture)}var Qe=(c={},c[Ar]=10497,c[Jt]=33071,c[ir]=33648,c),qe=(h={},h[ar]=9728,h[yn]=9984,h[An]=9986,h[nt]=9729,h[Et]=9985,h[or]=9987,h);function gt(Le,Ee,Ot){Ot?(a.texParameteri(Le,10242,Qe[Ee.wrapS]),a.texParameteri(Le,10243,Qe[Ee.wrapT]),(Le===32879||Le===35866)&&a.texParameteri(Le,32882,Qe[Ee.wrapR]),a.texParameteri(Le,10240,qe[Ee.magFilter]),a.texParameteri(Le,10241,qe[Ee.minFilter])):(a.texParameteri(Le,10242,33071),a.texParameteri(Le,10243,33071),(Le===32879||Le===35866)&&a.texParameteri(Le,32882,33071),(Ee.wrapS!==Jt||Ee.wrapT!==Jt)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),a.texParameteri(Le,10240,Me(Ee.magFilter)),a.texParameteri(Le,10241,Me(Ee.minFilter)),Ee.minFilter!==ar&&Ee.minFilter!==nt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var Lt=t.get("EXT_texture_filter_anisotropic");if(Lt){if(Ee.type===Xr&&t.get("OES_texture_float_linear")===null||Ee.type===fn&&(p||t.get("OES_texture_half_float_linear"))===null)return;(Ee.anisotropy>1||r.get(Ee).__currentAnisotropy)&&(a.texParameterf(Le,Lt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ee.anisotropy,n.getMaxAnisotropy())),r.get(Ee).__currentAnisotropy=Ee.anisotropy)}}function St(Le,Ee){Le.__webglInit===void 0&&(Le.__webglInit=!0,Ee.addEventListener("dispose",xe),Le.__webglTexture=a.createTexture(),s.memory.textures++)}function Vt(Le,Ee,Ot){var Lt=3553;Ee.isDataTexture2DArray&&(Lt=35866),Ee.isDataTexture3D&&(Lt=32879),St(Le,Ee),i.activeTexture(33984+Ot),i.bindTexture(Lt,Le.__webglTexture),a.pixelStorei(37440,Ee.flipY),a.pixelStorei(37441,Ee.premultiplyAlpha),a.pixelStorei(3317,Ee.unpackAlignment);var Er=he(Ee)&&te(Ee.image)===!1,ze=B(Ee.image,Er,!1,S),zt=te(ze)||p,Ht=o.convert(Ee.format),lr=o.convert(Ee.type),Ft=le(Ee.internalFormat,Ht,lr);gt(Lt,Ee,zt);var _t,_r=Ee.mipmaps;if(Ee.isDepthTexture)Ft=6402,p?Ee.type===Xr?Ft=36012:Ee.type===en?Ft=33190:Ee.type===Ui?Ft=35056:Ft=33189:Ee.type===Xr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Ee.format===$e&&Ft===6402&&Ee.type!==Hr&&Ee.type!==en&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Ee.type=Hr,lr=o.convert(Ee.type)),Ee.format===Xe&&Ft===6402&&(Ft=34041,Ee.type!==Ui&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Ee.type=Ui,lr=o.convert(Ee.type))),i.texImage2D(3553,0,Ft,ze.width,ze.height,0,Ht,lr,null);else if(Ee.isDataTexture)if(_r.length>0&&zt){for(var Nr=0,Bn=_r.length;Nr<Bn;Nr++)_t=_r[Nr],i.texImage2D(3553,Nr,Ft,_t.width,_t.height,0,Ht,lr,_t.data);Ee.generateMipmaps=!1,Le.__maxMipLevel=_r.length-1}else i.texImage2D(3553,0,Ft,ze.width,ze.height,0,Ht,lr,ze.data),Le.__maxMipLevel=0;else if(Ee.isCompressedTexture){for(var gn=0,tn=_r.length;gn<tn;gn++)_t=_r[gn],Ee.format!==ti&&Ee.format!==Hi?Ht!==null?i.compressedTexImage2D(3553,gn,Ft,_t.width,_t.height,0,_t.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,gn,Ft,_t.width,_t.height,0,Ht,lr,_t.data);Le.__maxMipLevel=_r.length-1}else if(Ee.isDataTexture2DArray)i.texImage3D(35866,0,Ft,ze.width,ze.height,ze.depth,0,Ht,lr,ze.data),Le.__maxMipLevel=0;else if(Ee.isDataTexture3D)i.texImage3D(32879,0,Ft,ze.width,ze.height,ze.depth,0,Ht,lr,ze.data),Le.__maxMipLevel=0;else if(_r.length>0&&zt){for(var on=0,Wn=_r.length;on<Wn;on++)_t=_r[on],i.texImage2D(3553,on,Ft,Ht,lr,_t);Ee.generateMipmaps=!1,Le.__maxMipLevel=_r.length-1}else i.texImage2D(3553,0,Ft,Ht,lr,ze),Le.__maxMipLevel=0;K(Ee,zt)&&Q(Lt,Ee,ze.width,ze.height),Le.__version=Ee.version,Ee.onUpdate&&Ee.onUpdate(Ee)}function Ke(Le,Ee,Ot){if(Ee.image.length===6){St(Le,Ee),i.activeTexture(33984+Ot),i.bindTexture(34067,Le.__webglTexture),a.pixelStorei(37440,Ee.flipY),a.pixelStorei(37441,Ee.premultiplyAlpha),a.pixelStorei(3317,Ee.unpackAlignment);for(var Lt=Ee&&(Ee.isCompressedTexture||Ee.image[0].isCompressedTexture),Er=Ee.image[0]&&Ee.image[0].isDataTexture,ze=[],zt=0;zt<6;zt++)!Lt&&!Er?ze[zt]=B(Ee.image[zt],!1,!0,_):ze[zt]=Er?Ee.image[zt].image:Ee.image[zt];var Ht=ze[0],lr=te(Ht)||p,Ft=o.convert(Ee.format),_t=o.convert(Ee.type),_r=le(Ee.internalFormat,Ft,_t);gt(34067,Ee,lr);var Nr;if(Lt){for(var Bn=0;Bn<6;Bn++){Nr=ze[Bn].mipmaps;for(var gn=0;gn<Nr.length;gn++){var tn=Nr[gn];Ee.format!==ti&&Ee.format!==Hi?Ft!==null?i.compressedTexImage2D(34069+Bn,gn,_r,tn.width,tn.height,0,tn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+Bn,gn,_r,tn.width,tn.height,0,Ft,_t,tn.data)}}Le.__maxMipLevel=Nr.length-1}else{Nr=Ee.mipmaps;for(var on=0;on<6;on++)if(Er){i.texImage2D(34069+on,0,_r,ze[on].width,ze[on].height,0,Ft,_t,ze[on].data);for(var Wn=0;Wn<Nr.length;Wn++){var Ps=Nr[Wn],yo=Ps.image[on].image;i.texImage2D(34069+on,Wn+1,_r,yo.width,yo.height,0,Ft,_t,yo.data)}}else{i.texImage2D(34069+on,0,_r,Ft,_t,ze[on]);for(var la=0;la<Nr.length;la++){var Ga=Nr[la];i.texImage2D(34069+on,la+1,_r,Ft,_t,Ga.image[on])}}Le.__maxMipLevel=Nr.length}K(Ee,lr)&&Q(34067,Ee,Ht.width,Ht.height),Le.__version=Ee.version,Ee.onUpdate&&Ee.onUpdate(Ee)}}function rr(Le,Ee,Ot,Lt){var Er=o.convert(Ee.texture.format),ze=o.convert(Ee.texture.type),zt=le(Ee.texture.internalFormat,Er,ze);i.texImage2D(Lt,0,zt,Ee.width,Ee.height,0,Er,ze,null),a.bindFramebuffer(36160,Le),a.framebufferTexture2D(36160,Ot,Lt,r.get(Ee.texture).__webglTexture,0),a.bindFramebuffer(36160,null)}function Bt(Le,Ee,Ot){if(a.bindRenderbuffer(36161,Le),Ee.depthBuffer&&!Ee.stencilBuffer){var Lt=33189;if(Ot){var Er=Ee.depthTexture;Er&&Er.isDepthTexture&&(Er.type===Xr?Lt=36012:Er.type===en&&(Lt=33190));var ze=Qr(Ee);a.renderbufferStorageMultisample(36161,ze,Lt,Ee.width,Ee.height)}else a.renderbufferStorage(36161,Lt,Ee.width,Ee.height);a.framebufferRenderbuffer(36160,36096,36161,Le)}else if(Ee.depthBuffer&&Ee.stencilBuffer){if(Ot){var zt=Qr(Ee);a.renderbufferStorageMultisample(36161,zt,35056,Ee.width,Ee.height)}else a.renderbufferStorage(36161,34041,Ee.width,Ee.height);a.framebufferRenderbuffer(36160,33306,36161,Le)}else{var Ht=o.convert(Ee.texture.format),lr=o.convert(Ee.texture.type),Ft=le(Ee.texture.internalFormat,Ht,lr);if(Ot){var _t=Qr(Ee);a.renderbufferStorageMultisample(36161,_t,Ft,Ee.width,Ee.height)}else a.renderbufferStorage(36161,Ft,Ee.width,Ee.height)}a.bindRenderbuffer(36161,null)}function sr(Le,Ee){var Ot=Ee&&Ee.isWebGLCubeRenderTarget;if(Ot)throw new Error("Depth Texture with cube render targets is not supported");if(a.bindFramebuffer(36160,Le),!(Ee.depthTexture&&Ee.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(Ee.depthTexture).__webglTexture||Ee.depthTexture.image.width!==Ee.width||Ee.depthTexture.image.height!==Ee.height)&&(Ee.depthTexture.image.width=Ee.width,Ee.depthTexture.image.height=Ee.height,Ee.depthTexture.needsUpdate=!0),Te(Ee.depthTexture,0);var Lt=r.get(Ee.depthTexture).__webglTexture;if(Ee.depthTexture.format===$e)a.framebufferTexture2D(36160,36096,3553,Lt,0);else if(Ee.depthTexture.format===Xe)a.framebufferTexture2D(36160,33306,3553,Lt,0);else throw new Error("Unknown depthTexture format")}function xr(Le){var Ee=r.get(Le),Ot=Le.isWebGLCubeRenderTarget===!0;if(Le.depthTexture){if(Ot)throw new Error("target.depthTexture not supported in Cube render targets");sr(Ee.__webglFramebuffer,Le)}else if(Ot){Ee.__webglDepthbuffer=[];for(var Lt=0;Lt<6;Lt++)a.bindFramebuffer(36160,Ee.__webglFramebuffer[Lt]),Ee.__webglDepthbuffer[Lt]=a.createRenderbuffer(),Bt(Ee.__webglDepthbuffer[Lt],Le,!1)}else a.bindFramebuffer(36160,Ee.__webglFramebuffer),Ee.__webglDepthbuffer=a.createRenderbuffer(),Bt(Ee.__webglDepthbuffer,Le,!1);a.bindFramebuffer(36160,null)}function Fr(Le){var Ee=r.get(Le),Ot=r.get(Le.texture);Le.addEventListener("dispose",_e),Ot.__webglTexture=a.createTexture(),s.memory.textures++;var Lt=Le.isWebGLCubeRenderTarget===!0,Er=Le.isWebGLMultisampleRenderTarget===!0,ze=te(Le)||p;if(p&&Le.texture.format===Hi&&(Le.texture.type===Xr||Le.texture.type===fn)&&(Le.texture.format=ti,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Lt){Ee.__webglFramebuffer=[];for(var zt=0;zt<6;zt++)Ee.__webglFramebuffer[zt]=a.createFramebuffer()}else if(Ee.__webglFramebuffer=a.createFramebuffer(),Er)if(p){Ee.__webglMultisampledFramebuffer=a.createFramebuffer(),Ee.__webglColorRenderbuffer=a.createRenderbuffer(),a.bindRenderbuffer(36161,Ee.__webglColorRenderbuffer);var Ht=o.convert(Le.texture.format),lr=o.convert(Le.texture.type),Ft=le(Le.texture.internalFormat,Ht,lr),_t=Qr(Le);a.renderbufferStorageMultisample(36161,_t,Ft,Le.width,Le.height),a.bindFramebuffer(36160,Ee.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(36160,36064,36161,Ee.__webglColorRenderbuffer),a.bindRenderbuffer(36161,null),Le.depthBuffer&&(Ee.__webglDepthRenderbuffer=a.createRenderbuffer(),Bt(Ee.__webglDepthRenderbuffer,Le,!0)),a.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Lt){i.bindTexture(34067,Ot.__webglTexture),gt(34067,Le.texture,ze);for(var _r=0;_r<6;_r++)rr(Ee.__webglFramebuffer[_r],Le,36064,34069+_r);K(Le.texture,ze)&&Q(34067,Le.texture,Le.width,Le.height),i.bindTexture(34067,null)}else i.bindTexture(3553,Ot.__webglTexture),gt(3553,Le.texture,ze),rr(Ee.__webglFramebuffer,Le,36064,3553),K(Le.texture,ze)&&Q(3553,Le.texture,Le.width,Le.height),i.bindTexture(3553,null);Le.depthBuffer&&xr(Le)}function Sr(Le){var Ee=Le.texture,Ot=te(Le)||p;if(K(Ee,Ot)){var Lt=Le.isWebGLCubeRenderTarget?34067:3553,Er=r.get(Ee).__webglTexture;i.bindTexture(Lt,Er),Q(Lt,Ee,Le.width,Le.height),i.bindTexture(Lt,null)}}function mn(Le){if(Le.isWebGLMultisampleRenderTarget)if(p){var Ee=r.get(Le);a.bindFramebuffer(36008,Ee.__webglMultisampledFramebuffer),a.bindFramebuffer(36009,Ee.__webglFramebuffer);var Ot=Le.width,Lt=Le.height,Er=16384;Le.depthBuffer&&(Er|=256),Le.stencilBuffer&&(Er|=1024),a.blitFramebuffer(0,0,Ot,Lt,0,0,Ot,Lt,Er,9728),a.bindFramebuffer(36160,Ee.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function Qr(Le){return p&&Le.isWebGLMultisampleRenderTarget?Math.min(D,Le.samples):0}function hn(Le){var Ee=s.render.frame;P.get(Le)!==Ee&&(P.set(Le,Ee),Le.update())}var zn=!1,fi=!1;function Kn(Le,Ee){Le&&Le.isWebGLRenderTarget&&(zn===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),zn=!0),Le=Le.texture),Te(Le,Ee)}function Un(Le,Ee){Le&&Le.isWebGLCubeRenderTarget&&(fi===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),fi=!0),Le=Le.texture),He(Le,Ee)}this.allocateTextureUnit=Se,this.resetTextureUnits=Be,this.setTexture2D=Te,this.setTexture2DArray=me,this.setTexture3D=Ue,this.setTextureCube=He,this.setupRenderTarget=Fr,this.updateRenderTargetMipmap=Sr,this.updateMultisampleRenderTarget=mn,this.safeSetTexture2D=Kn,this.safeSetTextureCube=Un}function xd(a,t,i){var r=i.isWebGL2;function n(o){var s;if(o===cr)return 5121;if(o===Mi)return 32819;if(o===ai)return 32820;if(o===rn)return 33635;if(o===Pr)return 5120;if(o===$r)return 5122;if(o===Hr)return 5123;if(o===Xn)return 5124;if(o===en)return 5125;if(o===Xr)return 5126;if(o===fn)return r?5131:(s=t.get("OES_texture_half_float"),s!==null?s.HALF_FLOAT_OES:null);if(o===ei)return 6406;if(o===Hi)return 6407;if(o===ti)return 6408;if(o===se)return 6409;if(o===be)return 6410;if(o===$e)return 6402;if(o===Xe)return 34041;if(o===ft)return 6403;if(o===Tt)return 36244;if(o===Gt)return 33319;if(o===Ct)return 33320;if(o===ut)return 36248;if(o===Xt)return 36249;if(o===Kt||o===vr||o===bn||o===Gr)if(s=t.get("WEBGL_compressed_texture_s3tc"),s!==null){if(o===Kt)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===vr)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===bn)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===Gr)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(o===Cr||o===Yr||o===Tn||o===Jn)if(s=t.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(o===Cr)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===Yr)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===Tn)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===Jn)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(o===mr)return s=t.get("WEBGL_compressed_texture_etc1"),s!==null?s.COMPRESSED_RGB_ETC1_WEBGL:null;if((o===Ir||o===Br)&&(s=t.get("WEBGL_compressed_texture_etc"),s!==null)){if(o===Ir)return s.COMPRESSED_RGB8_ETC2;if(o===Br)return s.COMPRESSED_RGBA8_ETC2_EAC}if(o===gi||o===pn||o===En||o===I||o===k||o===X||o===q||o===de||o===Re||o===Ge||o===vt||o===pt||o===We||o===et||o===Ut||o===Yt||o===er||o===Lr||o===br||o===ur||o===cn||o===On||o===Hn||o===Sn||o===Qn||o===oi||o===si||o===li)return s=t.get("WEBGL_compressed_texture_astc"),s!==null?o:null;if(o===At)return s=t.get("EXT_texture_compression_bptc"),s!==null?o:null;if(o===Ui)return r?34042:(s=t.get("WEBGL_depth_texture"),s!==null?s.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:n}}function Fa(){Qt.call(this),this.type="Group"}Fa.prototype=Object.assign(Object.create(Qt.prototype),{constructor:Fa,isGroup:!0});function $s(a){a===void 0&&(a=[]),Nn.call(this),this.cameras=a}$s.prototype=Object.assign(Object.create(Nn.prototype),{constructor:$s,isArrayCamera:!0});var Md=new fe,Td=new fe;function X0(a,t,i){Md.setFromMatrixPosition(t.matrixWorld),Td.setFromMatrixPosition(i.matrixWorld);var r=Md.distanceTo(Td),n=t.projectionMatrix.elements,o=i.projectionMatrix.elements,s=n[14]/(n[10]-1),c=n[14]/(n[10]+1),h=(n[9]+1)/n[5],p=(n[9]-1)/n[5],C=(n[8]-1)/n[0],_=(o[8]+1)/o[0],S=s*C,D=s*_,P=r/(-C+_),H=P*-C;t.matrixWorld.decompose(a.position,a.quaternion,a.scale),a.translateX(H),a.translateZ(P),a.matrixWorld.compose(a.position,a.quaternion,a.scale),a.matrixWorldInverse.getInverse(a.matrixWorld);var W=s+P,G=c+P,B=S-H,te=D+(r-H),he=h*c/G*W,K=p*c/G*W;a.projectionMatrix.makePerspective(B,te,he,K,W,G)}function Sd(a){var t,i,r=this,n=null,o=null,s=null,c=[],h=new kr,p=new kr,C=1,_="local-floor";typeof window<"u"&&"VRFrameData"in window&&(o=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",he,!1));var S=new kr,D=new ni,P=new fe,H=new Nn;H.viewport=new un,H.layers.enable(1);var W=new Nn;W.viewport=new un,W.layers.enable(2);var G=new $s([H,W]);G.layers.enable(1),G.layers.enable(2);var B=new bt,te;function he(){var Pe=r.isPresenting=n!==null&&n.isPresenting===!0;if(Pe){var Ce=n.getEyeParameters("left");t=2*Ce.renderWidth*C,i=Ce.renderHeight*C,te=a.getPixelRatio(),a.getSize(B),a.setDrawingBufferSize(t,i,1),H.viewport.set(0,0,t/2,i),W.viewport.set(t/2,0,t/2,i),_e.start(),r.dispatchEvent({type:"sessionstart"})}else r.enabled&&a.setDrawingBufferSize(B.width,B.height,te),_e.stop(),r.dispatchEvent({type:"sessionend"})}var K=[],Q=[];function le(Pe){for(var Ce=navigator.getGamepads&&navigator.getGamepads(),Ae=0,Be=Ce.length;Ae<Be;Ae++){var Se=Ce[Ae];if(Se&&(Se.id==="Daydream Controller"||Se.id==="Gear VR Controller"||Se.id==="Oculus Go Controller"||Se.id==="OpenVR Gamepad"||Se.id.startsWith("Oculus Touch")||Se.id.startsWith("HTC Vive Focus")||Se.id.startsWith("Spatial Controller"))){var Te=Se.hand;if(Pe===0&&(Te===""||Te==="right")||Pe===1&&Te==="left")return Se}}}function Me(){for(var Pe=0;Pe<c.length;Pe++){var Ce=c[Pe],Ae=le(Pe);if(Ae!==void 0&&Ae.pose!==void 0){if(Ae.pose===null)return;var Be=Ae.pose;Be.hasPosition===!1&&Ce.position.set(.2,-.6,-.05),Be.position!==null&&Ce.position.fromArray(Be.position),Be.orientation!==null&&Ce.quaternion.fromArray(Be.orientation),Ce.matrix.compose(Ce.position,Ce.quaternion,Ce.scale),Ce.matrix.premultiply(h),Ce.matrix.decompose(Ce.position,Ce.quaternion,Ce.scale),Ce.matrixWorldNeedsUpdate=!0,Ce.visible=!0;var Se=Ae.id==="Daydream Controller"?0:1;K[Pe]===void 0&&(K[Pe]=!1),K[Pe]!==Ae.buttons[Se].pressed&&(K[Pe]=Ae.buttons[Se].pressed,K[Pe]===!0?Ce.dispatchEvent({type:"selectstart"}):(Ce.dispatchEvent({type:"selectend"}),Ce.dispatchEvent({type:"select"}))),Se=2,Q[Pe]===void 0&&(Q[Pe]=!1),Ae.buttons[Se]!==void 0&&Q[Pe]!==Ae.buttons[Se].pressed&&(Q[Pe]=Ae.buttons[Se].pressed,Q[Pe]===!0?Ce.dispatchEvent({type:"squeezestart"}):(Ce.dispatchEvent({type:"squeezeend"}),Ce.dispatchEvent({type:"squeeze"})))}else Ce.visible=!1}}function xe(Pe,Ce){Ce!==null&&Ce.length===4&&Pe.set(Ce[0]*t,Ce[1]*i,Ce[2]*t,Ce[3]*i)}this.enabled=!1,this.getController=function(Pe){var Ce=c[Pe];return Ce===void 0&&(Ce=new Fa,Ce.matrixAutoUpdate=!1,Ce.visible=!1,c[Pe]=Ce),Ce},this.getDevice=function(){return n},this.setDevice=function(Pe){Pe!==void 0&&(n=Pe),_e.setContext(Pe)},this.setFramebufferScaleFactor=function(Pe){C=Pe},this.setReferenceSpaceType=function(Pe){_=Pe},this.setPoseTarget=function(Pe){Pe!==void 0&&(s=Pe)},this.getCamera=function(Pe){var Ce=_==="local-floor"?1.6:0;if(n.depthNear=Pe.near,n.depthFar=Pe.far,n.getFrameData(o),_==="local-floor"){var Ae=n.stageParameters;Ae?h.fromArray(Ae.sittingToStandingTransform):h.makeTranslation(0,Ce,0)}var Be=o.pose,Se=s!==null?s:Pe;Se.matrix.copy(h),Se.matrix.decompose(Se.position,Se.quaternion,Se.scale),Be.orientation!==null&&(D.fromArray(Be.orientation),Se.quaternion.multiply(D)),Be.position!==null&&(D.setFromRotationMatrix(h),P.fromArray(Be.position),P.applyQuaternion(D),Se.position.add(P)),Se.updateMatrixWorld();for(var Te=Se.children,me=0,Ue=Te.length;me<Ue;me++)Te[me].updateMatrixWorld(!0);H.near=Pe.near,W.near=Pe.near,H.far=Pe.far,W.far=Pe.far,H.matrixWorldInverse.fromArray(o.leftViewMatrix),W.matrixWorldInverse.fromArray(o.rightViewMatrix),p.getInverse(h),_==="local-floor"&&(H.matrixWorldInverse.multiply(p),W.matrixWorldInverse.multiply(p));var He=Se.parent;He!==null&&(S.getInverse(He.matrixWorld),H.matrixWorldInverse.multiply(S),W.matrixWorldInverse.multiply(S)),H.matrixWorld.getInverse(H.matrixWorldInverse),W.matrixWorld.getInverse(W.matrixWorldInverse),H.projectionMatrix.fromArray(o.leftProjectionMatrix),W.projectionMatrix.fromArray(o.rightProjectionMatrix),X0(G,H,W);var Qe=n.getLayers();if(Qe.length){var qe=Qe[0];xe(H.viewport,qe.leftBounds),xe(W.viewport,qe.rightBounds)}return Me(),G},this.getStandingMatrix=function(){return h},this.isPresenting=!1;var _e=new Du;this.setAnimationLoop=function(Pe){_e.setAnimationLoop(Pe),this.isPresenting&&_e.start()},this.submitFrame=function(){this.isPresenting&&n.submitFrame()},this.dispose=function(){typeof window<"u"&&window.removeEventListener("vrdisplaypresentchange",he)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}Object.assign(Sd.prototype,pa.prototype);function el(){this._targetRay=null,this._grip=null,this._hand=null}Object.assign(el.prototype,{constructor:el,getHandSpace:function(){return this._hand===null&&(this._hand=new Fa,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new Fa,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new Fa,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(t,i,r){var n=null,o=null,s=null,c=this._targetRay,h=this._grip,p=this._hand;if(t&&i.session.visibilityState!=="visible-blurred")if(p&&t.hand){s=!0;for(var C=Op(t.hand.values()),_;!(_=C()).done;){var S=_.value,D=i.getJointPose(S,r);if(p.joints[S.jointName]===void 0){var P=new Fa;P.matrixAutoUpdate=!1,P.visible=!1,p.joints[S.jointName]=P,p.add(P)}var H=p.joints[S.jointName];D!==null&&(H.matrix.fromArray(D.transform.matrix),H.matrix.decompose(H.position,H.rotation,H.scale),H.jointRadius=D.radius),H.visible=D!==null}var W=p.joints["index-finger-tip"],G=p.joints["thumb-tip"],B=W.position.distanceTo(G.position),te=.02,he=.005;p.inputState.pinching&&B>te+he?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!p.inputState.pinching&&B<=te-he&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else c!==null&&(n=i.getPose(t.targetRaySpace,r),n!==null&&(c.matrix.fromArray(n.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale))),h!==null&&t.gripSpace&&(o=i.getPose(t.gripSpace,r),o!==null&&(h.matrix.fromArray(o.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale)));return c!==null&&(c.visible=n!==null),h!==null&&(h.visible=o!==null),p!==null&&(p.visible=s!==null),this}});function _d(a,t){var i=this,r=null,n=1,o=null,s="local-floor",c=null,h=null,p=[],C=new Map,_=[],S,D=new Nn;D.layers.enable(1),D.viewport=new un;var P=new Nn;P.layers.enable(2),P.viewport=new un;var H=[D,P],W=new $s;W.layers.enable(1),W.layers.enable(2);var G=null,B=null;this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.getCameraPose=function(){return c},this.getController=function(Ae){var Be=p[Ae];return Be===void 0&&(Be=new el,p[Ae]=Be),Be.getTargetRaySpace()},this.getControllerGrip=function(Ae){var Be=p[Ae];return Be===void 0&&(Be=new el,p[Ae]=Be),Be.getGripSpace()},this.getHand=function(Ae){var Be=p[Ae];return Be===void 0&&(Be=new el,p[Ae]=Be),Be.getHandSpace()};function te(Ae){var Be=C.get(Ae.inputSource);Be&&Be.dispatchEvent({type:Ae.type,data:Ae.inputSource})}function he(){C.forEach(function(Ae,Be){Ae.disconnect(Be)}),C.clear(),G=null,B=null,a.setFramebuffer(null),a.setRenderTarget(a.getRenderTarget()),Ce.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Ae){n=Ae,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ae){s=Ae,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getSession=function(){return r},this.setSession=function(){var Ae=Rp(regeneratorRuntime.mark(function Be(Se){var Te,me;return regeneratorRuntime.wrap(function(He){for(;;)switch(He.prev=He.next){case 0:if(r=Se,r===null){He.next=24;break}if(r.addEventListener("select",te),r.addEventListener("selectstart",te),r.addEventListener("selectend",te),r.addEventListener("squeeze",te),r.addEventListener("squeezestart",te),r.addEventListener("squeezeend",te),r.addEventListener("end",he),r.addEventListener("inputsourceschange",K),Te=t.getContextAttributes(),Te.xrCompatible===!0){He.next=14;break}return He.next=14,t.makeXRCompatible();case 14:return me={antialias:Te.antialias,alpha:Te.alpha,depth:Te.depth,stencil:Te.stencil,framebufferScaleFactor:n},S=new XRWebGLLayer(r,t,me),window.XRWebGLBinding&&this.layersEnabled?this.addLayer(S):r.updateRenderState({baseLayer:S}),He.next=19,r.requestReferenceSpace(s);case 19:o=He.sent,Ce.setContext(r),Ce.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"});case 24:case"end":return He.stop()}},Be,this)}));return function(Be){return Ae.apply(this,arguments)}}(),this.addLayer=function(Ae){!window.XRWebGLBinding||!this.layersEnabled||!r||(_.push(Ae),r.updateRenderState({layers:_}))},this.removeLayer=function(Ae){!window.XRWebGLBinding||!this.layersEnabled||!r||(_.splice(_.indexOf(Ae),1),r.updateRenderState({layers:_}))};function K(Ae){for(var Be=r.inputSources,Se=0;Se<p.length;Se++)C.set(Be[Se],p[Se]);for(var Te=0;Te<Ae.removed.length;Te++){var me=Ae.removed[Te],Ue=C.get(me);Ue&&(Ue.dispatchEvent({type:"disconnected",data:me}),C.delete(me))}for(var He=0;He<Ae.added.length;He++){var Qe=Ae.added[He],qe=C.get(Qe);qe&&qe.dispatchEvent({type:"connected",data:Qe})}}var Q=new fe,le=new fe;function Me(Ae,Be,Se){Q.setFromMatrixPosition(Be.matrixWorld),le.setFromMatrixPosition(Se.matrixWorld);var Te=Q.distanceTo(le),me=Be.projectionMatrix.elements,Ue=Se.projectionMatrix.elements,He=me[14]/(me[10]-1),Qe=me[14]/(me[10]+1),qe=(me[9]+1)/me[5],gt=(me[9]-1)/me[5],St=(me[8]-1)/me[0],Vt=(Ue[8]+1)/Ue[0],Ke=He*St,rr=He*Vt,Bt=Te/(-St+Vt),sr=Bt*-St;Be.matrixWorld.decompose(Ae.position,Ae.quaternion,Ae.scale),Ae.translateX(sr),Ae.translateZ(Bt),Ae.matrixWorld.compose(Ae.position,Ae.quaternion,Ae.scale),Ae.matrixWorldInverse.copy(Ae.matrixWorld).invert();var xr=He+Bt,Fr=Qe+Bt,Sr=Ke-sr,mn=rr+(Te-sr),Qr=qe*Qe/Fr*xr,hn=gt*Qe/Fr*xr;Ae.projectionMatrix.makePerspective(Sr,mn,Qr,hn,xr,Fr)}function xe(Ae,Be){Be===null?Ae.matrixWorld.copy(Ae.matrix):Ae.matrixWorld.multiplyMatrices(Be.matrixWorld,Ae.matrix),Ae.matrixWorldInverse.copy(Ae.matrixWorld).invert()}this.setPoseTarget=function(Ae){Ae!==void 0&&(h=Ae)},this.getCamera=function(Ae){W.near=P.near=D.near=Ae.near,W.far=P.far=D.far=Ae.far,(G!==W.near||B!==W.far)&&(r.updateRenderState({depthNear:W.near,depthFar:W.far}),G=W.near,B=W.far);var Be=Ae.parent,Se=W.cameras,Te=h||Ae;xe(W,Be);for(var me=0;me<Se.length;me++)xe(Se[me],Be);Te.matrixWorld.copy(W.matrixWorld);for(var Ue=Te.children,He=0,Qe=Ue.length;He<Qe;He++)Ue[He].updateMatrixWorld(!0);return Se.length===2?Me(W,D,P):W.projectionMatrix.copy(D.projectionMatrix),W};var _e=null;function Pe(Ae,Be){if(c=Be.getViewerPose(o),c!==null){var Se=c.views;a.setFramebuffer(S.framebuffer);var Te=!1;Se.length!==W.cameras.length&&(W.cameras.length=0,Te=!0);for(var me=0;me<Se.length;me++){var Ue=Se[me],He=S.getViewport(Ue),Qe=H[me];Qe.matrix.fromArray(Ue.transform.matrix),Qe.projectionMatrix.fromArray(Ue.projectionMatrix),Qe.viewport.set(He.x,He.y,He.width,He.height),me===0&&W.matrix.copy(Qe.matrix),Te===!0&&W.cameras.push(Qe)}}for(var qe=r.inputSources,gt=0;gt<p.length;gt++){var St=p[gt],Vt=qe[gt];St.update(Vt,Be,o)}_e&&_e(Ae,Be)}var Ce=new Du;Ce.setAnimationLoop(Pe),this.setAnimationLoop=function(Ae){_e=Ae},this.dispose=function(){}}Object.assign(_d.prototype,pa.prototype);function Y0(a){function t(G,B){G.fogColor.value.copy(B.color),B.isFog?(G.fogNear.value=B.near,G.fogFar.value=B.far):B.isFogExp2&&(G.fogDensity.value=B.density)}function i(G,B,te,he){B.isMeshBasicMaterial?r(G,B):B.isMeshLambertMaterial?(r(G,B),h(G,B)):B.isMeshToonMaterial?(r(G,B),C(G,B)):B.isMeshPhongMaterial?(r(G,B),p(G,B)):B.isMeshStandardMaterial?(r(G,B),B.isMeshPhysicalMaterial?S(G,B):_(G,B)):B.isMeshMatcapMaterial?(r(G,B),D(G,B)):B.isMeshDepthMaterial?(r(G,B),P(G,B)):B.isMeshDistanceMaterial?(r(G,B),H(G,B)):B.isMeshNormalMaterial?(r(G,B),W(G,B)):B.isLineBasicMaterial?(n(G,B),B.isLineDashedMaterial&&o(G,B)):B.isPointsMaterial?s(G,B,te,he):B.isSpriteMaterial?c(G,B):B.isShadowMaterial?(G.color.value.copy(B.color),G.opacity.value=B.opacity):B.isShaderMaterial&&(B.uniformsNeedUpdate=!1)}function r(G,B){G.opacity.value=B.opacity,B.color&&G.diffuse.value.copy(B.color),B.emissive&&G.emissive.value.copy(B.emissive).multiplyScalar(B.emissiveIntensity),B.map&&(G.map.value=B.map),B.alphaMap&&(G.alphaMap.value=B.alphaMap),B.specularMap&&(G.specularMap.value=B.specularMap);var te=a.get(B).envMap;if(te){G.envMap.value=te,G.flipEnvMap.value=te.isCubeTexture&&te._needsFlipEnvMap?-1:1,G.reflectivity.value=B.reflectivity,G.refractionRatio.value=B.refractionRatio;var he=a.get(te).__maxMipLevel;he!==void 0&&(G.maxMipLevel.value=he)}B.lightMap&&(G.lightMap.value=B.lightMap,G.lightMapIntensity.value=B.lightMapIntensity),B.aoMap&&(G.aoMap.value=B.aoMap,G.aoMapIntensity.value=B.aoMapIntensity);var K;B.map?K=B.map:B.specularMap?K=B.specularMap:B.displacementMap?K=B.displacementMap:B.normalMap?K=B.normalMap:B.bumpMap?K=B.bumpMap:B.roughnessMap?K=B.roughnessMap:B.metalnessMap?K=B.metalnessMap:B.alphaMap?K=B.alphaMap:B.emissiveMap?K=B.emissiveMap:B.clearcoatMap?K=B.clearcoatMap:B.clearcoatNormalMap?K=B.clearcoatNormalMap:B.clearcoatRoughnessMap&&(K=B.clearcoatRoughnessMap),K!==void 0&&(K.isWebGLRenderTarget&&(K=K.texture),K.matrixAutoUpdate===!0&&K.updateMatrix(),G.uvTransform.value.copy(K.matrix));var Q;B.aoMap?Q=B.aoMap:B.lightMap&&(Q=B.lightMap),Q!==void 0&&(Q.isWebGLRenderTarget&&(Q=Q.texture),Q.matrixAutoUpdate===!0&&Q.updateMatrix(),G.uv2Transform.value.copy(Q.matrix))}function n(G,B){G.diffuse.value.copy(B.color),G.opacity.value=B.opacity}function o(G,B){G.dashSize.value=B.dashSize,G.totalSize.value=B.dashSize+B.gapSize,G.scale.value=B.scale}function s(G,B,te,he){G.diffuse.value.copy(B.color),G.opacity.value=B.opacity,G.size.value=B.size*te,G.scale.value=he*.5,B.map&&(G.map.value=B.map),B.alphaMap&&(G.alphaMap.value=B.alphaMap);var K;B.map?K=B.map:B.alphaMap&&(K=B.alphaMap),K!==void 0&&(K.matrixAutoUpdate===!0&&K.updateMatrix(),G.uvTransform.value.copy(K.matrix))}function c(G,B){G.diffuse.value.copy(B.color),G.opacity.value=B.opacity,G.rotation.value=B.rotation,B.map&&(G.map.value=B.map),B.alphaMap&&(G.alphaMap.value=B.alphaMap);var te;B.map?te=B.map:B.alphaMap&&(te=B.alphaMap),te!==void 0&&(te.matrixAutoUpdate===!0&&te.updateMatrix(),G.uvTransform.value.copy(te.matrix))}function h(G,B){B.emissiveMap&&(G.emissiveMap.value=B.emissiveMap)}function p(G,B){G.specular.value.copy(B.specular),G.shininess.value=Math.max(B.shininess,1e-4),B.emissiveMap&&(G.emissiveMap.value=B.emissiveMap),B.bumpMap&&(G.bumpMap.value=B.bumpMap,G.bumpScale.value=B.bumpScale,B.side===T&&(G.bumpScale.value*=-1)),B.normalMap&&(G.normalMap.value=B.normalMap,G.normalScale.value.copy(B.normalScale),B.side===T&&G.normalScale.value.negate()),B.displacementMap&&(G.displacementMap.value=B.displacementMap,G.displacementScale.value=B.displacementScale,G.displacementBias.value=B.displacementBias)}function C(G,B){B.gradientMap&&(G.gradientMap.value=B.gradientMap),B.emissiveMap&&(G.emissiveMap.value=B.emissiveMap),B.bumpMap&&(G.bumpMap.value=B.bumpMap,G.bumpScale.value=B.bumpScale,B.side===T&&(G.bumpScale.value*=-1)),B.normalMap&&(G.normalMap.value=B.normalMap,G.normalScale.value.copy(B.normalScale),B.side===T&&G.normalScale.value.negate()),B.displacementMap&&(G.displacementMap.value=B.displacementMap,G.displacementScale.value=B.displacementScale,G.displacementBias.value=B.displacementBias)}function _(G,B){G.roughness.value=B.roughness,G.metalness.value=B.metalness,B.roughnessMap&&(G.roughnessMap.value=B.roughnessMap),B.metalnessMap&&(G.metalnessMap.value=B.metalnessMap),B.emissiveMap&&(G.emissiveMap.value=B.emissiveMap),B.bumpMap&&(G.bumpMap.value=B.bumpMap,G.bumpScale.value=B.bumpScale,B.side===T&&(G.bumpScale.value*=-1)),B.normalMap&&(G.normalMap.value=B.normalMap,G.normalScale.value.copy(B.normalScale),B.side===T&&G.normalScale.value.negate()),B.displacementMap&&(G.displacementMap.value=B.displacementMap,G.displacementScale.value=B.displacementScale,G.displacementBias.value=B.displacementBias);var te=a.get(B).envMap;te&&(G.envMapIntensity.value=B.envMapIntensity)}function S(G,B){_(G,B),G.reflectivity.value=B.reflectivity,G.clearcoat.value=B.clearcoat,G.clearcoatRoughness.value=B.clearcoatRoughness,B.sheen&&G.sheen.value.copy(B.sheen),B.clearcoatMap&&(G.clearcoatMap.value=B.clearcoatMap),B.clearcoatRoughnessMap&&(G.clearcoatRoughnessMap.value=B.clearcoatRoughnessMap),B.clearcoatNormalMap&&(G.clearcoatNormalScale.value.copy(B.clearcoatNormalScale),G.clearcoatNormalMap.value=B.clearcoatNormalMap,B.side===T&&G.clearcoatNormalScale.value.negate()),G.transmission.value=B.transmission,B.transmissionMap&&(G.transmissionMap.value=B.transmissionMap)}function D(G,B){B.matcap&&(G.matcap.value=B.matcap),B.bumpMap&&(G.bumpMap.value=B.bumpMap,G.bumpScale.value=B.bumpScale,B.side===T&&(G.bumpScale.value*=-1)),B.normalMap&&(G.normalMap.value=B.normalMap,G.normalScale.value.copy(B.normalScale),B.side===T&&G.normalScale.value.negate()),B.displacementMap&&(G.displacementMap.value=B.displacementMap,G.displacementScale.value=B.displacementScale,G.displacementBias.value=B.displacementBias)}function P(G,B){B.displacementMap&&(G.displacementMap.value=B.displacementMap,G.displacementScale.value=B.displacementScale,G.displacementBias.value=B.displacementBias)}function H(G,B){B.displacementMap&&(G.displacementMap.value=B.displacementMap,G.displacementScale.value=B.displacementScale,G.displacementBias.value=B.displacementBias),G.referencePosition.value.copy(B.referencePosition),G.nearDistance.value=B.nearDistance,G.farDistance.value=B.farDistance}function W(G,B){B.bumpMap&&(G.bumpMap.value=B.bumpMap,G.bumpScale.value=B.bumpScale,B.side===T&&(G.bumpScale.value*=-1)),B.normalMap&&(G.normalMap.value=B.normalMap,G.normalScale.value.copy(B.normalScale),B.side===T&&G.normalScale.value.negate()),B.displacementMap&&(G.displacementMap.value=B.displacementMap,G.displacementScale.value=B.displacementScale,G.displacementBias.value=B.displacementBias)}return{refreshFogUniforms:t,refreshMaterialUniforms:i}}function Q0(){var a=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return a.style.display="block",a}function tl(a){a=a||{};var t=a.canvas!==void 0?a.canvas:Q0(),i=a.context!==void 0?a.context:null,r=a.alpha!==void 0?a.alpha:!1,n=a.depth!==void 0?a.depth:!0,o=a.stencil!==void 0?a.stencil:!0,s=a.antialias!==void 0?a.antialias:!1,c=a.premultipliedAlpha!==void 0?a.premultipliedAlpha:!0,h=a.preserveDrawingBuffer!==void 0?a.preserveDrawingBuffer:!1,p=a.powerPreference!==void 0?a.powerPreference:"default",C=a.failIfMajorPerformanceCaveat!==void 0?a.failIfMajorPerformanceCaveat:!1,_=null,S=null,D=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=yi,this.physicallyCorrectLights=!1,this.toneMapping=ot,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var P=this,H=!1,W=null,G=0,B=0,te=null,he=null,K=-1,Q=null,le=new un,Me=new un,xe=null,_e=t.width,Pe=t.height,Ce=1,Ae=null,Be=null,Se=new un(0,0,_e,Pe),Te=new un(0,0,_e,Pe),me=!1,Ue=new qs,He=!1,Qe=!1,qe=new kr,gt=new fe,St={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Vt(){return te===null?Ce:1}var Ke=i;function rr(pe,st){for(var Ze=0;Ze<pe.length;Ze++){var lt=pe[Ze],Dt=t.getContext(lt,st);if(Dt!==null)return Dt}return null}try{var Bt={alpha:r,depth:n,stencil:o,antialias:s,premultipliedAlpha:c,preserveDrawingBuffer:h,powerPreference:p,failIfMajorPerformanceCaveat:C};if(t.addEventListener("webglcontextlost",gn,!1),t.addEventListener("webglcontextrestored",tn,!1),Ke===null){var sr=["webgl2","webgl","experimental-webgl"];if(P.isWebGL1Renderer===!0&&sr.shift(),Ke=rr(sr,Bt),Ke===null)throw rr(sr)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Ke.getShaderPrecisionFormat===void 0&&(Ke.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(pe){throw console.error("THREE.WebGLRenderer: "+pe.message),pe}var xr,Fr,Sr,mn,Qr,hn,zn,fi,Kn,Un,Le,Ee,Ot,Lt,Er,ze,zt,Ht,lr,Ft,_t;function _r(){xr=new Tg(Ke),Fr=new wg(Ke,xr,a),xr.init(Fr),Ft=new xd(Ke,xr,Fr),Sr=new W0(Ke,xr,Fr),Sr.scissor(Me.copy(Te).multiplyScalar(Ce).floor()),Sr.viewport(le.copy(Se).multiplyScalar(Ce).floor()),mn=new Cg,Qr=new D0,hn=new j0(Ke,xr,Sr,Qr,Fr,Ft,mn),zn=new Mg(P),fi=new Zp(Ke,Fr),_t=new bg(Ke,xr,fi,Fr),Kn=new Sg(Ke,fi,mn,_t),Un=new Dg(Ke,Kn,fi,mn),zt=new Pg(Ke),Er=new xg(Qr),Le=new P0(P,zn,xr,Fr,_t,Er),Ee=new Y0(Qr),Ot=new B0(Qr),Lt=new G0(xr,Fr),ze=new Ag(P,zn,Sr,Un,c),Ht=new Eg(Ke,xr,mn,Fr),lr=new _g(Ke,xr,mn,Fr),mn.programs=Le.programs,P.capabilities=Fr,P.extensions=xr,P.properties=Qr,P.renderLists=Ot,P.state=Sr,P.info=mn}_r();var Nr=typeof navigator<"u"&&"xr"in navigator?new _d(P,Ke):new Sd(P);this.xr=Nr;var Bn=new wd(P,Un,Fr.maxTextureSize);this.shadowMap=Bn,this.getContext=function(){return Ke},this.getContextAttributes=function(){return Ke.getContextAttributes()},this.forceContextLoss=function(){var pe=xr.get("WEBGL_lose_context");pe&&pe.loseContext()},this.forceContextRestore=function(){var pe=xr.get("WEBGL_lose_context");pe&&pe.restoreContext()},this.getPixelRatio=function(){return Ce},this.setPixelRatio=function(pe){pe!==void 0&&(Ce=pe,this.setSize(_e,Pe,!1))},this.getSize=function(pe){return pe===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),pe=new bt),pe.set(_e,Pe)},this.setSize=function(pe,st,Ze){if(Nr.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}_e=pe,Pe=st,t.width=Math.floor(pe*Ce),t.height=Math.floor(st*Ce),Ze!==!1&&(t.style.width=pe+"px",t.style.height=st+"px"),this.setViewport(0,0,pe,st)},this.getDrawingBufferSize=function(pe){return pe===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),pe=new bt),pe.set(_e*Ce,Pe*Ce).floor()},this.setDrawingBufferSize=function(pe,st,Ze){_e=pe,Pe=st,Ce=Ze,t.width=Math.floor(pe*Ze),t.height=Math.floor(st*Ze),this.setViewport(0,0,pe,st)},this.getCurrentViewport=function(pe){return pe===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),pe=new un),pe.copy(le)},this.getViewport=function(pe){return pe.copy(Se)},this.setViewport=function(pe,st,Ze,lt){pe.isVector4?Se.set(pe.x,pe.y,pe.z,pe.w):Se.set(pe,st,Ze,lt),Sr.viewport(le.copy(Se).multiplyScalar(Ce).floor())},this.getScissor=function(pe){return pe.copy(Te)},this.setScissor=function(pe,st,Ze,lt){pe.isVector4?Te.set(pe.x,pe.y,pe.z,pe.w):Te.set(pe,st,Ze,lt),Sr.scissor(Me.copy(Te).multiplyScalar(Ce).floor())},this.getScissorTest=function(){return me},this.setScissorTest=function(pe){Sr.setScissorTest(me=pe)},this.setOpaqueSort=function(pe){Ae=pe},this.setTransparentSort=function(pe){Be=pe},this.getClearColor=function(pe){return pe===void 0&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),pe=new It),pe.copy(ze.getClearColor())},this.setClearColor=function(){ze.setClearColor.apply(ze,arguments)},this.getClearAlpha=function(){return ze.getClearAlpha()},this.setClearAlpha=function(){ze.setClearAlpha.apply(ze,arguments)},this.clear=function(pe,st,Ze){var lt=0;(pe===void 0||pe)&&(lt|=16384),(st===void 0||st)&&(lt|=256),(Ze===void 0||Ze)&&(lt|=1024),Ke.clear(lt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",gn,!1),t.removeEventListener("webglcontextrestored",tn,!1),Ot.dispose(),Lt.dispose(),Qr.dispose(),zn.dispose(),Un.dispose(),_t.dispose(),Nr.dispose(),Ta.stop()};function gn(pe){pe.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),H=!0}function tn(){console.log("THREE.WebGLRenderer: Context Restored."),H=!1,_r()}function on(pe){var st=pe.target;st.removeEventListener("dispose",on),Wn(st)}function Wn(pe){Ps(pe),Qr.remove(pe)}function Ps(pe){var st=Qr.get(pe).program;st!==void 0&&Le.releaseProgram(st)}function yo(pe,st){pe.render(function(Ze){P.renderBufferImmediate(Ze,st)})}this.renderBufferImmediate=function(pe,st){_t.initAttributes();var Ze=Qr.get(pe);pe.hasPositions&&!Ze.position&&(Ze.position=Ke.createBuffer()),pe.hasNormals&&!Ze.normal&&(Ze.normal=Ke.createBuffer()),pe.hasUvs&&!Ze.uv&&(Ze.uv=Ke.createBuffer()),pe.hasColors&&!Ze.color&&(Ze.color=Ke.createBuffer());var lt=st.getAttributes();pe.hasPositions&&(Ke.bindBuffer(34962,Ze.position),Ke.bufferData(34962,pe.positionArray,35048),_t.enableAttribute(lt.position),Ke.vertexAttribPointer(lt.position,3,5126,!1,0,0)),pe.hasNormals&&(Ke.bindBuffer(34962,Ze.normal),Ke.bufferData(34962,pe.normalArray,35048),_t.enableAttribute(lt.normal),Ke.vertexAttribPointer(lt.normal,3,5126,!1,0,0)),pe.hasUvs&&(Ke.bindBuffer(34962,Ze.uv),Ke.bufferData(34962,pe.uvArray,35048),_t.enableAttribute(lt.uv),Ke.vertexAttribPointer(lt.uv,2,5126,!1,0,0)),pe.hasColors&&(Ke.bindBuffer(34962,Ze.color),Ke.bufferData(34962,pe.colorArray,35048),_t.enableAttribute(lt.color),Ke.vertexAttribPointer(lt.color,3,5126,!1,0,0)),_t.disableUnusedAttributes(),Ke.drawArrays(4,0,pe.count),pe.count=0},this.renderBufferDirect=function(pe,st,Ze,lt,Dt,qr){st===null&&(st=St);var Vr=Dt.isMesh&&Dt.matrixWorld.determinant()<0,sn=Sl(pe,st,lt,Dt);Sr.setMaterial(lt,Vr);var Mr=Ze.index,jn=Ze.attributes.position;if(Mr===null){if(jn===void 0||jn.count===0)return}else if(Mr.count===0)return;var Pn=1;lt.wireframe===!0&&(Mr=Kn.getWireframeAttribute(Ze),Pn=2),(lt.morphTargets||lt.morphNormals)&&zt.update(Dt,Ze,lt,sn),_t.setup(Dt,lt,sn,Ze,Mr);var Ur,zr=Ht;Mr!==null&&(Ur=fi.get(Mr),zr=lr,zr.setIndex(Ur));var $n=Mr!==null?Mr.count:jn.count,pi=Ze.drawRange.start*Pn,nn=Ze.drawRange.count*Pn,Yn=qr!==null?qr.start*Pn:0,Kr=qr!==null?qr.count*Pn:1/0,Rr=Math.max(pi,Yn),an=Math.min($n,pi+nn,Yn+Kr)-1,jr=Math.max(0,an-Rr+1);if(jr!==0){if(Dt.isMesh)lt.wireframe===!0?(Sr.setLineWidth(lt.wireframeLinewidth*Vt()),zr.setMode(1)):zr.setMode(4);else if(Dt.isLine){var Jr=lt.linewidth;Jr===void 0&&(Jr=1),Sr.setLineWidth(Jr*Vt()),Dt.isLineSegments?zr.setMode(1):Dt.isLineLoop?zr.setMode(2):zr.setMode(3)}else Dt.isPoints?zr.setMode(0):Dt.isSprite&&zr.setMode(4);if(Dt.isInstancedMesh)zr.renderInstances(Rr,jr,Dt.count);else if(Ze.isInstancedBufferGeometry){var Cn=Math.min(Ze.instanceCount,Ze._maxInstanceCount);zr.renderInstances(Rr,jr,Cn)}else zr.render(Rr,jr)}},this.compile=function(pe,st){S=Lt.get(pe),S.init(),pe.traverseVisible(function(lt){lt.isLight&&lt.layers.test(st.layers)&&(S.pushLight(lt),lt.castShadow&&S.pushShadow(lt))}),S.setupLights();var Ze=new WeakMap;pe.traverse(function(lt){var Dt=lt.material;if(Dt)if(Array.isArray(Dt))for(var qr=0;qr<Dt.length;qr++){var Vr=Dt[qr];Ze.has(Vr)===!1&&(Fi(Vr,pe,lt),Ze.set(Vr))}else Ze.has(Dt)===!1&&(Fi(Dt,pe,lt),Ze.set(Dt))})};var la=null;function Ga(pe){Nr.isPresenting||la&&la(pe)}var Ta=new Du;Ta.setAnimationLoop(Ga),typeof window<"u"&&Ta.setContext(window),this.setAnimationLoop=function(pe){la=pe,Nr.setAnimationLoop(pe),pe===null?Ta.stop():Ta.start()},this.render=function(pe,st){var Ze,lt;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),Ze=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),lt=arguments[3]),st!==void 0&&st.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(H!==!0){_t.resetDefaultState(),K=-1,Q=null,pe.autoUpdate===!0&&pe.updateMatrixWorld(),st.parent===null&&st.updateMatrixWorld(),Nr.enabled===!0&&Nr.isPresenting===!0&&(st=Nr.getCamera(st)),pe.isScene===!0&&pe.onBeforeRender(P,pe,st,Ze||te),S=Lt.get(pe,D.length),S.init(),D.push(S),qe.multiplyMatrices(st.projectionMatrix,st.matrixWorldInverse),Ue.setFromProjectionMatrix(qe),Qe=this.localClippingEnabled,He=Er.init(this.clippingPlanes,Qe,st),_=Ot.get(pe,st),_.init(),Va(pe,st,0,P.sortObjects),_.finish(),P.sortObjects===!0&&_.sort(Ae,Be),He===!0&&Er.beginShadows();var Dt=S.state.shadowsArray;Bn.render(Dt,pe,st),S.setupLights(),S.setupLightsView(st),He===!0&&Er.endShadows(),this.info.autoReset===!0&&this.info.reset(),Ze!==void 0&&this.setRenderTarget(Ze),ze.render(_,pe,st,lt);var qr=_.opaque,Vr=_.transparent;qr.length>0&&Ao(qr,pe,st),Vr.length>0&&Ao(Vr,pe,st),pe.isScene===!0&&pe.onAfterRender(P,pe,st),te!==null&&(hn.updateRenderTargetMipmap(te),hn.updateMultisampleRenderTarget(te)),Sr.buffers.depth.setTest(!0),Sr.buffers.depth.setMask(!0),Sr.buffers.color.setMask(!0),Sr.setPolygonOffset(!1),Nr.enabled&&Nr.submitFrame&&Nr.submitFrame(),D.pop(),D.length>0?S=D[D.length-1]:S=null,_=null}};function Va(pe,st,Ze,lt){if(pe.visible!==!1){var Dt=pe.layers.test(st.layers);if(Dt){if(pe.isGroup)Ze=pe.renderOrder;else if(pe.isLOD)pe.autoUpdate===!0&&pe.update(st);else if(pe.isLight)S.pushLight(pe),pe.castShadow&&S.pushShadow(pe);else if(pe.isSprite){if(!pe.frustumCulled||Ue.intersectsSprite(pe)){lt&&gt.setFromMatrixPosition(pe.matrixWorld).applyMatrix4(qe);var qr=Un.update(pe),Vr=pe.material;Vr.visible&&_.push(pe,qr,Vr,Ze,gt.z,null)}}else if(pe.isImmediateRenderObject)lt&&gt.setFromMatrixPosition(pe.matrixWorld).applyMatrix4(qe),_.push(pe,null,pe.material,Ze,gt.z,null);else if((pe.isMesh||pe.isLine||pe.isPoints)&&(pe.isSkinnedMesh&&pe.skeleton.frame!==mn.render.frame&&(pe.skeleton.update(),pe.skeleton.frame=mn.render.frame),!pe.frustumCulled||Ue.intersectsObject(pe))){lt&&gt.setFromMatrixPosition(pe.matrixWorld).applyMatrix4(qe);var sn=Un.update(pe),Mr=pe.material;if(Array.isArray(Mr))for(var jn=sn.groups,Pn=0,Ur=jn.length;Pn<Ur;Pn++){var zr=jn[Pn],$n=Mr[zr.materialIndex];$n&&$n.visible&&_.push(pe,sn,$n,Ze,gt.z,zr)}else Mr.visible&&_.push(pe,sn,Mr,Ze,gt.z,null)}}for(var pi=pe.children,nn=0,Yn=pi.length;nn<Yn;nn++)Va(pi[nn],st,Ze,lt)}}function Ao(pe,st,Ze){for(var lt=st.isScene===!0?st.overrideMaterial:null,Dt=0,qr=pe.length;Dt<qr;Dt++){var Vr=pe[Dt],sn=Vr.object,Mr=Vr.geometry,jn=lt===null?Vr.material:lt,Pn=Vr.group;if(Ze.isArrayCamera)for(var Ur=Ze.cameras,zr=0,$n=Ur.length;zr<$n;zr++){var pi=Ur[zr];sn.layers.test(pi.layers)&&(Sr.viewport(le.copy(pi.viewport)),S.setupLightsView(pi),Qo(sn,st,pi,Mr,jn,Pn))}else Qo(sn,st,Ze,Mr,jn,Pn)}}function Qo(pe,st,Ze,lt,Dt,qr){if(pe.onBeforeRender(P,st,Ze,lt,Dt,qr),pe.modelViewMatrix.multiplyMatrices(Ze.matrixWorldInverse,pe.matrixWorld),pe.normalMatrix.getNormalMatrix(pe.modelViewMatrix),pe.isImmediateRenderObject){var Vr=Sl(Ze,st,Dt,pe);Sr.setMaterial(Dt),_t.reset(),yo(pe,Vr)}else P.renderBufferDirect(Ze,st,lt,Dt,pe,qr);pe.onAfterRender(P,st,Ze,lt,Dt,qr)}function Fi(pe,st,Ze){st.isScene!==!0&&(st=St);var lt=Qr.get(pe),Dt=S.state.lights,qr=S.state.shadowsArray,Vr=Dt.state.version,sn=Le.getParameters(pe,Dt.state,qr,st,Ze),Mr=Le.getProgramCacheKey(sn),jn=lt.program,Pn=!0;if(lt.environment=pe.isMeshStandardMaterial?st.environment:null,lt.fog=st.fog,lt.envMap=zn.get(pe.envMap||lt.environment),jn===void 0)pe.addEventListener("dispose",on);else if(jn.cacheKey!==Mr)Ps(pe);else if(lt.lightsStateVersion!==Vr)Pn=!1;else{if(sn.shaderID!==void 0)return;Pn=!1}Pn&&(sn.uniforms=Le.getUniforms(pe),pe.onBeforeCompile(sn,P),jn=Le.acquireProgram(sn,Mr),lt.program=jn,lt.uniforms=sn.uniforms,lt.outputEncoding=sn.outputEncoding);var Ur=lt.uniforms;(!pe.isShaderMaterial&&!pe.isRawShaderMaterial||pe.clipping===!0)&&(lt.numClippingPlanes=Er.numPlanes,lt.numIntersection=Er.numIntersection,Ur.clippingPlanes=Er.uniform),lt.needsLights=$c(pe),lt.lightsStateVersion=Vr,lt.needsLights&&(Ur.ambientLightColor.value=Dt.state.ambient,Ur.lightProbe.value=Dt.state.probe,Ur.directionalLights.value=Dt.state.directional,Ur.directionalLightShadows.value=Dt.state.directionalShadow,Ur.spotLights.value=Dt.state.spot,Ur.spotLightShadows.value=Dt.state.spotShadow,Ur.rectAreaLights.value=Dt.state.rectArea,Ur.ltc_1.value=Dt.state.rectAreaLTC1,Ur.ltc_2.value=Dt.state.rectAreaLTC2,Ur.pointLights.value=Dt.state.point,Ur.pointLightShadows.value=Dt.state.pointShadow,Ur.hemisphereLights.value=Dt.state.hemi,Ur.directionalShadowMap.value=Dt.state.directionalShadowMap,Ur.directionalShadowMatrix.value=Dt.state.directionalShadowMatrix,Ur.spotShadowMap.value=Dt.state.spotShadowMap,Ur.spotShadowMatrix.value=Dt.state.spotShadowMatrix,Ur.pointShadowMap.value=Dt.state.pointShadowMap,Ur.pointShadowMatrix.value=Dt.state.pointShadowMatrix);var zr=lt.program.getUniforms(),$n=io.seqWithValue(zr.seq,Ur);lt.uniformsList=$n}function Sl(pe,st,Ze,lt){st.isScene!==!0&&(st=St),hn.resetTextureUnits();var Dt=st.fog,qr=Ze.isMeshStandardMaterial?st.environment:null,Vr=te===null?P.outputEncoding:te.texture.encoding,sn=zn.get(Ze.envMap||qr),Mr=Qr.get(Ze),jn=S.state.lights;if(He===!0&&(Qe===!0||pe!==Q)){var Pn=pe===Q&&Ze.id===K;Er.setState(Ze,pe,Pn)}Ze.version===Mr.__version?(Ze.fog&&Mr.fog!==Dt||Mr.environment!==qr||Mr.needsLights&&Mr.lightsStateVersion!==jn.state.version||Mr.numClippingPlanes!==void 0&&(Mr.numClippingPlanes!==Er.numPlanes||Mr.numIntersection!==Er.numIntersection)||Mr.outputEncoding!==Vr||Mr.envMap!==sn)&&Fi(Ze,st,lt):(Fi(Ze,st,lt),Mr.__version=Ze.version);var Ur=!1,zr=!1,$n=!1,pi=Mr.program,nn=pi.getUniforms(),Yn=Mr.uniforms;if(Sr.useProgram(pi.program)&&(Ur=!0,zr=!0,$n=!0),Ze.id!==K&&(K=Ze.id,zr=!0),Ur||Q!==pe){if(nn.setValue(Ke,"projectionMatrix",pe.projectionMatrix),Fr.logarithmicDepthBuffer&&nn.setValue(Ke,"logDepthBufFC",2/(Math.log(pe.far+1)/Math.LN2)),Q!==pe&&(Q=pe,zr=!0,$n=!0),Ze.isShaderMaterial||Ze.isMeshPhongMaterial||Ze.isMeshToonMaterial||Ze.isMeshStandardMaterial||Ze.envMap){var Kr=nn.map.cameraPosition;Kr!==void 0&&Kr.setValue(Ke,gt.setFromMatrixPosition(pe.matrixWorld))}(Ze.isMeshPhongMaterial||Ze.isMeshToonMaterial||Ze.isMeshLambertMaterial||Ze.isMeshBasicMaterial||Ze.isMeshStandardMaterial||Ze.isShaderMaterial)&&nn.setValue(Ke,"isOrthographic",pe.isOrthographicCamera===!0),(Ze.isMeshPhongMaterial||Ze.isMeshToonMaterial||Ze.isMeshLambertMaterial||Ze.isMeshBasicMaterial||Ze.isMeshStandardMaterial||Ze.isShaderMaterial||Ze.isShadowMaterial||Ze.skinning)&&nn.setValue(Ke,"viewMatrix",pe.matrixWorldInverse)}if(Ze.skinning){nn.setOptional(Ke,lt,"bindMatrix"),nn.setOptional(Ke,lt,"bindMatrixInverse");var Rr=lt.skeleton;if(Rr){var an=Rr.bones;if(Fr.floatVertexTextures){if(Rr.boneTexture===null){var jr=Math.sqrt(an.length*4);jr=gr.ceilPowerOfTwo(jr),jr=Math.max(jr,4);var Jr=new Float32Array(jr*jr*4);Jr.set(Rr.boneMatrices);var Cn=new Ba(Jr,jr,jr,ti,Xr);Rr.boneMatrices=Jr,Rr.boneTexture=Cn,Rr.boneTextureSize=jr}nn.setValue(Ke,"boneTexture",Rr.boneTexture,hn),nn.setValue(Ke,"boneTextureSize",Rr.boneTextureSize)}else nn.setOptional(Ke,Rr,"boneMatrices")}}return(zr||Mr.receiveShadow!==lt.receiveShadow)&&(Mr.receiveShadow=lt.receiveShadow,nn.setValue(Ke,"receiveShadow",lt.receiveShadow)),zr&&(nn.setValue(Ke,"toneMappingExposure",P.toneMappingExposure),Mr.needsLights&&_l(Yn,$n),Dt&&Ze.fog&&Ee.refreshFogUniforms(Yn,Dt),Ee.refreshMaterialUniforms(Yn,Ze,Ce,Pe),io.upload(Ke,Mr.uniformsList,Yn,hn)),Ze.isShaderMaterial&&Ze.uniformsNeedUpdate===!0&&(io.upload(Ke,Mr.uniformsList,Yn,hn),Ze.uniformsNeedUpdate=!1),Ze.isSpriteMaterial&&nn.setValue(Ke,"center",lt.center),nn.setValue(Ke,"modelViewMatrix",lt.modelViewMatrix),nn.setValue(Ke,"normalMatrix",lt.normalMatrix),nn.setValue(Ke,"modelMatrix",lt.matrixWorld),pi}function _l(pe,st){pe.ambientLightColor.needsUpdate=st,pe.lightProbe.needsUpdate=st,pe.directionalLights.needsUpdate=st,pe.directionalLightShadows.needsUpdate=st,pe.pointLights.needsUpdate=st,pe.pointLightShadows.needsUpdate=st,pe.spotLights.needsUpdate=st,pe.spotLightShadows.needsUpdate=st,pe.rectAreaLights.needsUpdate=st,pe.hemisphereLights.needsUpdate=st}function $c(pe){return pe.isMeshLambertMaterial||pe.isMeshToonMaterial||pe.isMeshPhongMaterial||pe.isMeshStandardMaterial||pe.isShadowMaterial||pe.isShaderMaterial&&pe.lights===!0}this.setTexture2D=function(){var pe=!1;return function(Ze,lt){Ze&&Ze.isWebGLRenderTarget&&(pe||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),pe=!0),Ze=Ze.texture),hn.setTexture2D(Ze,lt)}}(),this.setFramebuffer=function(pe){W!==pe&&te===null&&Ke.bindFramebuffer(36160,pe),W=pe},this.getActiveCubeFace=function(){return G},this.getActiveMipmapLevel=function(){return B},this.getRenderList=function(){return _},this.setRenderList=function(pe){_=pe},this.getRenderTarget=function(){return te},this.setRenderTarget=function(pe,st,Ze){st===void 0&&(st=0),Ze===void 0&&(Ze=0),te=pe,G=st,B=Ze,pe&&Qr.get(pe).__webglFramebuffer===void 0&&hn.setupRenderTarget(pe);var lt=W,Dt=!1;if(pe){var qr=Qr.get(pe).__webglFramebuffer;pe.isWebGLCubeRenderTarget?(lt=qr[st],Dt=!0):pe.isWebGLMultisampleRenderTarget?lt=Qr.get(pe).__webglMultisampledFramebuffer:lt=qr,le.copy(pe.viewport),Me.copy(pe.scissor),xe=pe.scissorTest}else le.copy(Se).multiplyScalar(Ce).floor(),Me.copy(Te).multiplyScalar(Ce).floor(),xe=me;if(he!==lt&&(Ke.bindFramebuffer(36160,lt),he=lt),Sr.viewport(le),Sr.scissor(Me),Sr.setScissorTest(xe),Dt){var Vr=Qr.get(pe.texture);Ke.framebufferTexture2D(36160,36064,34069+st,Vr.__webglTexture,Ze)}},this.readRenderTargetPixels=function(pe,st,Ze,lt,Dt,qr,Vr){if(!(pe&&pe.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var sn=Qr.get(pe).__webglFramebuffer;if(pe.isWebGLCubeRenderTarget&&Vr!==void 0&&(sn=sn[Vr]),sn){var Mr=!1;sn!==he&&(Ke.bindFramebuffer(36160,sn),Mr=!0);try{var jn=pe.texture,Pn=jn.format,Ur=jn.type;if(Pn!==ti&&Ft.convert(Pn)!==Ke.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}var zr=Ur===fn&&(xr.has("EXT_color_buffer_half_float")||Fr.isWebGL2&&xr.has("EXT_color_buffer_float"));if(Ur!==cr&&Ft.convert(Ur)!==Ke.getParameter(35738)&&!(Ur===Xr&&(Fr.isWebGL2||xr.has("OES_texture_float")||xr.has("WEBGL_color_buffer_float")))&&!zr){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ke.checkFramebufferStatus(36160)===36053?st>=0&&st<=pe.width-lt&&Ze>=0&&Ze<=pe.height-Dt&&Ke.readPixels(st,Ze,lt,Dt,Ft.convert(Pn),Ft.convert(Ur),qr):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{Mr&&Ke.bindFramebuffer(36160,he)}}},this.copyFramebufferToTexture=function(pe,st,Ze){Ze===void 0&&(Ze=0);var lt=Math.pow(2,-Ze),Dt=Math.floor(st.image.width*lt),qr=Math.floor(st.image.height*lt),Vr=Ft.convert(st.format);hn.setTexture2D(st,0),Ke.copyTexImage2D(3553,Ze,Vr,pe.x,pe.y,Dt,qr,0),Sr.unbindTexture()},this.copyTextureToTexture=function(pe,st,Ze,lt){lt===void 0&&(lt=0);var Dt=st.image.width,qr=st.image.height,Vr=Ft.convert(Ze.format),sn=Ft.convert(Ze.type);hn.setTexture2D(Ze,0),Ke.pixelStorei(37440,Ze.flipY),Ke.pixelStorei(37441,Ze.premultiplyAlpha),Ke.pixelStorei(3317,Ze.unpackAlignment),st.isDataTexture?Ke.texSubImage2D(3553,lt,pe.x,pe.y,Dt,qr,Vr,sn,st.image.data):st.isCompressedTexture?Ke.compressedTexSubImage2D(3553,lt,pe.x,pe.y,st.mipmaps[0].width,st.mipmaps[0].height,Vr,st.mipmaps[0].data):Ke.texSubImage2D(3553,lt,pe.x,pe.y,Vr,sn,st.image),lt===0&&Ze.generateMipmaps&&Ke.generateMipmap(3553),Sr.unbindTexture()},this.initTexture=function(pe){hn.setTexture2D(pe,0),Sr.unbindTexture()},this.resetState=function(){Sr.reset(),_t.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Bu(a){tl.call(this,a)}Bu.prototype=Object.assign(Object.create(tl.prototype),{constructor:Bu,isWebGL1Renderer:!0});var Cd=function(){function a(i,r){Object.defineProperty(this,"isFogExp2",{value:!0}),this.name="",this.color=new It(i),this.density=r!==void 0?r:25e-5}var t=a.prototype;return t.clone=function(){return new a(this.color,this.density)},t.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},a}(),Ld=function(){function a(i,r,n){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new It(i),this.near=r!==void 0?r:1,this.far=n!==void 0?n:1e3}var t=a.prototype;return t.clone=function(){return new a(this.color,this.near,this.far)},t.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},a}(),Fu=function(a){Or(t,a);function t(){var r;return r=a.call(this)||this,Object.defineProperty(Ji(r),"isScene",{value:!0}),r.type="Scene",r.background=null,r.environment=null,r.fog=null,r.overrideMaterial=null,r.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:Ji(r)})),r}var i=t.prototype;return i.copy=function(n,o){return a.prototype.copy.call(this,n,o),n.background!==null&&(this.background=n.background.clone()),n.environment!==null&&(this.environment=n.environment.clone()),n.fog!==null&&(this.fog=n.fog.clone()),n.overrideMaterial!==null&&(this.overrideMaterial=n.overrideMaterial.clone()),this.autoUpdate=n.autoUpdate,this.matrixAutoUpdate=n.matrixAutoUpdate,this},i.toJSON=function(n){var o=a.prototype.toJSON.call(this,n);return this.background!==null&&(o.object.background=this.background.toJSON(n)),this.environment!==null&&(o.object.environment=this.environment.toJSON(n)),this.fog!==null&&(o.object.fog=this.fog.toJSON()),o},t}(Qt);function Di(a,t){this.array=a,this.stride=t,this.count=a!==void 0?a.length/t:0,this.usage=Bs,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=gr.generateUUID()}Object.defineProperty(Di.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),Object.assign(Di.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,i,r){t*=this.stride,r*=i.stride;for(var n=0,o=this.stride;n<o;n++)this.array[t+n]=i.array[r+n];return this},set:function(t,i){return i===void 0&&(i=0),this.array.set(t,i),this},clone:function(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=gr.generateUUID()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var i=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),r=new Di(i,this.stride);return r.setUsage(this.usage),r},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=gr.generateUUID()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var Do=new fe;function so(a,t,i,r){this.name="",this.data=a,this.itemSize=t,this.offset=i,this.normalized=r===!0}Object.defineProperties(so.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}}),Object.assign(so.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var i=0,r=this.data.count;i<r;i++)Do.x=this.getX(i),Do.y=this.getY(i),Do.z=this.getZ(i),Do.applyMatrix4(t),this.setXYZ(i,Do.x,Do.y,Do.z);return this},setX:function(t,i){return this.data.array[t*this.data.stride+this.offset]=i,this},setY:function(t,i){return this.data.array[t*this.data.stride+this.offset+1]=i,this},setZ:function(t,i){return this.data.array[t*this.data.stride+this.offset+2]=i,this},setW:function(t,i){return this.data.array[t*this.data.stride+this.offset+3]=i,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=r,this},setXYZ:function(t,i,r,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=r,this.data.array[t+2]=n,this},setXYZW:function(t,i,r,n,o){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=r,this.data.array[t+2]=n,this.data.array[t+3]=o,this},clone:function(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var i=[],r=0;r<this.count;r++)for(var n=r*this.data.stride+this.offset,o=0;o<this.itemSize;o++)i.push(this.data.array[n+o]);return new dr(new this.array.constructor(i),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new so(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var i=[],r=0;r<this.count;r++)for(var n=r*this.data.stride+this.offset,o=0;o<this.itemSize;o++)i.push(this.data.array[n+o]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});function lo(a){hr.call(this),this.type="SpriteMaterial",this.color=new It(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(a)}lo.prototype=Object.create(hr.prototype),lo.prototype.constructor=lo,lo.prototype.isSpriteMaterial=!0,lo.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.rotation=a.rotation,this.sizeAttenuation=a.sizeAttenuation,this};var ps,rl=new fe,vs=new fe,ms=new fe,gs=new bt,nl=new bt,Rd=new kr,Kl=new fe,il=new fe,$l=new fe,Pd=new bt,Nu=new bt,Dd=new bt;function al(a){if(Qt.call(this),this.type="Sprite",ps===void 0){ps=new tr;var t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new Di(t,5);ps.setIndex([0,1,2,0,2,3]),ps.setAttribute("position",new so(i,3,0,!1)),ps.setAttribute("uv",new so(i,2,3,!1))}this.geometry=ps,this.material=a!==void 0?a:new lo,this.center=new bt(.5,.5)}al.prototype=Object.assign(Object.create(Qt.prototype),{constructor:al,isSprite:!0,raycast:function(t,i){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),vs.setFromMatrixScale(this.matrixWorld),Rd.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),ms.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&vs.multiplyScalar(-ms.z);var r=this.material.rotation,n,o;r!==0&&(o=Math.cos(r),n=Math.sin(r));var s=this.center;ec(Kl.set(-.5,-.5,0),ms,s,vs,n,o),ec(il.set(.5,-.5,0),ms,s,vs,n,o),ec($l.set(.5,.5,0),ms,s,vs,n,o),Pd.set(0,0),Nu.set(1,0),Dd.set(1,1);var c=t.ray.intersectTriangle(Kl,il,$l,!1,rl);if(!(c===null&&(ec(il.set(-.5,.5,0),ms,s,vs,n,o),Nu.set(0,1),c=t.ray.intersectTriangle(Kl,$l,il,!1,rl),c===null))){var h=t.ray.origin.distanceTo(rl);h<t.near||h>t.far||i.push({distance:h,point:rl.clone(),uv:ma.getUV(rl,Kl,il,$l,Pd,Nu,Dd,new bt),face:null,object:this})}},copy:function(t){return Qt.prototype.copy.call(this,t),t.center!==void 0&&this.center.copy(t.center),this.material=t.material,this}});function ec(a,t,i,r,n,o){gs.subVectors(a,i).addScalar(.5).multiply(r),n!==void 0?(nl.x=o*gs.x-n*gs.y,nl.y=n*gs.x+o*gs.y):nl.copy(gs),a.copy(t),a.x+=nl.x,a.y+=nl.y,a.applyMatrix4(Rd)}var tc=new fe,Od=new fe;function ol(){Qt.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}ol.prototype=Object.assign(Object.create(Qt.prototype),{constructor:ol,isLOD:!0,copy:function(t){Qt.prototype.copy.call(this,t,!1);for(var i=t.levels,r=0,n=i.length;r<n;r++){var o=i[r];this.addLevel(o.object.clone(),o.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,i){i===void 0&&(i=0),i=Math.abs(i);var r=this.levels,n;for(n=0;n<r.length&&!(i<r[n].distance);n++);return r.splice(n,0,{distance:i,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var i=this.levels;if(i.length>0){var r,n;for(r=1,n=i.length;r<n&&!(t<i[r].distance);r++);return i[r-1].object}return null},raycast:function(t,i){var r=this.levels;if(r.length>0){tc.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(tc);this.getObjectForDistance(n).raycast(t,i)}},update:function(t){var i=this.levels;if(i.length>1){tc.setFromMatrixPosition(t.matrixWorld),Od.setFromMatrixPosition(this.matrixWorld);var r=tc.distanceTo(Od)/t.zoom;i[0].object.visible=!0;var n,o;for(n=1,o=i.length;n<o&&r>=i[n].distance;n++)i[n-1].object.visible=!1,i[n].object.visible=!0;for(this._currentLevel=n-1;n<o;n++)i[n].object.visible=!1}},toJSON:function(t){var i=Qt.prototype.toJSON.call(this,t);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];for(var r=this.levels,n=0,o=r.length;n<o;n++){var s=r[n];i.object.levels.push({object:s.object.uuid,distance:s.distance})}return i}});var Id=new fe,Bd=new un,Fd=new un,q0=new fe,Nd=new kr;function sl(a,t){a&&a.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),xn.call(this,a,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new kr,this.bindMatrixInverse=new kr}sl.prototype=Object.assign(Object.create(xn.prototype),{constructor:sl,isSkinnedMesh:!0,copy:function(t){return xn.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,i){this.skeleton=t,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new un,i=this.geometry.attributes.skinWeight,r=0,n=i.count;r<n;r++){t.x=i.getX(r),t.y=i.getY(r),t.z=i.getZ(r),t.w=i.getW(r);var o=1/t.manhattanLength();o!==1/0?t.multiplyScalar(o):t.set(1,0,0,0),i.setXYZW(r,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){xn.prototype.updateMatrixWorld.call(this,t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(t,i){var r=this.skeleton,n=this.geometry;Bd.fromBufferAttribute(n.attributes.skinIndex,t),Fd.fromBufferAttribute(n.attributes.skinWeight,t),Id.fromBufferAttribute(n.attributes.position,t).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(var o=0;o<4;o++){var s=Fd.getComponent(o);if(s!==0){var c=Bd.getComponent(o);Nd.multiplyMatrices(r.bones[c].matrixWorld,r.boneInverses[c]),i.addScaledVector(q0.copy(Id).applyMatrix4(Nd),s)}}return i.applyMatrix4(this.bindMatrixInverse)}});function ll(){Qt.call(this),this.type="Bone"}ll.prototype=Object.assign(Object.create(Qt.prototype),{constructor:ll,isBone:!0});var kd=new kr,J0=new kr;function cl(a,t){a===void 0&&(a=[]),t===void 0&&(t=[]),this.uuid=gr.generateUUID(),this.bones=a.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}Object.assign(cl.prototype,{init:function(){var t=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(t.length*16),i.length===0)this.calculateInverses();else if(t.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new kr)}},calculateInverses:function(){this.boneInverses.length=0;for(var t=0,i=this.bones.length;t<i;t++){var r=new kr;this.bones[t]&&r.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(r)}},pose:function(){for(var t=0,i=this.bones.length;t<i;t++){var r=this.bones[t];r&&r.matrixWorld.copy(this.boneInverses[t]).invert()}for(var n=0,o=this.bones.length;n<o;n++){var s=this.bones[n];s&&(s.parent&&s.parent.isBone?(s.matrix.copy(s.parent.matrixWorld).invert(),s.matrix.multiply(s.matrixWorld)):s.matrix.copy(s.matrixWorld),s.matrix.decompose(s.position,s.quaternion,s.scale))}},update:function(){for(var t=this.bones,i=this.boneInverses,r=this.boneMatrices,n=this.boneTexture,o=0,s=t.length;o<s;o++){var c=t[o]?t[o].matrixWorld:J0;kd.multiplyMatrices(c,i[o]),kd.toArray(r,o*16)}n!==null&&(n.needsUpdate=!0)},clone:function(){return new cl(this.bones,this.boneInverses)},getBoneByName:function(t){for(var i=0,r=this.bones.length;i<r;i++){var n=this.bones[i];if(n.name===t)return n}},dispose:function(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(t,i){this.uuid=t.uuid;for(var r=0,n=t.bones.length;r<n;r++){var o=t.bones[r],s=i[o];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),s=new ll),this.bones.push(s),this.boneInverses.push(new kr().fromArray(t.boneInverses[r]))}return this.init(),this},toJSON:function(){var t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;for(var i=this.bones,r=this.boneInverses,n=0,o=i.length;n<o;n++){var s=i[n];t.bones.push(s.uuid);var c=r[n];t.boneInverses.push(c.toArray())}return t}});var Ud=new kr,Hd=new kr,rc=[],ul=new xn;function nc(a,t,i){xn.call(this,a,t),this.instanceMatrix=new dr(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}nc.prototype=Object.assign(Object.create(xn.prototype),{constructor:nc,isInstancedMesh:!0,copy:function(t){return xn.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),t.instanceColor!==null&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this},getColorAt:function(t,i){i.fromArray(this.instanceColor.array,t*3)},getMatrixAt:function(t,i){i.fromArray(this.instanceMatrix.array,t*16)},raycast:function(t,i){var r=this.matrixWorld,n=this.count;if(ul.geometry=this.geometry,ul.material=this.material,ul.material!==void 0)for(var o=0;o<n;o++){this.getMatrixAt(o,Ud),Hd.multiplyMatrices(r,Ud),ul.matrixWorld=Hd,ul.raycast(t,rc);for(var s=0,c=rc.length;s<c;s++){var h=rc[s];h.instanceId=o,h.object=this,i.push(h)}rc.length=0}},setColorAt:function(t,i){this.instanceColor===null&&(this.instanceColor=new dr(new Float32Array(this.count*3),3)),i.toArray(this.instanceColor.array,t*3)},setMatrixAt:function(t,i){i.toArray(this.instanceMatrix.array,t*16)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});function Rn(a){hr.call(this),this.type="LineBasicMaterial",this.color=new It(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(a)}Rn.prototype=Object.create(hr.prototype),Rn.prototype.constructor=Rn,Rn.prototype.isLineBasicMaterial=!0,Rn.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.color.copy(a.color),this.linewidth=a.linewidth,this.linecap=a.linecap,this.linejoin=a.linejoin,this.morphTargets=a.morphTargets,this};var Gd=new fe,Vd=new fe,zd=new kr,ku=new es,ic=new Ka;function Vi(a,t){a===void 0&&(a=new tr),t===void 0&&(t=new Rn),Qt.call(this),this.type="Line",this.geometry=a,this.material=t,this.updateMorphTargets()}Vi.prototype=Object.assign(Object.create(Qt.prototype),{constructor:Vi,isLine:!0,copy:function(t){return Qt.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(t.index===null){for(var i=t.attributes.position,r=[0],n=1,o=i.count;n<o;n++)Gd.fromBufferAttribute(i,n-1),Vd.fromBufferAttribute(i,n),r[n]=r[n-1],r[n]+=Gd.distanceTo(Vd);t.setAttribute("lineDistance",new Nt(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(t,i){var r=this.geometry,n=this.matrixWorld,o=t.params.Line.threshold;if(r.boundingSphere===null&&r.computeBoundingSphere(),ic.copy(r.boundingSphere),ic.applyMatrix4(n),ic.radius+=o,t.ray.intersectsSphere(ic)!==!1){zd.copy(n).invert(),ku.copy(t.ray).applyMatrix4(zd);var s=o/((this.scale.x+this.scale.y+this.scale.z)/3),c=s*s,h=new fe,p=new fe,C=new fe,_=new fe,S=this.isLineSegments?2:1;if(r.isBufferGeometry){var D=r.index,P=r.attributes,H=P.position;if(D!==null)for(var W=D.array,G=0,B=W.length-1;G<B;G+=S){var te=W[G],he=W[G+1];h.fromBufferAttribute(H,te),p.fromBufferAttribute(H,he);var K=ku.distanceSqToSegment(h,p,_,C);if(!(K>c)){_.applyMatrix4(this.matrixWorld);var Q=t.ray.origin.distanceTo(_);Q<t.near||Q>t.far||i.push({distance:Q,point:C.clone().applyMatrix4(this.matrixWorld),index:G,face:null,faceIndex:null,object:this})}}else for(var le=0,Me=H.count-1;le<Me;le+=S){h.fromBufferAttribute(H,le),p.fromBufferAttribute(H,le+1);var xe=ku.distanceSqToSegment(h,p,_,C);if(!(xe>c)){_.applyMatrix4(this.matrixWorld);var _e=t.ray.origin.distanceTo(_);_e<t.near||_e>t.far||i.push({distance:_e,point:C.clone().applyMatrix4(this.matrixWorld),index:le,face:null,faceIndex:null,object:this})}}}else r.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var i=t.morphAttributes,r=Object.keys(i);if(r.length>0){var n=i[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,s=n.length;o<s;o++){var c=n[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}else{var h=t.morphTargets;h!==void 0&&h.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var Wd=new fe,jd=new fe;function bi(a,t){Vi.call(this,a,t),this.type="LineSegments"}bi.prototype=Object.assign(Object.create(Vi.prototype),{constructor:bi,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(t.index===null){for(var i=t.attributes.position,r=[],n=0,o=i.count;n<o;n+=2)Wd.fromBufferAttribute(i,n),jd.fromBufferAttribute(i,n+1),r[n]=n===0?0:r[n-1],r[n+1]=r[n]+Wd.distanceTo(jd);t.setAttribute("lineDistance",new Nt(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});function ac(a,t){Vi.call(this,a,t),this.type="LineLoop"}ac.prototype=Object.assign(Object.create(Vi.prototype),{constructor:ac,isLineLoop:!0});function ta(a){hr.call(this),this.type="PointsMaterial",this.color=new It(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(a)}ta.prototype=Object.create(hr.prototype),ta.prototype.constructor=ta,ta.prototype.isPointsMaterial=!0,ta.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.size=a.size,this.sizeAttenuation=a.sizeAttenuation,this.morphTargets=a.morphTargets,this};var Xd=new kr,Uu=new es,oc=new Ka,sc=new fe;function ys(a,t){a===void 0&&(a=new tr),t===void 0&&(t=new ta),Qt.call(this),this.type="Points",this.geometry=a,this.material=t,this.updateMorphTargets()}ys.prototype=Object.assign(Object.create(Qt.prototype),{constructor:ys,isPoints:!0,copy:function(t){return Qt.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,i){var r=this.geometry,n=this.matrixWorld,o=t.params.Points.threshold;if(r.boundingSphere===null&&r.computeBoundingSphere(),oc.copy(r.boundingSphere),oc.applyMatrix4(n),oc.radius+=o,t.ray.intersectsSphere(oc)!==!1){Xd.copy(n).invert(),Uu.copy(t.ray).applyMatrix4(Xd);var s=o/((this.scale.x+this.scale.y+this.scale.z)/3),c=s*s;if(r.isBufferGeometry){var h=r.index,p=r.attributes,C=p.position;if(h!==null)for(var _=h.array,S=0,D=_.length;S<D;S++){var P=_[S];sc.fromBufferAttribute(C,P),Yd(sc,P,c,n,t,i,this)}else for(var H=0,W=C.count;H<W;H++)sc.fromBufferAttribute(C,H),Yd(sc,H,c,n,t,i,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var i=t.morphAttributes,r=Object.keys(i);if(r.length>0){var n=i[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,s=n.length;o<s;o++){var c=n[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}else{var h=t.morphTargets;h!==void 0&&h.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function Yd(a,t,i,r,n,o,s){var c=Uu.distanceSqToPoint(a);if(c<i){var h=new fe;Uu.closestPointToPoint(a,h),h.applyMatrix4(r);var p=n.ray.origin.distanceTo(h);if(p<n.near||p>n.far)return;o.push({distance:p,distanceToRay:Math.sqrt(c),point:h,index:t,face:null,object:s})}}function Hu(a,t,i,r,n,o,s,c,h){vn.call(this,a,t,i,r,n,o,s,c,h),this.format=s!==void 0?s:Hi,this.minFilter=o!==void 0?o:nt,this.magFilter=n!==void 0?n:nt,this.generateMipmaps=!1;var p=this;function C(){p.needsUpdate=!0,a.requestVideoFrameCallback(C)}"requestVideoFrameCallback"in a&&a.requestVideoFrameCallback(C)}Hu.prototype=Object.assign(Object.create(vn.prototype),{constructor:Hu,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){var t=this.image,i="requestVideoFrameCallback"in t;i===!1&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function As(a,t,i,r,n,o,s,c,h,p,C,_){vn.call(this,null,o,s,c,h,p,r,n,C,_),this.image={width:t,height:i},this.mipmaps=a,this.flipY=!1,this.generateMipmaps=!1}As.prototype=Object.create(vn.prototype),As.prototype.constructor=As,As.prototype.isCompressedTexture=!0;function hl(a,t,i,r,n,o,s,c,h){vn.call(this,a,t,i,r,n,o,s,c,h),this.needsUpdate=!0}hl.prototype=Object.create(vn.prototype),hl.prototype.constructor=hl,hl.prototype.isCanvasTexture=!0;function dl(a,t,i,r,n,o,s,c,h,p){if(p=p!==void 0?p:$e,p!==$e&&p!==Xe)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&p===$e&&(i=Hr),i===void 0&&p===Xe&&(i=Ui),vn.call(this,null,r,n,o,s,c,p,i,h),this.image={width:a,height:t},this.magFilter=s!==void 0?s:ar,this.minFilter=c!==void 0?c:ar,this.flipY=!1,this.generateMipmaps=!1}dl.prototype=Object.create(vn.prototype),dl.prototype.constructor=dl,dl.prototype.isDepthTexture=!0;var lc=function(a){Or(t,a);function t(i,r,n,o){var s;i===void 0&&(i=1),r===void 0&&(r=8),n===void 0&&(n=0),o===void 0&&(o=Math.PI*2),s=a.call(this)||this,s.type="CircleGeometry",s.parameters={radius:i,segments:r,thetaStart:n,thetaLength:o},r=Math.max(3,r);var c=[],h=[],p=[],C=[],_=new fe,S=new bt;h.push(0,0,0),p.push(0,0,1),C.push(.5,.5);for(var D=0,P=3;D<=r;D++,P+=3){var H=n+D/r*o;_.x=i*Math.cos(H),_.y=i*Math.sin(H),h.push(_.x,_.y,_.z),p.push(0,0,1),S.x=(h[P]/i+1)/2,S.y=(h[P+1]/i+1)/2,C.push(S.x,S.y)}for(var W=1;W<=r;W++)c.push(W,W+1,0);return s.setIndex(c),s.setAttribute("position",new Nt(h,3)),s.setAttribute("normal",new Nt(p,3)),s.setAttribute("uv",new Nt(C,2)),s}return t}(tr),bs=function(a){Or(t,a);function t(i,r,n,o,s,c,h,p){var C;i===void 0&&(i=1),r===void 0&&(r=1),n===void 0&&(n=1),o===void 0&&(o=8),s===void 0&&(s=1),c===void 0&&(c=!1),h===void 0&&(h=0),p===void 0&&(p=Math.PI*2),C=a.call(this)||this,C.type="CylinderGeometry",C.parameters={radiusTop:i,radiusBottom:r,height:n,radialSegments:o,heightSegments:s,openEnded:c,thetaStart:h,thetaLength:p};var _=Ji(C);o=Math.floor(o),s=Math.floor(s);var S=[],D=[],P=[],H=[],W=0,G=[],B=n/2,te=0;he(),c===!1&&(i>0&&K(!0),r>0&&K(!1)),C.setIndex(S),C.setAttribute("position",new Nt(D,3)),C.setAttribute("normal",new Nt(P,3)),C.setAttribute("uv",new Nt(H,2));function he(){for(var Q=new fe,le=new fe,Me=0,xe=(r-i)/n,_e=0;_e<=s;_e++){for(var Pe=[],Ce=_e/s,Ae=Ce*(r-i)+i,Be=0;Be<=o;Be++){var Se=Be/o,Te=Se*p+h,me=Math.sin(Te),Ue=Math.cos(Te);le.x=Ae*me,le.y=-Ce*n+B,le.z=Ae*Ue,D.push(le.x,le.y,le.z),Q.set(me,xe,Ue).normalize(),P.push(Q.x,Q.y,Q.z),H.push(Se,1-Ce),Pe.push(W++)}G.push(Pe)}for(var He=0;He<o;He++)for(var Qe=0;Qe<s;Qe++){var qe=G[Qe][He],gt=G[Qe+1][He],St=G[Qe+1][He+1],Vt=G[Qe][He+1];S.push(qe,gt,Vt),S.push(gt,St,Vt),Me+=6}_.addGroup(te,Me,0),te+=Me}function K(Q){for(var le=W,Me=new bt,xe=new fe,_e=0,Pe=Q===!0?i:r,Ce=Q===!0?1:-1,Ae=1;Ae<=o;Ae++)D.push(0,B*Ce,0),P.push(0,Ce,0),H.push(.5,.5),W++;for(var Be=W,Se=0;Se<=o;Se++){var Te=Se/o,me=Te*p+h,Ue=Math.cos(me),He=Math.sin(me);xe.x=Pe*He,xe.y=B*Ce,xe.z=Pe*Ue,D.push(xe.x,xe.y,xe.z),P.push(0,Ce,0),Me.x=Ue*.5+.5,Me.y=He*.5*Ce+.5,H.push(Me.x,Me.y),W++}for(var Qe=0;Qe<o;Qe++){var qe=le+Qe,gt=Be+Qe;Q===!0?S.push(gt,gt+1,qe):S.push(gt+1,gt,qe),_e+=3}_.addGroup(te,_e,Q===!0?1:2),te+=_e}return C}return t}(tr),cc=function(a){Or(t,a);function t(i,r,n,o,s,c,h){var p;return i===void 0&&(i=1),r===void 0&&(r=1),n===void 0&&(n=8),o===void 0&&(o=1),s===void 0&&(s=!1),c===void 0&&(c=0),h===void 0&&(h=Math.PI*2),p=a.call(this,0,i,r,n,o,s,c,h)||this,p.type="ConeGeometry",p.parameters={radius:i,height:r,radialSegments:n,heightSegments:o,openEnded:s,thetaStart:c,thetaLength:h},p}return t}(bs),co=function(a){Or(t,a);function t(i,r,n,o){var s;n===void 0&&(n=1),o===void 0&&(o=0),s=a.call(this)||this,s.type="PolyhedronGeometry",s.parameters={vertices:i,indices:r,radius:n,detail:o};var c=[],h=[];p(o),_(n),S(),s.setAttribute("position",new Nt(c,3)),s.setAttribute("normal",new Nt(c.slice(),3)),s.setAttribute("uv",new Nt(h,2)),o===0?s.computeVertexNormals():s.normalizeNormals();function p(he){for(var K=new fe,Q=new fe,le=new fe,Me=0;Me<r.length;Me+=3)H(r[Me+0],K),H(r[Me+1],Q),H(r[Me+2],le),C(K,Q,le,he)}function C(he,K,Q,le){for(var Me=le+1,xe=[],_e=0;_e<=Me;_e++){xe[_e]=[];for(var Pe=he.clone().lerp(Q,_e/Me),Ce=K.clone().lerp(Q,_e/Me),Ae=Me-_e,Be=0;Be<=Ae;Be++)Be===0&&_e===Me?xe[_e][Be]=Pe:xe[_e][Be]=Pe.clone().lerp(Ce,Be/Ae)}for(var Se=0;Se<Me;Se++)for(var Te=0;Te<2*(Me-Se)-1;Te++){var me=Math.floor(Te/2);Te%2===0?(P(xe[Se][me+1]),P(xe[Se+1][me]),P(xe[Se][me])):(P(xe[Se][me+1]),P(xe[Se+1][me+1]),P(xe[Se+1][me]))}}function _(he){for(var K=new fe,Q=0;Q<c.length;Q+=3)K.x=c[Q+0],K.y=c[Q+1],K.z=c[Q+2],K.normalize().multiplyScalar(he),c[Q+0]=K.x,c[Q+1]=K.y,c[Q+2]=K.z}function S(){for(var he=new fe,K=0;K<c.length;K+=3){he.x=c[K+0],he.y=c[K+1],he.z=c[K+2];var Q=B(he)/2/Math.PI+.5,le=te(he)/Math.PI+.5;h.push(Q,1-le)}W(),D()}function D(){for(var he=0;he<h.length;he+=6){var K=h[he+0],Q=h[he+2],le=h[he+4],Me=Math.max(K,Q,le),xe=Math.min(K,Q,le);Me>.9&&xe<.1&&(K<.2&&(h[he+0]+=1),Q<.2&&(h[he+2]+=1),le<.2&&(h[he+4]+=1))}}function P(he){c.push(he.x,he.y,he.z)}function H(he,K){var Q=he*3;K.x=i[Q+0],K.y=i[Q+1],K.z=i[Q+2]}function W(){for(var he=new fe,K=new fe,Q=new fe,le=new fe,Me=new bt,xe=new bt,_e=new bt,Pe=0,Ce=0;Pe<c.length;Pe+=9,Ce+=6){he.set(c[Pe+0],c[Pe+1],c[Pe+2]),K.set(c[Pe+3],c[Pe+4],c[Pe+5]),Q.set(c[Pe+6],c[Pe+7],c[Pe+8]),Me.set(h[Ce+0],h[Ce+1]),xe.set(h[Ce+2],h[Ce+3]),_e.set(h[Ce+4],h[Ce+5]),le.copy(he).add(K).add(Q).divideScalar(3);var Ae=B(le);G(Me,Ce+0,he,Ae),G(xe,Ce+2,K,Ae),G(_e,Ce+4,Q,Ae)}}function G(he,K,Q,le){le<0&&he.x===1&&(h[K]=he.x-1),Q.x===0&&Q.z===0&&(h[K]=le/2/Math.PI+.5)}function B(he){return Math.atan2(he.z,-he.x)}function te(he){return Math.atan2(-he.y,Math.sqrt(he.x*he.x+he.z*he.z))}return s}return t}(tr),uc=function(a){Or(t,a);function t(i,r){var n;i===void 0&&(i=1),r===void 0&&(r=0);var o=(1+Math.sqrt(5))/2,s=1/o,c=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-o,0,-s,o,0,s,-o,0,s,o,-s,-o,0,-s,o,0,s,-o,0,s,o,0,-o,0,-s,o,0,-s,-o,0,s,o,0,s],h=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];return n=a.call(this,c,h,i,r)||this,n.type="DodecahedronGeometry",n.parameters={radius:i,detail:r},n}return t}(co),hc=new fe,dc=new fe,Gu=new fe,Es=new ma,Vu=function(a){Or(t,a);function t(i,r){var n;if(n=a.call(this)||this,n.type="EdgesGeometry",n.parameters={thresholdAngle:r},r=r!==void 0?r:1,i.isGeometry===!0)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Ji(n);for(var o=4,s=Math.pow(10,o),c=Math.cos(gr.DEG2RAD*r),h=i.getIndex(),p=i.getAttribute("position"),C=h?h.count:p.count,_=[0,0,0],S=["a","b","c"],D=new Array(3),P={},H=[],W=0;W<C;W+=3){h?(_[0]=h.getX(W),_[1]=h.getX(W+1),_[2]=h.getX(W+2)):(_[0]=W,_[1]=W+1,_[2]=W+2);var G=Es.a,B=Es.b,te=Es.c;if(G.fromBufferAttribute(p,_[0]),B.fromBufferAttribute(p,_[1]),te.fromBufferAttribute(p,_[2]),Es.getNormal(Gu),D[0]=Math.round(G.x*s)+","+Math.round(G.y*s)+","+Math.round(G.z*s),D[1]=Math.round(B.x*s)+","+Math.round(B.y*s)+","+Math.round(B.z*s),D[2]=Math.round(te.x*s)+","+Math.round(te.y*s)+","+Math.round(te.z*s),!(D[0]===D[1]||D[1]===D[2]||D[2]===D[0]))for(var he=0;he<3;he++){var K=(he+1)%3,Q=D[he],le=D[K],Me=Es[S[he]],xe=Es[S[K]],_e=Q+"_"+le,Pe=le+"_"+Q;Pe in P&&P[Pe]?(Gu.dot(P[Pe].normal)<=c&&(H.push(Me.x,Me.y,Me.z),H.push(xe.x,xe.y,xe.z)),P[Pe]=null):_e in P||(P[_e]={index0:_[he],index1:_[K],normal:Gu.clone()})}}for(var Ce in P)if(P[Ce]){var Ae=P[Ce],Be=Ae.index0,Se=Ae.index1;hc.fromBufferAttribute(p,Be),dc.fromBufferAttribute(p,Se),H.push(hc.x,hc.y,hc.z),H.push(dc.x,dc.y,dc.z)}return n.setAttribute("position",new Nt(H,3)),n}return t}(tr),Z0={triangulate:function(t,i,r){r=r||2;var n=i&&i.length,o=n?i[0]*r:t.length,s=Qd(t,0,o,r,!0),c=[];if(!s||s.next===s.prev)return c;var h,p,C,_,S,D,P;if(n&&(s=ry(t,i,s,r)),t.length>80*r){h=C=t[0],p=_=t[1];for(var H=r;H<o;H+=r)S=t[H],D=t[H+1],S<h&&(h=S),D<p&&(p=D),S>C&&(C=S),D>_&&(_=D);P=Math.max(C-h,_-p),P=P!==0?1/P:0}return fl(s,c,r,h,p,P),c}};function Qd(a,t,i,r,n){var o,s;if(n===fy(a,t,i,r)>0)for(o=t;o<i;o+=r)s=Zd(o,a[o],a[o+1],s);else for(o=i-r;o>=t;o-=r)s=Zd(o,a[o],a[o+1],s);return s&&fc(s,s.next)&&(vl(s),s=s.next),s}function uo(a,t){if(!a)return a;t||(t=a);var i=a,r;do if(r=!1,!i.steiner&&(fc(i,i.next)||In(i.prev,i,i.next)===0)){if(vl(i),i=t=i.prev,i===i.next)break;r=!0}else i=i.next;while(r||i!==t);return t}function fl(a,t,i,r,n,o,s){if(a){!s&&o&&sy(a,r,n,o);for(var c=a,h,p;a.prev!==a.next;){if(h=a.prev,p=a.next,o?$0(a,r,n,o):K0(a)){t.push(h.i/i),t.push(a.i/i),t.push(p.i/i),vl(a),a=p.next,c=p.next;continue}if(a=p,a===c){s?s===1?(a=ey(uo(a),t,i),fl(a,t,i,r,n,o,2)):s===2&&ty(a,t,i,r,n,o):fl(uo(a),t,i,r,n,o,1);break}}}}function K0(a){var t=a.prev,i=a,r=a.next;if(In(t,i,r)>=0)return!1;for(var n=a.next.next;n!==a.prev;){if(ws(t.x,t.y,i.x,i.y,r.x,r.y,n.x,n.y)&&In(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function $0(a,t,i,r){var n=a.prev,o=a,s=a.next;if(In(n,o,s)>=0)return!1;for(var c=n.x<o.x?n.x<s.x?n.x:s.x:o.x<s.x?o.x:s.x,h=n.y<o.y?n.y<s.y?n.y:s.y:o.y<s.y?o.y:s.y,p=n.x>o.x?n.x>s.x?n.x:s.x:o.x>s.x?o.x:s.x,C=n.y>o.y?n.y>s.y?n.y:s.y:o.y>s.y?o.y:s.y,_=zu(c,h,t,i,r),S=zu(p,C,t,i,r),D=a.prevZ,P=a.nextZ;D&&D.z>=_&&P&&P.z<=S;){if(D!==a.prev&&D!==a.next&&ws(n.x,n.y,o.x,o.y,s.x,s.y,D.x,D.y)&&In(D.prev,D,D.next)>=0||(D=D.prevZ,P!==a.prev&&P!==a.next&&ws(n.x,n.y,o.x,o.y,s.x,s.y,P.x,P.y)&&In(P.prev,P,P.next)>=0))return!1;P=P.nextZ}for(;D&&D.z>=_;){if(D!==a.prev&&D!==a.next&&ws(n.x,n.y,o.x,o.y,s.x,s.y,D.x,D.y)&&In(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;P&&P.z<=S;){if(P!==a.prev&&P!==a.next&&ws(n.x,n.y,o.x,o.y,s.x,s.y,P.x,P.y)&&In(P.prev,P,P.next)>=0)return!1;P=P.nextZ}return!0}function ey(a,t,i){var r=a;do{var n=r.prev,o=r.next.next;!fc(n,o)&&qd(n,r,r.next,o)&&pl(n,o)&&pl(o,n)&&(t.push(n.i/i),t.push(r.i/i),t.push(o.i/i),vl(r),vl(r.next),r=a=o),r=r.next}while(r!==a);return uo(r)}function ty(a,t,i,r,n,o){var s=a;do{for(var c=s.next.next;c!==s.prev;){if(s.i!==c.i&&uy(s,c)){var h=Jd(s,c);s=uo(s,s.next),h=uo(h,h.next),fl(s,t,i,r,n,o),fl(h,t,i,r,n,o);return}c=c.next}s=s.next}while(s!==a)}function ry(a,t,i,r){var n=[],o,s,c,h,p;for(o=0,s=t.length;o<s;o++)c=t[o]*r,h=o<s-1?t[o+1]*r:a.length,p=Qd(a,c,h,r,!1),p===p.next&&(p.steiner=!0),n.push(cy(p));for(n.sort(ny),o=0;o<n.length;o++)iy(n[o],i),i=uo(i,i.next);return i}function ny(a,t){return a.x-t.x}function iy(a,t){if(t=ay(a,t),t){var i=Jd(t,a);uo(t,t.next),uo(i,i.next)}}function ay(a,t){var i=t,r=a.x,n=a.y,o=-1/0,s;do{if(n<=i.y&&n>=i.next.y&&i.next.y!==i.y){var c=i.x+(n-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(c<=r&&c>o){if(o=c,c===r){if(n===i.y)return i;if(n===i.next.y)return i.next}s=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!s)return null;if(r===o)return s;var h=s,p=s.x,C=s.y,_=1/0,S;i=s;do r>=i.x&&i.x>=p&&r!==i.x&&ws(n<C?r:o,n,p,C,n<C?o:r,n,i.x,i.y)&&(S=Math.abs(n-i.y)/(r-i.x),pl(i,a)&&(S<_||S===_&&(i.x>s.x||i.x===s.x&&oy(s,i)))&&(s=i,_=S)),i=i.next;while(i!==h);return s}function oy(a,t){return In(a.prev,a,t.prev)<0&&In(t.next,a,a.next)<0}function sy(a,t,i,r){var n=a;do n.z===null&&(n.z=zu(n.x,n.y,t,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==a);n.prevZ.nextZ=null,n.prevZ=null,ly(n)}function ly(a){var t,i,r,n,o,s,c,h,p=1;do{for(i=a,a=null,o=null,s=0;i;){for(s++,r=i,c=0,t=0;t<p&&(c++,r=r.nextZ,!!r);t++);for(h=p;c>0||h>0&&r;)c!==0&&(h===0||!r||i.z<=r.z)?(n=i,i=i.nextZ,c--):(n=r,r=r.nextZ,h--),o?o.nextZ=n:a=n,n.prevZ=o,o=n;i=r}o.nextZ=null,p*=2}while(s>1);return a}function zu(a,t,i,r,n){return a=32767*(a-i)*n,t=32767*(t-r)*n,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,a|t<<1}function cy(a){var t=a,i=a;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==a);return i}function ws(a,t,i,r,n,o,s,c){return(n-s)*(t-c)-(a-s)*(o-c)>=0&&(a-s)*(r-c)-(i-s)*(t-c)>=0&&(i-s)*(o-c)-(n-s)*(r-c)>=0}function uy(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!hy(a,t)&&(pl(a,t)&&pl(t,a)&&dy(a,t)&&(In(a.prev,a,t.prev)||In(a,t.prev,t))||fc(a,t)&&In(a.prev,a,a.next)>0&&In(t.prev,t,t.next)>0)}function In(a,t,i){return(t.y-a.y)*(i.x-t.x)-(t.x-a.x)*(i.y-t.y)}function fc(a,t){return a.x===t.x&&a.y===t.y}function qd(a,t,i,r){var n=vc(In(a,t,i)),o=vc(In(a,t,r)),s=vc(In(i,r,a)),c=vc(In(i,r,t));return!!(n!==o&&s!==c||n===0&&pc(a,i,t)||o===0&&pc(a,r,t)||s===0&&pc(i,a,r)||c===0&&pc(i,t,r))}function pc(a,t,i){return t.x<=Math.max(a.x,i.x)&&t.x>=Math.min(a.x,i.x)&&t.y<=Math.max(a.y,i.y)&&t.y>=Math.min(a.y,i.y)}function vc(a){return a>0?1:a<0?-1:0}function hy(a,t){var i=a;do{if(i.i!==a.i&&i.next.i!==a.i&&i.i!==t.i&&i.next.i!==t.i&&qd(i,i.next,a,t))return!0;i=i.next}while(i!==a);return!1}function pl(a,t){return In(a.prev,a,a.next)<0?In(a,t,a.next)>=0&&In(a,a.prev,t)>=0:In(a,t,a.prev)<0||In(a,a.next,t)<0}function dy(a,t){var i=a,r=!1,n=(a.x+t.x)/2,o=(a.y+t.y)/2;do i.y>o!=i.next.y>o&&i.next.y!==i.y&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==a);return r}function Jd(a,t){var i=new Wu(a.i,a.x,a.y),r=new Wu(t.i,t.x,t.y),n=a.next,o=t.prev;return a.next=t,t.prev=a,i.next=n,n.prev=i,r.next=i,i.prev=r,o.next=r,r.prev=o,r}function Zd(a,t,i,r){var n=new Wu(a,t,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function vl(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Wu(a,t,i){this.i=a,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function fy(a,t,i,r){for(var n=0,o=t,s=i-r;o<i;o+=r)n+=(a[s]-a[o])*(a[o+1]+a[s+1]),s=o;return n}var Na={area:function(t){for(var i=t.length,r=0,n=i-1,o=0;o<i;n=o++)r+=t[n].x*t[o].y-t[o].x*t[n].y;return r*.5},isClockWise:function(t){return Na.area(t)<0},triangulateShape:function(t,i){var r=[],n=[],o=[];Kd(t),$d(r,t);var s=t.length;i.forEach(Kd);for(var c=0;c<i.length;c++)n.push(s),s+=i[c].length,$d(r,i[c]);for(var h=Z0.triangulate(r,n),p=0;p<h.length;p+=3)o.push(h.slice(p,p+3));return o}};function Kd(a){var t=a.length;t>2&&a[t-1].equals(a[0])&&a.pop()}function $d(a,t){for(var i=0;i<t.length;i++)a.push(t[i].x),a.push(t[i].y)}var Oo=function(a){Or(t,a);function t(r,n){var o;o=a.call(this)||this,o.type="ExtrudeGeometry",o.parameters={shapes:r,options:n},r=Array.isArray(r)?r:[r];for(var s=Ji(o),c=[],h=[],p=0,C=r.length;p<C;p++){var _=r[p];S(_)}o.setAttribute("position",new Nt(c,3)),o.setAttribute("uv",new Nt(h,2)),o.computeVertexNormals();function S(D){var P=[],H=n.curveSegments!==void 0?n.curveSegments:12,W=n.steps!==void 0?n.steps:1,G=n.depth!==void 0?n.depth:100,B=n.bevelEnabled!==void 0?n.bevelEnabled:!0,te=n.bevelThickness!==void 0?n.bevelThickness:6,he=n.bevelSize!==void 0?n.bevelSize:te-2,K=n.bevelOffset!==void 0?n.bevelOffset:0,Q=n.bevelSegments!==void 0?n.bevelSegments:3,le=n.extrudePath,Me=n.UVGenerator!==void 0?n.UVGenerator:py;n.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),G=n.amount);var xe,_e=!1,Pe,Ce,Ae,Be;le&&(xe=le.getSpacedPoints(W),_e=!0,B=!1,Pe=le.computeFrenetFrames(W,!1),Ce=new fe,Ae=new fe,Be=new fe),B||(Q=0,te=0,he=0,K=0);var Se=D.extractPoints(H),Te=Se.shape,me=Se.holes,Ue=!Na.isClockWise(Te);if(Ue){Te=Te.reverse();for(var He=0,Qe=me.length;He<Qe;He++){var qe=me[He];Na.isClockWise(qe)&&(me[He]=qe.reverse())}}for(var gt=Na.triangulateShape(Te,me),St=Te,Vt=0,Ke=me.length;Vt<Ke;Vt++){var rr=me[Vt];Te=Te.concat(rr)}function Bt(Kr,Rr,an){return Rr||console.error("THREE.ExtrudeGeometry: vec does not exist"),Rr.clone().multiplyScalar(an).add(Kr)}var sr=Te.length,xr=gt.length;function Fr(Kr,Rr,an){var jr,Jr,Cn,vi=Kr.x-Rr.x,mi=Kr.y-Rr.y,wi=an.x-Kr.x,Ni=an.y-Kr.y,za=vi*vi+mi*mi,_h=vi*Ni-mi*wi;if(Math.abs(_h)>Number.EPSILON){var eu=Math.sqrt(za),Xf=Math.sqrt(wi*wi+Ni*Ni),Yf=Rr.x-mi/eu,Qf=Rr.y+vi/eu,X1=an.x-Ni/Xf,Y1=an.y+wi/Xf,qf=((X1-Yf)*Ni-(Y1-Qf)*wi)/(vi*Ni-mi*wi);jr=Yf+vi*qf-Kr.x,Jr=Qf+mi*qf-Kr.y;var Jf=jr*jr+Jr*Jr;if(Jf<=2)return new bt(jr,Jr);Cn=Math.sqrt(Jf/2)}else{var tu=!1;vi>Number.EPSILON?wi>Number.EPSILON&&(tu=!0):vi<-Number.EPSILON?wi<-Number.EPSILON&&(tu=!0):Math.sign(mi)===Math.sign(Ni)&&(tu=!0),tu?(jr=-mi,Jr=vi,Cn=Math.sqrt(za)):(jr=vi,Jr=mi,Cn=Math.sqrt(za/2))}return new bt(jr/Cn,Jr/Cn)}for(var Sr=[],mn=0,Qr=St.length,hn=Qr-1,zn=mn+1;mn<Qr;mn++,hn++,zn++)hn===Qr&&(hn=0),zn===Qr&&(zn=0),Sr[mn]=Fr(St[mn],St[hn],St[zn]);for(var fi=[],Kn,Un=Sr.concat(),Le=0,Ee=me.length;Le<Ee;Le++){var Ot=me[Le];Kn=[];for(var Lt=0,Er=Ot.length,ze=Er-1,zt=Lt+1;Lt<Er;Lt++,ze++,zt++)ze===Er&&(ze=0),zt===Er&&(zt=0),Kn[Lt]=Fr(Ot[Lt],Ot[ze],Ot[zt]);fi.push(Kn),Un=Un.concat(Kn)}for(var Ht=0;Ht<Q;Ht++){for(var lr=Ht/Q,Ft=te*Math.cos(lr*Math.PI/2),_t=he*Math.sin(lr*Math.PI/2)+K,_r=0,Nr=St.length;_r<Nr;_r++){var Bn=Bt(St[_r],Sr[_r],_t);zr(Bn.x,Bn.y,-Ft)}for(var gn=0,tn=me.length;gn<tn;gn++){var on=me[gn];Kn=fi[gn];for(var Wn=0,Ps=on.length;Wn<Ps;Wn++){var yo=Bt(on[Wn],Kn[Wn],_t);zr(yo.x,yo.y,-Ft)}}}for(var la=he+K,Ga=0;Ga<sr;Ga++){var Ta=B?Bt(Te[Ga],Un[Ga],la):Te[Ga];_e?(Ae.copy(Pe.normals[0]).multiplyScalar(Ta.x),Ce.copy(Pe.binormals[0]).multiplyScalar(Ta.y),Be.copy(xe[0]).add(Ae).add(Ce),zr(Be.x,Be.y,Be.z)):zr(Ta.x,Ta.y,0)}for(var Va=1;Va<=W;Va++)for(var Ao=0;Ao<sr;Ao++){var Qo=B?Bt(Te[Ao],Un[Ao],la):Te[Ao];_e?(Ae.copy(Pe.normals[Va]).multiplyScalar(Qo.x),Ce.copy(Pe.binormals[Va]).multiplyScalar(Qo.y),Be.copy(xe[Va]).add(Ae).add(Ce),zr(Be.x,Be.y,Be.z)):zr(Qo.x,Qo.y,G/W*Va)}for(var Fi=Q-1;Fi>=0;Fi--){for(var Sl=Fi/Q,_l=te*Math.cos(Sl*Math.PI/2),$c=he*Math.sin(Sl*Math.PI/2)+K,pe=0,st=St.length;pe<st;pe++){var Ze=Bt(St[pe],Sr[pe],$c);zr(Ze.x,Ze.y,G+_l)}for(var lt=0,Dt=me.length;lt<Dt;lt++){var qr=me[lt];Kn=fi[lt];for(var Vr=0,sn=qr.length;Vr<sn;Vr++){var Mr=Bt(qr[Vr],Kn[Vr],$c);_e?zr(Mr.x,Mr.y+xe[W-1].y,xe[W-1].x+_l):zr(Mr.x,Mr.y,G+_l)}}}jn(),Pn();function jn(){var Kr=c.length/3;if(B){for(var Rr=0,an=sr*Rr,jr=0;jr<xr;jr++){var Jr=gt[jr];$n(Jr[2]+an,Jr[1]+an,Jr[0]+an)}Rr=W+Q*2,an=sr*Rr;for(var Cn=0;Cn<xr;Cn++){var vi=gt[Cn];$n(vi[0]+an,vi[1]+an,vi[2]+an)}}else{for(var mi=0;mi<xr;mi++){var wi=gt[mi];$n(wi[2],wi[1],wi[0])}for(var Ni=0;Ni<xr;Ni++){var za=gt[Ni];$n(za[0]+sr*W,za[1]+sr*W,za[2]+sr*W)}}s.addGroup(Kr,c.length/3-Kr,0)}function Pn(){var Kr=c.length/3,Rr=0;Ur(St,Rr),Rr+=St.length;for(var an=0,jr=me.length;an<jr;an++){var Jr=me[an];Ur(Jr,Rr),Rr+=Jr.length}s.addGroup(Kr,c.length/3-Kr,1)}function Ur(Kr,Rr){for(var an=Kr.length;--an>=0;){var jr=an,Jr=an-1;Jr<0&&(Jr=Kr.length-1);for(var Cn=0,vi=W+Q*2;Cn<vi;Cn++){var mi=sr*Cn,wi=sr*(Cn+1),Ni=Rr+jr+mi,za=Rr+Jr+mi,_h=Rr+Jr+wi,eu=Rr+jr+wi;pi(Ni,za,_h,eu)}}}function zr(Kr,Rr,an){P.push(Kr),P.push(Rr),P.push(an)}function $n(Kr,Rr,an){nn(Kr),nn(Rr),nn(an);var jr=c.length/3,Jr=Me.generateTopUV(s,c,jr-3,jr-2,jr-1);Yn(Jr[0]),Yn(Jr[1]),Yn(Jr[2])}function pi(Kr,Rr,an,jr){nn(Kr),nn(Rr),nn(jr),nn(Rr),nn(an),nn(jr);var Jr=c.length/3,Cn=Me.generateSideWallUV(s,c,Jr-6,Jr-3,Jr-2,Jr-1);Yn(Cn[0]),Yn(Cn[1]),Yn(Cn[3]),Yn(Cn[1]),Yn(Cn[2]),Yn(Cn[3])}function nn(Kr){c.push(P[Kr*3+0]),c.push(P[Kr*3+1]),c.push(P[Kr*3+2])}function Yn(Kr){h.push(Kr.x),h.push(Kr.y)}}return o}var i=t.prototype;return i.toJSON=function(){var n=tr.prototype.toJSON.call(this),o=this.parameters.shapes,s=this.parameters.options;return vy(o,s,n)},t}(tr),py={generateTopUV:function(t,i,r,n,o){var s=i[r*3],c=i[r*3+1],h=i[n*3],p=i[n*3+1],C=i[o*3],_=i[o*3+1];return[new bt(s,c),new bt(h,p),new bt(C,_)]},generateSideWallUV:function(t,i,r,n,o,s){var c=i[r*3],h=i[r*3+1],p=i[r*3+2],C=i[n*3],_=i[n*3+1],S=i[n*3+2],D=i[o*3],P=i[o*3+1],H=i[o*3+2],W=i[s*3],G=i[s*3+1],B=i[s*3+2];return Math.abs(h-_)<.01?[new bt(c,1-p),new bt(C,1-S),new bt(D,1-H),new bt(W,1-B)]:[new bt(h,1-p),new bt(_,1-S),new bt(P,1-H),new bt(G,1-B)]}};function vy(a,t,i){if(i.shapes=[],Array.isArray(a))for(var r=0,n=a.length;r<n;r++){var o=a[r];i.shapes.push(o.uuid)}else i.shapes.push(a.uuid);return t.extrudePath!==void 0&&(i.options.extrudePath=t.extrudePath.toJSON()),i}var mc=function(a){Or(t,a);function t(i,r){var n;i===void 0&&(i=1),r===void 0&&(r=0);var o=(1+Math.sqrt(5))/2,s=[-1,o,0,1,o,0,-1,-o,0,1,-o,0,0,-1,o,0,1,o,0,-1,-o,0,1,-o,o,0,-1,o,0,1,-o,0,-1,-o,0,1],c=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];return n=a.call(this,s,c,i,r)||this,n.type="IcosahedronGeometry",n.parameters={radius:i,detail:r},n}return t}(co),gc=function(a){Or(t,a);function t(i,r,n,o){var s;r===void 0&&(r=12),n===void 0&&(n=0),o===void 0&&(o=Math.PI*2),s=a.call(this)||this,s.type="LatheGeometry",s.parameters={points:i,segments:r,phiStart:n,phiLength:o},r=Math.floor(r),o=gr.clamp(o,0,Math.PI*2);for(var c=[],h=[],p=[],C=1/r,_=new fe,S=new bt,D=0;D<=r;D++)for(var P=n+D*C*o,H=Math.sin(P),W=Math.cos(P),G=0;G<=i.length-1;G++)_.x=i[G].x*H,_.y=i[G].y,_.z=i[G].x*W,h.push(_.x,_.y,_.z),S.x=D/r,S.y=G/(i.length-1),p.push(S.x,S.y);for(var B=0;B<r;B++)for(var te=0;te<i.length-1;te++){var he=te+B*i.length,K=he,Q=he+i.length,le=he+i.length+1,Me=he+1;c.push(K,Q,Me),c.push(Q,le,Me)}if(s.setIndex(c),s.setAttribute("position",new Nt(h,3)),s.setAttribute("uv",new Nt(p,2)),s.computeVertexNormals(),o===Math.PI*2)for(var xe=s.attributes.normal.array,_e=new fe,Pe=new fe,Ce=new fe,Ae=r*i.length*3,Be=0,Se=0;Be<i.length;Be++,Se+=3)_e.x=xe[Se+0],_e.y=xe[Se+1],_e.z=xe[Se+2],Pe.x=xe[Ae+Se+0],Pe.y=xe[Ae+Se+1],Pe.z=xe[Ae+Se+2],Ce.addVectors(_e,Pe).normalize(),xe[Se+0]=xe[Ae+Se+0]=Ce.x,xe[Se+1]=xe[Ae+Se+1]=Ce.y,xe[Se+2]=xe[Ae+Se+2]=Ce.z;return s}return t}(tr),ml=function(a){Or(t,a);function t(i,r){var n;i===void 0&&(i=1),r===void 0&&(r=0);var o=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];return n=a.call(this,o,s,i,r)||this,n.type="OctahedronGeometry",n.parameters={radius:i,detail:r},n}return t}(co);function Io(a,t,i){tr.call(this),this.type="ParametricGeometry",this.parameters={func:a,slices:t,stacks:i};var r=[],n=[],o=[],s=[],c=1e-5,h=new fe,p=new fe,C=new fe,_=new fe,S=new fe;a.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var D=t+1,P=0;P<=i;P++)for(var H=P/i,W=0;W<=t;W++){var G=W/t;a(G,H,p),n.push(p.x,p.y,p.z),G-c>=0?(a(G-c,H,C),_.subVectors(p,C)):(a(G+c,H,C),_.subVectors(C,p)),H-c>=0?(a(G,H-c,C),S.subVectors(p,C)):(a(G,H+c,C),S.subVectors(C,p)),h.crossVectors(_,S).normalize(),o.push(h.x,h.y,h.z),s.push(G,H)}for(var B=0;B<i;B++)for(var te=0;te<t;te++){var he=B*D+te,K=B*D+te+1,Q=(B+1)*D+te+1,le=(B+1)*D+te;r.push(he,K,le),r.push(K,Q,le)}this.setIndex(r),this.setAttribute("position",new Nt(n,3)),this.setAttribute("normal",new Nt(o,3)),this.setAttribute("uv",new Nt(s,2))}Io.prototype=Object.create(tr.prototype),Io.prototype.constructor=Io;var yc=function(a){Or(t,a);function t(i,r,n,o,s,c){var h;i===void 0&&(i=.5),r===void 0&&(r=1),n===void 0&&(n=8),o===void 0&&(o=1),s===void 0&&(s=0),c===void 0&&(c=Math.PI*2),h=a.call(this)||this,h.type="RingGeometry",h.parameters={innerRadius:i,outerRadius:r,thetaSegments:n,phiSegments:o,thetaStart:s,thetaLength:c},n=Math.max(3,n),o=Math.max(1,o);for(var p=[],C=[],_=[],S=[],D=i,P=(r-i)/o,H=new fe,W=new bt,G=0;G<=o;G++){for(var B=0;B<=n;B++){var te=s+B/n*c;H.x=D*Math.cos(te),H.y=D*Math.sin(te),C.push(H.x,H.y,H.z),_.push(0,0,1),W.x=(H.x/r+1)/2,W.y=(H.y/r+1)/2,S.push(W.x,W.y)}D+=P}for(var he=0;he<o;he++)for(var K=he*(n+1),Q=0;Q<n;Q++){var le=Q+K,Me=le,xe=le+n+1,_e=le+n+2,Pe=le+1;p.push(Me,xe,Pe),p.push(xe,_e,Pe)}return h.setIndex(p),h.setAttribute("position",new Nt(C,3)),h.setAttribute("normal",new Nt(_,3)),h.setAttribute("uv",new Nt(S,2)),h}return t}(tr),gl=function(a){Or(t,a);function t(r,n){var o;n===void 0&&(n=12),o=a.call(this)||this,o.type="ShapeGeometry",o.parameters={shapes:r,curveSegments:n};var s=[],c=[],h=[],p=[],C=0,_=0;if(Array.isArray(r)===!1)D(r);else for(var S=0;S<r.length;S++)D(r[S]),o.addGroup(C,_,S),C+=_,_=0;o.setIndex(s),o.setAttribute("position",new Nt(c,3)),o.setAttribute("normal",new Nt(h,3)),o.setAttribute("uv",new Nt(p,2));function D(P){var H=c.length/3,W=P.extractPoints(n),G=W.shape,B=W.holes;Na.isClockWise(G)===!1&&(G=G.reverse());for(var te=0,he=B.length;te<he;te++){var K=B[te];Na.isClockWise(K)===!0&&(B[te]=K.reverse())}for(var Q=Na.triangulateShape(G,B),le=0,Me=B.length;le<Me;le++){var xe=B[le];G=G.concat(xe)}for(var _e=0,Pe=G.length;_e<Pe;_e++){var Ce=G[_e];c.push(Ce.x,Ce.y,0),h.push(0,0,1),p.push(Ce.x,Ce.y)}for(var Ae=0,Be=Q.length;Ae<Be;Ae++){var Se=Q[Ae],Te=Se[0]+H,me=Se[1]+H,Ue=Se[2]+H;s.push(Te,me,Ue),_+=3}}return o}var i=t.prototype;return i.toJSON=function(){var n=tr.prototype.toJSON.call(this),o=this.parameters.shapes;return my(o,n)},t}(tr);function my(a,t){if(t.shapes=[],Array.isArray(a))for(var i=0,r=a.length;i<r;i++){var n=a[i];t.shapes.push(n.uuid)}else t.shapes.push(a.uuid);return t}var yl=function(a){Or(t,a);function t(i,r,n,o,s,c,h){var p;i===void 0&&(i=1),r===void 0&&(r=8),n===void 0&&(n=6),o===void 0&&(o=0),s===void 0&&(s=Math.PI*2),c===void 0&&(c=0),h===void 0&&(h=Math.PI),p=a.call(this)||this,p.type="SphereGeometry",p.parameters={radius:i,widthSegments:r,heightSegments:n,phiStart:o,phiLength:s,thetaStart:c,thetaLength:h},r=Math.max(3,Math.floor(r)),n=Math.max(2,Math.floor(n));for(var C=Math.min(c+h,Math.PI),_=0,S=[],D=new fe,P=new fe,H=[],W=[],G=[],B=[],te=0;te<=n;te++){var he=[],K=te/n,Q=0;te==0&&c==0?Q=.5/r:te==n&&C==Math.PI&&(Q=-.5/r);for(var le=0;le<=r;le++){var Me=le/r;D.x=-i*Math.cos(o+Me*s)*Math.sin(c+K*h),D.y=i*Math.cos(c+K*h),D.z=i*Math.sin(o+Me*s)*Math.sin(c+K*h),W.push(D.x,D.y,D.z),P.copy(D).normalize(),G.push(P.x,P.y,P.z),B.push(Me+Q,1-K),he.push(_++)}S.push(he)}for(var xe=0;xe<n;xe++)for(var _e=0;_e<r;_e++){var Pe=S[xe][_e+1],Ce=S[xe][_e],Ae=S[xe+1][_e],Be=S[xe+1][_e+1];(xe!==0||c>0)&&H.push(Pe,Ce,Be),(xe!==n-1||C<Math.PI)&&H.push(Ce,Ae,Be)}return p.setIndex(H),p.setAttribute("position",new Nt(W,3)),p.setAttribute("normal",new Nt(G,3)),p.setAttribute("uv",new Nt(B,2)),p}return t}(tr),Ac=function(a){Or(t,a);function t(i,r){var n;i===void 0&&(i=1),r===void 0&&(r=0);var o=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];return n=a.call(this,o,s,i,r)||this,n.type="TetrahedronGeometry",n.parameters={radius:i,detail:r},n}return t}(co),bc=function(a){Or(t,a);function t(i,r){var n;r===void 0&&(r={});var o=r.font;if(!(o&&o.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new tr||Ji(n);var s=o.generateShapes(i,r.size);return r.depth=r.height!==void 0?r.height:50,r.bevelThickness===void 0&&(r.bevelThickness=10),r.bevelSize===void 0&&(r.bevelSize=8),r.bevelEnabled===void 0&&(r.bevelEnabled=!1),n=a.call(this,s,r)||this,n.type="TextGeometry",n}return t}(Oo),Ec=function(a){Or(t,a);function t(i,r,n,o,s){var c;i===void 0&&(i=1),r===void 0&&(r=.4),n===void 0&&(n=8),o===void 0&&(o=6),s===void 0&&(s=Math.PI*2),c=a.call(this)||this,c.type="TorusGeometry",c.parameters={radius:i,tube:r,radialSegments:n,tubularSegments:o,arc:s},n=Math.floor(n),o=Math.floor(o);for(var h=[],p=[],C=[],_=[],S=new fe,D=new fe,P=new fe,H=0;H<=n;H++)for(var W=0;W<=o;W++){var G=W/o*s,B=H/n*Math.PI*2;D.x=(i+r*Math.cos(B))*Math.cos(G),D.y=(i+r*Math.cos(B))*Math.sin(G),D.z=r*Math.sin(B),p.push(D.x,D.y,D.z),S.x=i*Math.cos(G),S.y=i*Math.sin(G),P.subVectors(D,S).normalize(),C.push(P.x,P.y,P.z),_.push(W/o),_.push(H/n)}for(var te=1;te<=n;te++)for(var he=1;he<=o;he++){var K=(o+1)*te+he-1,Q=(o+1)*(te-1)+he-1,le=(o+1)*(te-1)+he,Me=(o+1)*te+he;h.push(K,Q,Me),h.push(Q,le,Me)}return c.setIndex(h),c.setAttribute("position",new Nt(p,3)),c.setAttribute("normal",new Nt(C,3)),c.setAttribute("uv",new Nt(_,2)),c}return t}(tr),wc=function(a){Or(t,a);function t(i,r,n,o,s,c){var h;i===void 0&&(i=1),r===void 0&&(r=.4),n===void 0&&(n=64),o===void 0&&(o=8),s===void 0&&(s=2),c===void 0&&(c=3),h=a.call(this)||this,h.type="TorusKnotGeometry",h.parameters={radius:i,tube:r,tubularSegments:n,radialSegments:o,p:s,q:c},n=Math.floor(n),o=Math.floor(o);for(var p=[],C=[],_=[],S=[],D=new fe,P=new fe,H=new fe,W=new fe,G=new fe,B=new fe,te=new fe,he=0;he<=n;++he){var K=he/n*s*Math.PI*2;Te(K,s,c,i,H),Te(K+.01,s,c,i,W),B.subVectors(W,H),te.addVectors(W,H),G.crossVectors(B,te),te.crossVectors(G,B),G.normalize(),te.normalize();for(var Q=0;Q<=o;++Q){var le=Q/o*Math.PI*2,Me=-r*Math.cos(le),xe=r*Math.sin(le);D.x=H.x+(Me*te.x+xe*G.x),D.y=H.y+(Me*te.y+xe*G.y),D.z=H.z+(Me*te.z+xe*G.z),C.push(D.x,D.y,D.z),P.subVectors(D,H).normalize(),_.push(P.x,P.y,P.z),S.push(he/n),S.push(Q/o)}}for(var _e=1;_e<=n;_e++)for(var Pe=1;Pe<=o;Pe++){var Ce=(o+1)*(_e-1)+(Pe-1),Ae=(o+1)*_e+(Pe-1),Be=(o+1)*_e+Pe,Se=(o+1)*(_e-1)+Pe;p.push(Ce,Ae,Se),p.push(Ae,Be,Se)}h.setIndex(p),h.setAttribute("position",new Nt(C,3)),h.setAttribute("normal",new Nt(_,3)),h.setAttribute("uv",new Nt(S,2));function Te(me,Ue,He,Qe,qe){var gt=Math.cos(me),St=Math.sin(me),Vt=He/Ue*me,Ke=Math.cos(Vt);qe.x=Qe*(2+Ke)*.5*gt,qe.y=Qe*(2+Ke)*St*.5,qe.z=Qe*Math.sin(Vt)*.5}return h}return t}(tr),xc=function(a){Or(t,a);function t(r,n,o,s,c){var h;n===void 0&&(n=64),o===void 0&&(o=1),s===void 0&&(s=8),c===void 0&&(c=!1),h=a.call(this)||this,h.type="TubeGeometry",h.parameters={path:r,tubularSegments:n,radius:o,radialSegments:s,closed:c};var p=r.computeFrenetFrames(n,c);h.tangents=p.tangents,h.normals=p.normals,h.binormals=p.binormals;var C=new fe,_=new fe,S=new bt,D=new fe,P=[],H=[],W=[],G=[];B(),h.setIndex(G),h.setAttribute("position",new Nt(P,3)),h.setAttribute("normal",new Nt(H,3)),h.setAttribute("uv",new Nt(W,2));function B(){for(var Q=0;Q<n;Q++)te(Q);te(c===!1?n:0),K(),he()}function te(Q){D=r.getPointAt(Q/n,D);for(var le=p.normals[Q],Me=p.binormals[Q],xe=0;xe<=s;xe++){var _e=xe/s*Math.PI*2,Pe=Math.sin(_e),Ce=-Math.cos(_e);_.x=Ce*le.x+Pe*Me.x,_.y=Ce*le.y+Pe*Me.y,_.z=Ce*le.z+Pe*Me.z,_.normalize(),H.push(_.x,_.y,_.z),C.x=D.x+o*_.x,C.y=D.y+o*_.y,C.z=D.z+o*_.z,P.push(C.x,C.y,C.z)}}function he(){for(var Q=1;Q<=n;Q++)for(var le=1;le<=s;le++){var Me=(s+1)*(Q-1)+(le-1),xe=(s+1)*Q+(le-1),_e=(s+1)*Q+le,Pe=(s+1)*(Q-1)+le;G.push(Me,xe,Pe),G.push(xe,_e,Pe)}}function K(){for(var Q=0;Q<=n;Q++)for(var le=0;le<=s;le++)S.x=Q/n,S.y=le/s,W.push(S.x,S.y)}return h}var i=t.prototype;return i.toJSON=function(){var n=tr.prototype.toJSON.call(this);return n.path=this.parameters.path.toJSON(),n},t}(tr),ju=function(a){Or(t,a);function t(i){var r;if(r=a.call(this)||this,r.type="WireframeGeometry",i.isGeometry===!0)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Ji(r);var n=[],o=[0,0],s={},c=new fe;if(i.index!==null){var h=i.attributes.position,p=i.index,C=i.groups;C.length===0&&(C=[{start:0,count:p.count,materialIndex:0}]);for(var _=0,S=C.length;_<S;++_)for(var D=C[_],P=D.start,H=D.count,W=P,G=P+H;W<G;W+=3)for(var B=0;B<3;B++){var te=p.getX(W+B),he=p.getX(W+(B+1)%3);o[0]=Math.min(te,he),o[1]=Math.max(te,he);var K=o[0]+","+o[1];s[K]===void 0&&(s[K]={index1:o[0],index2:o[1]})}for(var Q in s){var le=s[Q];c.fromBufferAttribute(h,le.index1),n.push(c.x,c.y,c.z),c.fromBufferAttribute(h,le.index2),n.push(c.x,c.y,c.z)}}else for(var Me=i.attributes.position,xe=0,_e=Me.count/3;xe<_e;xe++)for(var Pe=0;Pe<3;Pe++){var Ce=3*xe+Pe;c.fromBufferAttribute(Me,Ce),n.push(c.x,c.y,c.z);var Ae=3*xe+(Pe+1)%3;c.fromBufferAttribute(Me,Ae),n.push(c.x,c.y,c.z)}return r.setAttribute("position",new Nt(n,3)),r}return t}(tr),Ei=Object.freeze({__proto__:null,BoxGeometry:Ro,BoxBufferGeometry:Ro,CircleGeometry:lc,CircleBufferGeometry:lc,ConeGeometry:cc,ConeBufferGeometry:cc,CylinderGeometry:bs,CylinderBufferGeometry:bs,DodecahedronGeometry:uc,DodecahedronBufferGeometry:uc,EdgesGeometry:Vu,ExtrudeGeometry:Oo,ExtrudeBufferGeometry:Oo,IcosahedronGeometry:mc,IcosahedronBufferGeometry:mc,LatheGeometry:gc,LatheBufferGeometry:gc,OctahedronGeometry:ml,OctahedronBufferGeometry:ml,ParametricGeometry:Io,ParametricBufferGeometry:Io,PlaneGeometry:Js,PlaneBufferGeometry:Js,PolyhedronGeometry:co,PolyhedronBufferGeometry:co,RingGeometry:yc,RingBufferGeometry:yc,ShapeGeometry:gl,ShapeBufferGeometry:gl,SphereGeometry:yl,SphereBufferGeometry:yl,TetrahedronGeometry:Ac,TetrahedronBufferGeometry:Ac,TextGeometry:bc,TextBufferGeometry:bc,TorusGeometry:Ec,TorusBufferGeometry:Ec,TorusKnotGeometry:wc,TorusKnotBufferGeometry:wc,TubeGeometry:xc,TubeBufferGeometry:xc,WireframeGeometry:ju});function Bo(a){hr.call(this),this.type="ShadowMaterial",this.color=new It(0),this.transparent=!0,this.setValues(a)}Bo.prototype=Object.create(hr.prototype),Bo.prototype.constructor=Bo,Bo.prototype.isShadowMaterial=!0,Bo.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.color.copy(a.color),this};function ka(a){Ai.call(this,a),this.type="RawShaderMaterial"}ka.prototype=Object.create(Ai.prototype),ka.prototype.constructor=ka,ka.prototype.isRawShaderMaterial=!0;function ba(a){hr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new It(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new It(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new bt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(a)}ba.prototype=Object.create(hr.prototype),ba.prototype.constructor=ba,ba.prototype.isMeshStandardMaterial=!0,ba.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.defines={STANDARD:""},this.color.copy(a.color),this.roughness=a.roughness,this.metalness=a.metalness,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.roughnessMap=a.roughnessMap,this.metalnessMap=a.metalnessMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapIntensity=a.envMapIntensity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this.vertexTangents=a.vertexTangents,this};function ho(a){ba.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new bt(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(i){this.reflectivity=gr.clamp(2.5*(i-1)/(i+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(a)}ho.prototype=Object.create(ba.prototype),ho.prototype.constructor=ho,ho.prototype.isMeshPhysicalMaterial=!0,ho.prototype.copy=function(a){return ba.prototype.copy.call(this,a),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=a.clearcoat,this.clearcoatMap=a.clearcoatMap,this.clearcoatRoughness=a.clearcoatRoughness,this.clearcoatRoughnessMap=a.clearcoatRoughnessMap,this.clearcoatNormalMap=a.clearcoatNormalMap,this.clearcoatNormalScale.copy(a.clearcoatNormalScale),this.reflectivity=a.reflectivity,a.sheen?this.sheen=(this.sheen||new It).copy(a.sheen):this.sheen=null,this.transmission=a.transmission,this.transmissionMap=a.transmissionMap,this};function fo(a){hr.call(this),this.type="MeshPhongMaterial",this.color=new It(16777215),this.specular=new It(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new It(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new bt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Oe,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}fo.prototype=Object.create(hr.prototype),fo.prototype.constructor=fo,fo.prototype.isMeshPhongMaterial=!0,fo.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.color.copy(a.color),this.specular.copy(a.specular),this.shininess=a.shininess,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};function Fo(a){hr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new It(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new It(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new bt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}Fo.prototype=Object.create(hr.prototype),Fo.prototype.constructor=Fo,Fo.prototype.isMeshToonMaterial=!0,Fo.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.gradientMap=a.gradientMap,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};function No(a){hr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new bt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}No.prototype=Object.create(hr.prototype),No.prototype.constructor=No,No.prototype.isMeshNormalMaterial=!0,No.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};function ko(a){hr.call(this),this.type="MeshLambertMaterial",this.color=new It(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new It(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Oe,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}ko.prototype=Object.create(hr.prototype),ko.prototype.constructor=ko,ko.prototype.isMeshLambertMaterial=!0,ko.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};function Uo(a){hr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new It(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new bt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}Uo.prototype=Object.create(hr.prototype),Uo.prototype.constructor=Uo,Uo.prototype.isMeshMatcapMaterial=!0,Uo.prototype.copy=function(a){return hr.prototype.copy.call(this,a),this.defines={MATCAP:""},this.color.copy(a.color),this.matcap=a.matcap,this.map=a.map,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};function Ho(a){Rn.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(a)}Ho.prototype=Object.create(Rn.prototype),Ho.prototype.constructor=Ho,Ho.prototype.isLineDashedMaterial=!0,Ho.prototype.copy=function(a){return Rn.prototype.copy.call(this,a),this.scale=a.scale,this.dashSize=a.dashSize,this.gapSize=a.gapSize,this};var gy=Object.freeze({__proto__:null,ShadowMaterial:Bo,SpriteMaterial:lo,RawShaderMaterial:ka,ShaderMaterial:Ai,PointsMaterial:ta,MeshPhysicalMaterial:ho,MeshStandardMaterial:ba,MeshPhongMaterial:fo,MeshToonMaterial:Fo,MeshNormalMaterial:No,MeshLambertMaterial:ko,MeshDepthMaterial:ao,MeshDistanceMaterial:oo,MeshBasicMaterial:Li,MeshMatcapMaterial:Uo,LineDashedMaterial:Ho,LineBasicMaterial:Rn,Material:hr}),_n={arraySlice:function(t,i,r){return _n.isTypedArray(t)?new t.constructor(t.subarray(i,r!==void 0?r:t.length)):t.slice(i,r)},convertArray:function(t,i,r){return!t||!r&&t.constructor===i?t:typeof i.BYTES_PER_ELEMENT=="number"?new i(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function i(s,c){return t[s]-t[c]}for(var r=t.length,n=new Array(r),o=0;o!==r;++o)n[o]=o;return n.sort(i),n},sortedArray:function(t,i,r){for(var n=t.length,o=new t.constructor(n),s=0,c=0;c!==n;++s)for(var h=r[s]*i,p=0;p!==i;++p)o[c++]=t[h+p];return o},flattenJSON:function(t,i,r,n){for(var o=1,s=t[0];s!==void 0&&s[n]===void 0;)s=t[o++];if(s!==void 0){var c=s[n];if(c!==void 0)if(Array.isArray(c))do c=s[n],c!==void 0&&(i.push(s.time),r.push.apply(r,c)),s=t[o++];while(s!==void 0);else if(c.toArray!==void 0)do c=s[n],c!==void 0&&(i.push(s.time),c.toArray(r,r.length)),s=t[o++];while(s!==void 0);else do c=s[n],c!==void 0&&(i.push(s.time),r.push(c)),s=t[o++];while(s!==void 0)}},subclip:function(t,i,r,n,o){o===void 0&&(o=30);var s=t.clone();s.name=i;for(var c=[],h=0;h<s.tracks.length;++h){for(var p=s.tracks[h],C=p.getValueSize(),_=[],S=[],D=0;D<p.times.length;++D){var P=p.times[D]*o;if(!(P<r||P>=n)){_.push(p.times[D]);for(var H=0;H<C;++H)S.push(p.values[D*C+H])}}_.length!==0&&(p.times=_n.convertArray(_,p.times.constructor),p.values=_n.convertArray(S,p.values.constructor),c.push(p))}s.tracks=c;for(var W=1/0,G=0;G<s.tracks.length;++G)W>s.tracks[G].times[0]&&(W=s.tracks[G].times[0]);for(var B=0;B<s.tracks.length;++B)s.tracks[B].shift(-1*W);return s.resetDuration(),s},makeClipAdditive:function(t,i,r,n){i===void 0&&(i=0),r===void 0&&(r=t),n===void 0&&(n=30),n<=0&&(n=30);for(var o=r.tracks.length,s=i/n,c=function(_){var S=r.tracks[_],D=S.ValueTypeName;if(D==="bool"||D==="string")return"continue";var P=t.tracks.find(function(Ue){return Ue.name===S.name&&Ue.ValueTypeName===D});if(P===void 0)return"continue";var H=0,W=S.getValueSize();S.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(H=W/3);var G=0,B=P.getValueSize();P.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(G=B/3);var te=S.times.length-1,he=void 0;if(s<=S.times[0]){var K=H,Q=W-H;he=_n.arraySlice(S.values,K,Q)}else if(s>=S.times[te]){var le=te*W+H,Me=le+W-H;he=_n.arraySlice(S.values,le,Me)}else{var xe=S.createInterpolant(),_e=H,Pe=W-H;xe.evaluate(s),he=_n.arraySlice(xe.resultBuffer,_e,Pe)}if(D==="quaternion"){var Ce=new ni().fromArray(he).normalize().conjugate();Ce.toArray(he)}for(var Ae=P.times.length,Be=0;Be<Ae;++Be){var Se=Be*B+G;if(D==="quaternion")ni.multiplyQuaternionsFlat(P.values,Se,he,0,P.values,Se);else for(var Te=B-G*2,me=0;me<Te;++me)P.values[Se+me]-=he[me]}},h=0;h<o;++h)var p=c(h);return t.blendMode=Ca,t}};function Oi(a,t,i,r){this.parameterPositions=a,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i}Object.assign(Oi.prototype,{evaluate:function(t){var i=this.parameterPositions,r=this._cachedIndex,n=i[r],o=i[r-1];e:{t:{var s;r:{n:if(!(t<n)){for(var c=r+2;;){if(n===void 0){if(t<o)break n;return r=i.length,this._cachedIndex=r,this.afterEnd_(r-1,t,o)}if(r===c)break;if(o=n,n=i[++r],t<n)break t}s=i.length;break r}if(!(t>=o)){var h=i[1];t<h&&(r=2,o=h);for(var p=r-2;;){if(o===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(r===p)break;if(n=o,o=i[--r-1],t>=o)break t}s=r,r=0;break r}break e}for(;r<s;){var C=r+s>>>1;t<i[C]?s=C:r=C+1}if(n=i[r],o=i[r-1],o===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(n===void 0)return r=i.length,this._cachedIndex=r,this.afterEnd_(r-1,o,t)}this._cachedIndex=r,this.intervalChanged_(r,o,n)}return this.interpolate_(r,o,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var i=this.resultBuffer,r=this.sampleValues,n=this.valueSize,o=t*n,s=0;s!==n;++s)i[s]=r[o+s];return i},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Oi.prototype,{beforeStart_:Oi.prototype.copySampleValue_,afterEnd_:Oi.prototype.copySampleValue_});function Mc(a,t,i,r){Oi.call(this,a,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}Mc.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Mc,DefaultSettings_:{endingStart:Ti,endingEnd:Ti},intervalChanged_:function(t,i,r){var n=this.parameterPositions,o=t-2,s=t+1,c=n[o],h=n[s];if(c===void 0)switch(this.getSettings_().endingStart){case Si:o=t,c=2*i-r;break;case qi:o=n.length-2,c=i+n[o]-n[o+1];break;default:o=t,c=r}if(h===void 0)switch(this.getSettings_().endingEnd){case Si:s=t,h=2*r-i;break;case qi:s=1,h=r+n[1]-n[0];break;default:s=t-1,h=i}var p=(r-i)*.5,C=this.valueSize;this._weightPrev=p/(i-c),this._weightNext=p/(h-r),this._offsetPrev=o*C,this._offsetNext=s*C},interpolate_:function(t,i,r,n){for(var o=this.resultBuffer,s=this.sampleValues,c=this.valueSize,h=t*c,p=h-c,C=this._offsetPrev,_=this._offsetNext,S=this._weightPrev,D=this._weightNext,P=(r-i)/(n-i),H=P*P,W=H*P,G=-S*W+2*S*H-S*P,B=(1+S)*W+(-1.5-2*S)*H+(-.5+S)*P+1,te=(-1-D)*W+(1.5+D)*H+.5*P,he=D*W-D*H,K=0;K!==c;++K)o[K]=G*s[C+K]+B*s[p+K]+te*s[h+K]+he*s[_+K];return o}});function Al(a,t,i,r){Oi.call(this,a,t,i,r)}Al.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Al,interpolate_:function(t,i,r,n){for(var o=this.resultBuffer,s=this.sampleValues,c=this.valueSize,h=t*c,p=h-c,C=(r-i)/(n-i),_=1-C,S=0;S!==c;++S)o[S]=s[p+S]*_+s[h+S]*C;return o}});function Tc(a,t,i,r){Oi.call(this,a,t,i,r)}Tc.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Tc,interpolate_:function(t){return this.copySampleValue_(t-1)}});function ii(a,t,i,r){if(a===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a,this.times=_n.convertArray(t,this.TimeBufferType),this.values=_n.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}Object.assign(ii,{toJSON:function(t){var i=t.constructor,r;if(i.toJSON!==void 0)r=i.toJSON(t);else{r={name:t.name,times:_n.convertArray(t.times,Array),values:_n.convertArray(t.values,Array)};var n=t.getInterpolation();n!==t.DefaultInterpolation&&(r.interpolation=n)}return r.type=t.ValueTypeName,r}}),Object.assign(ii.prototype,{constructor:ii,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Qi,InterpolantFactoryMethodDiscrete:function(t){return new Tc(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Al(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Mc(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var i;switch(t){case Yi:i=this.InterpolantFactoryMethodDiscrete;break;case Qi:i=this.InterpolantFactoryMethodLinear;break;case da:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=i,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Yi;case this.InterpolantFactoryMethodLinear:return Qi;case this.InterpolantFactoryMethodSmooth:return da}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(t!==0)for(var i=this.times,r=0,n=i.length;r!==n;++r)i[r]+=t;return this},scale:function(t){if(t!==1)for(var i=this.times,r=0,n=i.length;r!==n;++r)i[r]*=t;return this},trim:function(t,i){for(var r=this.times,n=r.length,o=0,s=n-1;o!==n&&r[o]<t;)++o;for(;s!==-1&&r[s]>i;)--s;if(++s,o!==0||s!==n){o>=s&&(s=Math.max(s,1),o=s-1);var c=this.getValueSize();this.times=_n.arraySlice(r,o,s),this.values=_n.arraySlice(this.values,o*c,s*c)}return this},validate:function(){var t=!0,i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var r=this.times,n=this.values,o=r.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var s=null,c=0;c!==o;c++){var h=r[c];if(typeof h=="number"&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,h),t=!1;break}if(s!==null&&s>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,h,s),t=!1;break}s=h}if(n!==void 0&&_n.isTypedArray(n))for(var p=0,C=n.length;p!==C;++p){var _=n[p];if(isNaN(_)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,p,_),t=!1;break}}return t},optimize:function(){for(var t=_n.arraySlice(this.times),i=_n.arraySlice(this.values),r=this.getValueSize(),n=this.getInterpolation()===da,o=t.length-1,s=1,c=1;c<o;++c){var h=!1,p=t[c],C=t[c+1];if(p!==C&&(c!==1||p!==t[0]))if(n)h=!0;else for(var _=c*r,S=_-r,D=_+r,P=0;P!==r;++P){var H=i[_+P];if(H!==i[S+P]||H!==i[D+P]){h=!0;break}}if(h){if(c!==s){t[s]=t[c];for(var W=c*r,G=s*r,B=0;B!==r;++B)i[G+B]=i[W+B]}++s}}if(o>0){t[s]=t[o];for(var te=o*r,he=s*r,K=0;K!==r;++K)i[he+K]=i[te+K];++s}return s!==t.length?(this.times=_n.arraySlice(t,0,s),this.values=_n.arraySlice(i,0,s*r)):(this.times=t,this.values=i),this},clone:function(){var t=_n.arraySlice(this.times,0),i=_n.arraySlice(this.values,0),r=this.constructor,n=new r(this.name,t,i);return n.createInterpolant=this.createInterpolant,n}});function Sc(a,t,i){ii.call(this,a,t,i)}Sc.prototype=Object.assign(Object.create(ii.prototype),{constructor:Sc,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Yi,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function _c(a,t,i,r){ii.call(this,a,t,i,r)}_c.prototype=Object.assign(Object.create(ii.prototype),{constructor:_c,ValueTypeName:"color"});function xs(a,t,i,r){ii.call(this,a,t,i,r)}xs.prototype=Object.assign(Object.create(ii.prototype),{constructor:xs,ValueTypeName:"number"});function Cc(a,t,i,r){Oi.call(this,a,t,i,r)}Cc.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Cc,interpolate_:function(t,i,r,n){for(var o=this.resultBuffer,s=this.sampleValues,c=this.valueSize,h=(r-i)/(n-i),p=t*c,C=p+c;p!==C;p+=4)ni.slerpFlat(o,0,s,p-c,s,p,h);return o}});function bl(a,t,i,r){ii.call(this,a,t,i,r)}bl.prototype=Object.assign(Object.create(ii.prototype),{constructor:bl,ValueTypeName:"quaternion",DefaultInterpolation:Qi,InterpolantFactoryMethodLinear:function(t){return new Cc(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0});function Lc(a,t,i,r){ii.call(this,a,t,i,r)}Lc.prototype=Object.assign(Object.create(ii.prototype),{constructor:Lc,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Yi,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Ms(a,t,i,r){ii.call(this,a,t,i,r)}Ms.prototype=Object.assign(Object.create(ii.prototype),{constructor:Ms,ValueTypeName:"vector"});function Ii(a,t,i,r){t===void 0&&(t=-1),r===void 0&&(r=fa),this.name=a,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=gr.generateUUID(),this.duration<0&&this.resetDuration()}function yy(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return xs;case"vector":case"vector2":case"vector3":case"vector4":return Ms;case"color":return _c;case"quaternion":return bl;case"bool":case"boolean":return Sc;case"string":return Lc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+a)}function Ay(a){if(a.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=yy(a.type);if(a.times===void 0){var i=[],r=[];_n.flattenJSON(a.keys,i,r,"value"),a.times=i,a.values=r}return t.parse!==void 0?t.parse(a):new t(a.name,a.times,a.values,a.interpolation)}Object.assign(Ii,{parse:function(t){for(var i=[],r=t.tracks,n=1/(t.fps||1),o=0,s=r.length;o!==s;++o)i.push(Ay(r[o]).scale(n));var c=new Ii(t.name,t.duration,i,t.blendMode);return c.uuid=t.uuid,c},toJSON:function(t){for(var i=[],r=t.tracks,n={name:t.name,duration:t.duration,tracks:i,uuid:t.uuid,blendMode:t.blendMode},o=0,s=r.length;o!==s;++o)i.push(ii.toJSON(r[o]));return n},CreateFromMorphTargetSequence:function(t,i,r,n){for(var o=i.length,s=[],c=0;c<o;c++){var h=[],p=[];h.push((c+o-1)%o,c,(c+1)%o),p.push(0,1,0);var C=_n.getKeyframeOrder(h);h=_n.sortedArray(h,1,C),p=_n.sortedArray(p,1,C),!n&&h[0]===0&&(h.push(o),p.push(p[0])),s.push(new xs(".morphTargetInfluences["+i[c].name+"]",h,p).scale(1/r))}return new Ii(t,-1,s)},findByName:function(t,i){var r=t;if(!Array.isArray(t)){var n=t;r=n.geometry&&n.geometry.animations||n.animations}for(var o=0;o<r.length;o++)if(r[o].name===i)return r[o];return null},CreateClipsFromMorphTargetSequences:function(t,i,r){for(var n={},o=/^([\w-]*?)([\d]+)$/,s=0,c=t.length;s<c;s++){var h=t[s],p=h.name.match(o);if(p&&p.length>1){var C=p[1],_=n[C];_||(n[C]=_=[]),_.push(h)}}var S=[];for(var D in n)S.push(Ii.CreateFromMorphTargetSequence(D,n[D],i,r));return S},parseAnimation:function(t,i){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var r=function(le,Me,xe,_e,Pe){if(xe.length!==0){var Ce=[],Ae=[];_n.flattenJSON(xe,Ce,Ae,_e),Ce.length!==0&&Pe.push(new le(Me,Ce,Ae))}},n=[],o=t.name||"default",s=t.fps||30,c=t.blendMode,h=t.length||-1,p=t.hierarchy||[],C=0;C<p.length;C++){var _=p[C].keys;if(!(!_||_.length===0))if(_[0].morphTargets){var S={},D=void 0;for(D=0;D<_.length;D++)if(_[D].morphTargets)for(var P=0;P<_[D].morphTargets.length;P++)S[_[D].morphTargets[P]]=-1;for(var H in S){for(var W=[],G=[],B=0;B!==_[D].morphTargets.length;++B){var te=_[D];W.push(te.time),G.push(te.morphTarget===H?1:0)}n.push(new xs(".morphTargetInfluence["+H+"]",W,G))}h=S.length*(s||1)}else{var he=".bones["+i[C].name+"]";r(Ms,he+".position",_,"pos",n),r(bl,he+".quaternion",_,"rot",n),r(Ms,he+".scale",_,"scl",n)}}if(n.length===0)return null;var K=new Ii(o,h,n,c);return K}}),Object.assign(Ii.prototype,{resetDuration:function(){for(var t=this.tracks,i=0,r=0,n=t.length;r!==n;++r){var o=this.tracks[r];i=Math.max(i,o.times[o.times.length-1])}return this.duration=i,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,i=0;i<this.tracks.length;i++)t=t&&this.tracks[i].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],i=0;i<this.tracks.length;i++)t.push(this.tracks[i].clone());return new Ii(this.name,this.duration,t,this.blendMode)},toJSON:function(){return Ii.toJSON(this)}});var Go={enabled:!1,files:{},add:function(t,i){this.enabled!==!1&&(this.files[t]=i)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Xu(a,t,i){var r=this,n=!1,o=0,s=0,c=void 0,h=[];this.onStart=void 0,this.onLoad=a,this.onProgress=t,this.onError=i,this.itemStart=function(p){s++,n===!1&&r.onStart!==void 0&&r.onStart(p,o,s),n=!0},this.itemEnd=function(p){o++,r.onProgress!==void 0&&r.onProgress(p,o,s),o===s&&(n=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(p){r.onError!==void 0&&r.onError(p)},this.resolveURL=function(p){return c?c(p):p},this.setURLModifier=function(p){return c=p,this},this.addHandler=function(p,C){return h.push(p,C),this},this.removeHandler=function(p){var C=h.indexOf(p);return C!==-1&&h.splice(C,2),this},this.getHandler=function(p){for(var C=0,_=h.length;C<_;C+=2){var S=h[C],D=h[C+1];if(S.global&&(S.lastIndex=0),S.test(p))return D}return null}}var ef=new Xu;function dn(a){this.manager=a!==void 0?a:ef,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(dn.prototype,{load:function(){},loadAsync:function(t,i){var r=this;return new Promise(function(n,o){r.load(t,n,i,o)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});var ra={};function zi(a){dn.call(this,a)}zi.prototype=Object.assign(Object.create(dn.prototype),{constructor:zi,load:function(t,i,r,n){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var o=this,s=Go.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){i&&i(s),o.manager.itemEnd(t)},0),s;if(ra[t]!==void 0){ra[t].push({onLoad:i,onProgress:r,onError:n});return}var c=/^data:(.*?)(;base64)?,(.*)$/,h=t.match(c),p;if(h){var C=h[1],_=!!h[2],S=h[3];S=decodeURIComponent(S),_&&(S=atob(S));try{var D,P=(this.responseType||"").toLowerCase();switch(P){case"arraybuffer":case"blob":for(var H=new Uint8Array(S.length),W=0;W<S.length;W++)H[W]=S.charCodeAt(W);P==="blob"?D=new Blob([H.buffer],{type:C}):D=H.buffer;break;case"document":var G=new DOMParser;D=G.parseFromString(S,C);break;case"json":D=JSON.parse(S);break;default:D=S;break}setTimeout(function(){i&&i(D),o.manager.itemEnd(t)},0)}catch(te){setTimeout(function(){n&&n(te),o.manager.itemError(t),o.manager.itemEnd(t)},0)}}else{ra[t]=[],ra[t].push({onLoad:i,onProgress:r,onError:n}),p=new XMLHttpRequest,p.open("GET",t,!0),p.addEventListener("load",function(te){var he=this.response,K=ra[t];if(delete ra[t],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Go.add(t,he);for(var Q=0,le=K.length;Q<le;Q++){var Me=K[Q];Me.onLoad&&Me.onLoad(he)}o.manager.itemEnd(t)}else{for(var xe=0,_e=K.length;xe<_e;xe++){var Pe=K[xe];Pe.onError&&Pe.onError(te)}o.manager.itemError(t),o.manager.itemEnd(t)}},!1),p.addEventListener("progress",function(te){for(var he=ra[t],K=0,Q=he.length;K<Q;K++){var le=he[K];le.onProgress&&le.onProgress(te)}},!1),p.addEventListener("error",function(te){var he=ra[t];delete ra[t];for(var K=0,Q=he.length;K<Q;K++){var le=he[K];le.onError&&le.onError(te)}o.manager.itemError(t),o.manager.itemEnd(t)},!1),p.addEventListener("abort",function(te){var he=ra[t];delete ra[t];for(var K=0,Q=he.length;K<Q;K++){var le=he[K];le.onError&&le.onError(te)}o.manager.itemError(t),o.manager.itemEnd(t)},!1),this.responseType!==void 0&&(p.responseType=this.responseType),this.withCredentials!==void 0&&(p.withCredentials=this.withCredentials),p.overrideMimeType&&p.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(var B in this.requestHeader)p.setRequestHeader(B,this.requestHeader[B]);p.send(null)}return o.manager.itemStart(t),p},setResponseType:function(t){return this.responseType=t,this},setMimeType:function(t){return this.mimeType=t,this}});function Yu(a){dn.call(this,a)}Yu.prototype=Object.assign(Object.create(dn.prototype),{constructor:Yu,load:function(t,i,r,n){var o=this,s=new zi(o.manager);s.setPath(o.path),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(t,function(c){try{i(o.parse(JSON.parse(c)))}catch(h){n?n(h):console.error(h),o.manager.itemError(t)}},r,n)},parse:function(t){for(var i=[],r=0;r<t.length;r++){var n=Ii.parse(t[r]);i.push(n)}return i}});function Qu(a){dn.call(this,a)}Qu.prototype=Object.assign(Object.create(dn.prototype),{constructor:Qu,load:function(t,i,r,n){var o=this,s=[],c=new As,h=new zi(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(o.withCredentials);var p=0;function C(D){h.load(t[D],function(P){var H=o.parse(P,!0);s[D]={width:H.width,height:H.height,format:H.format,mipmaps:H.mipmaps},p+=1,p===6&&(H.mipmapCount===1&&(c.minFilter=nt),c.image=s,c.format=H.format,c.needsUpdate=!0,i&&i(c))},r,n)}if(Array.isArray(t))for(var _=0,S=t.length;_<S;++_)C(_);else h.load(t,function(D){var P=o.parse(D,!0);if(P.isCubemap){for(var H=P.mipmaps.length/P.mipmapCount,W=0;W<H;W++){s[W]={mipmaps:[]};for(var G=0;G<P.mipmapCount;G++)s[W].mipmaps.push(P.mipmaps[W*P.mipmapCount+G]),s[W].format=P.format,s[W].width=P.width,s[W].height=P.height}c.image=s}else c.image.width=P.width,c.image.height=P.height,c.mipmaps=P.mipmaps;P.mipmapCount===1&&(c.minFilter=nt),c.format=P.format,c.needsUpdate=!0,i&&i(c)},r,n);return c}});function Ts(a){dn.call(this,a)}Ts.prototype=Object.assign(Object.create(dn.prototype),{constructor:Ts,load:function(t,i,r,n){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var o=this,s=Go.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){i&&i(s),o.manager.itemEnd(t)},0),s;var c=document.createElementNS("http://www.w3.org/1999/xhtml","img");function h(){c.removeEventListener("load",h,!1),c.removeEventListener("error",p,!1),Go.add(t,this),i&&i(this),o.manager.itemEnd(t)}function p(C){c.removeEventListener("load",h,!1),c.removeEventListener("error",p,!1),n&&n(C),o.manager.itemError(t),o.manager.itemEnd(t)}return c.addEventListener("load",h,!1),c.addEventListener("error",p,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),o.manager.itemStart(t),c.src=t,c}});function Rc(a){dn.call(this,a)}Rc.prototype=Object.assign(Object.create(dn.prototype),{constructor:Rc,load:function(t,i,r,n){var o=new Aa,s=new Ts(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);var c=0;function h(C){s.load(t[C],function(_){o.images[C]=_,c++,c===6&&(o.needsUpdate=!0,i&&i(o))},void 0,n)}for(var p=0;p<t.length;++p)h(p);return o}});function Pc(a){dn.call(this,a)}Pc.prototype=Object.assign(Object.create(dn.prototype),{constructor:Pc,load:function(t,i,r,n){var o=this,s=new Ba,c=new zi(this.manager);return c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setPath(this.path),c.setWithCredentials(o.withCredentials),c.load(t,function(h){var p=o.parse(h);p&&(p.image!==void 0?s.image=p.image:p.data!==void 0&&(s.image.width=p.width,s.image.height=p.height,s.image.data=p.data),s.wrapS=p.wrapS!==void 0?p.wrapS:Jt,s.wrapT=p.wrapT!==void 0?p.wrapT:Jt,s.magFilter=p.magFilter!==void 0?p.magFilter:nt,s.minFilter=p.minFilter!==void 0?p.minFilter:nt,s.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.encoding!==void 0&&(s.encoding=p.encoding),p.flipY!==void 0&&(s.flipY=p.flipY),p.format!==void 0&&(s.format=p.format),p.type!==void 0&&(s.type=p.type),p.mipmaps!==void 0&&(s.mipmaps=p.mipmaps,s.minFilter=or),p.mipmapCount===1&&(s.minFilter=nt),s.needsUpdate=!0,i&&i(s,p))},r,n),s}});function Dc(a){dn.call(this,a)}Dc.prototype=Object.assign(Object.create(dn.prototype),{constructor:Dc,load:function(t,i,r,n){var o=new vn,s=new Ts(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(c){o.image=c;var h=t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0;o.format=h?Hi:ti,o.needsUpdate=!0,i!==void 0&&i(o)},r,n),o}});function Zt(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(Zt.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,i){var r=this.getUtoTmapping(t);return this.getPoint(r,i)},getPoints:function(t){t===void 0&&(t=5);for(var i=[],r=0;r<=t;r++)i.push(this.getPoint(r/t));return i},getSpacedPoints:function(t){t===void 0&&(t=5);for(var i=[],r=0;r<=t;r++)i.push(this.getPointAt(r/t));return i},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t===void 0&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var i=[],r,n=this.getPoint(0),o=0;i.push(0);for(var s=1;s<=t;s++)r=this.getPoint(s/t),o+=r.distanceTo(n),i.push(o),n=r;return this.cacheArcLengths=i,i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,i){var r=this.getLengths(),n=0,o=r.length,s;i?s=i:s=t*r[o-1];for(var c=0,h=o-1,p;c<=h;)if(n=Math.floor(c+(h-c)/2),p=r[n]-s,p<0)c=n+1;else if(p>0)h=n-1;else{h=n;break}if(n=h,r[n]===s)return n/(o-1);var C=r[n],_=r[n+1],S=_-C,D=(s-C)/S,P=(n+D)/(o-1);return P},getTangent:function(t,i){var r=1e-4,n=t-r,o=t+r;n<0&&(n=0),o>1&&(o=1);var s=this.getPoint(n),c=this.getPoint(o),h=i||(s.isVector2?new bt:new fe);return h.copy(c).sub(s).normalize(),h},getTangentAt:function(t,i){var r=this.getUtoTmapping(t);return this.getTangent(r,i)},computeFrenetFrames:function(t,i){for(var r=new fe,n=[],o=[],s=[],c=new fe,h=new kr,p=0;p<=t;p++){var C=p/t;n[p]=this.getTangentAt(C,new fe),n[p].normalize()}o[0]=new fe,s[0]=new fe;var _=Number.MAX_VALUE,S=Math.abs(n[0].x),D=Math.abs(n[0].y),P=Math.abs(n[0].z);S<=_&&(_=S,r.set(1,0,0)),D<=_&&(_=D,r.set(0,1,0)),P<=_&&r.set(0,0,1),c.crossVectors(n[0],r).normalize(),o[0].crossVectors(n[0],c),s[0].crossVectors(n[0],o[0]);for(var H=1;H<=t;H++){if(o[H]=o[H-1].clone(),s[H]=s[H-1].clone(),c.crossVectors(n[H-1],n[H]),c.length()>Number.EPSILON){c.normalize();var W=Math.acos(gr.clamp(n[H-1].dot(n[H]),-1,1));o[H].applyMatrix4(h.makeRotationAxis(c,W))}s[H].crossVectors(n[H],o[H])}if(i===!0){var G=Math.acos(gr.clamp(o[0].dot(o[t]),-1,1));G/=t,n[0].dot(c.crossVectors(o[0],o[t]))>0&&(G=-G);for(var B=1;B<=t;B++)o[B].applyMatrix4(h.makeRotationAxis(n[B],G*B)),s[B].crossVectors(n[B],o[B])}return{tangents:n,normals:o,binormals:s}},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}});function Bi(a,t,i,r,n,o,s,c){Zt.call(this),this.type="EllipseCurve",this.aX=a||0,this.aY=t||0,this.xRadius=i||1,this.yRadius=r||1,this.aStartAngle=n||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=s||!1,this.aRotation=c||0}Bi.prototype=Object.create(Zt.prototype),Bi.prototype.constructor=Bi,Bi.prototype.isEllipseCurve=!0,Bi.prototype.getPoint=function(a,t){for(var i=t||new bt,r=Math.PI*2,n=this.aEndAngle-this.aStartAngle,o=Math.abs(n)<Number.EPSILON;n<0;)n+=r;for(;n>r;)n-=r;n<Number.EPSILON&&(o?n=0:n=r),this.aClockwise===!0&&!o&&(n===r?n=-r:n=n-r);var s=this.aStartAngle+a*n,c=this.aX+this.xRadius*Math.cos(s),h=this.aY+this.yRadius*Math.sin(s);if(this.aRotation!==0){var p=Math.cos(this.aRotation),C=Math.sin(this.aRotation),_=c-this.aX,S=h-this.aY;c=_*p-S*C+this.aX,h=_*C+S*p+this.aY}return i.set(c,h)},Bi.prototype.copy=function(a){return Zt.prototype.copy.call(this,a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this},Bi.prototype.toJSON=function(){var a=Zt.prototype.toJSON.call(this);return a.aX=this.aX,a.aY=this.aY,a.xRadius=this.xRadius,a.yRadius=this.yRadius,a.aStartAngle=this.aStartAngle,a.aEndAngle=this.aEndAngle,a.aClockwise=this.aClockwise,a.aRotation=this.aRotation,a},Bi.prototype.fromJSON=function(a){return Zt.prototype.fromJSON.call(this,a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this};function Ss(a,t,i,r,n,o){Bi.call(this,a,t,i,i,r,n,o),this.type="ArcCurve"}Ss.prototype=Object.create(Bi.prototype),Ss.prototype.constructor=Ss,Ss.prototype.isArcCurve=!0;function qu(){var a=0,t=0,i=0,r=0;function n(o,s,c,h){a=o,t=c,i=-3*o+3*s-2*c-h,r=2*o-2*s+c+h}return{initCatmullRom:function(s,c,h,p,C){n(c,h,C*(h-s),C*(p-c))},initNonuniformCatmullRom:function(s,c,h,p,C,_,S){var D=(c-s)/C-(h-s)/(C+_)+(h-c)/_,P=(h-c)/_-(p-c)/(_+S)+(p-h)/S;D*=_,P*=_,n(c,h,D,P)},calc:function(s){var c=s*s,h=c*s;return a+t*s+i*c+r*h}}}var Oc=new fe,Ju=new qu,Zu=new qu,Ku=new qu;function hi(a,t,i,r){a===void 0&&(a=[]),t===void 0&&(t=!1),i===void 0&&(i="centripetal"),r===void 0&&(r=.5),Zt.call(this),this.type="CatmullRomCurve3",this.points=a,this.closed=t,this.curveType=i,this.tension=r}hi.prototype=Object.create(Zt.prototype),hi.prototype.constructor=hi,hi.prototype.isCatmullRomCurve3=!0,hi.prototype.getPoint=function(a,t){t===void 0&&(t=new fe);var i=t,r=this.points,n=r.length,o=(n-(this.closed?0:1))*a,s=Math.floor(o),c=o-s;this.closed?s+=s>0?0:(Math.floor(Math.abs(s)/n)+1)*n:c===0&&s===n-1&&(s=n-2,c=1);var h,p;this.closed||s>0?h=r[(s-1)%n]:(Oc.subVectors(r[0],r[1]).add(r[0]),h=Oc);var C=r[s%n],_=r[(s+1)%n];if(this.closed||s+2<n?p=r[(s+2)%n]:(Oc.subVectors(r[n-1],r[n-2]).add(r[n-1]),p=Oc),this.curveType==="centripetal"||this.curveType==="chordal"){var S=this.curveType==="chordal"?.5:.25,D=Math.pow(h.distanceToSquared(C),S),P=Math.pow(C.distanceToSquared(_),S),H=Math.pow(_.distanceToSquared(p),S);P<1e-4&&(P=1),D<1e-4&&(D=P),H<1e-4&&(H=P),Ju.initNonuniformCatmullRom(h.x,C.x,_.x,p.x,D,P,H),Zu.initNonuniformCatmullRom(h.y,C.y,_.y,p.y,D,P,H),Ku.initNonuniformCatmullRom(h.z,C.z,_.z,p.z,D,P,H)}else this.curveType==="catmullrom"&&(Ju.initCatmullRom(h.x,C.x,_.x,p.x,this.tension),Zu.initCatmullRom(h.y,C.y,_.y,p.y,this.tension),Ku.initCatmullRom(h.z,C.z,_.z,p.z,this.tension));return i.set(Ju.calc(c),Zu.calc(c),Ku.calc(c)),i},hi.prototype.copy=function(a){Zt.prototype.copy.call(this,a),this.points=[];for(var t=0,i=a.points.length;t<i;t++){var r=a.points[t];this.points.push(r.clone())}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this},hi.prototype.toJSON=function(){var a=Zt.prototype.toJSON.call(this);a.points=[];for(var t=0,i=this.points.length;t<i;t++){var r=this.points[t];a.points.push(r.toArray())}return a.closed=this.closed,a.curveType=this.curveType,a.tension=this.tension,a},hi.prototype.fromJSON=function(a){Zt.prototype.fromJSON.call(this,a),this.points=[];for(var t=0,i=a.points.length;t<i;t++){var r=a.points[t];this.points.push(new fe().fromArray(r))}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this};function tf(a,t,i,r,n){var o=(r-t)*.5,s=(n-i)*.5,c=a*a,h=a*c;return(2*i-2*r+o+s)*h+(-3*i+3*r-2*o-s)*c+o*a+i}function by(a,t){var i=1-a;return i*i*t}function Ey(a,t){return 2*(1-a)*a*t}function wy(a,t){return a*a*t}function El(a,t,i,r){return by(a,t)+Ey(a,i)+wy(a,r)}function xy(a,t){var i=1-a;return i*i*i*t}function My(a,t){var i=1-a;return 3*i*i*a*t}function Ty(a,t){return 3*(1-a)*a*a*t}function Sy(a,t){return a*a*a*t}function wl(a,t,i,r,n){return xy(a,t)+My(a,i)+Ty(a,r)+Sy(a,n)}function na(a,t,i,r){a===void 0&&(a=new bt),t===void 0&&(t=new bt),i===void 0&&(i=new bt),r===void 0&&(r=new bt),Zt.call(this),this.type="CubicBezierCurve",this.v0=a,this.v1=t,this.v2=i,this.v3=r}na.prototype=Object.create(Zt.prototype),na.prototype.constructor=na,na.prototype.isCubicBezierCurve=!0,na.prototype.getPoint=function(a,t){t===void 0&&(t=new bt);var i=t,r=this.v0,n=this.v1,o=this.v2,s=this.v3;return i.set(wl(a,r.x,n.x,o.x,s.x),wl(a,r.y,n.y,o.y,s.y)),i},na.prototype.copy=function(a){return Zt.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this},na.prototype.toJSON=function(){var a=Zt.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a},na.prototype.fromJSON=function(a){return Zt.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this};function Ea(a,t,i,r){a===void 0&&(a=new fe),t===void 0&&(t=new fe),i===void 0&&(i=new fe),r===void 0&&(r=new fe),Zt.call(this),this.type="CubicBezierCurve3",this.v0=a,this.v1=t,this.v2=i,this.v3=r}Ea.prototype=Object.create(Zt.prototype),Ea.prototype.constructor=Ea,Ea.prototype.isCubicBezierCurve3=!0,Ea.prototype.getPoint=function(a,t){t===void 0&&(t=new fe);var i=t,r=this.v0,n=this.v1,o=this.v2,s=this.v3;return i.set(wl(a,r.x,n.x,o.x,s.x),wl(a,r.y,n.y,o.y,s.y),wl(a,r.z,n.z,o.z,s.z)),i},Ea.prototype.copy=function(a){return Zt.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this},Ea.prototype.toJSON=function(){var a=Zt.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a},Ea.prototype.fromJSON=function(a){return Zt.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this};function xi(a,t){a===void 0&&(a=new bt),t===void 0&&(t=new bt),Zt.call(this),this.type="LineCurve",this.v1=a,this.v2=t}xi.prototype=Object.create(Zt.prototype),xi.prototype.constructor=xi,xi.prototype.isLineCurve=!0,xi.prototype.getPoint=function(a,t){t===void 0&&(t=new bt);var i=t;return a===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(a).add(this.v1)),i},xi.prototype.getPointAt=function(a,t){return this.getPoint(a,t)},xi.prototype.getTangent=function(a,t){var i=t||new bt;return i.copy(this.v2).sub(this.v1).normalize(),i},xi.prototype.copy=function(a){return Zt.prototype.copy.call(this,a),this.v1.copy(a.v1),this.v2.copy(a.v2),this},xi.prototype.toJSON=function(){var a=Zt.prototype.toJSON.call(this);return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},xi.prototype.fromJSON=function(a){return Zt.prototype.fromJSON.call(this,a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};function ia(a,t){a===void 0&&(a=new fe),t===void 0&&(t=new fe),Zt.call(this),this.type="LineCurve3",this.v1=a,this.v2=t}ia.prototype=Object.create(Zt.prototype),ia.prototype.constructor=ia,ia.prototype.isLineCurve3=!0,ia.prototype.getPoint=function(a,t){t===void 0&&(t=new fe);var i=t;return a===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(a).add(this.v1)),i},ia.prototype.getPointAt=function(a,t){return this.getPoint(a,t)},ia.prototype.copy=function(a){return Zt.prototype.copy.call(this,a),this.v1.copy(a.v1),this.v2.copy(a.v2),this},ia.prototype.toJSON=function(){var a=Zt.prototype.toJSON.call(this);return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},ia.prototype.fromJSON=function(a){return Zt.prototype.fromJSON.call(this,a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};function aa(a,t,i){a===void 0&&(a=new bt),t===void 0&&(t=new bt),i===void 0&&(i=new bt),Zt.call(this),this.type="QuadraticBezierCurve",this.v0=a,this.v1=t,this.v2=i}aa.prototype=Object.create(Zt.prototype),aa.prototype.constructor=aa,aa.prototype.isQuadraticBezierCurve=!0,aa.prototype.getPoint=function(a,t){t===void 0&&(t=new bt);var i=t,r=this.v0,n=this.v1,o=this.v2;return i.set(El(a,r.x,n.x,o.x),El(a,r.y,n.y,o.y)),i},aa.prototype.copy=function(a){return Zt.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this},aa.prototype.toJSON=function(){var a=Zt.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},aa.prototype.fromJSON=function(a){return Zt.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};function wa(a,t,i){a===void 0&&(a=new fe),t===void 0&&(t=new fe),i===void 0&&(i=new fe),Zt.call(this),this.type="QuadraticBezierCurve3",this.v0=a,this.v1=t,this.v2=i}wa.prototype=Object.create(Zt.prototype),wa.prototype.constructor=wa,wa.prototype.isQuadraticBezierCurve3=!0,wa.prototype.getPoint=function(a,t){t===void 0&&(t=new fe);var i=t,r=this.v0,n=this.v1,o=this.v2;return i.set(El(a,r.x,n.x,o.x),El(a,r.y,n.y,o.y),El(a,r.z,n.z,o.z)),i},wa.prototype.copy=function(a){return Zt.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this},wa.prototype.toJSON=function(){var a=Zt.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},wa.prototype.fromJSON=function(a){return Zt.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};function oa(a){a===void 0&&(a=[]),Zt.call(this),this.type="SplineCurve",this.points=a}oa.prototype=Object.create(Zt.prototype),oa.prototype.constructor=oa,oa.prototype.isSplineCurve=!0,oa.prototype.getPoint=function(a,t){t===void 0&&(t=new bt);var i=t,r=this.points,n=(r.length-1)*a,o=Math.floor(n),s=n-o,c=r[o===0?o:o-1],h=r[o],p=r[o>r.length-2?r.length-1:o+1],C=r[o>r.length-3?r.length-1:o+2];return i.set(tf(s,c.x,h.x,p.x,C.x),tf(s,c.y,h.y,p.y,C.y)),i},oa.prototype.copy=function(a){Zt.prototype.copy.call(this,a),this.points=[];for(var t=0,i=a.points.length;t<i;t++){var r=a.points[t];this.points.push(r.clone())}return this},oa.prototype.toJSON=function(){var a=Zt.prototype.toJSON.call(this);a.points=[];for(var t=0,i=this.points.length;t<i;t++){var r=this.points[t];a.points.push(r.toArray())}return a},oa.prototype.fromJSON=function(a){Zt.prototype.fromJSON.call(this,a),this.points=[];for(var t=0,i=a.points.length;t<i;t++){var r=a.points[t];this.points.push(new bt().fromArray(r))}return this};var $u=Object.freeze({__proto__:null,ArcCurve:Ss,CatmullRomCurve3:hi,CubicBezierCurve:na,CubicBezierCurve3:Ea,EllipseCurve:Bi,LineCurve:xi,LineCurve3:ia,QuadraticBezierCurve:aa,QuadraticBezierCurve3:wa,SplineCurve:oa});function po(){Zt.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}po.prototype=Object.assign(Object.create(Zt.prototype),{constructor:po,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);t.equals(i)||this.curves.push(new xi(i,t))},getPoint:function(t){for(var i=t*this.getLength(),r=this.getCurveLengths(),n=0;n<r.length;){if(r[n]>=i){var o=r[n]-i,s=this.curves[n],c=s.getLength(),h=c===0?0:1-o/c;return s.getPointAt(h)}n++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],i=0,r=0,n=this.curves.length;r<n;r++)i+=this.curves[r].getLength(),t.push(i);return this.cacheLengths=t,t},getSpacedPoints:function(t){t===void 0&&(t=40);for(var i=[],r=0;r<=t;r++)i.push(this.getPoint(r/t));return this.autoClose&&i.push(i[0]),i},getPoints:function(t){t===void 0&&(t=12);for(var i=[],r,n=0,o=this.curves;n<o.length;n++)for(var s=o[n],c=s&&s.isEllipseCurve?t*2:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?t*s.points.length:t,h=s.getPoints(c),p=0;p<h.length;p++){var C=h[p];r&&r.equals(C)||(i.push(C),r=C)}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(t){Zt.prototype.copy.call(this,t),this.curves=[];for(var i=0,r=t.curves.length;i<r;i++){var n=t.curves[i];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=Zt.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var i=0,r=this.curves.length;i<r;i++){var n=this.curves[i];t.curves.push(n.toJSON())}return t},fromJSON:function(t){Zt.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var i=0,r=t.curves.length;i<r;i++){var n=t.curves[i];this.curves.push(new $u[n.type]().fromJSON(n))}return this}});function sa(a){po.call(this),this.type="Path",this.currentPoint=new bt,a&&this.setFromPoints(a)}sa.prototype=Object.assign(Object.create(po.prototype),{constructor:sa,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var i=1,r=t.length;i<r;i++)this.lineTo(t[i].x,t[i].y);return this},moveTo:function(t,i){return this.currentPoint.set(t,i),this},lineTo:function(t,i){var r=new xi(this.currentPoint.clone(),new bt(t,i));return this.curves.push(r),this.currentPoint.set(t,i),this},quadraticCurveTo:function(t,i,r,n){var o=new aa(this.currentPoint.clone(),new bt(t,i),new bt(r,n));return this.curves.push(o),this.currentPoint.set(r,n),this},bezierCurveTo:function(t,i,r,n,o,s){var c=new na(this.currentPoint.clone(),new bt(t,i),new bt(r,n),new bt(o,s));return this.curves.push(c),this.currentPoint.set(o,s),this},splineThru:function(t){var i=[this.currentPoint.clone()].concat(t),r=new oa(i);return this.curves.push(r),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,i,r,n,o,s){var c=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(t+c,i+h,r,n,o,s),this},absarc:function(t,i,r,n,o,s){return this.absellipse(t,i,r,r,n,o,s),this},ellipse:function(t,i,r,n,o,s,c,h){var p=this.currentPoint.x,C=this.currentPoint.y;return this.absellipse(t+p,i+C,r,n,o,s,c,h),this},absellipse:function(t,i,r,n,o,s,c,h){var p=new Bi(t,i,r,n,o,s,c,h);if(this.curves.length>0){var C=p.getPoint(0);C.equals(this.currentPoint)||this.lineTo(C.x,C.y)}this.curves.push(p);var _=p.getPoint(1);return this.currentPoint.copy(_),this},copy:function(t){return po.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=po.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return po.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}});function vo(a){sa.call(this,a),this.uuid=gr.generateUUID(),this.type="Shape",this.holes=[]}vo.prototype=Object.assign(Object.create(sa.prototype),{constructor:vo,getPointsHoles:function(t){for(var i=[],r=0,n=this.holes.length;r<n;r++)i[r]=this.holes[r].getPoints(t);return i},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){sa.prototype.copy.call(this,t),this.holes=[];for(var i=0,r=t.holes.length;i<r;i++){var n=t.holes[i];this.holes.push(n.clone())}return this},toJSON:function(){var t=sa.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var i=0,r=this.holes.length;i<r;i++){var n=this.holes[i];t.holes.push(n.toJSON())}return t},fromJSON:function(t){sa.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var i=0,r=t.holes.length;i<r;i++){var n=t.holes[i];this.holes.push(new sa().fromJSON(n))}return this}});function Mn(a,t){t===void 0&&(t=1),Qt.call(this),this.type="Light",this.color=new It(a),this.intensity=t}Mn.prototype=Object.assign(Object.create(Qt.prototype),{constructor:Mn,isLight:!0,copy:function(t){return Qt.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var i=Qt.prototype.toJSON.call(this,t);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}});function Ic(a,t,i){Mn.call(this,a,i),this.type="HemisphereLight",this.position.copy(Qt.DefaultUp),this.updateMatrix(),this.groundColor=new It(t)}Ic.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Ic,isHemisphereLight:!0,copy:function(t){return Mn.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}});function Ua(a){this.camera=a,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new bt(512,512),this.map=null,this.mapPass=null,this.matrix=new kr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new qs,this._frameExtents=new bt(1,1),this._viewportCount=1,this._viewports=[new un(0,0,1,1)]}Object.assign(Ua.prototype,{_projScreenMatrix:new kr,_lightPositionWorld:new fe,_lookTarget:new fe,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var i=this.camera,r=this.matrix,n=this._projScreenMatrix,o=this._lookTarget,s=this._lightPositionWorld;s.setFromMatrixPosition(t.matrixWorld),i.position.copy(s),o.setFromMatrixPosition(t.target.matrixWorld),i.lookAt(o),i.updateMatrixWorld(),n.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(i.projectionMatrix),r.multiply(i.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}});function eh(){Ua.call(this,new Nn(50,1,.5,500)),this.focus=1}eh.prototype=Object.assign(Object.create(Ua.prototype),{constructor:eh,isSpotLightShadow:!0,updateMatrices:function(t){var i=this.camera,r=gr.RAD2DEG*2*t.angle*this.focus,n=this.mapSize.width/this.mapSize.height,o=t.distance||i.far;(r!==i.fov||n!==i.aspect||o!==i.far)&&(i.fov=r,i.aspect=n,i.far=o,i.updateProjectionMatrix()),Ua.prototype.updateMatrices.call(this,t)}});function Bc(a,t,i,r,n,o){Mn.call(this,a,t),this.type="SpotLight",this.position.copy(Qt.DefaultUp),this.updateMatrix(),this.target=new Qt,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(c){this.intensity=c/Math.PI}}),this.distance=i!==void 0?i:0,this.angle=r!==void 0?r:Math.PI/3,this.penumbra=n!==void 0?n:0,this.decay=o!==void 0?o:1,this.shadow=new eh}Bc.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Bc,isSpotLight:!0,copy:function(t){return Mn.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}});function th(){Ua.call(this,new Nn(90,1,.5,500)),this._frameExtents=new bt(4,2),this._viewportCount=6,this._viewports=[new un(2,1,1,1),new un(0,1,1,1),new un(3,1,1,1),new un(1,1,1,1),new un(3,0,1,1),new un(1,0,1,1)],this._cubeDirections=[new fe(1,0,0),new fe(-1,0,0),new fe(0,0,1),new fe(0,0,-1),new fe(0,1,0),new fe(0,-1,0)],this._cubeUps=[new fe(0,1,0),new fe(0,1,0),new fe(0,1,0),new fe(0,1,0),new fe(0,0,1),new fe(0,0,-1)]}th.prototype=Object.assign(Object.create(Ua.prototype),{constructor:th,isPointLightShadow:!0,updateMatrices:function(t,i){i===void 0&&(i=0);var r=this.camera,n=this.matrix,o=this._lightPositionWorld,s=this._lookTarget,c=this._projScreenMatrix;o.setFromMatrixPosition(t.matrixWorld),r.position.copy(o),s.copy(r.position),s.add(this._cubeDirections[i]),r.up.copy(this._cubeUps[i]),r.lookAt(s),r.updateMatrixWorld(),n.makeTranslation(-o.x,-o.y,-o.z),c.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(c)}});function Fc(a,t,i,r){Mn.call(this,a,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(o){this.intensity=o/(4*Math.PI)}}),this.distance=i!==void 0?i:0,this.decay=r!==void 0?r:1,this.shadow=new th}Fc.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Fc,isPointLight:!0,copy:function(t){return Mn.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}});function _s(a,t,i,r,n,o){a===void 0&&(a=-1),t===void 0&&(t=1),i===void 0&&(i=1),r===void 0&&(r=-1),n===void 0&&(n=.1),o===void 0&&(o=2e3),ya.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=a,this.right=t,this.top=i,this.bottom=r,this.near=n,this.far=o,this.updateProjectionMatrix()}_s.prototype=Object.assign(Object.create(ya.prototype),{constructor:_s,isOrthographicCamera:!0,copy:function(t,i){return ya.prototype.copy.call(this,t,i),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this},setViewOffset:function(t,i,r,n,o,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=r,this.view.offsetY=n,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,o=r-t,s=r+t,c=n+i,h=n-i;if(this.view!==null&&this.view.enabled){var p=(this.right-this.left)/this.view.fullWidth/this.zoom,C=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=p*this.view.offsetX,s=o+p*this.view.width,c-=C*this.view.offsetY,h=c-C*this.view.height}this.projectionMatrix.makeOrthographic(o,s,c,h,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){var i=Qt.prototype.toJSON.call(this,t);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}});function rh(){Ua.call(this,new _s(-5,5,5,-5,.5,500))}rh.prototype=Object.assign(Object.create(Ua.prototype),{constructor:rh,isDirectionalLightShadow:!0,updateMatrices:function(t){Ua.prototype.updateMatrices.call(this,t)}});function Nc(a,t){Mn.call(this,a,t),this.type="DirectionalLight",this.position.copy(Qt.DefaultUp),this.updateMatrix(),this.target=new Qt,this.shadow=new rh}Nc.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Nc,isDirectionalLight:!0,copy:function(t){return Mn.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}});function kc(a,t){Mn.call(this,a,t),this.type="AmbientLight"}kc.prototype=Object.assign(Object.create(Mn.prototype),{constructor:kc,isAmbientLight:!0});function Uc(a,t,i,r){Mn.call(this,a,t),this.type="RectAreaLight",this.width=i!==void 0?i:10,this.height=r!==void 0?r:10}Uc.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Uc,isRectAreaLight:!0,copy:function(t){return Mn.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var i=Mn.prototype.toJSON.call(this,t);return i.object.width=this.width,i.object.height=this.height,i}});var rf=function(){function a(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(var i=0;i<9;i++)this.coefficients.push(new fe)}var t=a.prototype;return t.set=function(r){for(var n=0;n<9;n++)this.coefficients[n].copy(r[n]);return this},t.zero=function(){for(var r=0;r<9;r++)this.coefficients[r].set(0,0,0);return this},t.getAt=function(r,n){var o=r.x,s=r.y,c=r.z,h=this.coefficients;return n.copy(h[0]).multiplyScalar(.282095),n.addScaledVector(h[1],.488603*s),n.addScaledVector(h[2],.488603*c),n.addScaledVector(h[3],.488603*o),n.addScaledVector(h[4],1.092548*(o*s)),n.addScaledVector(h[5],1.092548*(s*c)),n.addScaledVector(h[6],.315392*(3*c*c-1)),n.addScaledVector(h[7],1.092548*(o*c)),n.addScaledVector(h[8],.546274*(o*o-s*s)),n},t.getIrradianceAt=function(r,n){var o=r.x,s=r.y,c=r.z,h=this.coefficients;return n.copy(h[0]).multiplyScalar(.886227),n.addScaledVector(h[1],2*.511664*s),n.addScaledVector(h[2],2*.511664*c),n.addScaledVector(h[3],2*.511664*o),n.addScaledVector(h[4],2*.429043*o*s),n.addScaledVector(h[5],2*.429043*s*c),n.addScaledVector(h[6],.743125*c*c-.247708),n.addScaledVector(h[7],2*.429043*o*c),n.addScaledVector(h[8],.429043*(o*o-s*s)),n},t.add=function(r){for(var n=0;n<9;n++)this.coefficients[n].add(r.coefficients[n]);return this},t.addScaledSH=function(r,n){for(var o=0;o<9;o++)this.coefficients[o].addScaledVector(r.coefficients[o],n);return this},t.scale=function(r){for(var n=0;n<9;n++)this.coefficients[n].multiplyScalar(r);return this},t.lerp=function(r,n){for(var o=0;o<9;o++)this.coefficients[o].lerp(r.coefficients[o],n);return this},t.equals=function(r){for(var n=0;n<9;n++)if(!this.coefficients[n].equals(r.coefficients[n]))return!1;return!0},t.copy=function(r){return this.set(r.coefficients)},t.clone=function(){return new this.constructor().copy(this)},t.fromArray=function(r,n){n===void 0&&(n=0);for(var o=this.coefficients,s=0;s<9;s++)o[s].fromArray(r,n+s*3);return this},t.toArray=function(r,n){r===void 0&&(r=[]),n===void 0&&(n=0);for(var o=this.coefficients,s=0;s<9;s++)o[s].toArray(r,n+s*3);return r},a.getBasisAt=function(r,n){var o=r.x,s=r.y,c=r.z;n[0]=.282095,n[1]=.488603*s,n[2]=.488603*c,n[3]=.488603*o,n[4]=1.092548*o*s,n[5]=1.092548*s*c,n[6]=.315392*(3*c*c-1),n[7]=1.092548*o*c,n[8]=.546274*(o*o-s*s)},a}();function Wi(a,t){Mn.call(this,void 0,t),this.type="LightProbe",this.sh=a!==void 0?a:new rf}Wi.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Wi,isLightProbe:!0,copy:function(t){return Mn.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){var i=Mn.prototype.toJSON.call(this,t);return i.object.sh=this.sh.toArray(),i}});function Hc(a){dn.call(this,a),this.textures={}}Hc.prototype=Object.assign(Object.create(dn.prototype),{constructor:Hc,load:function(t,i,r,n){var o=this,s=new zi(o.manager);s.setPath(o.path),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(t,function(c){try{i(o.parse(JSON.parse(c)))}catch(h){n?n(h):console.error(h),o.manager.itemError(t)}},r,n)},parse:function(t){var i=this.textures;function r(p){return i[p]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",p),i[p]}var n=new gy[t.type];if(t.uuid!==void 0&&(n.uuid=t.uuid),t.name!==void 0&&(n.name=t.name),t.color!==void 0&&n.color!==void 0&&n.color.setHex(t.color),t.roughness!==void 0&&(n.roughness=t.roughness),t.metalness!==void 0&&(n.metalness=t.metalness),t.sheen!==void 0&&(n.sheen=new It().setHex(t.sheen)),t.emissive!==void 0&&n.emissive!==void 0&&n.emissive.setHex(t.emissive),t.specular!==void 0&&n.specular!==void 0&&n.specular.setHex(t.specular),t.shininess!==void 0&&(n.shininess=t.shininess),t.clearcoat!==void 0&&(n.clearcoat=t.clearcoat),t.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=t.clearcoatRoughness),t.fog!==void 0&&(n.fog=t.fog),t.flatShading!==void 0&&(n.flatShading=t.flatShading),t.blending!==void 0&&(n.blending=t.blending),t.combine!==void 0&&(n.combine=t.combine),t.side!==void 0&&(n.side=t.side),t.opacity!==void 0&&(n.opacity=t.opacity),t.transparent!==void 0&&(n.transparent=t.transparent),t.alphaTest!==void 0&&(n.alphaTest=t.alphaTest),t.depthTest!==void 0&&(n.depthTest=t.depthTest),t.depthWrite!==void 0&&(n.depthWrite=t.depthWrite),t.colorWrite!==void 0&&(n.colorWrite=t.colorWrite),t.stencilWrite!==void 0&&(n.stencilWrite=t.stencilWrite),t.stencilWriteMask!==void 0&&(n.stencilWriteMask=t.stencilWriteMask),t.stencilFunc!==void 0&&(n.stencilFunc=t.stencilFunc),t.stencilRef!==void 0&&(n.stencilRef=t.stencilRef),t.stencilFuncMask!==void 0&&(n.stencilFuncMask=t.stencilFuncMask),t.stencilFail!==void 0&&(n.stencilFail=t.stencilFail),t.stencilZFail!==void 0&&(n.stencilZFail=t.stencilZFail),t.stencilZPass!==void 0&&(n.stencilZPass=t.stencilZPass),t.wireframe!==void 0&&(n.wireframe=t.wireframe),t.wireframeLinewidth!==void 0&&(n.wireframeLinewidth=t.wireframeLinewidth),t.wireframeLinecap!==void 0&&(n.wireframeLinecap=t.wireframeLinecap),t.wireframeLinejoin!==void 0&&(n.wireframeLinejoin=t.wireframeLinejoin),t.rotation!==void 0&&(n.rotation=t.rotation),t.linewidth!==1&&(n.linewidth=t.linewidth),t.dashSize!==void 0&&(n.dashSize=t.dashSize),t.gapSize!==void 0&&(n.gapSize=t.gapSize),t.scale!==void 0&&(n.scale=t.scale),t.polygonOffset!==void 0&&(n.polygonOffset=t.polygonOffset),t.polygonOffsetFactor!==void 0&&(n.polygonOffsetFactor=t.polygonOffsetFactor),t.polygonOffsetUnits!==void 0&&(n.polygonOffsetUnits=t.polygonOffsetUnits),t.skinning!==void 0&&(n.skinning=t.skinning),t.morphTargets!==void 0&&(n.morphTargets=t.morphTargets),t.morphNormals!==void 0&&(n.morphNormals=t.morphNormals),t.dithering!==void 0&&(n.dithering=t.dithering),t.vertexTangents!==void 0&&(n.vertexTangents=t.vertexTangents),t.visible!==void 0&&(n.visible=t.visible),t.toneMapped!==void 0&&(n.toneMapped=t.toneMapped),t.userData!==void 0&&(n.userData=t.userData),t.vertexColors!==void 0&&(typeof t.vertexColors=="number"?n.vertexColors=t.vertexColors>0:n.vertexColors=t.vertexColors),t.uniforms!==void 0)for(var o in t.uniforms){var s=t.uniforms[o];switch(n.uniforms[o]={},s.type){case"t":n.uniforms[o].value=r(s.value);break;case"c":n.uniforms[o].value=new It().setHex(s.value);break;case"v2":n.uniforms[o].value=new bt().fromArray(s.value);break;case"v3":n.uniforms[o].value=new fe().fromArray(s.value);break;case"v4":n.uniforms[o].value=new un().fromArray(s.value);break;case"m3":n.uniforms[o].value=new _i().fromArray(s.value);break;case"m4":n.uniforms[o].value=new kr().fromArray(s.value);break;default:n.uniforms[o].value=s.value}}if(t.defines!==void 0&&(n.defines=t.defines),t.vertexShader!==void 0&&(n.vertexShader=t.vertexShader),t.fragmentShader!==void 0&&(n.fragmentShader=t.fragmentShader),t.extensions!==void 0)for(var c in t.extensions)n.extensions[c]=t.extensions[c];if(t.shading!==void 0&&(n.flatShading=t.shading===1),t.size!==void 0&&(n.size=t.size),t.sizeAttenuation!==void 0&&(n.sizeAttenuation=t.sizeAttenuation),t.map!==void 0&&(n.map=r(t.map)),t.matcap!==void 0&&(n.matcap=r(t.matcap)),t.alphaMap!==void 0&&(n.alphaMap=r(t.alphaMap)),t.bumpMap!==void 0&&(n.bumpMap=r(t.bumpMap)),t.bumpScale!==void 0&&(n.bumpScale=t.bumpScale),t.normalMap!==void 0&&(n.normalMap=r(t.normalMap)),t.normalMapType!==void 0&&(n.normalMapType=t.normalMapType),t.normalScale!==void 0){var h=t.normalScale;Array.isArray(h)===!1&&(h=[h,h]),n.normalScale=new bt().fromArray(h)}return t.displacementMap!==void 0&&(n.displacementMap=r(t.displacementMap)),t.displacementScale!==void 0&&(n.displacementScale=t.displacementScale),t.displacementBias!==void 0&&(n.displacementBias=t.displacementBias),t.roughnessMap!==void 0&&(n.roughnessMap=r(t.roughnessMap)),t.metalnessMap!==void 0&&(n.metalnessMap=r(t.metalnessMap)),t.emissiveMap!==void 0&&(n.emissiveMap=r(t.emissiveMap)),t.emissiveIntensity!==void 0&&(n.emissiveIntensity=t.emissiveIntensity),t.specularMap!==void 0&&(n.specularMap=r(t.specularMap)),t.envMap!==void 0&&(n.envMap=r(t.envMap)),t.envMapIntensity!==void 0&&(n.envMapIntensity=t.envMapIntensity),t.reflectivity!==void 0&&(n.reflectivity=t.reflectivity),t.refractionRatio!==void 0&&(n.refractionRatio=t.refractionRatio),t.lightMap!==void 0&&(n.lightMap=r(t.lightMap)),t.lightMapIntensity!==void 0&&(n.lightMapIntensity=t.lightMapIntensity),t.aoMap!==void 0&&(n.aoMap=r(t.aoMap)),t.aoMapIntensity!==void 0&&(n.aoMapIntensity=t.aoMapIntensity),t.gradientMap!==void 0&&(n.gradientMap=r(t.gradientMap)),t.clearcoatMap!==void 0&&(n.clearcoatMap=r(t.clearcoatMap)),t.clearcoatRoughnessMap!==void 0&&(n.clearcoatRoughnessMap=r(t.clearcoatRoughnessMap)),t.clearcoatNormalMap!==void 0&&(n.clearcoatNormalMap=r(t.clearcoatNormalMap)),t.clearcoatNormalScale!==void 0&&(n.clearcoatNormalScale=new bt().fromArray(t.clearcoatNormalScale)),t.transmission!==void 0&&(n.transmission=t.transmission),t.transmissionMap!==void 0&&(n.transmissionMap=r(t.transmissionMap)),n},setTextures:function(t){return this.textures=t,this}});var nh={decodeText:function(t){if(typeof TextDecoder<"u")return new TextDecoder().decode(t);for(var i="",r=0,n=t.length;r<n;r++)i+=String.fromCharCode(t[r]);try{return decodeURIComponent(escape(i))}catch{return i}},extractUrlBase:function(t){var i=t.lastIndexOf("/");return i===-1?"./":t.substr(0,i+1)}};function xl(){tr.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}xl.prototype=Object.assign(Object.create(tr.prototype),{constructor:xl,isInstancedBufferGeometry:!0,copy:function(t){return tr.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t=tr.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}});function Gc(a,t,i,r){typeof i=="number"&&(r=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),dr.call(this,a,t,i),this.meshPerAttribute=r||1}Gc.prototype=Object.assign(Object.create(dr.prototype),{constructor:Gc,isInstancedBufferAttribute:!0,copy:function(t){return dr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=dr.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}});function Vc(a){dn.call(this,a)}Vc.prototype=Object.assign(Object.create(dn.prototype),{constructor:Vc,load:function(t,i,r,n){var o=this,s=new zi(o.manager);s.setPath(o.path),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(t,function(c){try{i(o.parse(JSON.parse(c)))}catch(h){n?n(h):console.error(h),o.manager.itemError(t)}},r,n)},parse:function(t){var i={},r={};function n(me,Ue){if(i[Ue]!==void 0)return i[Ue];var He=me.interleavedBuffers,Qe=He[Ue],qe=o(me,Qe.buffer),gt=Ys(Qe.type,qe),St=new Di(gt,Qe.stride);return St.uuid=Qe.uuid,i[Ue]=St,St}function o(me,Ue){if(r[Ue]!==void 0)return r[Ue];var He=me.arrayBuffers,Qe=He[Ue],qe=new Uint32Array(Qe).buffer;return r[Ue]=qe,qe}var s=t.isInstancedBufferGeometry?new xl:new tr,c=t.data.index;if(c!==void 0){var h=Ys(c.type,c.array);s.setIndex(new dr(h,1))}var p=t.data.attributes;for(var C in p){var _=p[C],S=void 0;if(_.isInterleavedBufferAttribute){var D=n(t.data,_.data);S=new so(D,_.itemSize,_.offset,_.normalized)}else{var P=Ys(_.type,_.array),H=_.isInstancedBufferAttribute?Gc:dr;S=new H(P,_.itemSize,_.normalized)}_.name!==void 0&&(S.name=_.name),s.setAttribute(C,S)}var W=t.data.morphAttributes;if(W)for(var G in W){for(var B=W[G],te=[],he=0,K=B.length;he<K;he++){var Q=B[he],le=void 0;if(Q.isInterleavedBufferAttribute){var Me=n(t.data,Q.data);le=new so(Me,Q.itemSize,Q.offset,Q.normalized)}else{var xe=Ys(Q.type,Q.array);le=new dr(xe,Q.itemSize,Q.normalized)}Q.name!==void 0&&(le.name=Q.name),te.push(le)}s.morphAttributes[G]=te}var _e=t.data.morphTargetsRelative;_e&&(s.morphTargetsRelative=!0);var Pe=t.data.groups||t.data.drawcalls||t.data.offsets;if(Pe!==void 0)for(var Ce=0,Ae=Pe.length;Ce!==Ae;++Ce){var Be=Pe[Ce];s.addGroup(Be.start,Be.count,Be.materialIndex)}var Se=t.data.boundingSphere;if(Se!==void 0){var Te=new fe;Se.center!==void 0&&Te.fromArray(Se.center),s.boundingSphere=new Ka(Te,Se.radius)}return t.name&&(s.name=t.name),t.userData&&(s.userData=t.userData),s}});var _y=function(a){Or(t,a);function t(r){return a.call(this,r)||this}var i=t.prototype;return i.load=function(n,o,s,c){var h=this,p=this.path===""?nh.extractUrlBase(n):this.path;this.resourcePath=this.resourcePath||p;var C=new zi(this.manager);C.setPath(this.path),C.setRequestHeader(this.requestHeader),C.setWithCredentials(this.withCredentials),C.load(n,function(_){var S=null;try{S=JSON.parse(_)}catch(P){c!==void 0&&c(P),console.error("THREE:ObjectLoader: Can't parse "+n+".",P.message);return}var D=S.metadata;if(D===void 0||D.type===void 0||D.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+n);return}h.parse(S,o)},s,c)},i.parse=function(n,o){var s=this.parseAnimations(n.animations),c=this.parseShapes(n.shapes),h=this.parseGeometries(n.geometries,c),p=this.parseImages(n.images,function(){o!==void 0&&o(S)}),C=this.parseTextures(n.textures,p),_=this.parseMaterials(n.materials,C),S=this.parseObject(n.object,h,_,s),D=this.parseSkeletons(n.skeletons,S);if(this.bindSkeletons(S,D),o!==void 0){var P=!1;for(var H in p)if(p[H]instanceof HTMLImageElement){P=!0;break}P===!1&&o(S)}return S},i.parseShapes=function(n){var o={};if(n!==void 0)for(var s=0,c=n.length;s<c;s++){var h=new vo().fromJSON(n[s]);o[h.uuid]=h}return o},i.parseSkeletons=function(n,o){var s={},c={};if(o.traverse(function(_){_.isBone&&(c[_.uuid]=_)}),n!==void 0)for(var h=0,p=n.length;h<p;h++){var C=new cl().fromJSON(n[h],c);s[C.uuid]=C}return s},i.parseGeometries=function(n,o){var s={},c;if(n!==void 0)for(var h=new Vc,p=0,C=n.length;p<C;p++){var _=void 0,S=n[p];switch(S.type){case"PlaneGeometry":case"PlaneBufferGeometry":_=new Ei[S.type](S.width,S.height,S.widthSegments,S.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":_=new Ei[S.type](S.width,S.height,S.depth,S.widthSegments,S.heightSegments,S.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":_=new Ei[S.type](S.radius,S.segments,S.thetaStart,S.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":_=new Ei[S.type](S.radiusTop,S.radiusBottom,S.height,S.radialSegments,S.heightSegments,S.openEnded,S.thetaStart,S.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":_=new Ei[S.type](S.radius,S.height,S.radialSegments,S.heightSegments,S.openEnded,S.thetaStart,S.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":_=new Ei[S.type](S.radius,S.widthSegments,S.heightSegments,S.phiStart,S.phiLength,S.thetaStart,S.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":_=new Ei[S.type](S.radius,S.detail);break;case"RingGeometry":case"RingBufferGeometry":_=new Ei[S.type](S.innerRadius,S.outerRadius,S.thetaSegments,S.phiSegments,S.thetaStart,S.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":_=new Ei[S.type](S.radius,S.tube,S.radialSegments,S.tubularSegments,S.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":_=new Ei[S.type](S.radius,S.tube,S.tubularSegments,S.radialSegments,S.p,S.q);break;case"TubeGeometry":case"TubeBufferGeometry":_=new Ei[S.type](new $u[S.path.type]().fromJSON(S.path),S.tubularSegments,S.radius,S.radialSegments,S.closed);break;case"LatheGeometry":case"LatheBufferGeometry":_=new Ei[S.type](S.points,S.segments,S.phiStart,S.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":_=new Ei[S.type](S.vertices,S.indices,S.radius,S.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":c=[];for(var D=0,P=S.shapes.length;D<P;D++){var H=o[S.shapes[D]];c.push(H)}_=new Ei[S.type](c,S.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":c=[];for(var W=0,G=S.shapes.length;W<G;W++){var B=o[S.shapes[W]];c.push(B)}var te=S.options.extrudePath;te!==void 0&&(S.options.extrudePath=new $u[te.type]().fromJSON(te)),_=new Ei[S.type](c,S.options);break;case"BufferGeometry":case"InstancedBufferGeometry":_=h.parse(S);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var he=new THREE.LegacyJSONLoader;_=he.parse(S,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+S.type+'"');continue}_.uuid=S.uuid,S.name!==void 0&&(_.name=S.name),_.isBufferGeometry===!0&&S.userData!==void 0&&(_.userData=S.userData),s[S.uuid]=_}return s},i.parseMaterials=function(n,o){var s={},c={};if(n!==void 0){var h=new Hc;h.setTextures(o);for(var p=0,C=n.length;p<C;p++){var _=n[p];if(_.type==="MultiMaterial"){for(var S=[],D=0;D<_.materials.length;D++){var P=_.materials[D];s[P.uuid]===void 0&&(s[P.uuid]=h.parse(P)),S.push(s[P.uuid])}c[_.uuid]=S}else s[_.uuid]===void 0&&(s[_.uuid]=h.parse(_)),c[_.uuid]=s[_.uuid]}}return c},i.parseAnimations=function(n){var o={};if(n!==void 0)for(var s=0;s<n.length;s++){var c=n[s],h=Ii.parse(c);o[h.uuid]=h}return o},i.parseImages=function(n,o){var s=this,c={},h;function p(K){return s.manager.itemStart(K),h.load(K,function(){s.manager.itemEnd(K)},void 0,function(){s.manager.itemError(K),s.manager.itemEnd(K)})}function C(K){if(typeof K=="string"){var Q=K,le=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Q)?Q:s.resourcePath+Q;return p(le)}else return K.data?{data:Ys(K.type,K.data),width:K.width,height:K.height}:null}if(n!==void 0&&n.length>0){var _=new Xu(o);h=new Ts(_),h.setCrossOrigin(this.crossOrigin);for(var S=0,D=n.length;S<D;S++){var P=n[S],H=P.url;if(Array.isArray(H)){c[P.uuid]=[];for(var W=0,G=H.length;W<G;W++){var B=H[W],te=C(B);te!==null&&(te instanceof HTMLImageElement?c[P.uuid].push(te):c[P.uuid].push(new Ba(te.data,te.width,te.height)))}}else{var he=C(P.url);he!==null&&(c[P.uuid]=he)}}}return c},i.parseTextures=function(n,o){function s(D,P){return typeof D=="number"?D:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",D),P[D])}var c={};if(n!==void 0)for(var h=0,p=n.length;h<p;h++){var C=n[h];C.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',C.uuid),o[C.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",C.image);var _=void 0,S=o[C.image];Array.isArray(S)?(_=new Aa(S),S.length===6&&(_.needsUpdate=!0)):(S&&S.data?_=new Ba(S.data,S.width,S.height):_=new vn(S),S&&(_.needsUpdate=!0)),_.uuid=C.uuid,C.name!==void 0&&(_.name=C.name),C.mapping!==void 0&&(_.mapping=s(C.mapping,Cy)),C.offset!==void 0&&_.offset.fromArray(C.offset),C.repeat!==void 0&&_.repeat.fromArray(C.repeat),C.center!==void 0&&_.center.fromArray(C.center),C.rotation!==void 0&&(_.rotation=C.rotation),C.wrap!==void 0&&(_.wrapS=s(C.wrap[0],nf),_.wrapT=s(C.wrap[1],nf)),C.format!==void 0&&(_.format=C.format),C.type!==void 0&&(_.type=C.type),C.encoding!==void 0&&(_.encoding=C.encoding),C.minFilter!==void 0&&(_.minFilter=s(C.minFilter,af)),C.magFilter!==void 0&&(_.magFilter=s(C.magFilter,af)),C.anisotropy!==void 0&&(_.anisotropy=C.anisotropy),C.flipY!==void 0&&(_.flipY=C.flipY),C.premultiplyAlpha!==void 0&&(_.premultiplyAlpha=C.premultiplyAlpha),C.unpackAlignment!==void 0&&(_.unpackAlignment=C.unpackAlignment),c[C.uuid]=_}return c},i.parseObject=function(n,o,s,c){var h;function p(Me){return o[Me]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",Me),o[Me]}function C(Me){if(Me!==void 0){if(Array.isArray(Me)){for(var xe=[],_e=0,Pe=Me.length;_e<Pe;_e++){var Ce=Me[_e];s[Ce]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",Ce),xe.push(s[Ce])}return xe}return s[Me]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",Me),s[Me]}}var _,S;switch(n.type){case"Scene":h=new Fu,n.background!==void 0&&Number.isInteger(n.background)&&(h.background=new It(n.background)),n.fog!==void 0&&(n.fog.type==="Fog"?h.fog=new Ld(n.fog.color,n.fog.near,n.fog.far):n.fog.type==="FogExp2"&&(h.fog=new Cd(n.fog.color,n.fog.density)));break;case"PerspectiveCamera":h=new Nn(n.fov,n.aspect,n.near,n.far),n.focus!==void 0&&(h.focus=n.focus),n.zoom!==void 0&&(h.zoom=n.zoom),n.filmGauge!==void 0&&(h.filmGauge=n.filmGauge),n.filmOffset!==void 0&&(h.filmOffset=n.filmOffset),n.view!==void 0&&(h.view=Object.assign({},n.view));break;case"OrthographicCamera":h=new _s(n.left,n.right,n.top,n.bottom,n.near,n.far),n.zoom!==void 0&&(h.zoom=n.zoom),n.view!==void 0&&(h.view=Object.assign({},n.view));break;case"AmbientLight":h=new kc(n.color,n.intensity);break;case"DirectionalLight":h=new Nc(n.color,n.intensity);break;case"PointLight":h=new Fc(n.color,n.intensity,n.distance,n.decay);break;case"RectAreaLight":h=new Uc(n.color,n.intensity,n.width,n.height);break;case"SpotLight":h=new Bc(n.color,n.intensity,n.distance,n.angle,n.penumbra,n.decay);break;case"HemisphereLight":h=new Ic(n.color,n.groundColor,n.intensity);break;case"LightProbe":h=new Wi().fromJSON(n);break;case"SkinnedMesh":_=p(n.geometry),S=C(n.material),h=new sl(_,S),n.bindMode!==void 0&&(h.bindMode=n.bindMode),n.bindMatrix!==void 0&&h.bindMatrix.fromArray(n.bindMatrix),n.skeleton!==void 0&&(h.skeleton=n.skeleton);break;case"Mesh":_=p(n.geometry),S=C(n.material),h=new xn(_,S);break;case"InstancedMesh":_=p(n.geometry),S=C(n.material);var D=n.count,P=n.instanceMatrix;h=new nc(_,S,D),h.instanceMatrix=new dr(new Float32Array(P.array),16);break;case"LOD":h=new ol;break;case"Line":h=new Vi(p(n.geometry),C(n.material));break;case"LineLoop":h=new ac(p(n.geometry),C(n.material));break;case"LineSegments":h=new bi(p(n.geometry),C(n.material));break;case"PointCloud":case"Points":h=new ys(p(n.geometry),C(n.material));break;case"Sprite":h=new al(C(n.material));break;case"Group":h=new Fa;break;case"Bone":h=new ll;break;default:h=new Qt}if(h.uuid=n.uuid,n.name!==void 0&&(h.name=n.name),n.matrix!==void 0?(h.matrix.fromArray(n.matrix),n.matrixAutoUpdate!==void 0&&(h.matrixAutoUpdate=n.matrixAutoUpdate),h.matrixAutoUpdate&&h.matrix.decompose(h.position,h.quaternion,h.scale)):(n.position!==void 0&&h.position.fromArray(n.position),n.rotation!==void 0&&h.rotation.fromArray(n.rotation),n.quaternion!==void 0&&h.quaternion.fromArray(n.quaternion),n.scale!==void 0&&h.scale.fromArray(n.scale)),n.castShadow!==void 0&&(h.castShadow=n.castShadow),n.receiveShadow!==void 0&&(h.receiveShadow=n.receiveShadow),n.shadow&&(n.shadow.bias!==void 0&&(h.shadow.bias=n.shadow.bias),n.shadow.normalBias!==void 0&&(h.shadow.normalBias=n.shadow.normalBias),n.shadow.radius!==void 0&&(h.shadow.radius=n.shadow.radius),n.shadow.mapSize!==void 0&&h.shadow.mapSize.fromArray(n.shadow.mapSize),n.shadow.camera!==void 0&&(h.shadow.camera=this.parseObject(n.shadow.camera))),n.visible!==void 0&&(h.visible=n.visible),n.frustumCulled!==void 0&&(h.frustumCulled=n.frustumCulled),n.renderOrder!==void 0&&(h.renderOrder=n.renderOrder),n.userData!==void 0&&(h.userData=n.userData),n.layers!==void 0&&(h.layers.mask=n.layers),n.children!==void 0)for(var H=n.children,W=0;W<H.length;W++)h.add(this.parseObject(H[W],o,s,c));if(n.animations!==void 0)for(var G=n.animations,B=0;B<G.length;B++){var te=G[B];h.animations.push(c[te])}if(n.type==="LOD"){n.autoUpdate!==void 0&&(h.autoUpdate=n.autoUpdate);for(var he=n.levels,K=0;K<he.length;K++){var Q=he[K],le=h.getObjectByProperty("uuid",Q.object);le!==void 0&&h.addLevel(le,Q.distance)}}return h},i.bindSkeletons=function(n,o){Object.keys(o).length!==0&&n.traverse(function(s){if(s.isSkinnedMesh===!0&&s.skeleton!==void 0){var c=o[s.skeleton];c===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",s.skeleton):s.bind(c,s.bindMatrix)}})},i.setTexturePath=function(n){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(n)},t}(dn),Cy={UVMapping:V,CubeReflectionMapping:ue,CubeRefractionMapping:De,EquirectangularReflectionMapping:Je,EquirectangularRefractionMapping:tt,CubeUVReflectionMapping:jt,CubeUVRefractionMapping:wr},nf={RepeatWrapping:Ar,ClampToEdgeWrapping:Jt,MirroredRepeatWrapping:ir},af={NearestFilter:ar,NearestMipmapNearestFilter:yn,NearestMipmapLinearFilter:An,LinearFilter:nt,LinearMipmapNearestFilter:Et,LinearMipmapLinearFilter:or};function ih(a){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),dn.call(this,a),this.options={premultiplyAlpha:"none"}}ih.prototype=Object.assign(Object.create(dn.prototype),{constructor:ih,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(t,i,r,n){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var o=this,s=Go.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){i&&i(s),o.manager.itemEnd(t)},0),s;var c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",fetch(t,c).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,o.options)}).then(function(h){Go.add(t,h),i&&i(h),o.manager.itemEnd(t)}).catch(function(h){n&&n(h),o.manager.itemError(t),o.manager.itemEnd(t)}),o.manager.itemStart(t)}});function ah(){this.type="ShapePath",this.color=new It,this.subPaths=[],this.currentPath=null}Object.assign(ah.prototype,{moveTo:function(t,i){return this.currentPath=new sa,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,i),this},lineTo:function(t,i){return this.currentPath.lineTo(t,i),this},quadraticCurveTo:function(t,i,r,n){return this.currentPath.quadraticCurveTo(t,i,r,n),this},bezierCurveTo:function(t,i,r,n,o,s){return this.currentPath.bezierCurveTo(t,i,r,n,o,s),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,i){function r(He){for(var Qe=[],qe=0,gt=He.length;qe<gt;qe++){var St=He[qe],Vt=new vo;Vt.curves=St.curves,Qe.push(Vt)}return Qe}function n(He,Qe){for(var qe=Qe.length,gt=!1,St=qe-1,Vt=0;Vt<qe;St=Vt++){var Ke=Qe[St],rr=Qe[Vt],Bt=rr.x-Ke.x,sr=rr.y-Ke.y;if(Math.abs(sr)>Number.EPSILON){if(sr<0&&(Ke=Qe[Vt],Bt=-Bt,rr=Qe[St],sr=-sr),He.y<Ke.y||He.y>rr.y)continue;if(He.y===Ke.y){if(He.x===Ke.x)return!0}else{var xr=sr*(He.x-Ke.x)-Bt*(He.y-Ke.y);if(xr===0)return!0;if(xr<0)continue;gt=!gt}}else{if(He.y!==Ke.y)continue;if(rr.x<=He.x&&He.x<=Ke.x||Ke.x<=He.x&&He.x<=rr.x)return!0}}return gt}var o=Na.isClockWise,s=this.subPaths;if(s.length===0)return[];if(i===!0)return r(s);var c,h,p,C=[];if(s.length===1)return h=s[0],p=new vo,p.curves=h.curves,C.push(p),C;var _=!o(s[0].getPoints());_=t?!_:_;var S=[],D=[],P=[],H=0,W;D[H]=void 0,P[H]=[];for(var G=0,B=s.length;G<B;G++)h=s[G],W=h.getPoints(),c=o(W),c=t?!c:c,c?(!_&&D[H]&&H++,D[H]={s:new vo,p:W},D[H].s.curves=h.curves,_&&H++,P[H]=[]):P[H].push({h,p:W[0]});if(!D[0])return r(s);if(D.length>1){for(var te=!1,he=[],K=0,Q=D.length;K<Q;K++)S[K]=[];for(var le=0,Me=D.length;le<Me;le++)for(var xe=P[le],_e=0;_e<xe.length;_e++){for(var Pe=xe[_e],Ce=!0,Ae=0;Ae<D.length;Ae++)n(Pe.p,D[Ae].p)&&(le!==Ae&&he.push({froms:le,tos:Ae,hole:_e}),Ce?(Ce=!1,S[Ae].push(Pe)):te=!0);Ce&&S[le].push(Pe)}he.length>0&&(te||(P=S))}for(var Be,Se=0,Te=D.length;Se<Te;Se++){p=D[Se].s,C.push(p),Be=P[Se];for(var me=0,Ue=Be.length;me<Ue;me++)p.holes.push(Be[me].h)}return C}});var of=function(){function a(i){Object.defineProperty(this,"isFont",{value:!0}),this.type="Font",this.data=i}var t=a.prototype;return t.generateShapes=function(r,n){n===void 0&&(n=100);for(var o=[],s=Ly(r,n,this.data),c=0,h=s.length;c<h;c++)Array.prototype.push.apply(o,s[c].toShapes());return o},a}();function Ly(a,t,i){for(var r=Array.from?Array.from(a):String(a).split(""),n=t/i.resolution,o=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*n,s=[],c=0,h=0,p=0;p<r.length;p++){var C=r[p];if(C===`
`)c=0,h-=o;else{var _=Ry(C,n,c,h,i);c+=_.offsetX,s.push(_.path)}}return s}function Ry(a,t,i,r,n){var o=n.glyphs[a]||n.glyphs["?"];if(!o){console.error('THREE.Font: character "'+a+'" does not exists in font family '+n.familyName+".");return}var s=new ah,c,h,p,C,_,S,D,P;if(o.o)for(var H=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),W=0,G=H.length;W<G;){var B=H[W++];switch(B){case"m":c=H[W++]*t+i,h=H[W++]*t+r,s.moveTo(c,h);break;case"l":c=H[W++]*t+i,h=H[W++]*t+r,s.lineTo(c,h);break;case"q":p=H[W++]*t+i,C=H[W++]*t+r,_=H[W++]*t+i,S=H[W++]*t+r,s.quadraticCurveTo(_,S,p,C);break;case"b":p=H[W++]*t+i,C=H[W++]*t+r,_=H[W++]*t+i,S=H[W++]*t+r,D=H[W++]*t+i,P=H[W++]*t+r,s.bezierCurveTo(_,S,D,P,p,C);break}}return{offsetX:o.ha*t,path:s}}function oh(a){dn.call(this,a)}oh.prototype=Object.assign(Object.create(dn.prototype),{constructor:oh,load:function(t,i,r,n){var o=this,s=new zi(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(o.withCredentials),s.load(t,function(c){var h;try{h=JSON.parse(c)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),h=JSON.parse(c.substring(65,c.length-2))}var p=o.parse(h);i&&i(p)},r,n)},parse:function(t){return new of(t)}});var zc,sh={getContext:function(){return zc===void 0&&(zc=new(window.AudioContext||window.webkitAudioContext)),zc},setContext:function(t){zc=t}};function Wc(a){dn.call(this,a)}Wc.prototype=Object.assign(Object.create(dn.prototype),{constructor:Wc,load:function(t,i,r,n){var o=this,s=new zi(o.manager);s.setResponseType("arraybuffer"),s.setPath(o.path),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(t,function(c){try{var h=c.slice(0),p=sh.getContext();p.decodeAudioData(h,function(C){i(C)})}catch(C){n?n(C):console.error(C),o.manager.itemError(t)}},r,n)}});function lh(a,t,i){Wi.call(this,void 0,i);var r=new It().set(a),n=new It().set(t),o=new fe(r.r,r.g,r.b),s=new fe(n.r,n.g,n.b),c=Math.sqrt(Math.PI),h=c*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(s).multiplyScalar(c),this.sh.coefficients[1].copy(o).sub(s).multiplyScalar(h)}lh.prototype=Object.assign(Object.create(Wi.prototype),{constructor:lh,isHemisphereLightProbe:!0,copy:function(t){return Wi.prototype.copy.call(this,t),this},toJSON:function(t){var i=Wi.prototype.toJSON.call(this,t);return i}});function ch(a,t){Wi.call(this,void 0,t);var i=new It().set(a);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}ch.prototype=Object.assign(Object.create(Wi.prototype),{constructor:ch,isAmbientLightProbe:!0,copy:function(t){return Wi.prototype.copy.call(this,t),this},toJSON:function(t){var i=Wi.prototype.toJSON.call(this,t);return i}});var sf=new kr,lf=new kr;function cf(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Nn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Nn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(cf.prototype,{update:function(t){var i=this._cache,r=i.focus!==t.focus||i.fov!==t.fov||i.aspect!==t.aspect*this.aspect||i.near!==t.near||i.far!==t.far||i.zoom!==t.zoom||i.eyeSep!==this.eyeSep;if(r){i.focus=t.focus,i.fov=t.fov,i.aspect=t.aspect*this.aspect,i.near=t.near,i.far=t.far,i.zoom=t.zoom,i.eyeSep=this.eyeSep;var n=t.projectionMatrix.clone(),o=i.eyeSep/2,s=o*i.near/i.focus,c=i.near*Math.tan(gr.DEG2RAD*i.fov*.5)/i.zoom,h,p;lf.elements[12]=-o,sf.elements[12]=o,h=-c*i.aspect+s,p=c*i.aspect+s,n.elements[0]=2*i.near/(p-h),n.elements[8]=(p+h)/(p-h),this.cameraL.projectionMatrix.copy(n),h=-c*i.aspect-s,p=c*i.aspect-s,n.elements[0]=2*i.near/(p-h),n.elements[8]=(p+h)/(p-h),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(lf),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(sf)}});var uf=function(){function a(i){this.autoStart=i!==void 0?i:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var t=a.prototype;return t.start=function(){this.startTime=hf(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},t.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},t.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},t.getDelta=function(){var r=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var n=hf();r=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=r}return r},a}();function hf(){return(typeof performance>"u"?Date:performance).now()}var Vo=new fe,df=new ni,Py=new fe,zo=new fe,Dy=function(a){Or(t,a);function t(){var r;return r=a.call(this)||this,r.type="AudioListener",r.context=sh.getContext(),r.gain=r.context.createGain(),r.gain.connect(r.context.destination),r.filter=null,r.timeDelta=0,r._clock=new uf,r}var i=t.prototype;return i.getInput=function(){return this.gain},i.removeFilter=function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},i.getFilter=function(){return this.filter},i.setFilter=function(n){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=n,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},i.getMasterVolume=function(){return this.gain.gain.value},i.setMasterVolume=function(n){return this.gain.gain.setTargetAtTime(n,this.context.currentTime,.01),this},i.updateMatrixWorld=function(n){a.prototype.updateMatrixWorld.call(this,n);var o=this.context.listener,s=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Vo,df,Py),zo.set(0,0,-1).applyQuaternion(df),o.positionX){var c=this.context.currentTime+this.timeDelta;o.positionX.linearRampToValueAtTime(Vo.x,c),o.positionY.linearRampToValueAtTime(Vo.y,c),o.positionZ.linearRampToValueAtTime(Vo.z,c),o.forwardX.linearRampToValueAtTime(zo.x,c),o.forwardY.linearRampToValueAtTime(zo.y,c),o.forwardZ.linearRampToValueAtTime(zo.z,c),o.upX.linearRampToValueAtTime(s.x,c),o.upY.linearRampToValueAtTime(s.y,c),o.upZ.linearRampToValueAtTime(s.z,c)}else o.setPosition(Vo.x,Vo.y,Vo.z),o.setOrientation(zo.x,zo.y,zo.z,s.x,s.y,s.z)},t}(Qt),uh=function(a){Or(t,a);function t(r){var n;return n=a.call(this)||this,n.type="Audio",n.listener=r,n.context=r.context,n.gain=n.context.createGain(),n.gain.connect(r.getInput()),n.autoplay=!1,n.buffer=null,n.detune=0,n.loop=!1,n.loopStart=0,n.loopEnd=0,n.offset=0,n.duration=void 0,n.playbackRate=1,n.isPlaying=!1,n.hasPlaybackControl=!0,n.source=null,n.sourceType="empty",n._startedAt=0,n._progress=0,n._connected=!1,n.filters=[],n}var i=t.prototype;return i.getOutput=function(){return this.gain},i.setNodeSource=function(n){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=n,this.connect(),this},i.setMediaElementSource=function(n){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(n),this.connect(),this},i.setMediaStreamSource=function(n){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(n),this.connect(),this},i.setBuffer=function(n){return this.buffer=n,this.sourceType="buffer",this.autoplay&&this.play(),this},i.play=function(n){if(n===void 0&&(n=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+n;var o=this.context.createBufferSource();return o.buffer=this.buffer,o.loop=this.loop,o.loopStart=this.loopStart,o.loopEnd=this.loopEnd,o.onended=this.onEnded.bind(this),o.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=o,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},i.pause=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},i.stop=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},i.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var n=1,o=this.filters.length;n<o;n++)this.filters[n-1].connect(this.filters[n]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},i.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var n=1,o=this.filters.length;n<o;n++)this.filters[n-1].disconnect(this.filters[n]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},i.getFilters=function(){return this.filters},i.setFilters=function(n){return n||(n=[]),this._connected===!0?(this.disconnect(),this.filters=n.slice(),this.connect()):this.filters=n.slice(),this},i.setDetune=function(n){if(this.detune=n,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},i.getDetune=function(){return this.detune},i.getFilter=function(){return this.getFilters()[0]},i.setFilter=function(n){return this.setFilters(n?[n]:[])},i.setPlaybackRate=function(n){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=n,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},i.getPlaybackRate=function(){return this.playbackRate},i.onEnded=function(){this.isPlaying=!1},i.getLoop=function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},i.setLoop=function(n){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=n,this.isPlaying===!0&&(this.source.loop=this.loop),this},i.setLoopStart=function(n){return this.loopStart=n,this},i.setLoopEnd=function(n){return this.loopEnd=n,this},i.getVolume=function(){return this.gain.gain.value},i.setVolume=function(n){return this.gain.gain.setTargetAtTime(n,this.context.currentTime,.01),this},t}(Qt),Wo=new fe,ff=new ni,Oy=new fe,jo=new fe,Iy=function(a){Or(t,a);function t(r){var n;return n=a.call(this,r)||this,n.panner=n.context.createPanner(),n.panner.panningModel="HRTF",n.panner.connect(n.gain),n}var i=t.prototype;return i.getOutput=function(){return this.panner},i.getRefDistance=function(){return this.panner.refDistance},i.setRefDistance=function(n){return this.panner.refDistance=n,this},i.getRolloffFactor=function(){return this.panner.rolloffFactor},i.setRolloffFactor=function(n){return this.panner.rolloffFactor=n,this},i.getDistanceModel=function(){return this.panner.distanceModel},i.setDistanceModel=function(n){return this.panner.distanceModel=n,this},i.getMaxDistance=function(){return this.panner.maxDistance},i.setMaxDistance=function(n){return this.panner.maxDistance=n,this},i.setDirectionalCone=function(n,o,s){return this.panner.coneInnerAngle=n,this.panner.coneOuterAngle=o,this.panner.coneOuterGain=s,this},i.updateMatrixWorld=function(n){if(a.prototype.updateMatrixWorld.call(this,n),!(this.hasPlaybackControl===!0&&this.isPlaying===!1)){this.matrixWorld.decompose(Wo,ff,Oy),jo.set(0,0,1).applyQuaternion(ff);var o=this.panner;if(o.positionX){var s=this.context.currentTime+this.listener.timeDelta;o.positionX.linearRampToValueAtTime(Wo.x,s),o.positionY.linearRampToValueAtTime(Wo.y,s),o.positionZ.linearRampToValueAtTime(Wo.z,s),o.orientationX.linearRampToValueAtTime(jo.x,s),o.orientationY.linearRampToValueAtTime(jo.y,s),o.orientationZ.linearRampToValueAtTime(jo.z,s)}else o.setPosition(Wo.x,Wo.y,Wo.z),o.setOrientation(jo.x,jo.y,jo.z)}},t}(uh),pf=function(){function a(i,r){r===void 0&&(r=2048),this.analyser=i.context.createAnalyser(),this.analyser.fftSize=r,this.data=new Uint8Array(this.analyser.frequencyBinCount),i.getOutput().connect(this.analyser)}var t=a.prototype;return t.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},t.getAverageFrequency=function(){for(var r=0,n=this.getFrequencyData(),o=0;o<n.length;o++)r+=n[o];return r/n.length},a}();function hh(a,t,i){this.binding=a,this.valueSize=i;var r,n,o;switch(t){case"quaternion":r=this._slerp,n=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,n=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,n=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=n,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(hh.prototype,{accumulate:function(t,i){var r=this.buffer,n=this.valueSize,o=t*n+n,s=this.cumulativeWeight;if(s===0){for(var c=0;c!==n;++c)r[o+c]=r[c];s=i}else{s+=i;var h=i/s;this._mixBufferRegion(r,o,0,h,n)}this.cumulativeWeight=s},accumulateAdditive:function(t){var i=this.buffer,r=this.valueSize,n=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,n,0,t,r),this.cumulativeWeightAdditive+=t},apply:function(t){var i=this.valueSize,r=this.buffer,n=t*i+i,o=this.cumulativeWeight,s=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){var h=i*this._origIndex;this._mixBufferRegion(r,n,h,1-o,i)}s>0&&this._mixBufferRegionAdditive(r,n,this._addIndex*i,1,i);for(var p=i,C=i+i;p!==C;++p)if(r[p]!==r[p+i]){c.setValue(r,n);break}},saveOriginalState:function(){var t=this.binding,i=this.buffer,r=this.valueSize,n=r*this._origIndex;t.getValue(i,n);for(var o=r,s=n;o!==s;++o)i[o]=i[n+o%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var t=this.valueSize*3;this.binding.setValue(this.buffer,t)},_setAdditiveIdentityNumeric:function(){for(var t=this._addIndex*this.valueSize,i=t+this.valueSize,r=t;r<i;r++)this.buffer[r]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){for(var t=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize,r=0;r<this.valueSize;r++)this.buffer[i+r]=this.buffer[t+r]},_select:function(t,i,r,n,o){if(n>=.5)for(var s=0;s!==o;++s)t[i+s]=t[r+s]},_slerp:function(t,i,r,n){ni.slerpFlat(t,i,t,i,t,r,n)},_slerpAdditive:function(t,i,r,n,o){var s=this._workIndex*o;ni.multiplyQuaternionsFlat(t,s,t,i,t,r),ni.slerpFlat(t,i,t,i,t,s,n)},_lerp:function(t,i,r,n,o){for(var s=1-n,c=0;c!==o;++c){var h=i+c;t[h]=t[h]*s+t[r+c]*n}},_lerpAdditive:function(t,i,r,n,o){for(var s=0;s!==o;++s){var c=i+s;t[c]=t[c]+t[r+s]*n}}});var dh="\\[\\]\\.:\\/",By=new RegExp("["+dh+"]","g"),fh="[^"+dh+"]",Fy="[^"+dh.replace("\\.","")+"]",Ny=/((?:WC+[\/:])*)/.source.replace("WC",fh),ky=/(WCOD+)?/.source.replace("WCOD",Fy),Uy=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",fh),Hy=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",fh),Gy=new RegExp("^"+Ny+ky+Uy+Hy+"$"),Vy=["material","materials","bones"];function vf(a,t,i){var r=i||di.parseTrackName(t);this._targetGroup=a,this._bindings=a.subscribe_(t,r)}Object.assign(vf.prototype,{getValue:function(t,i){this.bind();var r=this._targetGroup.nCachedObjects_,n=this._bindings[r];n!==void 0&&n.getValue(t,i)},setValue:function(t,i){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,o=r.length;n!==o;++n)r[n].setValue(t,i)},bind:function(){for(var t=this._bindings,i=this._targetGroup.nCachedObjects_,r=t.length;i!==r;++i)t[i].bind()},unbind:function(){for(var t=this._bindings,i=this._targetGroup.nCachedObjects_,r=t.length;i!==r;++i)t[i].unbind()}});function di(a,t,i){this.path=t,this.parsedPath=i||di.parseTrackName(t),this.node=di.findNode(a,this.parsedPath.nodeName)||a,this.rootNode=a}Object.assign(di,{Composite:vf,create:function(t,i,r){return t&&t.isAnimationObjectGroup?new di.Composite(t,i,r):new di(t,i,r)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(By,"")},parseTrackName:function(t){var i=Gy.exec(t);if(!i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){var o=r.nodeName.substring(n+1);Vy.indexOf(o)!==-1&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=o)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r},findNode:function(t,i){if(!i||i===""||i==="."||i===-1||i===t.name||i===t.uuid)return t;if(t.skeleton){var r=t.skeleton.getBoneByName(i);if(r!==void 0)return r}if(t.children){var n=function s(c){for(var h=0;h<c.length;h++){var p=c[h];if(p.name===i||p.uuid===i)return p;var C=s(p.children);if(C)return C}return null},o=n(t.children);if(o)return o}return null}}),Object.assign(di.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,i){t[i]=this.node[this.propertyName]},function(t,i){for(var r=this.resolvedProperty,n=0,o=r.length;n!==o;++n)t[i++]=r[n]},function(t,i){t[i]=this.resolvedProperty[this.propertyIndex]},function(t,i){this.resolvedProperty.toArray(t,i)}],SetterByBindingTypeAndVersioning:[[function(t,i){this.targetObject[this.propertyName]=t[i]},function(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0},function(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,i){for(var r=this.resolvedProperty,n=0,o=r.length;n!==o;++n)r[n]=t[i++]},function(t,i){for(var r=this.resolvedProperty,n=0,o=r.length;n!==o;++n)r[n]=t[i++];this.targetObject.needsUpdate=!0},function(t,i){for(var r=this.resolvedProperty,n=0,o=r.length;n!==o;++n)r[n]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,i){this.resolvedProperty[this.propertyIndex]=t[i]},function(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0},function(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,i){this.resolvedProperty.fromArray(t,i)},function(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0},function(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,i){this.bind(),this.getValue(t,i)},setValue:function(t,i){this.bind(),this.setValue(t,i)},bind:function(){var t=this.node,i=this.parsedPath,r=i.objectName,n=i.propertyName,o=i.propertyIndex;if(t||(t=di.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){var s=i.objectIndex;switch(r){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(var c=0;c<t.length;c++)if(t[c].name===s){s=c;break}break;default:if(t[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[r]}if(s!==void 0){if(t[s]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[s]}}var h=t[n];if(h===void 0){var p=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+p+"."+n+" but it wasn't found.",t);return}var C=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?C=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(C=this.Versioning.MatrixWorldNeedsUpdate);var _=this.BindingType.Direct;if(o!==void 0){if(n==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[o]!==void 0&&(o=t.morphTargetDictionary[o])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}_=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=o}else h.fromArray!==void 0&&h.toArray!==void 0?(_=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(_=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=n;this.getValue=this.GetterByBindingType[_],this.setValue=this.SetterByBindingTypeAndVersioning[_][C]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(di.prototype,{_getValue_unbound:di.prototype.getValue,_setValue_unbound:di.prototype.setValue});function mf(){this.uuid=gr.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var a={};this._indicesByUUID=a;for(var t=0,i=arguments.length;t!==i;++t)a[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}Object.assign(mf.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,i=this._indicesByUUID,r=this._paths,n=this._parsedPaths,o=this._bindings,s=o.length,c=void 0,h=t.length,p=this.nCachedObjects_,C=0,_=arguments.length;C!==_;++C){var S=arguments[C],D=S.uuid,P=i[D];if(P===void 0){P=h++,i[D]=P,t.push(S);for(var H=0,W=s;H!==W;++H)o[H].push(new di(S,r[H],n[H]))}else if(P<p){c=t[P];var G=--p,B=t[G];i[B.uuid]=P,t[P]=B,i[D]=G,t[G]=S;for(var te=0,he=s;te!==he;++te){var K=o[te],Q=K[G],le=K[P];K[P]=Q,le===void 0&&(le=new di(S,r[te],n[te])),K[G]=le}}else t[P]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=p},remove:function(){for(var t=this._objects,i=this._indicesByUUID,r=this._bindings,n=r.length,o=this.nCachedObjects_,s=0,c=arguments.length;s!==c;++s){var h=arguments[s],p=h.uuid,C=i[p];if(C!==void 0&&C>=o){var _=o++,S=t[_];i[S.uuid]=C,t[C]=S,i[p]=_,t[_]=h;for(var D=0,P=n;D!==P;++D){var H=r[D],W=H[_],G=H[C];H[C]=W,H[_]=G}}}this.nCachedObjects_=o},uncache:function(){for(var t=this._objects,i=this._indicesByUUID,r=this._bindings,n=r.length,o=this.nCachedObjects_,s=t.length,c=0,h=arguments.length;c!==h;++c){var p=arguments[c],C=p.uuid,_=i[C];if(_!==void 0)if(delete i[C],_<o){var S=--o,D=t[S],P=--s,H=t[P];i[D.uuid]=_,t[_]=D,i[H.uuid]=S,t[S]=H,t.pop();for(var W=0,G=n;W!==G;++W){var B=r[W],te=B[S],he=B[P];B[_]=te,B[S]=he,B.pop()}}else{var K=--s,Q=t[K];K>0&&(i[Q.uuid]=_),t[_]=Q,t.pop();for(var le=0,Me=n;le!==Me;++le){var xe=r[le];xe[_]=xe[K],xe.pop()}}}this.nCachedObjects_=o},subscribe_:function(t,i){var r=this._bindingsIndicesByPath,n=r[t],o=this._bindings;if(n!==void 0)return o[n];var s=this._paths,c=this._parsedPaths,h=this._objects,p=h.length,C=this.nCachedObjects_,_=new Array(p);n=o.length,r[t]=n,s.push(t),c.push(i),o.push(_);for(var S=C,D=h.length;S!==D;++S){var P=h[S];_[S]=new di(P,t,i)}return _},unsubscribe_:function(t){var i=this._bindingsIndicesByPath,r=i[t];if(r!==void 0){var n=this._paths,o=this._parsedPaths,s=this._bindings,c=s.length-1,h=s[c],p=t[c];i[p]=r,s[r]=h,s.pop(),o[r]=o[c],o.pop(),n[r]=n[c],n.pop()}}});var zy=function(){function a(i,r,n,o){n===void 0&&(n=null),o===void 0&&(o=r.blendMode),this._mixer=i,this._clip=r,this._localRoot=n,this.blendMode=o;for(var s=r.tracks,c=s.length,h=new Array(c),p={endingStart:Ti,endingEnd:Ti},C=0;C!==c;++C){var _=s[C].createInterpolant(null);h[C]=_,_.settings=p}this._interpolantSettings=p,this._interpolants=h,this._propertyBindings=new Array(c),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Xi,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}var t=a.prototype;return t.play=function(){return this._mixer._activateAction(this),this},t.stop=function(){return this._mixer._deactivateAction(this),this.reset()},t.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},t.isRunning=function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},t.isScheduled=function(){return this._mixer._isActiveAction(this)},t.startAt=function(r){return this._startTime=r,this},t.setLoop=function(r,n){return this.loop=r,this.repetitions=n,this},t.setEffectiveWeight=function(r){return this.weight=r,this._effectiveWeight=this.enabled?r:0,this.stopFading()},t.getEffectiveWeight=function(){return this._effectiveWeight},t.fadeIn=function(r){return this._scheduleFading(r,0,1)},t.fadeOut=function(r){return this._scheduleFading(r,1,0)},t.crossFadeFrom=function(r,n,o){if(r.fadeOut(n),this.fadeIn(n),o){var s=this._clip.duration,c=r._clip.duration,h=c/s,p=s/c;r.warp(1,h,n),this.warp(p,1,n)}return this},t.crossFadeTo=function(r,n,o){return r.crossFadeFrom(this,n,o)},t.stopFading=function(){var r=this._weightInterpolant;return r!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(r)),this},t.setEffectiveTimeScale=function(r){return this.timeScale=r,this._effectiveTimeScale=this.paused?0:r,this.stopWarping()},t.getEffectiveTimeScale=function(){return this._effectiveTimeScale},t.setDuration=function(r){return this.timeScale=this._clip.duration/r,this.stopWarping()},t.syncWith=function(r){return this.time=r.time,this.timeScale=r.timeScale,this.stopWarping()},t.halt=function(r){return this.warp(this._effectiveTimeScale,0,r)},t.warp=function(r,n,o){var s=this._mixer,c=s.time,h=this.timeScale,p=this._timeScaleInterpolant;p===null&&(p=s._lendControlInterpolant(),this._timeScaleInterpolant=p);var C=p.parameterPositions,_=p.sampleValues;return C[0]=c,C[1]=c+o,_[0]=r/h,_[1]=n/h,this},t.stopWarping=function(){var r=this._timeScaleInterpolant;return r!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(r)),this},t.getMixer=function(){return this._mixer},t.getClip=function(){return this._clip},t.getRoot=function(){return this._localRoot||this._mixer._root},t._update=function(r,n,o,s){if(!this.enabled){this._updateWeight(r);return}var c=this._startTime;if(c!==null){var h=(r-c)*o;if(h<0||o===0)return;this._startTime=null,n=o*h}n*=this._updateTimeScale(r);var p=this._updateTime(n),C=this._updateWeight(r);if(C>0){var _=this._interpolants,S=this._propertyBindings;switch(this.blendMode){case Ca:for(var D=0,P=_.length;D!==P;++D)_[D].evaluate(p),S[D].accumulateAdditive(C);break;case fa:default:for(var H=0,W=_.length;H!==W;++H)_[H].evaluate(p),S[H].accumulate(s,C)}}},t._updateWeight=function(r){var n=0;if(this.enabled){n=this.weight;var o=this._weightInterpolant;if(o!==null){var s=o.evaluate(r)[0];n*=s,r>o.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n},t._updateTimeScale=function(r){var n=0;if(!this.paused){n=this.timeScale;var o=this._timeScaleInterpolant;if(o!==null){var s=o.evaluate(r)[0];n*=s,r>o.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n},t._updateTime=function(r){var n=this._clip.duration,o=this.loop,s=this.time+r,c=this._loopCount,h=o===Ya;if(r===0)return c===-1?s:h&&(c&1)===1?n-s:s;if(o===ci){c===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=n)s=n;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:r<0?-1:1})}}else{if(c===-1&&(r>=0?(c=0,this._setEndings(!0,this.repetitions===0,h)):this._setEndings(this.repetitions===0,!0,h)),s>=n||s<0){var p=Math.floor(s/n);s-=n*p,c+=Math.abs(p);var C=this.repetitions-c;if(C<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=r>0?n:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:r>0?1:-1});else{if(C===1){var _=r<0;this._setEndings(_,!_,h)}else this._setEndings(!1,!1,h);this._loopCount=c,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:p})}}else this.time=s;if(h&&(c&1)===1)return n-s}return s},t._setEndings=function(r,n,o){var s=this._interpolantSettings;o?(s.endingStart=Si,s.endingEnd=Si):(r?s.endingStart=this.zeroSlopeAtStart?Si:Ti:s.endingStart=qi,n?s.endingEnd=this.zeroSlopeAtEnd?Si:Ti:s.endingEnd=qi)},t._scheduleFading=function(r,n,o){var s=this._mixer,c=s.time,h=this._weightInterpolant;h===null&&(h=s._lendControlInterpolant(),this._weightInterpolant=h);var p=h.parameterPositions,C=h.sampleValues;return p[0]=c,C[0]=n,p[1]=c+r,C[1]=o,this},a}();function ph(a){this._root=a,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}ph.prototype=Object.assign(Object.create(pa.prototype),{constructor:ph,_bindAction:function(t,i){var r=t._localRoot||this._root,n=t._clip.tracks,o=n.length,s=t._propertyBindings,c=t._interpolants,h=r.uuid,p=this._bindingsByRootAndName,C=p[h];C===void 0&&(C={},p[h]=C);for(var _=0;_!==o;++_){var S=n[_],D=S.name,P=C[D];if(P!==void 0)s[_]=P;else{if(P=s[_],P!==void 0){P._cacheIndex===null&&(++P.referenceCount,this._addInactiveBinding(P,h,D));continue}var H=i&&i._propertyBindings[_].binding.parsedPath;P=new hh(di.create(r,D,H),S.ValueTypeName,S.getValueSize()),++P.referenceCount,this._addInactiveBinding(P,h,D),s[_]=P}c[_].resultBuffer=P.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){var i=(t._localRoot||this._root).uuid,r=t._clip.uuid,n=this._actionsByClip[r];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,r,i)}for(var o=t._propertyBindings,s=0,c=o.length;s!==c;++s){var h=o[s];h.useCount++===0&&(this._lendBinding(h),h.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var i=t._propertyBindings,r=0,n=i.length;r!==n;++r){var o=i[r];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var i=t._cacheIndex;return i!==null&&i<this._nActiveActions},_addInactiveAction:function(t,i,r){var n=this._actions,o=this._actionsByClip,s=o[i];if(s===void 0)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,o[i]=s;else{var c=s.knownActions;t._byClipCacheIndex=c.length,c.push(t)}t._cacheIndex=n.length,n.push(t),s.actionByRoot[r]=t},_removeInactiveAction:function(t){var i=this._actions,r=i[i.length-1],n=t._cacheIndex;r._cacheIndex=n,i[n]=r,i.pop(),t._cacheIndex=null;var o=t._clip.uuid,s=this._actionsByClip,c=s[o],h=c.knownActions,p=h[h.length-1],C=t._byClipCacheIndex;p._byClipCacheIndex=C,h[C]=p,h.pop(),t._byClipCacheIndex=null;var _=c.actionByRoot,S=(t._localRoot||this._root).uuid;delete _[S],h.length===0&&delete s[o],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var i=t._propertyBindings,r=0,n=i.length;r!==n;++r){var o=i[r];--o.referenceCount===0&&this._removeInactiveBinding(o)}},_lendAction:function(t){var i=this._actions,r=t._cacheIndex,n=this._nActiveActions++,o=i[n];t._cacheIndex=n,i[n]=t,o._cacheIndex=r,i[r]=o},_takeBackAction:function(t){var i=this._actions,r=t._cacheIndex,n=--this._nActiveActions,o=i[n];t._cacheIndex=n,i[n]=t,o._cacheIndex=r,i[r]=o},_addInactiveBinding:function(t,i,r){var n=this._bindingsByRootAndName,o=this._bindings,s=n[i];s===void 0&&(s={},n[i]=s),s[r]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var i=this._bindings,r=t.binding,n=r.rootNode.uuid,o=r.path,s=this._bindingsByRootAndName,c=s[n],h=i[i.length-1],p=t._cacheIndex;h._cacheIndex=p,i[p]=h,i.pop(),delete c[o],Object.keys(c).length===0&&delete s[n]},_lendBinding:function(t){var i=this._bindings,r=t._cacheIndex,n=this._nActiveBindings++,o=i[n];t._cacheIndex=n,i[n]=t,o._cacheIndex=r,i[r]=o},_takeBackBinding:function(t){var i=this._bindings,r=t._cacheIndex,n=--this._nActiveBindings,o=i[n];t._cacheIndex=n,i[n]=t,o._cacheIndex=r,i[r]=o},_lendControlInterpolant:function(){var t=this._controlInterpolants,i=this._nActiveControlInterpolants++,r=t[i];return r===void 0&&(r=new Al(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),r.__cacheIndex=i,t[i]=r),r},_takeBackControlInterpolant:function(t){var i=this._controlInterpolants,r=t.__cacheIndex,n=--this._nActiveControlInterpolants,o=i[n];t.__cacheIndex=n,i[n]=t,o.__cacheIndex=r,i[r]=o},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,i,r){var n=i||this._root,o=n.uuid,s=typeof t=="string"?Ii.findByName(n,t):t,c=s!==null?s.uuid:t,h=this._actionsByClip[c],p=null;if(r===void 0&&(s!==null?r=s.blendMode:r=fa),h!==void 0){var C=h.actionByRoot[o];if(C!==void 0&&C.blendMode===r)return C;p=h.knownActions[0],s===null&&(s=p._clip)}if(s===null)return null;var _=new zy(this,s,i,r);return this._bindAction(_,p),this._addInactiveAction(_,c,o),_},existingAction:function(t,i){var r=i||this._root,n=r.uuid,o=typeof t=="string"?Ii.findByName(r,t):t,s=o?o.uuid:t,c=this._actionsByClip[s];return c!==void 0&&c.actionByRoot[n]||null},stopAllAction:function(){for(var t=this._actions,i=this._nActiveActions,r=i-1;r>=0;--r)t[r].stop();return this},update:function(t){t*=this.timeScale;for(var i=this._actions,r=this._nActiveActions,n=this.time+=t,o=Math.sign(t),s=this._accuIndex^=1,c=0;c!==r;++c){var h=i[c];h._update(n,t,o,s)}for(var p=this._bindings,C=this._nActiveBindings,_=0;_!==C;++_)p[_].apply(s);return this},setTime:function(t){this.time=0;for(var i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var i=this._actions,r=t.uuid,n=this._actionsByClip,o=n[r];if(o!==void 0){for(var s=o.knownActions,c=0,h=s.length;c!==h;++c){var p=s[c];this._deactivateAction(p);var C=p._cacheIndex,_=i[i.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,_._cacheIndex=C,i[C]=_,i.pop(),this._removeInactiveBindingsForAction(p)}delete n[r]}},uncacheRoot:function(t){var i=t.uuid,r=this._actionsByClip;for(var n in r){var o=r[n].actionByRoot,s=o[i];s!==void 0&&(this._deactivateAction(s),this._removeInactiveAction(s))}var c=this._bindingsByRootAndName,h=c[i];if(h!==void 0)for(var p in h){var C=h[p];C.restoreOriginalState(),this._removeInactiveBinding(C)}},uncacheAction:function(t,i){var r=this.existingAction(t,i);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}});var gf=function(){function a(i){typeof i=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),i=arguments[1]),this.value=i}var t=a.prototype;return t.clone=function(){return new a(this.value.clone===void 0?this.value:this.value.clone())},a}();function vh(a,t,i){Di.call(this,a,t),this.meshPerAttribute=i||1}vh.prototype=Object.assign(Object.create(Di.prototype),{constructor:vh,isInstancedInterleavedBuffer:!0,copy:function(t){return Di.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){var i=Di.prototype.clone.call(this,t);return i.meshPerAttribute=this.meshPerAttribute,i},toJSON:function(t){var i=Di.prototype.toJSON.call(this,t);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}});function mh(a,t,i,r,n){this.buffer=a,this.type=t,this.itemSize=i,this.elementSize=r,this.count=n,this.version=0}Object.defineProperty(mh.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),Object.assign(mh.prototype,{isGLBufferAttribute:!0,setBuffer:function(t){return this.buffer=t,this},setType:function(t,i){return this.type=t,this.elementSize=i,this},setItemSize:function(t){return this.itemSize=t,this},setCount:function(t){return this.count=t,this}});function gh(a,t,i,r){this.ray=new es(a,t),this.near=i||0,this.far=r||1/0,this.camera=null,this.layers=new vu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function yf(a,t){return a.distance-t.distance}function yh(a,t,i,r){if(a.layers.test(t.layers)&&a.raycast(t,i),r===!0)for(var n=a.children,o=0,s=n.length;o<s;o++)yh(n[o],t,i,!0)}Object.assign(gh.prototype,{set:function(t,i){this.ray.set(t,i)},setFromCamera:function(t,i){i&&i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i&&i.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)},intersectObject:function(t,i,r){var n=r||[];return yh(t,this,n,i),n.sort(yf),n},intersectObjects:function(t,i,r){var n=r||[];if(Array.isArray(t)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var o=0,s=t.length;o<s;o++)yh(t[o],this,n,i);return n.sort(yf),n}});var Wy=function(){function a(i,r,n){return i===void 0&&(i=1),r===void 0&&(r=0),n===void 0&&(n=0),this.radius=i,this.phi=r,this.theta=n,this}var t=a.prototype;return t.set=function(r,n,o){return this.radius=r,this.phi=n,this.theta=o,this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.radius=r.radius,this.phi=r.phi,this.theta=r.theta,this},t.makeSafe=function(){var r=1e-6;return this.phi=Math.max(r,Math.min(Math.PI-r,this.phi)),this},t.setFromVector3=function(r){return this.setFromCartesianCoords(r.x,r.y,r.z)},t.setFromCartesianCoords=function(r,n,o){return this.radius=Math.sqrt(r*r+n*n+o*o),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(r,o),this.phi=Math.acos(gr.clamp(n/this.radius,-1,1))),this},a}(),jy=function(){function a(i,r,n){return this.radius=i!==void 0?i:1,this.theta=r!==void 0?r:0,this.y=n!==void 0?n:0,this}var t=a.prototype;return t.set=function(r,n,o){return this.radius=r,this.theta=n,this.y=o,this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.radius=r.radius,this.theta=r.theta,this.y=r.y,this},t.setFromVector3=function(r){return this.setFromCartesianCoords(r.x,r.y,r.z)},t.setFromCartesianCoords=function(r,n,o){return this.radius=Math.sqrt(r*r+o*o),this.theta=Math.atan2(r,o),this.y=n,this},a}(),Af=new bt,bf=function(){function a(i,r){Object.defineProperty(this,"isBox2",{value:!0}),this.min=i!==void 0?i:new bt(1/0,1/0),this.max=r!==void 0?r:new bt(-1/0,-1/0)}var t=a.prototype;return t.set=function(r,n){return this.min.copy(r),this.max.copy(n),this},t.setFromPoints=function(r){this.makeEmpty();for(var n=0,o=r.length;n<o;n++)this.expandByPoint(r[n]);return this},t.setFromCenterAndSize=function(r,n){var o=Af.copy(n).multiplyScalar(.5);return this.min.copy(r).sub(o),this.max.copy(r).add(o),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.min.copy(r.min),this.max.copy(r.max),this},t.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},t.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},t.getCenter=function(r){return r===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),r=new bt),this.isEmpty()?r.set(0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)},t.getSize=function(r){return r===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),r=new bt),this.isEmpty()?r.set(0,0):r.subVectors(this.max,this.min)},t.expandByPoint=function(r){return this.min.min(r),this.max.max(r),this},t.expandByVector=function(r){return this.min.sub(r),this.max.add(r),this},t.expandByScalar=function(r){return this.min.addScalar(-r),this.max.addScalar(r),this},t.containsPoint=function(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y)},t.containsBox=function(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y},t.getParameter=function(r,n){return n===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),n=new bt),n.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y))},t.intersectsBox=function(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y)},t.clampPoint=function(r,n){return n===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),n=new bt),n.copy(r).clamp(this.min,this.max)},t.distanceToPoint=function(r){var n=Af.copy(r).clamp(this.min,this.max);return n.sub(r).length()},t.intersect=function(r){return this.min.max(r.min),this.max.min(r.max),this},t.union=function(r){return this.min.min(r.min),this.max.max(r.max),this},t.translate=function(r){return this.min.add(r),this.max.add(r),this},t.equals=function(r){return r.min.equals(this.min)&&r.max.equals(this.max)},a}(),Ef=new fe,jc=new fe,wf=function(){function a(i,r){this.start=i!==void 0?i:new fe,this.end=r!==void 0?r:new fe}var t=a.prototype;return t.set=function(r,n){return this.start.copy(r),this.end.copy(n),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.start.copy(r.start),this.end.copy(r.end),this},t.getCenter=function(r){return r===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),r=new fe),r.addVectors(this.start,this.end).multiplyScalar(.5)},t.delta=function(r){return r===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),r=new fe),r.subVectors(this.end,this.start)},t.distanceSq=function(){return this.start.distanceToSquared(this.end)},t.distance=function(){return this.start.distanceTo(this.end)},t.at=function(r,n){return n===void 0&&(console.warn("THREE.Line3: .at() target is now required"),n=new fe),this.delta(n).multiplyScalar(r).add(this.start)},t.closestPointToPointParameter=function(r,n){Ef.subVectors(r,this.start),jc.subVectors(this.end,this.start);var o=jc.dot(jc),s=jc.dot(Ef),c=s/o;return n&&(c=gr.clamp(c,0,1)),c},t.closestPointToPoint=function(r,n,o){var s=this.closestPointToPointParameter(r,n);return o===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),o=new fe),this.delta(o).multiplyScalar(s).add(this.start)},t.applyMatrix4=function(r){return this.start.applyMatrix4(r),this.end.applyMatrix4(r),this},t.equals=function(r){return r.start.equals(this.start)&&r.end.equals(this.end)},a}();function Ml(a){Qt.call(this),this.material=a,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Ml.prototype=Object.create(Qt.prototype),Ml.prototype.constructor=Ml,Ml.prototype.isImmediateRenderObject=!0;var xf=new fe,Xy=function(a){Or(t,a);function t(r,n){var o;o=a.call(this)||this,o.light=r,o.light.updateMatrixWorld(),o.matrix=r.matrixWorld,o.matrixAutoUpdate=!1,o.color=n;for(var s=new tr,c=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],h=0,p=1,C=32;h<C;h++,p++){var _=h/C*Math.PI*2,S=p/C*Math.PI*2;c.push(Math.cos(_),Math.sin(_),1,Math.cos(S),Math.sin(S),1)}s.setAttribute("position",new Nt(c,3));var D=new Rn({fog:!1,toneMapped:!1});return o.cone=new bi(s,D),o.add(o.cone),o.update(),o}var i=t.prototype;return i.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},i.update=function(){this.light.updateMatrixWorld();var n=this.light.distance?this.light.distance:1e3,o=n*Math.tan(this.light.angle);this.cone.scale.set(o,o,n),xf.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(xf),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},t}(Qt),mo=new fe,Xc=new kr,Ah=new kr,Mf=function(a){Or(t,a);function t(r){for(var n,o=Tf(r),s=new tr,c=[],h=[],p=new It(0,0,1),C=new It(0,1,0),_=0;_<o.length;_++){var S=o[_];S.parent&&S.parent.isBone&&(c.push(0,0,0),c.push(0,0,0),h.push(p.r,p.g,p.b),h.push(C.r,C.g,C.b))}s.setAttribute("position",new Nt(c,3)),s.setAttribute("color",new Nt(h,3));var D=new Rn({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return n=a.call(this,s,D)||this,n.type="SkeletonHelper",n.isSkeletonHelper=!0,n.root=r,n.bones=o,n.matrix=r.matrixWorld,n.matrixAutoUpdate=!1,n}var i=t.prototype;return i.updateMatrixWorld=function(n){var o=this.bones,s=this.geometry,c=s.getAttribute("position");Ah.copy(this.root.matrixWorld).invert();for(var h=0,p=0;h<o.length;h++){var C=o[h];C.parent&&C.parent.isBone&&(Xc.multiplyMatrices(Ah,C.matrixWorld),mo.setFromMatrixPosition(Xc),c.setXYZ(p,mo.x,mo.y,mo.z),Xc.multiplyMatrices(Ah,C.parent.matrixWorld),mo.setFromMatrixPosition(Xc),c.setXYZ(p+1,mo.x,mo.y,mo.z),p+=2)}s.getAttribute("position").needsUpdate=!0,a.prototype.updateMatrixWorld.call(this,n)},t}(bi);function Tf(a){var t=[];a&&a.isBone&&t.push(a);for(var i=0;i<a.children.length;i++)t.push.apply(t,Tf(a.children[i]));return t}var Yy=function(a){Or(t,a);function t(r,n,o){var s,c=new yl(n,4,2),h=new Li({wireframe:!0,fog:!1,toneMapped:!1});return s=a.call(this,c,h)||this,s.light=r,s.light.updateMatrixWorld(),s.color=o,s.type="PointLightHelper",s.matrix=s.light.matrixWorld,s.matrixAutoUpdate=!1,s.update(),s}var i=t.prototype;return i.dispose=function(){this.geometry.dispose(),this.material.dispose()},i.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)},t}(xn),Qy=new fe,Sf=new It,_f=new It,qy=function(a){Or(t,a);function t(r,n,o){var s;s=a.call(this)||this,s.light=r,s.light.updateMatrixWorld(),s.matrix=r.matrixWorld,s.matrixAutoUpdate=!1,s.color=o;var c=new ml(n);c.rotateY(Math.PI*.5),s.material=new Li({wireframe:!0,fog:!1,toneMapped:!1}),s.color===void 0&&(s.material.vertexColors=!0);var h=c.getAttribute("position"),p=new Float32Array(h.count*3);return c.setAttribute("color",new dr(p,3)),s.add(new xn(c,s.material)),s.update(),s}var i=t.prototype;return i.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},i.update=function(){var n=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var o=n.geometry.getAttribute("color");Sf.copy(this.light.color),_f.copy(this.light.groundColor);for(var s=0,c=o.count;s<c;s++){var h=s<c/2?Sf:_f;o.setXYZ(s,h.r,h.g,h.b)}o.needsUpdate=!0}n.lookAt(Qy.setFromMatrixPosition(this.light.matrixWorld).negate())},t}(Qt),Cf=function(a){Or(t,a);function t(i,r,n,o){var s;i===void 0&&(i=10),r===void 0&&(r=10),n===void 0&&(n=4473924),o===void 0&&(o=8947848),n=new It(n),o=new It(o);for(var c=r/2,h=i/r,p=i/2,C=[],_=[],S=0,D=0,P=-p;S<=r;S++,P+=h){C.push(-p,0,P,p,0,P),C.push(P,0,-p,P,0,p);var H=S===c?n:o;H.toArray(_,D),D+=3,H.toArray(_,D),D+=3,H.toArray(_,D),D+=3,H.toArray(_,D),D+=3}var W=new tr;W.setAttribute("position",new Nt(C,3)),W.setAttribute("color",new Nt(_,3));var G=new Rn({vertexColors:!0,toneMapped:!1});return s=a.call(this,W,G)||this,s.type="GridHelper",s}return t}(bi),Jy=function(a){Or(t,a);function t(i,r,n,o,s,c){var h;i===void 0&&(i=10),r===void 0&&(r=16),n===void 0&&(n=8),o===void 0&&(o=64),s===void 0&&(s=4473924),c===void 0&&(c=8947848),s=new It(s),c=new It(c);for(var p=[],C=[],_=0;_<=r;_++){var S=_/r*(Math.PI*2),D=Math.sin(S)*i,P=Math.cos(S)*i;p.push(0,0,0),p.push(D,0,P);var H=_&1?s:c;C.push(H.r,H.g,H.b),C.push(H.r,H.g,H.b)}for(var W=0;W<=n;W++)for(var G=W&1?s:c,B=i-i/n*W,te=0;te<o;te++){var he=te/o*(Math.PI*2),K=Math.sin(he)*B,Q=Math.cos(he)*B;p.push(K,0,Q),C.push(G.r,G.g,G.b),he=(te+1)/o*(Math.PI*2),K=Math.sin(he)*B,Q=Math.cos(he)*B,p.push(K,0,Q),C.push(G.r,G.g,G.b)}var le=new tr;le.setAttribute("position",new Nt(p,3)),le.setAttribute("color",new Nt(C,3));var Me=new Rn({vertexColors:!0,toneMapped:!1});return h=a.call(this,le,Me)||this,h.type="PolarGridHelper",h}return t}(bi),Lf=new fe,Yc=new fe,Rf=new fe,Zy=function(a){Or(t,a);function t(r,n,o){var s;s=a.call(this)||this,s.light=r,s.light.updateMatrixWorld(),s.matrix=r.matrixWorld,s.matrixAutoUpdate=!1,s.color=o,n===void 0&&(n=1);var c=new tr;c.setAttribute("position",new Nt([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));var h=new Rn({fog:!1,toneMapped:!1});return s.lightPlane=new Vi(c,h),s.add(s.lightPlane),c=new tr,c.setAttribute("position",new Nt([0,0,0,0,0,1],3)),s.targetLine=new Vi(c,h),s.add(s.targetLine),s.update(),s}var i=t.prototype;return i.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},i.update=function(){Lf.setFromMatrixPosition(this.light.matrixWorld),Yc.setFromMatrixPosition(this.light.target.matrixWorld),Rf.subVectors(Yc,Lf),this.lightPlane.lookAt(Yc),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Yc),this.targetLine.scale.z=Rf.length()},t}(Qt),Qc=new fe,kn=new ya,Ky=function(a){Or(t,a);function t(r){var n,o=new tr,s=new Rn({color:16777215,vertexColors:!0,toneMapped:!1}),c=[],h=[],p={},C=new It(16755200),_=new It(16711680),S=new It(43775),D=new It(16777215),P=new It(3355443);H("n1","n2",C),H("n2","n4",C),H("n4","n3",C),H("n3","n1",C),H("f1","f2",C),H("f2","f4",C),H("f4","f3",C),H("f3","f1",C),H("n1","f1",C),H("n2","f2",C),H("n3","f3",C),H("n4","f4",C),H("p","n1",_),H("p","n2",_),H("p","n3",_),H("p","n4",_),H("u1","u2",S),H("u2","u3",S),H("u3","u1",S),H("c","t",D),H("p","c",P),H("cn1","cn2",P),H("cn3","cn4",P),H("cf1","cf2",P),H("cf3","cf4",P);function H(G,B,te){W(G,te),W(B,te)}function W(G,B){c.push(0,0,0),h.push(B.r,B.g,B.b),p[G]===void 0&&(p[G]=[]),p[G].push(c.length/3-1)}return o.setAttribute("position",new Nt(c,3)),o.setAttribute("color",new Nt(h,3)),n=a.call(this,o,s)||this,n.type="CameraHelper",n.camera=r,n.camera.updateProjectionMatrix&&n.camera.updateProjectionMatrix(),n.matrix=r.matrixWorld,n.matrixAutoUpdate=!1,n.pointMap=p,n.update(),n}var i=t.prototype;return i.update=function(){var n=this.geometry,o=this.pointMap,s=1,c=1;kn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Vn("c",o,n,kn,0,0,-1),Vn("t",o,n,kn,0,0,1),Vn("n1",o,n,kn,-s,-c,-1),Vn("n2",o,n,kn,s,-c,-1),Vn("n3",o,n,kn,-s,c,-1),Vn("n4",o,n,kn,s,c,-1),Vn("f1",o,n,kn,-s,-c,1),Vn("f2",o,n,kn,s,-c,1),Vn("f3",o,n,kn,-s,c,1),Vn("f4",o,n,kn,s,c,1),Vn("u1",o,n,kn,s*.7,c*1.1,-1),Vn("u2",o,n,kn,-s*.7,c*1.1,-1),Vn("u3",o,n,kn,0,c*2,-1),Vn("cf1",o,n,kn,-s,0,1),Vn("cf2",o,n,kn,s,0,1),Vn("cf3",o,n,kn,0,-c,1),Vn("cf4",o,n,kn,0,c,1),Vn("cn1",o,n,kn,-s,0,-1),Vn("cn2",o,n,kn,s,0,-1),Vn("cn3",o,n,kn,0,-c,-1),Vn("cn4",o,n,kn,0,c,-1),n.getAttribute("position").needsUpdate=!0},t}(bi);function Vn(a,t,i,r,n,o,s){Qc.set(n,o,s).unproject(r);var c=t[a];if(c!==void 0)for(var h=i.getAttribute("position"),p=0,C=c.length;p<C;p++)h.setXYZ(c[p],Qc.x,Qc.y,Qc.z)}var qc=new La,Pf=function(a){Or(t,a);function t(r,n){var o;n===void 0&&(n=16776960);var s=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),c=new Float32Array(8*3),h=new tr;return h.setIndex(new dr(s,1)),h.setAttribute("position",new dr(c,3)),o=a.call(this,h,new Rn({color:n,toneMapped:!1}))||this,o.object=r,o.type="BoxHelper",o.matrixAutoUpdate=!1,o.update(),o}var i=t.prototype;return i.update=function(n){if(n!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&qc.setFromObject(this.object),!qc.isEmpty()){var o=qc.min,s=qc.max,c=this.geometry.attributes.position,h=c.array;h[0]=s.x,h[1]=s.y,h[2]=s.z,h[3]=o.x,h[4]=s.y,h[5]=s.z,h[6]=o.x,h[7]=o.y,h[8]=s.z,h[9]=s.x,h[10]=o.y,h[11]=s.z,h[12]=s.x,h[13]=s.y,h[14]=o.z,h[15]=o.x,h[16]=s.y,h[17]=o.z,h[18]=o.x,h[19]=o.y,h[20]=o.z,h[21]=s.x,h[22]=o.y,h[23]=o.z,c.needsUpdate=!0,this.geometry.computeBoundingSphere()}},i.setFromObject=function(n){return this.object=n,this.update(),this},i.copy=function(n){return bi.prototype.copy.call(this,n),this.object=n.object,this},t}(bi),$y=function(a){Or(t,a);function t(r,n){var o;n===void 0&&(n=16776960);var s=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),c=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],h=new tr;return h.setIndex(new dr(s,1)),h.setAttribute("position",new Nt(c,3)),o=a.call(this,h,new Rn({color:n,toneMapped:!1}))||this,o.box=r,o.type="Box3Helper",o.geometry.computeBoundingSphere(),o}var i=t.prototype;return i.updateMatrixWorld=function(n){var o=this.box;o.isEmpty()||(o.getCenter(this.position),o.getSize(this.scale),this.scale.multiplyScalar(.5),a.prototype.updateMatrixWorld.call(this,n))},t}(bi),e1=function(a){Or(t,a);function t(r,n,o){var s;n===void 0&&(n=1),o===void 0&&(o=16776960);var c=o,h=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],p=new tr;p.setAttribute("position",new Nt(h,3)),p.computeBoundingSphere(),s=a.call(this,p,new Rn({color:c,toneMapped:!1}))||this,s.type="PlaneHelper",s.plane=r,s.size=n;var C=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],_=new tr;return _.setAttribute("position",new Nt(C,3)),_.computeBoundingSphere(),s.add(new xn(_,new Li({color:c,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),s}var i=t.prototype;return i.updateMatrixWorld=function(n){var o=-this.plane.constant;Math.abs(o)<1e-8&&(o=1e-8),this.scale.set(.5*this.size,.5*this.size,o),this.children[0].material.side=o<0?T:L,this.lookAt(this.plane.normal),a.prototype.updateMatrixWorld.call(this,n)},t}(Vi),Df=new fe,Jc,bh,t1=function(a){Or(t,a);function t(r,n,o,s,c,h){var p;return p=a.call(this)||this,p.type="ArrowHelper",r===void 0&&(r=new fe(0,0,1)),n===void 0&&(n=new fe(0,0,0)),o===void 0&&(o=1),s===void 0&&(s=16776960),c===void 0&&(c=.2*o),h===void 0&&(h=.2*c),Jc===void 0&&(Jc=new tr,Jc.setAttribute("position",new Nt([0,0,0,0,1,0],3)),bh=new bs(0,.5,1,5,1),bh.translate(0,-.5,0)),p.position.copy(n),p.line=new Vi(Jc,new Rn({color:s,toneMapped:!1})),p.line.matrixAutoUpdate=!1,p.add(p.line),p.cone=new xn(bh,new Li({color:s,toneMapped:!1})),p.cone.matrixAutoUpdate=!1,p.add(p.cone),p.setDirection(r),p.setLength(o,c,h),p}var i=t.prototype;return i.setDirection=function(n){if(n.y>.99999)this.quaternion.set(0,0,0,1);else if(n.y<-.99999)this.quaternion.set(1,0,0,0);else{Df.set(n.z,0,-n.x).normalize();var o=Math.acos(n.y);this.quaternion.setFromAxisAngle(Df,o)}},i.setLength=function(n,o,s){o===void 0&&(o=.2*n),s===void 0&&(s=.2*o),this.line.scale.set(1,Math.max(1e-4,n-o),1),this.line.updateMatrix(),this.cone.scale.set(s,o,s),this.cone.position.y=n,this.cone.updateMatrix()},i.setColor=function(n){this.line.material.color.set(n),this.cone.material.color.set(n)},i.copy=function(n){return a.prototype.copy.call(this,n,!1),this.line.copy(n.line),this.cone.copy(n.cone),this},t}(Qt),Of=function(a){Or(t,a);function t(i){var r;i===void 0&&(i=1);var n=[0,0,0,i,0,0,0,0,0,0,i,0,0,0,0,0,0,i],o=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new tr;s.setAttribute("position",new Nt(n,3)),s.setAttribute("color",new Nt(o,3));var c=new Rn({vertexColors:!0,toneMapped:!1});return r=a.call(this,s,c)||this,r.type="AxesHelper",r}return t}(bi),If=new Float32Array(1),r1=new Int32Array(If.buffer),n1={toHalfFloat:function(t){If[0]=t;var i=r1[0],r=i>>16&32768,n=i>>12&2047,o=i>>23&255;return o<103?r:o>142?(r|=31744,r|=(o==255?0:1)&&i&8388607,r):o<113?(n|=2048,r|=(n>>114-o)+(n>>113-o&1),r):(r|=o-112<<10|n>>1,r+=n&1,r)}},Ha,Cs=4,go=8,xa=Math.pow(2,go),Bf=[.125,.215,.35,.446,.526,.582],Ff=go-Cs+1+Bf.length,Ls=20,Ma=(Ha={},Ha[yi]=0,Ha[Is]=1,Ha[Rl]=2,Ha[iu]=3,Ha[au]=4,Ha[ou]=5,Ha[Ll]=6,Ha),Xo=new Li({side:T,depthWrite:!1,depthTest:!1}),i1=new xn(new Ro,Xo),Eh=new _s,wh=s1(),Tl=wh._lodPlanes,Nf=wh._sizeLods,Zc=wh._sigmas,kf=new It,xh=null,Yo=(1+Math.sqrt(5))/2,Rs=1/Yo,Uf=[new fe(1,1,1),new fe(-1,1,1),new fe(1,1,-1),new fe(-1,1,-1),new fe(0,Yo,Rs),new fe(0,Yo,-Rs),new fe(Rs,0,Yo),new fe(-Rs,0,Yo),new fe(Yo,Rs,0),new fe(-Yo,Rs,0)];function Hf(a){var t=Math.max(a.r,a.g,a.b),i=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);a.multiplyScalar(Math.pow(2,-i));var r=(i+128)/255;return r}var a1=function(){function a(i){this._renderer=i,this._pingPongRenderTarget=null,this._blurMaterial=l1(Ls),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}var t=a.prototype;return t.fromScene=function(r,n,o,s){n===void 0&&(n=0),o===void 0&&(o=.1),s===void 0&&(s=100),xh=this._renderer.getRenderTarget();var c=this._allocateTargets();return this._sceneToCubeUV(r,o,s,c),n>0&&this._blur(c,0,0,n),this._applyPMREM(c),this._cleanup(c),c},t.fromEquirectangular=function(r){return this._fromTexture(r)},t.fromCubemap=function(r){return this._fromTexture(r)},t.compileCubemapShader=function(){this._cubemapShader===null&&(this._cubemapShader=zf(),this._compileMaterial(this._cubemapShader))},t.compileEquirectangularShader=function(){this._equirectShader===null&&(this._equirectShader=Vf(),this._compileMaterial(this._equirectShader))},t.dispose=function(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(var r=0;r<Tl.length;r++)Tl[r].dispose()},t._cleanup=function(r){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(xh),r.scissorTest=!1,Kc(r,0,0,r.width,r.height)},t._fromTexture=function(r){xh=this._renderer.getRenderTarget();var n=this._allocateTargets(r);return this._textureToCubeUV(r,n),this._applyPMREM(n),this._cleanup(n),n},t._allocateTargets=function(r){var n={magFilter:ar,minFilter:ar,generateMipmaps:!1,type:cr,format:Ve,encoding:o1(r)?r.encoding:Rl,depthBuffer:!1},o=Gf(n);return o.depthBuffer=!r,this._pingPongRenderTarget=Gf(n),o},t._compileMaterial=function(r){var n=new xn(Tl[0],r);this._renderer.compile(n,Eh)},t._sceneToCubeUV=function(r,n,o,s){var c=90,h=1,p=new Nn(c,h,n,o),C=[1,-1,1,1,1,1],_=[1,1,1,-1,-1,-1],S=this._renderer,D=S.autoClear,P=S.outputEncoding,H=S.toneMapping;S.getClearColor(kf),S.toneMapping=ot,S.outputEncoding=yi,S.autoClear=!1;var W=!1,G=r.background;if(G){if(G.isColor){Xo.color.copy(G).convertSRGBToLinear(),r.background=null;var B=Hf(Xo.color);Xo.opacity=B,W=!0}}else{Xo.color.copy(kf).convertSRGBToLinear();var te=Hf(Xo.color);Xo.opacity=te,W=!0}for(var he=0;he<6;he++){var K=he%3;K==0?(p.up.set(0,C[he],0),p.lookAt(_[he],0,0)):K==1?(p.up.set(0,0,C[he]),p.lookAt(0,_[he],0)):(p.up.set(0,C[he],0),p.lookAt(0,0,_[he])),Kc(s,K*xa,he>2?xa:0,xa,xa),S.setRenderTarget(s),W&&S.render(i1,p),S.render(r,p)}S.toneMapping=H,S.outputEncoding=P,S.autoClear=D},t._textureToCubeUV=function(r,n){var o=this._renderer;r.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=zf()):this._equirectShader==null&&(this._equirectShader=Vf());var s=r.isCubeTexture?this._cubemapShader:this._equirectShader,c=new xn(Tl[0],s),h=s.uniforms;h.envMap.value=r,r.isCubeTexture||h.texelSize.value.set(1/r.image.width,1/r.image.height),h.inputEncoding.value=Ma[r.encoding],h.outputEncoding.value=Ma[n.texture.encoding],Kc(n,0,0,3*xa,2*xa),o.setRenderTarget(n),o.render(c,Eh)},t._applyPMREM=function(r){var n=this._renderer,o=n.autoClear;n.autoClear=!1;for(var s=1;s<Ff;s++){var c=Math.sqrt(Zc[s]*Zc[s]-Zc[s-1]*Zc[s-1]),h=Uf[(s-1)%Uf.length];this._blur(r,s-1,s,c,h)}n.autoClear=o},t._blur=function(r,n,o,s,c){var h=this._pingPongRenderTarget;this._halfBlur(r,h,n,o,s,"latitudinal",c),this._halfBlur(h,r,o,o,s,"longitudinal",c)},t._halfBlur=function(r,n,o,s,c,h,p){var C=this._renderer,_=this._blurMaterial;h!=="latitudinal"&&h!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var S=3,D=new xn(Tl[s],_),P=_.uniforms,H=Nf[o]-1,W=isFinite(c)?Math.PI/(2*H):2*Math.PI/(2*Ls-1),G=c/W,B=isFinite(c)?1+Math.floor(S*G):Ls;B>Ls&&console.warn("sigmaRadians, "+c+", is too large and will clip, as it requested "+B+" samples when the maximum is set to "+Ls);for(var te=[],he=0,K=0;K<Ls;++K){var Q=K/G,le=Math.exp(-Q*Q/2);te.push(le),K==0?he+=le:K<B&&(he+=2*le)}for(var Me=0;Me<te.length;Me++)te[Me]=te[Me]/he;P.envMap.value=r.texture,P.samples.value=B,P.weights.value=te,P.latitudinal.value=h==="latitudinal",p&&(P.poleAxis.value=p),P.dTheta.value=W,P.mipInt.value=go-o,P.inputEncoding.value=Ma[r.texture.encoding],P.outputEncoding.value=Ma[r.texture.encoding];var xe=Nf[s],_e=3*Math.max(0,xa-2*xe),Pe=(s===0?0:2*xa)+2*xe*(s>go-Cs?s-go+Cs:0);Kc(n,_e,Pe,3*xe,2*xe),C.setRenderTarget(n),C.render(D,Eh)},a}();function o1(a){return a===void 0||a.type!==cr?!1:a.encoding===yi||a.encoding===Is||a.encoding===Ll}function s1(){for(var a=[],t=[],i=[],r=go,n=0;n<Ff;n++){var o=Math.pow(2,r);t.push(o);var s=1/o;n>go-Cs?s=Bf[n-go+Cs-1]:n==0&&(s=0),i.push(s);for(var c=1/(o-1),h=-c/2,p=1+c/2,C=[h,h,p,h,p,p,h,h,p,p,h,p],_=6,S=6,D=3,P=2,H=1,W=new Float32Array(D*S*_),G=new Float32Array(P*S*_),B=new Float32Array(H*S*_),te=0;te<_;te++){var he=te%3*2/3-1,K=te>2?0:-1,Q=[he,K,0,he+2/3,K,0,he+2/3,K+1,0,he,K,0,he+2/3,K+1,0,he,K+1,0];W.set(Q,D*S*te),G.set(C,P*S*te);var le=[te,te,te,te,te,te];B.set(le,H*S*te)}var Me=new tr;Me.setAttribute("position",new dr(W,D)),Me.setAttribute("uv",new dr(G,P)),Me.setAttribute("faceIndex",new dr(B,H)),a.push(Me),r>Cs&&r--}return{_lodPlanes:a,_sizeLods:t,_sigmas:i}}function Gf(a){var t=new qa(3*xa,3*xa,a);return t.texture.mapping=jt,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function Kc(a,t,i,r,n){a.viewport.set(t,i,r,n),a.scissor.set(t,i,r,n)}function l1(a){var t=new Float32Array(a),i=new fe(0,1,0),r=new ka({name:"SphericalGaussianBlur",defines:{n:a},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i},inputEncoding:{value:Ma[yi]},outputEncoding:{value:Ma[yi]}},vertexShader:Mh(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			`+Th()+`

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:z,depthTest:!1,depthWrite:!1});return r}function Vf(){var a=new bt(1,1),t=new ka({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:a},inputEncoding:{value:Ma[yi]},outputEncoding:{value:Ma[yi]}},vertexShader:Mh(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			`+Th()+`

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:z,depthTest:!1,depthWrite:!1});return t}function zf(){var a=new ka({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Ma[yi]},outputEncoding:{value:Ma[yi]}},vertexShader:Mh(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			`+Th()+`

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:z,depthTest:!1,depthWrite:!1});return a}function Mh(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Th(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}function c1(a,t,i,r,n,o,s){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Mu(a,t,i,n,o,s)}var u1=0,h1=1,d1=0,f1=1,p1=2;function v1(a){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),a}function m1(a){return a===void 0&&(a=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),a.isMultiMaterial=!0,a.materials=a,a.clone=function(){return a.slice()},a}function g1(a,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new ys(a,t)}function y1(a){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new al(a)}function A1(a,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new ys(a,t)}function b1(a){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new ta(a)}function E1(a){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new ta(a)}function w1(a){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new ta(a)}function x1(a,t,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new fe(a,t,i)}function M1(a,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new dr(a,t).setUsage(Mo)}function T1(a,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Hs(a,t)}function S1(a,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Gs(a,t)}function _1(a,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Vs(a,t)}function C1(a,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new zs(a,t)}function L1(a,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Co(a,t)}function R1(a,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Ws(a,t)}function P1(a,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Lo(a,t)}function D1(a,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Nt(a,t)}function O1(a,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Xs(a,t)}Zt.create=function(a,t){return console.log("THREE.Curve.create() has been deprecated"),a.prototype=Object.create(Zt.prototype),a.prototype.constructor=a,a.prototype.getPoint=t,a},Object.assign(sa.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}});function Wf(a){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),hi.call(this,a),this.type="catmullrom",this.closed=!0}Wf.prototype=Object.create(hi.prototype);function jf(a){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),hi.call(this,a),this.type="catmullrom"}jf.prototype=Object.create(hi.prototype);function Sh(a){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),hi.call(this,a),this.type="catmullrom"}Sh.prototype=Object.create(hi.prototype),Object.assign(Sh.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});function I1(a){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Of(a)}function B1(a,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Pf(a,t)}function F1(a,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new bi(new Vu(a.geometry),new Rn({color:t!==void 0?t:16777215}))}Cf.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Mf.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};function N1(a,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new bi(new ju(a.geometry),new Rn({color:t!==void 0?t:16777215}))}Object.assign(dn.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),nh.extractUrlBase(t)}}),dn.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};function k1(a){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new zi(a)}function U1(a){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Pc(a)}Object.assign(bf.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(La.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Ka.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),qs.prototype.setFromMatrix=function(a){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(a)},wf.prototype.center=function(a){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(a)},Object.assign(gr,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),gr.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),gr.ceilPowerOfTwo(t)}}),Object.assign(_i.prototype,{flattenToArrayOffset:function(t,i){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,i)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},getInverse:function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()}}),Object.assign(kr.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,i){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,i)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new fe().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,i,r,n,o,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,i,n,r,o,s)},getInverse:function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()}}),va.prototype.isIntersectionLine=function(a){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(a)},Object.assign(ni.prototype,{multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},inverse:function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()}}),Object.assign(es.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(ma.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,i)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(ma,{barycoordFromPoint:function(t,i,r,n,o){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ma.getBarycoord(t,i,r,n,o)},normal:function(t,i,r,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ma.getNormal(t,i,r,n)}}),Object.assign(vo.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Oo(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new gl(this,t)}}),Object.assign(bt.prototype,{fromAttribute:function(t,i,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,i,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(fe.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,i){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(i,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,i,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,i,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(un.prototype,{fromAttribute:function(t,i,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,i,r)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Qt.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,i){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(i,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Qt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(xn.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(xn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Qa},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(ol.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(cl.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),sl.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Zt.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Nn.prototype.setLens=function(a,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(a)},Object.defineProperties(Mn.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(dr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Mo},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Mo)}}}),Object.assign(dr.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?Mo:Bs),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(tr.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,i){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(i&&i.isBufferAttribute)&&!(i&&i.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new dr(arguments[1],arguments[2]))):t==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(i),this):this.setAttribute(t,i)},addDrawCall:function(t,i,r){r!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,i)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(tr.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(xl.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Object.defineProperties(gh.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(Di.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Mo},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(Di.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?Mo:Bs),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Oo.prototype,{getArrays:function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")}}),Object.assign(Fu.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(gf.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(hr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new It}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===O}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(fo.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(ho.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(t){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=t}}}),Object.defineProperties(Ai.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(tl.prototype,{clearTarget:function(t,i,r,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(i,r,n)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(tl.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=t===!0?Is:yi}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(wd.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});function H1(a,t,i){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Pu(a,i)}Object.defineProperties(qa.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(uh.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var i=this,r=new Wc;return r.load(t,function(n){i.setBuffer(n)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),pf.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Po.prototype.updateCubeMap=function(a,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(a,t)},Po.prototype.clear=function(a,t,i,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(a,t,i,r)};var G1={merge:function(t,i,r){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var n;i.isMesh&&(i.matrixAutoUpdate&&i.updateMatrix(),n=i.matrix,i=i.geometry),t.merge(i,n,r)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}};To.crossOrigin=void 0,To.loadTexture=function(a,t,i,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var n=new Dc;n.setCrossOrigin(this.crossOrigin);var o=n.load(a,i,void 0,r);return t&&(o.mapping=t),o},To.loadTextureCube=function(a,t,i,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var n=new Rc;n.setCrossOrigin(this.crossOrigin);var o=n.load(a,i,void 0,r);return t&&(o.mapping=t),o},To.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},To.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};function V1(){console.error("THREE.CanvasRenderer has been removed")}function z1(){console.error("THREE.JSONLoader has been removed.")}var W1={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function j1(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:A}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=A),l.ACESFilmicToneMapping=ne,l.AddEquation=j,l.AddOperation=Ye,l.AdditiveAnimationBlendMode=Ca,l.AdditiveBlending=Y,l.AlphaFormat=ei,l.AlwaysDepth=kt,l.AlwaysStencilFunc=Uh,l.AmbientLight=kc,l.AmbientLightProbe=ch,l.AnimationClip=Ii,l.AnimationLoader=Yu,l.AnimationMixer=ph,l.AnimationObjectGroup=mf,l.AnimationUtils=_n,l.ArcCurve=Ss,l.ArrayCamera=$s,l.ArrowHelper=t1,l.Audio=uh,l.AudioAnalyser=pf,l.AudioContext=sh,l.AudioListener=Dy,l.AudioLoader=Wc,l.AxesHelper=Of,l.AxisHelper=I1,l.BackSide=T,l.BasicDepthPacking=Fh,l.BasicShadowMap=b,l.BinaryTextureLoader=U1,l.Bone=ll,l.BooleanKeyframeTrack=Sc,l.BoundingBoxHelper=B1,l.Box2=bf,l.Box3=La,l.Box3Helper=$y,l.BoxBufferGeometry=Ro,l.BoxGeometry=Ro,l.BoxHelper=Pf,l.BufferAttribute=dr,l.BufferGeometry=tr,l.BufferGeometryLoader=Vc,l.ByteType=Pr,l.Cache=Go,l.Camera=ya,l.CameraHelper=Ky,l.CanvasRenderer=V1,l.CanvasTexture=hl,l.CatmullRomCurve3=hi,l.CineonToneMapping=xt,l.CircleBufferGeometry=lc,l.CircleGeometry=lc,l.ClampToEdgeWrapping=Jt,l.Clock=uf,l.ClosedSplineCurve3=Wf,l.Color=It,l.ColorKeyframeTrack=_c,l.CompressedTexture=As,l.CompressedTextureLoader=Qu,l.ConeBufferGeometry=cc,l.ConeGeometry=cc,l.CubeCamera=Po,l.CubeReflectionMapping=ue,l.CubeRefractionMapping=De,l.CubeTexture=Aa,l.CubeTextureLoader=Rc,l.CubeUVReflectionMapping=jt,l.CubeUVRefractionMapping=wr,l.CubicBezierCurve=na,l.CubicBezierCurve3=Ea,l.CubicInterpolant=Mc,l.CullFaceBack=f,l.CullFaceFront=m,l.CullFaceFrontBack=u,l.CullFaceNone=v,l.Curve=Zt,l.CurvePath=po,l.CustomBlending=ce,l.CustomToneMapping=U,l.CylinderBufferGeometry=bs,l.CylinderGeometry=bs,l.Cylindrical=jy,l.DataTexture=Ba,l.DataTexture2DArray=hs,l.DataTexture3D=ds,l.DataTextureLoader=Pc,l.DataUtils=n1,l.DecrementStencilOp=hp,l.DecrementWrapStencilOp=fp,l.DefaultLoadingManager=ef,l.DepthFormat=$e,l.DepthStencilFormat=Xe,l.DepthTexture=dl,l.DirectionalLight=Nc,l.DirectionalLightHelper=Zy,l.DiscreteInterpolant=Tc,l.DodecahedronBufferGeometry=uc,l.DodecahedronGeometry=uc,l.DoubleSide=R,l.DstAlphaFactor=Wt,l.DstColorFactor=Dr,l.DynamicBufferAttribute=M1,l.DynamicCopyUsage=_p,l.DynamicDrawUsage=Mo,l.DynamicReadUsage=Mp,l.EdgesGeometry=Vu,l.EdgesHelper=F1,l.EllipseCurve=Bi,l.EqualDepth=ge,l.EqualStencilFunc=gp,l.EquirectangularReflectionMapping=Je,l.EquirectangularRefractionMapping=tt,l.Euler=Ul,l.EventDispatcher=pa,l.ExtrudeBufferGeometry=Oo,l.ExtrudeGeometry=Oo,l.Face3=Mu,l.Face4=c1,l.FaceColors=f1,l.FileLoader=zi,l.FlatShading=O,l.Float16BufferAttribute=js,l.Float32Attribute=D1,l.Float32BufferAttribute=Nt,l.Float64Attribute=O1,l.Float64BufferAttribute=Xs,l.FloatType=Xr,l.Fog=Ld,l.FogExp2=Cd,l.Font=of,l.FontLoader=oh,l.FrontSide=L,l.Frustum=qs,l.GLBufferAttribute=mh,l.GLSL1=Lp,l.GLSL3=su,l.GammaEncoding=Ll,l.GeometryUtils=G1,l.GreaterDepth=we,l.GreaterEqualDepth=ve,l.GreaterEqualStencilFunc=Ep,l.GreaterStencilFunc=Ap,l.GridHelper=Cf,l.Group=Fa,l.HalfFloatType=fn,l.HemisphereLight=Ic,l.HemisphereLightHelper=qy,l.HemisphereLightProbe=lh,l.IcosahedronBufferGeometry=mc,l.IcosahedronGeometry=mc,l.ImageBitmapLoader=ih,l.ImageLoader=Ts,l.ImageUtils=To,l.ImmediateRenderObject=Ml,l.IncrementStencilOp=up,l.IncrementWrapStencilOp=dp,l.InstancedBufferAttribute=Gc,l.InstancedBufferGeometry=xl,l.InstancedInterleavedBuffer=vh,l.InstancedMesh=nc,l.Int16Attribute=C1,l.Int16BufferAttribute=zs,l.Int32Attribute=R1,l.Int32BufferAttribute=Ws,l.Int8Attribute=T1,l.Int8BufferAttribute=Hs,l.IntType=Xn,l.InterleavedBuffer=Di,l.InterleavedBufferAttribute=so,l.Interpolant=Oi,l.InterpolateDiscrete=Yi,l.InterpolateLinear=Qi,l.InterpolateSmooth=da,l.InvertStencilOp=pp,l.JSONLoader=z1,l.KeepStencilOp=Pl,l.KeyframeTrack=ii,l.LOD=ol,l.LatheBufferGeometry=gc,l.LatheGeometry=gc,l.Layers=vu,l.LensFlare=j1,l.LessDepth=ie,l.LessEqualDepth=ae,l.LessEqualStencilFunc=yp,l.LessStencilFunc=mp,l.Light=Mn,l.LightProbe=Wi,l.Line=Vi,l.Line3=wf,l.LineBasicMaterial=Rn,l.LineCurve=xi,l.LineCurve3=ia,l.LineDashedMaterial=Ho,l.LineLoop=ac,l.LinePieces=h1,l.LineSegments=bi,l.LineStrip=u1,l.LinearEncoding=yi,l.LinearFilter=nt,l.LinearInterpolant=Al,l.LinearMipMapLinearFilter=pr,l.LinearMipMapNearestFilter=$t,l.LinearMipmapLinearFilter=or,l.LinearMipmapNearestFilter=Et,l.LinearToneMapping=ct,l.Loader=dn,l.LoaderUtils=nh,l.LoadingManager=Xu,l.LogLuvEncoding=Bh,l.LoopOnce=ci,l.LoopPingPong=Ya,l.LoopRepeat=Xi,l.LuminanceAlphaFormat=be,l.LuminanceFormat=se,l.MOUSE=E,l.Material=hr,l.MaterialLoader=Hc,l.Math=gr,l.MathUtils=gr,l.Matrix3=_i,l.Matrix4=kr,l.MaxEquation=Ne,l.Mesh=xn,l.MeshBasicMaterial=Li,l.MeshDepthMaterial=ao,l.MeshDistanceMaterial=oo,l.MeshFaceMaterial=v1,l.MeshLambertMaterial=ko,l.MeshMatcapMaterial=Uo,l.MeshNormalMaterial=No,l.MeshPhongMaterial=fo,l.MeshPhysicalMaterial=ho,l.MeshStandardMaterial=ba,l.MeshToonMaterial=Fo,l.MinEquation=ye,l.MirroredRepeatWrapping=ir,l.MixOperation=Fe,l.MultiMaterial=m1,l.MultiplyBlending=J,l.MultiplyOperation=Oe,l.NearestFilter=ar,l.NearestMipMapLinearFilter=at,l.NearestMipMapNearestFilter=Ln,l.NearestMipmapLinearFilter=An,l.NearestMipmapNearestFilter=yn,l.NeverDepth=ln,l.NeverStencilFunc=vp,l.NoBlending=z,l.NoColors=d1,l.NoToneMapping=ot,l.NormalAnimationBlendMode=fa,l.NormalBlending=re,l.NotEqualDepth=Ie,l.NotEqualStencilFunc=bp,l.NumberKeyframeTrack=xs,l.Object3D=Qt,l.ObjectLoader=_y,l.ObjectSpaceNormalMap=kh,l.OctahedronBufferGeometry=ml,l.OctahedronGeometry=ml,l.OneFactor=ke,l.OneMinusDstAlphaFactor=nr,l.OneMinusDstColorFactor=wt,l.OneMinusSrcAlphaFactor=Rt,l.OneMinusSrcColorFactor=rt,l.OrthographicCamera=_s,l.PCFShadowMap=g,l.PCFSoftShadowMap=y,l.PMREMGenerator=a1,l.ParametricBufferGeometry=Io,l.ParametricGeometry=Io,l.Particle=y1,l.ParticleBasicMaterial=E1,l.ParticleSystem=A1,l.ParticleSystemMaterial=w1,l.Path=sa,l.PerspectiveCamera=Nn,l.Plane=va,l.PlaneBufferGeometry=Js,l.PlaneGeometry=Js,l.PlaneHelper=e1,l.PointCloud=g1,l.PointCloudMaterial=b1,l.PointLight=Fc,l.PointLightHelper=Yy,l.Points=ys,l.PointsMaterial=ta,l.PolarGridHelper=Jy,l.PolyhedronBufferGeometry=co,l.PolyhedronGeometry=co,l.PositionalAudio=Iy,l.PropertyBinding=di,l.PropertyMixer=hh,l.QuadraticBezierCurve=aa,l.QuadraticBezierCurve3=wa,l.Quaternion=ni,l.QuaternionKeyframeTrack=bl,l.QuaternionLinearInterpolant=Cc,l.REVISION=A,l.RGBADepthPacking=Nh,l.RGBAFormat=ti,l.RGBAIntegerFormat=Xt,l.RGBA_ASTC_10x10_Format=pt,l.RGBA_ASTC_10x5_Format=Re,l.RGBA_ASTC_10x6_Format=Ge,l.RGBA_ASTC_10x8_Format=vt,l.RGBA_ASTC_12x10_Format=We,l.RGBA_ASTC_12x12_Format=et,l.RGBA_ASTC_4x4_Format=gi,l.RGBA_ASTC_5x4_Format=pn,l.RGBA_ASTC_5x5_Format=En,l.RGBA_ASTC_6x5_Format=I,l.RGBA_ASTC_6x6_Format=k,l.RGBA_ASTC_8x5_Format=X,l.RGBA_ASTC_8x6_Format=q,l.RGBA_ASTC_8x8_Format=de,l.RGBA_BPTC_Format=At,l.RGBA_ETC2_EAC_Format=Br,l.RGBA_PVRTC_2BPPV1_Format=Jn,l.RGBA_PVRTC_4BPPV1_Format=Tn,l.RGBA_S3TC_DXT1_Format=vr,l.RGBA_S3TC_DXT3_Format=bn,l.RGBA_S3TC_DXT5_Format=Gr,l.RGBDEncoding=ou,l.RGBEEncoding=Rl,l.RGBEFormat=Ve,l.RGBFormat=Hi,l.RGBIntegerFormat=ut,l.RGBM16Encoding=au,l.RGBM7Encoding=iu,l.RGB_ETC1_Format=mr,l.RGB_ETC2_Format=Ir,l.RGB_PVRTC_2BPPV1_Format=Yr,l.RGB_PVRTC_4BPPV1_Format=Cr,l.RGB_S3TC_DXT1_Format=Kt,l.RGFormat=Gt,l.RGIntegerFormat=Ct,l.RawShaderMaterial=ka,l.Ray=es,l.Raycaster=gh,l.RectAreaLight=Uc,l.RedFormat=ft,l.RedIntegerFormat=Tt,l.ReinhardToneMapping=mt,l.RepeatWrapping=Ar,l.ReplaceStencilOp=cp,l.ReverseSubtractEquation=Z,l.RingBufferGeometry=yc,l.RingGeometry=yc,l.SRGB8_ALPHA8_ASTC_10x10_Format=oi,l.SRGB8_ALPHA8_ASTC_10x5_Format=Hn,l.SRGB8_ALPHA8_ASTC_10x6_Format=Sn,l.SRGB8_ALPHA8_ASTC_10x8_Format=Qn,l.SRGB8_ALPHA8_ASTC_12x10_Format=si,l.SRGB8_ALPHA8_ASTC_12x12_Format=li,l.SRGB8_ALPHA8_ASTC_4x4_Format=Ut,l.SRGB8_ALPHA8_ASTC_5x4_Format=Yt,l.SRGB8_ALPHA8_ASTC_5x5_Format=er,l.SRGB8_ALPHA8_ASTC_6x5_Format=Lr,l.SRGB8_ALPHA8_ASTC_6x6_Format=br,l.SRGB8_ALPHA8_ASTC_8x5_Format=ur,l.SRGB8_ALPHA8_ASTC_8x6_Format=cn,l.SRGB8_ALPHA8_ASTC_8x8_Format=On,l.Scene=Fu,l.SceneUtils=W1,l.ShaderChunk=Wr,l.ShaderLib=ea,l.ShaderMaterial=Ai,l.ShadowMaterial=Bo,l.Shape=vo,l.ShapeBufferGeometry=gl,l.ShapeGeometry=gl,l.ShapePath=ah,l.ShapeUtils=Na,l.ShortType=$r,l.Skeleton=cl,l.SkeletonHelper=Mf,l.SkinnedMesh=sl,l.SmoothShading=F,l.Sphere=Ka,l.SphereBufferGeometry=yl,l.SphereGeometry=yl,l.Spherical=Wy,l.SphericalHarmonics3=rf,l.Spline=Sh,l.SplineCurve=oa,l.SplineCurve3=jf,l.SpotLight=Bc,l.SpotLightHelper=Xy,l.Sprite=al,l.SpriteMaterial=lo,l.SrcAlphaFactor=Mt,l.SrcAlphaSaturateFactor=yr,l.SrcColorFactor=it,l.StaticCopyUsage=Sp,l.StaticDrawUsage=Bs,l.StaticReadUsage=xp,l.StereoCamera=cf,l.StreamCopyUsage=Cp,l.StreamDrawUsage=wp,l.StreamReadUsage=Tp,l.StringKeyframeTrack=Lc,l.SubtractEquation=oe,l.SubtractiveBlending=ee,l.TOUCH=d,l.TangentSpaceNormalMap=xo,l.TetrahedronBufferGeometry=Ac,l.TetrahedronGeometry=Ac,l.TextBufferGeometry=bc,l.TextGeometry=bc,l.Texture=vn,l.TextureLoader=Dc,l.TorusBufferGeometry=Ec,l.TorusGeometry=Ec,l.TorusKnotBufferGeometry=wc,l.TorusKnotGeometry=wc,l.Triangle=ma,l.TriangleFanDrawMode=Gn,l.TriangleStripDrawMode=wo,l.TrianglesDrawMode=Qa,l.TubeBufferGeometry=xc,l.TubeGeometry=xc,l.UVMapping=V,l.Uint16Attribute=L1,l.Uint16BufferAttribute=Co,l.Uint32Attribute=P1,l.Uint32BufferAttribute=Lo,l.Uint8Attribute=S1,l.Uint8BufferAttribute=Gs,l.Uint8ClampedAttribute=_1,l.Uint8ClampedBufferAttribute=Vs,l.Uniform=gf,l.UniformsLib=Pt,l.UniformsUtils=ed,l.UnsignedByteType=cr,l.UnsignedInt248Type=Ui,l.UnsignedIntType=en,l.UnsignedShort4444Type=Mi,l.UnsignedShort5551Type=ai,l.UnsignedShort565Type=rn,l.UnsignedShortType=Hr,l.VSMShadowMap=x,l.Vector2=bt,l.Vector3=fe,l.Vector4=un,l.VectorKeyframeTrack=Ms,l.Vertex=x1,l.VertexColors=p1,l.VideoTexture=Hu,l.WebGL1Renderer=Bu,l.WebGLCubeRenderTarget=Pu,l.WebGLMultisampleRenderTarget=Bp,l.WebGLRenderTarget=qa,l.WebGLRenderTargetCube=H1,l.WebGLRenderer=tl,l.WebGLUtils=xd,l.WireframeGeometry=ju,l.WireframeHelper=N1,l.WrapAroundEnding=qi,l.XHRLoader=k1,l.ZeroCurvatureEnding=Ti,l.ZeroFactor=je,l.ZeroSlopeEnding=Si,l.ZeroStencilOp=lp,l.sRGBEncoding=Is,Object.defineProperty(l,"__esModule",{value:!0})})},{}],58:[function(M,N,$){THREE.DRACOLoader=function(l){THREE.Loader.call(this,l),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}},THREE.DRACOLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.DRACOLoader,setDecoderPath:function(l){return this.decoderPath=l,this},setDecoderConfig:function(l){return this.decoderConfig=l,this},setWorkerLimit:function(l){return this.workerLimit=l,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(l,w,A,E){var d=new THREE.FileLoader(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(l,v=>{var f={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(v,f).then(w).catch(E)},A,E)},decodeDracoFile:function(l,w,A,E){var d={attributeIDs:A||this.defaultAttributeIDs,attributeTypes:E||this.defaultAttributeTypes,useUniqueIDs:!!A};this.decodeGeometry(l,d).then(w)},decodeGeometry:function(l,w){for(var A in w.attributeTypes){var E=w.attributeTypes[A];E.BYTES_PER_ELEMENT!==void 0&&(w.attributeTypes[A]=E.name)}var d=JSON.stringify(w);if(THREE.DRACOLoader.taskCache.has(l)){var v=THREE.DRACOLoader.taskCache.get(l);if(v.key===d)return v.promise;if(l.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var f,m=this.workerNextTaskID++,u=l.byteLength,b=this._getWorker(m,u).then(g=>(f=g,new Promise((y,x)=>{f._callbacks[m]={resolve:y,reject:x},f.postMessage({type:"decode",id:m,taskConfig:w,buffer:l},[l])}))).then(g=>this._createGeometry(g.geometry));return b.catch(()=>!0).then(()=>{f&&m&&this._releaseTask(f,m)}),THREE.DRACOLoader.taskCache.set(l,{key:d,promise:b}),b},_createGeometry:function(l){var w=new THREE.BufferGeometry;l.index&&w.setIndex(new THREE.BufferAttribute(l.index.array,1));for(var A=0;A<l.attributes.length;A++){var E=l.attributes[A],d=E.name,v=E.array,f=E.itemSize;w.setAttribute(d,new THREE.BufferAttribute(v,f))}return w},_loadLibrary:function(l,w){var A=new THREE.FileLoader(this.manager);return A.setPath(this.decoderPath),A.setResponseType(w),A.setWithCredentials(this.withCredentials),new Promise((E,d)=>{A.load(l,E,void 0,d)})},preload:function(){return this._initDecoder(),this},_initDecoder:function(){if(this.decoderPending)return this.decoderPending;var l=typeof WebAssembly!="object"||this.decoderConfig.type==="js",w=[];return l?w.push(this._loadLibrary("draco_decoder.js","text")):(w.push(this._loadLibrary("draco_wasm_wrapper.js","text")),w.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(w).then(A=>{var E=A[0];l||(this.decoderConfig.wasmBinary=A[1]);var d=THREE.DRACOLoader.DRACOWorker.toString(),v=["/* draco decoder */",E,"","/* worker */",d.substring(d.indexOf("{")+1,d.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([v]))}),this.decoderPending},_getWorker:function(l,w){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){var A=new Worker(this.workerSourceURL);A._callbacks={},A._taskCosts={},A._taskLoad=0,A.postMessage({type:"init",decoderConfig:this.decoderConfig}),A.onmessage=function(d){var v=d.data;switch(v.type){case"decode":A._callbacks[v.id].resolve(v);break;case"error":A._callbacks[v.id].reject(v);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+v.type+'"')}},this.workerPool.push(A)}else this.workerPool.sort(function(E,d){return E._taskLoad>d._taskLoad?-1:1});var A=this.workerPool[this.workerPool.length-1];return A._taskCosts[l]=w,A._taskLoad+=w,A})},_releaseTask:function(l,w){l._taskLoad-=l._taskCosts[w],delete l._callbacks[w],delete l._taskCosts[w]},debug:function(){console.log("Task load: ",this.workerPool.map(l=>l._taskLoad))},dispose:function(){for(var l=0;l<this.workerPool.length;++l)this.workerPool[l].terminate();return this.workerPool.length=0,this}}),THREE.DRACOLoader.DRACOWorker=function(){var l,w;onmessage=function(f){var m=f.data;switch(m.type){case"init":l=m.decoderConfig,w=new Promise(function(g){l.onModuleLoaded=function(y){g({draco:y})},DracoDecoderModule(l)});break;case"decode":var u=m.buffer,b=m.taskConfig;w.then(g=>{var y=g.draco,x=new y.Decoder,L=new y.DecoderBuffer;L.Init(new Int8Array(u),u.byteLength);try{var T=A(y,x,L,b),R=T.attributes.map(O=>O.array.buffer);T.index&&R.push(T.index.array.buffer),self.postMessage({type:"decode",id:m.id,geometry:T},R)}catch(O){console.error(O),self.postMessage({type:"error",id:m.id,error:O.message})}finally{y.destroy(L),y.destroy(x)}});break}};function A(f,m,u,b){var g=b.attributeIDs,y=b.attributeTypes,x,L,T=m.GetEncodedGeometryType(u);if(T===f.TRIANGULAR_MESH)x=new f.Mesh,L=m.DecodeBufferToMesh(u,x);else if(T===f.POINT_CLOUD)x=new f.PointCloud,L=m.DecodeBufferToPointCloud(u,x);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!L.ok()||x.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+L.error_msg());var R={index:null,attributes:[]};for(var O in g){var F=self[y[O]],z,re;if(b.useUniqueIDs)re=g[O],z=m.GetAttributeByUniqueId(x,re);else{if(re=m.GetAttributeId(x,f[g[O]]),re===-1)continue;z=m.GetAttribute(x,re)}R.attributes.push(d(f,m,x,O,F,z))}return T===f.TRIANGULAR_MESH&&(R.index=E(f,m,x)),f.destroy(x),R}function E(f,m,u){var b=u.num_faces(),g=b*3,y=g*4,x=f._malloc(y);m.GetTrianglesUInt32Array(u,y,x);var L=new Uint32Array(f.HEAPF32.buffer,x,g).slice();return f._free(x),{array:L,itemSize:1}}function d(f,m,u,b,g,y){var x=y.num_components(),L=u.num_points(),T=L*x,R=T*g.BYTES_PER_ELEMENT,O=v(f,g),F=f._malloc(R);m.GetAttributeDataArrayForAllPoints(u,y,O,R,F);var z=new g(f.HEAPF32.buffer,F,T).slice();return f._free(F),{name:b,array:z,itemSize:x}}function v(f,m){switch(m){case Float32Array:return f.DT_FLOAT32;case Int8Array:return f.DT_INT8;case Int16Array:return f.DT_INT16;case Int32Array:return f.DT_INT32;case Uint8Array:return f.DT_UINT8;case Uint16Array:return f.DT_UINT16;case Uint32Array:return f.DT_UINT32}}},THREE.DRACOLoader.taskCache=new WeakMap,THREE.DRACOLoader.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},THREE.DRACOLoader.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},THREE.DRACOLoader.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},THREE.DRACOLoader.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")}},{}],59:[function(M,N,$){THREE.GLTFLoader=function(){function l(ie){THREE.Loader.call(this,ie),this.dracoLoader=null,this.ddsLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(ae){return new f(ae)}),this.register(function(ae){return new u(ae)}),this.register(function(ae){return new b(ae)}),this.register(function(ae){return new m(ae)}),this.register(function(ae){return new d(ae)}),this.register(function(ae){return new g(ae)})}l.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:l,load:function(ie,ae,ge,ve){var we=this,Ie;this.resourcePath!==""?Ie=this.resourcePath:this.path!==""?Ie=this.path:Ie=THREE.LoaderUtils.extractUrlBase(ie),this.manager.itemStart(ie);var Oe=function(Ye){ve?ve(Ye):console.error(Ye),we.manager.itemError(ie),we.manager.itemEnd(ie)},Fe=new THREE.FileLoader(this.manager);Fe.setPath(this.path),Fe.setResponseType("arraybuffer"),Fe.setRequestHeader(this.requestHeader),Fe.setWithCredentials(this.withCredentials),Fe.load(ie,function(Ye){try{we.parse(Ye,Ie,function(ot){ae(ot),we.manager.itemEnd(ie)},Oe)}catch(ot){Oe(ot)}},ge,Oe)},setDRACOLoader:function(ie){return this.dracoLoader=ie,this},setDDSLoader:function(ie){return this.ddsLoader=ie,this},setKTX2Loader:function(ie){return this.ktx2Loader=ie,this},setMeshoptDecoder:function(ie){return this.meshoptDecoder=ie,this},register:function(ie){return this.pluginCallbacks.indexOf(ie)===-1&&this.pluginCallbacks.push(ie),this},unregister:function(ie){return this.pluginCallbacks.indexOf(ie)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(ie),1),this},parse:function(ie,ae,ge,ve){var we,Ie={},Oe={};if(typeof ie=="string")we=ie;else{var Fe=THREE.LoaderUtils.decodeText(new Uint8Array(ie,0,4));if(Fe===y){try{Ie[A.KHR_BINARY_GLTF]=new T(ie)}catch(U){ve&&ve(U);return}we=Ie[A.KHR_BINARY_GLTF].content}else we=THREE.LoaderUtils.decodeText(new Uint8Array(ie))}var Ye=JSON.parse(we);if(Ye.asset===void 0||Ye.asset.version[0]<2){ve&&ve(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}var ot=new wt(Ye,{path:ae||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});ot.fileLoader.setRequestHeader(this.requestHeader);for(var ct=0;ct<this.pluginCallbacks.length;ct++){var mt=this.pluginCallbacks[ct](ot);Oe[mt.name]=mt,Ie[mt.name]=!0}if(Ye.extensionsUsed)for(var ct=0;ct<Ye.extensionsUsed.length;++ct){var xt=Ye.extensionsUsed[ct],ne=Ye.extensionsRequired||[];switch(xt){case A.KHR_MATERIALS_UNLIT:Ie[xt]=new v;break;case A.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:Ie[xt]=new z;break;case A.KHR_DRACO_MESH_COMPRESSION:Ie[xt]=new R(Ye,this.dracoLoader);break;case A.MSFT_TEXTURE_DDS:Ie[xt]=new E(this.ddsLoader);break;case A.KHR_TEXTURE_TRANSFORM:Ie[xt]=new O;break;case A.KHR_MESH_QUANTIZATION:Ie[xt]=new re;break;default:ne.indexOf(xt)>=0&&Oe[xt]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+xt+'".')}}ot.setExtensions(Ie),ot.setPlugins(Oe),ot.parse(ge,ve)}});function w(){var ie={};return{get:function(ae){return ie[ae]},add:function(ae,ge){ie[ae]=ge},remove:function(ae){delete ie[ae]},removeAll:function(){ie={}}}}var A={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function E(ie){if(!ie)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=A.MSFT_TEXTURE_DDS,this.ddsLoader=ie}function d(ie){this.parser=ie,this.name=A.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}d.prototype._markDefs=function(){for(var ie=this.parser,ae=this.parser.json.nodes||[],ge=0,ve=ae.length;ge<ve;ge++){var we=ae[ge];we.extensions&&we.extensions[this.name]&&we.extensions[this.name].light!==void 0&&ie._addNodeRef(this.cache,we.extensions[this.name].light)}},d.prototype._loadLight=function(ie){var ae=this.parser,ge="light:"+ie,ve=ae.cache.get(ge);if(ve)return ve;var we=ae.json,Ie=we.extensions&&we.extensions[this.name]||{},Oe=Ie.lights||[],Fe=Oe[ie],Ye,ot=new THREE.Color(16777215);Fe.color!==void 0&&ot.fromArray(Fe.color);var ct=Fe.range!==void 0?Fe.range:0;switch(Fe.type){case"directional":Ye=new THREE.DirectionalLight(ot),Ye.target.position.set(0,0,-1),Ye.add(Ye.target);break;case"point":Ye=new THREE.PointLight(ot),Ye.distance=ct;break;case"spot":Ye=new THREE.SpotLight(ot),Ye.distance=ct,Fe.spot=Fe.spot||{},Fe.spot.innerConeAngle=Fe.spot.innerConeAngle!==void 0?Fe.spot.innerConeAngle:0,Fe.spot.outerConeAngle=Fe.spot.outerConeAngle!==void 0?Fe.spot.outerConeAngle:Math.PI/4,Ye.angle=Fe.spot.outerConeAngle,Ye.penumbra=1-Fe.spot.innerConeAngle/Fe.spot.outerConeAngle,Ye.target.position.set(0,0,-1),Ye.add(Ye.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+Fe.type)}return Ye.position.set(0,0,0),Ye.decay=2,Fe.intensity!==void 0&&(Ye.intensity=Fe.intensity),Ye.name=ae.createUniqueName(Fe.name||"light_"+ie),ve=Promise.resolve(Ye),ae.cache.add(ge,ve),ve},d.prototype.createNodeAttachment=function(ie){var ae=this,ge=this.parser,ve=ge.json,we=ve.nodes[ie],Ie=we.extensions&&we.extensions[this.name]||{},Oe=Ie.light;return Oe===void 0?null:this._loadLight(Oe).then(function(Fe){return ge._getNodeRef(ae.cache,Oe,Fe)})};function v(){this.name=A.KHR_MATERIALS_UNLIT}v.prototype.getMaterialType=function(){return THREE.MeshBasicMaterial},v.prototype.extendParams=function(ie,ae,ge){var ve=[];ie.color=new THREE.Color(1,1,1),ie.opacity=1;var we=ae.pbrMetallicRoughness;if(we){if(Array.isArray(we.baseColorFactor)){var Ie=we.baseColorFactor;ie.color.fromArray(Ie),ie.opacity=Ie[3]}we.baseColorTexture!==void 0&&ve.push(ge.assignTexture(ie,"map",we.baseColorTexture))}return Promise.all(ve)};function f(ie){this.parser=ie,this.name=A.KHR_MATERIALS_CLEARCOAT}f.prototype.getMaterialType=function(ie){var ae=this.parser,ge=ae.json.materials[ie];return!ge.extensions||!ge.extensions[this.name]?null:THREE.MeshPhysicalMaterial},f.prototype.extendMaterialParams=function(ie,ae){var ge=this.parser,ve=ge.json.materials[ie];if(!ve.extensions||!ve.extensions[this.name])return Promise.resolve();var we=[],Ie=ve.extensions[this.name];if(Ie.clearcoatFactor!==void 0&&(ae.clearcoat=Ie.clearcoatFactor),Ie.clearcoatTexture!==void 0&&we.push(ge.assignTexture(ae,"clearcoatMap",Ie.clearcoatTexture)),Ie.clearcoatRoughnessFactor!==void 0&&(ae.clearcoatRoughness=Ie.clearcoatRoughnessFactor),Ie.clearcoatRoughnessTexture!==void 0&&we.push(ge.assignTexture(ae,"clearcoatRoughnessMap",Ie.clearcoatRoughnessTexture)),Ie.clearcoatNormalTexture!==void 0&&(we.push(ge.assignTexture(ae,"clearcoatNormalMap",Ie.clearcoatNormalTexture)),Ie.clearcoatNormalTexture.scale!==void 0)){var Oe=Ie.clearcoatNormalTexture.scale;ae.clearcoatNormalScale=new THREE.Vector2(Oe,-Oe)}return Promise.all(we)};function m(ie){this.parser=ie,this.name=A.KHR_MATERIALS_TRANSMISSION}m.prototype.getMaterialType=function(ie){var ae=this.parser,ge=ae.json.materials[ie];return!ge.extensions||!ge.extensions[this.name]?null:THREE.MeshPhysicalMaterial},m.prototype.extendMaterialParams=function(ie,ae){var ge=this.parser,ve=ge.json.materials[ie];if(!ve.extensions||!ve.extensions[this.name])return Promise.resolve();var we=[],Ie=ve.extensions[this.name];return Ie.transmissionFactor!==void 0&&(ae.transmission=Ie.transmissionFactor),Ie.transmissionTexture!==void 0&&we.push(ge.assignTexture(ae,"transmissionMap",Ie.transmissionTexture)),Promise.all(we)};function u(ie){this.parser=ie,this.name=A.KHR_TEXTURE_BASISU}u.prototype.loadTexture=function(ie){var ae=this.parser,ge=ae.json,ve=ge.textures[ie];if(!ve.extensions||!ve.extensions[this.name])return null;var we=ve.extensions[this.name],Ie=ge.images[we.source],Oe=ae.options.ktx2Loader;if(!Oe){if(ge.extensionsRequired&&ge.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return ae.loadTextureImage(ie,Ie,Oe)};function b(ie){this.parser=ie,this.name=A.EXT_TEXTURE_WEBP,this.isSupported=null}b.prototype.loadTexture=function(ie){var ae=this.name,ge=this.parser,ve=ge.json,we=ve.textures[ie];if(!we.extensions||!we.extensions[ae])return null;var Ie=we.extensions[ae],Oe=ve.images[Ie.source],Fe=Oe.uri?ge.options.manager.getHandler(Oe.uri):ge.textureLoader;return this.detectSupport().then(function(Ye){if(Ye)return ge.loadTextureImage(ie,Oe,Fe);if(ve.extensionsRequired&&ve.extensionsRequired.indexOf(ae)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return ge.loadTexture(ie)})},b.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise(function(ie){var ae=new Image;ae.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",ae.onload=ae.onerror=function(){ie(ae.height===1)}})),this.isSupported};function g(ie){this.name=A.EXT_MESHOPT_COMPRESSION,this.parser=ie}g.prototype.loadBufferView=function(ie){var ae=this.parser.json,ge=ae.bufferViews[ie];if(ge.extensions&&ge.extensions[this.name]){var ve=ge.extensions[this.name],we=this.parser.getDependency("buffer",ve.buffer),Ie=this.parser.options.meshoptDecoder;if(!Ie||!Ie.supported){if(ae.extensionsRequired&&ae.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([we,Ie.ready]).then(function(Oe){var Fe=ve.byteOffset||0,Ye=ve.byteLength||0,ot=ve.count,ct=ve.byteStride,mt=new ArrayBuffer(ot*ct),xt=new Uint8Array(Oe[0],Fe,Ye);return Ie.decodeGltfBuffer(new Uint8Array(mt),ot,ct,xt,ve.mode,ve.filter),mt})}else return null};var y="glTF",x=12,L={JSON:1313821514,BIN:5130562};function T(ie){this.name=A.KHR_BINARY_GLTF,this.content=null,this.body=null;var ae=new DataView(ie,0,x);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(ie.slice(0,4))),version:ae.getUint32(4,!0),length:ae.getUint32(8,!0)},this.header.magic!==y)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var ge=this.header.length-x,ve=new DataView(ie,x),we=0;we<ge;){var Ie=ve.getUint32(we,!0);we+=4;var Oe=ve.getUint32(we,!0);if(we+=4,Oe===L.JSON){var Fe=new Uint8Array(ie,x+we,Ie);this.content=THREE.LoaderUtils.decodeText(Fe)}else if(Oe===L.BIN){var Ye=x+we;this.body=ie.slice(Ye,Ye+Ie)}we+=Ie}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}function R(ie,ae){if(!ae)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=A.KHR_DRACO_MESH_COMPRESSION,this.json=ie,this.dracoLoader=ae,this.dracoLoader.preload()}R.prototype.decodePrimitive=function(ie,ae){var ge=this.json,ve=this.dracoLoader,we=ie.extensions[this.name].bufferView,Ie=ie.extensions[this.name].attributes,Oe={},Fe={},Ye={};for(var ot in Ie){var ct=Z[ot]||ot.toLowerCase();Oe[ct]=Ie[ot]}for(ot in ie.attributes){var ct=Z[ot]||ot.toLowerCase();if(Ie[ot]!==void 0){var mt=ge.accessors[ie.attributes[ot]],xt=J[mt.componentType];Ye[ct]=xt,Fe[ct]=mt.normalized===!0}}return ae.getDependency("bufferView",we).then(function(ne){return new Promise(function(U){ve.decodeDracoFile(ne,function(V){for(var ue in V.attributes){var De=V.attributes[ue],Je=Fe[ue];Je!==void 0&&(De.normalized=Je)}U(V)},Oe,Ye)})})};function O(){this.name=A.KHR_TEXTURE_TRANSFORM}O.prototype.extendTexture=function(ie,ae){return ie=ie.clone(),ae.offset!==void 0&&ie.offset.fromArray(ae.offset),ae.rotation!==void 0&&(ie.rotation=ae.rotation),ae.scale!==void 0&&ie.repeat.fromArray(ae.scale),ae.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),ie.needsUpdate=!0,ie};function F(ie){THREE.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var ae=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),ge=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),ve=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	texelSpecular = sRGBToLinear( texelSpecular );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),we=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),Ie=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),Oe={specular:{value:new THREE.Color().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=Oe,this.onBeforeCompile=function(Fe){for(var Ye in Oe)Fe.uniforms[Ye]=Oe[Ye];Fe.fragmentShader=Fe.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",ae).replace("#include <metalnessmap_pars_fragment>",ge).replace("#include <roughnessmap_fragment>",ve).replace("#include <metalnessmap_fragment>",we).replace("#include <lights_physical_fragment>",Ie)},Object.defineProperties(this,{specular:{get:function(){return Oe.specular.value},set:function(Fe){Oe.specular.value=Fe}},specularMap:{get:function(){return Oe.specularMap.value},set:function(Fe){Oe.specularMap.value=Fe,Fe?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return Oe.glossiness.value},set:function(Fe){Oe.glossiness.value=Fe}},glossinessMap:{get:function(){return Oe.glossinessMap.value},set:function(Fe){Oe.glossinessMap.value=Fe,Fe?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(ie)}F.prototype=Object.create(THREE.MeshStandardMaterial.prototype),F.prototype.constructor=F,F.prototype.copy=function(ie){return THREE.MeshStandardMaterial.prototype.copy.call(this,ie),this.specularMap=ie.specularMap,this.specular.copy(ie.specular),this.glossinessMap=ie.glossinessMap,this.glossiness=ie.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this};function z(){return{name:A.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return F},extendParams:function(ie,ae,ge){var ve=ae.extensions[this.name];ie.color=new THREE.Color(1,1,1),ie.opacity=1;var we=[];if(Array.isArray(ve.diffuseFactor)){var Ie=ve.diffuseFactor;ie.color.fromArray(Ie),ie.opacity=Ie[3]}if(ve.diffuseTexture!==void 0&&we.push(ge.assignTexture(ie,"map",ve.diffuseTexture)),ie.emissive=new THREE.Color(0,0,0),ie.glossiness=ve.glossinessFactor!==void 0?ve.glossinessFactor:1,ie.specular=new THREE.Color(1,1,1),Array.isArray(ve.specularFactor)&&ie.specular.fromArray(ve.specularFactor),ve.specularGlossinessTexture!==void 0){var Oe=ve.specularGlossinessTexture;we.push(ge.assignTexture(ie,"glossinessMap",Oe)),we.push(ge.assignTexture(ie,"specularMap",Oe))}return Promise.all(we)},createMaterial:function(ie){var ae=new F(ie);return ae.fog=!0,ae.color=ie.color,ae.map=ie.map===void 0?null:ie.map,ae.lightMap=null,ae.lightMapIntensity=1,ae.aoMap=ie.aoMap===void 0?null:ie.aoMap,ae.aoMapIntensity=1,ae.emissive=ie.emissive,ae.emissiveIntensity=1,ae.emissiveMap=ie.emissiveMap===void 0?null:ie.emissiveMap,ae.bumpMap=ie.bumpMap===void 0?null:ie.bumpMap,ae.bumpScale=1,ae.normalMap=ie.normalMap===void 0?null:ie.normalMap,ae.normalMapType=THREE.TangentSpaceNormalMap,ie.normalScale&&(ae.normalScale=ie.normalScale),ae.displacementMap=null,ae.displacementScale=1,ae.displacementBias=0,ae.specularMap=ie.specularMap===void 0?null:ie.specularMap,ae.specular=ie.specular,ae.glossinessMap=ie.glossinessMap===void 0?null:ie.glossinessMap,ae.glossiness=ie.glossiness,ae.alphaMap=null,ae.envMap=ie.envMap===void 0?null:ie.envMap,ae.envMapIntensity=1,ae.refractionRatio=.98,ae}}}function re(){this.name=A.KHR_MESH_QUANTIZATION}function Y(ie,ae,ge,ve){THREE.Interpolant.call(this,ie,ae,ge,ve)}Y.prototype=Object.create(THREE.Interpolant.prototype),Y.prototype.constructor=Y,Y.prototype.copySampleValue_=function(ie){for(var ae=this.resultBuffer,ge=this.sampleValues,ve=this.valueSize,we=ie*ve*3+ve,Ie=0;Ie!==ve;Ie++)ae[Ie]=ge[we+Ie];return ae},Y.prototype.beforeStart_=Y.prototype.copySampleValue_,Y.prototype.afterEnd_=Y.prototype.copySampleValue_,Y.prototype.interpolate_=function(ie,ae,ge,ve){for(var we=this.resultBuffer,Ie=this.sampleValues,Oe=this.valueSize,Fe=Oe*2,Ye=Oe*3,ot=ve-ae,ct=(ge-ae)/ot,mt=ct*ct,xt=mt*ct,ne=ie*Ye,U=ne-Ye,V=-2*xt+3*mt,ue=xt-mt,De=1-V,Je=ue-mt+ct,tt=0;tt!==Oe;tt++){var jt=Ie[U+tt+Oe],wr=Ie[U+tt+Fe]*ot,Ar=Ie[ne+tt+Oe],Jt=Ie[ne+tt]*ot;we[tt]=De*jt+Je*wr+V*Ar+ue*Jt}return we};var ee={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},J={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ce={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},j={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},oe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Z={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ye={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Ne={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},je={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function ke(ie,ae){return typeof ie!="string"||ie===""?"":(/^https?:\/\//i.test(ae)&&/^\//.test(ie)&&(ae=ae.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(ie)||/^data:.*,.*$/i.test(ie)||/^blob:.*$/i.test(ie)?ie:ae+ie)}function it(ie){return ie.DefaultMaterial===void 0&&(ie.DefaultMaterial=new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide})),ie.DefaultMaterial}function rt(ie,ae,ge){for(var ve in ge.extensions)ie[ve]===void 0&&(ae.userData.gltfExtensions=ae.userData.gltfExtensions||{},ae.userData.gltfExtensions[ve]=ge.extensions[ve])}function Mt(ie,ae){ae.extras!==void 0&&(typeof ae.extras=="object"?Object.assign(ie.userData,ae.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+ae.extras))}function Rt(ie,ae,ge){for(var ve=!1,we=!1,Ie=0,Oe=ae.length;Ie<Oe;Ie++){var Fe=ae[Ie];if(Fe.POSITION!==void 0&&(ve=!0),Fe.NORMAL!==void 0&&(we=!0),ve&&we)break}if(!ve&&!we)return Promise.resolve(ie);for(var Ye=[],ot=[],Ie=0,Oe=ae.length;Ie<Oe;Ie++){var Fe=ae[Ie];if(ve){var ct=Fe.POSITION!==void 0?ge.getDependency("accessor",Fe.POSITION):ie.attributes.position;Ye.push(ct)}if(we){var ct=Fe.NORMAL!==void 0?ge.getDependency("accessor",Fe.NORMAL):ie.attributes.normal;ot.push(ct)}}return Promise.all([Promise.all(Ye),Promise.all(ot)]).then(function(mt){var xt=mt[0],ne=mt[1];return ve&&(ie.morphAttributes.position=xt),we&&(ie.morphAttributes.normal=ne),ie.morphTargetsRelative=!0,ie})}function Wt(ie,ae){if(ie.updateMorphTargets(),ae.weights!==void 0)for(var ge=0,ve=ae.weights.length;ge<ve;ge++)ie.morphTargetInfluences[ge]=ae.weights[ge];if(ae.extras&&Array.isArray(ae.extras.targetNames)){var we=ae.extras.targetNames;if(ie.morphTargetInfluences.length===we.length){ie.morphTargetDictionary={};for(var ge=0,ve=we.length;ge<ve;ge++)ie.morphTargetDictionary[we[ge]]=ge}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function nr(ie){var ae=ie.extensions&&ie.extensions[A.KHR_DRACO_MESH_COMPRESSION],ge;return ae?ge="draco:"+ae.bufferView+":"+ae.indices+":"+Dr(ae.attributes):ge=ie.indices+":"+Dr(ie.attributes)+":"+ie.mode,ge}function Dr(ie){for(var ae="",ge=Object.keys(ie).sort(),ve=0,we=ge.length;ve<we;ve++)ae+=ge[ve]+":"+ie[ge[ve]]+";";return ae}function wt(ie,ae){this.json=ie||{},this.extensions={},this.plugins={},this.options=ae||{},this.cache=new w,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},typeof createImageBitmap<"u"&&/Firefox/.test(navigator.userAgent)===!1?this.textureLoader=new THREE.ImageBitmapLoader(this.options.manager):this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}wt.prototype.setExtensions=function(ie){this.extensions=ie},wt.prototype.setPlugins=function(ie){this.plugins=ie},wt.prototype.parse=function(ie,ae){var ge=this,ve=this.json,we=this.extensions;this.cache.removeAll(),this._invokeAll(function(Ie){return Ie._markDefs&&Ie._markDefs()}),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(Ie){var Oe={scene:Ie[0][ve.scene||0],scenes:Ie[0],animations:Ie[1],cameras:Ie[2],asset:ve.asset,parser:ge,userData:{}};rt(we,Oe,ve),Mt(Oe,ve),ie(Oe)}).catch(ae)},wt.prototype._markDefs=function(){for(var ie=this.json.nodes||[],ae=this.json.skins||[],ge=this.json.meshes||[],ve=0,we=ae.length;ve<we;ve++)for(var Ie=ae[ve].joints,Oe=0,Fe=Ie.length;Oe<Fe;Oe++)ie[Ie[Oe]].isBone=!0;for(var Ye=0,ot=ie.length;Ye<ot;Ye++){var ct=ie[Ye];ct.mesh!==void 0&&(this._addNodeRef(this.meshCache,ct.mesh),ct.skin!==void 0&&(ge[ct.mesh].isSkinnedMesh=!0)),ct.camera!==void 0&&this._addNodeRef(this.cameraCache,ct.camera)}},wt.prototype._addNodeRef=function(ie,ae){ae!==void 0&&(ie.refs[ae]===void 0&&(ie.refs[ae]=ie.uses[ae]=0),ie.refs[ae]++)},wt.prototype._getNodeRef=function(ie,ae,ge){if(ie.refs[ae]<=1)return ge;var ve=ge.clone();return ve.name+="_instance_"+ie.uses[ae]++,ve},wt.prototype._invokeOne=function(ie){var ae=Object.values(this.plugins);ae.push(this);for(var ge=0;ge<ae.length;ge++){var ve=ie(ae[ge]);if(ve)return ve}},wt.prototype._invokeAll=function(ie){var ae=Object.values(this.plugins);ae.unshift(this);for(var ge=[],ve=0;ve<ae.length;ve++){var we=ie(ae[ve]);we&&ge.push(we)}return ge},wt.prototype.getDependency=function(ie,ae){var ge=ie+":"+ae,ve=this.cache.get(ge);if(!ve){switch(ie){case"scene":ve=this.loadScene(ae);break;case"node":ve=this.loadNode(ae);break;case"mesh":ve=this._invokeOne(function(we){return we.loadMesh&&we.loadMesh(ae)});break;case"accessor":ve=this.loadAccessor(ae);break;case"bufferView":ve=this._invokeOne(function(we){return we.loadBufferView&&we.loadBufferView(ae)});break;case"buffer":ve=this.loadBuffer(ae);break;case"material":ve=this._invokeOne(function(we){return we.loadMaterial&&we.loadMaterial(ae)});break;case"texture":ve=this._invokeOne(function(we){return we.loadTexture&&we.loadTexture(ae)});break;case"skin":ve=this.loadSkin(ae);break;case"animation":ve=this.loadAnimation(ae);break;case"camera":ve=this.loadCamera(ae);break;default:throw new Error("Unknown type: "+ie)}this.cache.add(ge,ve)}return ve},wt.prototype.getDependencies=function(ie){var ae=this.cache.get(ie);if(!ae){var ge=this,ve=this.json[ie+(ie==="mesh"?"es":"s")]||[];ae=Promise.all(ve.map(function(we,Ie){return ge.getDependency(ie,Ie)})),this.cache.add(ie,ae)}return ae},wt.prototype.loadBuffer=function(ie){var ae=this.json.buffers[ie],ge=this.fileLoader;if(ae.type&&ae.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+ae.type+" buffer type is not supported.");if(ae.uri===void 0&&ie===0)return Promise.resolve(this.extensions[A.KHR_BINARY_GLTF].body);var ve=this.options;return new Promise(function(we,Ie){ge.load(ke(ae.uri,ve.path),we,void 0,function(){Ie(new Error('THREE.GLTFLoader: Failed to load buffer "'+ae.uri+'".'))})})},wt.prototype.loadBufferView=function(ie){var ae=this.json.bufferViews[ie];return this.getDependency("buffer",ae.buffer).then(function(ge){var ve=ae.byteLength||0,we=ae.byteOffset||0;return ge.slice(we,we+ve)})},wt.prototype.loadAccessor=function(ie){var ae=this,ge=this.json,ve=this.json.accessors[ie];if(ve.bufferView===void 0&&ve.sparse===void 0)return Promise.resolve(null);var we=[];return ve.bufferView!==void 0?we.push(this.getDependency("bufferView",ve.bufferView)):we.push(null),ve.sparse!==void 0&&(we.push(this.getDependency("bufferView",ve.sparse.indices.bufferView)),we.push(this.getDependency("bufferView",ve.sparse.values.bufferView))),Promise.all(we).then(function(Ie){var Oe=Ie[0],Fe=oe[ve.type],Ye=J[ve.componentType],ot=Ye.BYTES_PER_ELEMENT,ct=ot*Fe,mt=ve.byteOffset||0,xt=ve.bufferView!==void 0?ge.bufferViews[ve.bufferView].byteStride:void 0,ne=ve.normalized===!0,U,V;if(xt&&xt!==ct){var ue=Math.floor(mt/xt),De="InterleavedBuffer:"+ve.bufferView+":"+ve.componentType+":"+ue+":"+ve.count,Je=ae.cache.get(De);Je||(U=new Ye(Oe,ue*xt,ve.count*xt/ot),Je=new THREE.InterleavedBuffer(U,xt/ot),ae.cache.add(De,Je)),V=new THREE.InterleavedBufferAttribute(Je,Fe,mt%xt/ot,ne)}else Oe===null?U=new Ye(ve.count*Fe):U=new Ye(Oe,mt,ve.count*Fe),V=new THREE.BufferAttribute(U,Fe,ne);if(ve.sparse!==void 0){var tt=oe.SCALAR,jt=J[ve.sparse.indices.componentType],wr=ve.sparse.indices.byteOffset||0,Ar=ve.sparse.values.byteOffset||0,Jt=new jt(Ie[1],wr,ve.sparse.count*tt),ir=new Ye(Ie[2],Ar,ve.sparse.count*Fe);Oe!==null&&(V=new THREE.BufferAttribute(V.array.slice(),V.itemSize,V.normalized));for(var ar=0,yn=Jt.length;ar<yn;ar++){var Ln=Jt[ar];if(V.setX(Ln,ir[ar*Fe]),Fe>=2&&V.setY(Ln,ir[ar*Fe+1]),Fe>=3&&V.setZ(Ln,ir[ar*Fe+2]),Fe>=4&&V.setW(Ln,ir[ar*Fe+3]),Fe>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return V})},wt.prototype.loadTexture=function(ie){var ae=this,ge=this.json,ve=this.options,we=ge.textures[ie],Ie=we.extensions||{},Oe;Ie[A.MSFT_TEXTURE_DDS]?Oe=ge.images[Ie[A.MSFT_TEXTURE_DDS].source]:Oe=ge.images[we.source];var Fe;return Oe.uri&&(Fe=ve.manager.getHandler(Oe.uri)),Fe||(Fe=Ie[A.MSFT_TEXTURE_DDS]?ae.extensions[A.MSFT_TEXTURE_DDS].ddsLoader:this.textureLoader),this.loadTextureImage(ie,Oe,Fe)},wt.prototype.loadTextureImage=function(ie,ae,ge){var ve=this,we=this.json,Ie=this.options,Oe=we.textures[ie],Fe=self.URL||self.webkitURL,Ye=ae.uri,ot=!1,ct=!0;return ae.mimeType==="image/jpeg"&&(ct=!1),ae.bufferView!==void 0&&(Ye=ve.getDependency("bufferView",ae.bufferView).then(function(mt){if(ae.mimeType==="image/png"){var xt=new DataView(mt,25,1).getUint8(0,!1);ct=xt===6||xt===4||xt===3}ot=!0;var ne=new Blob([mt],{type:ae.mimeType});return Ye=Fe.createObjectURL(ne),Ye})),Promise.resolve(Ye).then(function(mt){return new Promise(function(xt,ne){var U=xt;ge.isImageBitmapLoader===!0&&(U=function(V){xt(new THREE.CanvasTexture(V))}),ge.load(ke(mt,Ie.path),U,void 0,ne)})}).then(function(mt){ot===!0&&Fe.revokeObjectURL(Ye),mt.flipY=!1,Oe.name&&(mt.name=Oe.name),ct||(mt.format=THREE.RGBFormat);var xt=we.samplers||{},ne=xt[Oe.sampler]||{};return mt.magFilter=ce[ne.magFilter]||THREE.LinearFilter,mt.minFilter=ce[ne.minFilter]||THREE.LinearMipmapLinearFilter,mt.wrapS=j[ne.wrapS]||THREE.RepeatWrapping,mt.wrapT=j[ne.wrapT]||THREE.RepeatWrapping,ve.associations.set(mt,{type:"textures",index:ie}),mt})},wt.prototype.assignTexture=function(ie,ae,ge){var ve=this;return this.getDependency("texture",ge.index).then(function(we){if(ge.texCoord!==void 0&&ge.texCoord!=0&&!(ae==="aoMap"&&ge.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+ge.texCoord+" for texture "+ae+" not yet supported."),ve.extensions[A.KHR_TEXTURE_TRANSFORM]){var Ie=ge.extensions!==void 0?ge.extensions[A.KHR_TEXTURE_TRANSFORM]:void 0;if(Ie){var Oe=ve.associations.get(we);we=ve.extensions[A.KHR_TEXTURE_TRANSFORM].extendTexture(we,Ie),ve.associations.set(we,Oe)}}ie[ae]=we})},wt.prototype.assignFinalMaterial=function(ie){var ae=ie.geometry,ge=ie.material,ve=ae.attributes.tangent!==void 0,we=ae.attributes.color!==void 0,Ie=ae.attributes.normal===void 0,Oe=ie.isSkinnedMesh===!0,Fe=Object.keys(ae.morphAttributes).length>0,Ye=Fe&&ae.morphAttributes.normal!==void 0;if(ie.isPoints){var ot="PointsMaterial:"+ge.uuid,ct=this.cache.get(ot);ct||(ct=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(ct,ge),ct.color.copy(ge.color),ct.map=ge.map,ct.sizeAttenuation=!1,this.cache.add(ot,ct)),ge=ct}else if(ie.isLine){var ot="LineBasicMaterial:"+ge.uuid,mt=this.cache.get(ot);mt||(mt=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(mt,ge),mt.color.copy(ge.color),this.cache.add(ot,mt)),ge=mt}if(ve||we||Ie||Oe||Fe){var ot="ClonedMaterial:"+ge.uuid+":";ge.isGLTFSpecularGlossinessMaterial&&(ot+="specular-glossiness:"),Oe&&(ot+="skinning:"),ve&&(ot+="vertex-tangents:"),we&&(ot+="vertex-colors:"),Ie&&(ot+="flat-shading:"),Fe&&(ot+="morph-targets:"),Ye&&(ot+="morph-normals:");var xt=this.cache.get(ot);xt||(xt=ge.clone(),Oe&&(xt.skinning=!0),we&&(xt.vertexColors=!0),Ie&&(xt.flatShading=!0),Fe&&(xt.morphTargets=!0),Ye&&(xt.morphNormals=!0),ve&&(xt.vertexTangents=!0,ge.normalScale&&(ge.normalScale.y*=-1),ge.clearcoatNormalScale&&(ge.clearcoatNormalScale.y*=-1)),this.cache.add(ot,xt),this.associations.set(xt,this.associations.get(ge))),ge=xt}ge.aoMap&&ae.attributes.uv2===void 0&&ae.attributes.uv!==void 0&&ae.setAttribute("uv2",ae.attributes.uv),ie.material=ge},wt.prototype.getMaterialType=function(){return THREE.MeshStandardMaterial},wt.prototype.loadMaterial=function(ie){var ae=this,ge=this.json,ve=this.extensions,we=ge.materials[ie],Ie,Oe={},Fe=we.extensions||{},Ye=[];if(Fe[A.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var ot=ve[A.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];Ie=ot.getMaterialType(),Ye.push(ot.extendParams(Oe,we,ae))}else if(Fe[A.KHR_MATERIALS_UNLIT]){var ct=ve[A.KHR_MATERIALS_UNLIT];Ie=ct.getMaterialType(),Ye.push(ct.extendParams(Oe,we,ae))}else{var mt=we.pbrMetallicRoughness||{};if(Oe.color=new THREE.Color(1,1,1),Oe.opacity=1,Array.isArray(mt.baseColorFactor)){var xt=mt.baseColorFactor;Oe.color.fromArray(xt),Oe.opacity=xt[3]}mt.baseColorTexture!==void 0&&Ye.push(ae.assignTexture(Oe,"map",mt.baseColorTexture)),Oe.metalness=mt.metallicFactor!==void 0?mt.metallicFactor:1,Oe.roughness=mt.roughnessFactor!==void 0?mt.roughnessFactor:1,mt.metallicRoughnessTexture!==void 0&&(Ye.push(ae.assignTexture(Oe,"metalnessMap",mt.metallicRoughnessTexture)),Ye.push(ae.assignTexture(Oe,"roughnessMap",mt.metallicRoughnessTexture))),Ie=this._invokeOne(function(U){return U.getMaterialType&&U.getMaterialType(ie)}),Ye.push(Promise.all(this._invokeAll(function(U){return U.extendMaterialParams&&U.extendMaterialParams(ie,Oe)})))}we.doubleSided===!0&&(Oe.side=THREE.DoubleSide);var ne=we.alphaMode||je.OPAQUE;return ne===je.BLEND?(Oe.transparent=!0,Oe.depthWrite=!1):(Oe.transparent=!1,ne===je.MASK&&(Oe.alphaTest=we.alphaCutoff!==void 0?we.alphaCutoff:.5)),we.normalTexture!==void 0&&Ie!==THREE.MeshBasicMaterial&&(Ye.push(ae.assignTexture(Oe,"normalMap",we.normalTexture)),Oe.normalScale=new THREE.Vector2(1,-1),we.normalTexture.scale!==void 0&&Oe.normalScale.set(we.normalTexture.scale,-we.normalTexture.scale)),we.occlusionTexture!==void 0&&Ie!==THREE.MeshBasicMaterial&&(Ye.push(ae.assignTexture(Oe,"aoMap",we.occlusionTexture)),we.occlusionTexture.strength!==void 0&&(Oe.aoMapIntensity=we.occlusionTexture.strength)),we.emissiveFactor!==void 0&&Ie!==THREE.MeshBasicMaterial&&(Oe.emissive=new THREE.Color().fromArray(we.emissiveFactor)),we.emissiveTexture!==void 0&&Ie!==THREE.MeshBasicMaterial&&Ye.push(ae.assignTexture(Oe,"emissiveMap",we.emissiveTexture)),Promise.all(Ye).then(function(){var U;return Ie===F?U=ve[A.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(Oe):U=new Ie(Oe),we.name&&(U.name=we.name),U.map&&(U.map.encoding=THREE.sRGBEncoding),U.emissiveMap&&(U.emissiveMap.encoding=THREE.sRGBEncoding),Mt(U,we),ae.associations.set(U,{type:"materials",index:ie}),we.extensions&&rt(ve,U,we),U})},wt.prototype.createUniqueName=function(ie){for(var ae=THREE.PropertyBinding.sanitizeNodeName(ie||""),ge=ae,ve=1;this.nodeNamesUsed[ge];++ve)ge=ae+"_"+ve;return this.nodeNamesUsed[ge]=!0,ge};function yr(ie,ae,ge){var ve=ae.attributes,we=new THREE.Box3;if(ve.POSITION!==void 0){var Ie=ge.json.accessors[ve.POSITION],Oe=Ie.min,Fe=Ie.max;if(Oe!==void 0&&Fe!==void 0)we.set(new THREE.Vector3(Oe[0],Oe[1],Oe[2]),new THREE.Vector3(Fe[0],Fe[1],Fe[2]));else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;var Ye=ae.targets;if(Ye!==void 0){for(var ot=new THREE.Vector3,ct=new THREE.Vector3,mt=0,xt=Ye.length;mt<xt;mt++){var ne=Ye[mt];if(ne.POSITION!==void 0){var Ie=ge.json.accessors[ne.POSITION],Oe=Ie.min,Fe=Ie.max;Oe!==void 0&&Fe!==void 0?(ct.setX(Math.max(Math.abs(Oe[0]),Math.abs(Fe[0]))),ct.setY(Math.max(Math.abs(Oe[1]),Math.abs(Fe[1]))),ct.setZ(Math.max(Math.abs(Oe[2]),Math.abs(Fe[2]))),ot.max(ct)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}we.expandByVector(ot)}ie.boundingBox=we;var U=new THREE.Sphere;we.getCenter(U.center),U.radius=we.min.distanceTo(we.max)/2,ie.boundingSphere=U}function ln(ie,ae,ge){var ve=ae.attributes,we=[];function Ie(ot,ct){return ge.getDependency("accessor",ot).then(function(mt){ie.setAttribute(ct,mt)})}for(var Oe in ve){var Fe=Z[Oe]||Oe.toLowerCase();Fe in ie.attributes||we.push(Ie(ve[Oe],Fe))}if(ae.indices!==void 0&&!ie.index){var Ye=ge.getDependency("accessor",ae.indices).then(function(ot){ie.setIndex(ot)});we.push(Ye)}return Mt(ie,ae),yr(ie,ae,ge),Promise.all(we).then(function(){return ae.targets!==void 0?Rt(ie,ae.targets,ge):ie})}function kt(ie,ae){var ge=ie.getIndex();if(ge===null){var ve=[],we=ie.getAttribute("position");if(we!==void 0){for(var Ie=0;Ie<we.count;Ie++)ve.push(Ie);ie.setIndex(ve),ge=ie.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),ie}var Oe=ge.count-2,Fe=[];if(ae===THREE.TriangleFanDrawMode)for(var Ie=1;Ie<=Oe;Ie++)Fe.push(ge.getX(0)),Fe.push(ge.getX(Ie)),Fe.push(ge.getX(Ie+1));else for(var Ie=0;Ie<Oe;Ie++)Ie%2===0?(Fe.push(ge.getX(Ie)),Fe.push(ge.getX(Ie+1)),Fe.push(ge.getX(Ie+2))):(Fe.push(ge.getX(Ie+2)),Fe.push(ge.getX(Ie+1)),Fe.push(ge.getX(Ie)));Fe.length/3!==Oe&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var Ye=ie.clone();return Ye.setIndex(Fe),Ye}return wt.prototype.loadGeometries=function(ie){var ae=this,ge=this.extensions,ve=this.primitiveCache;function we(xt){return ge[A.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(xt,ae).then(function(ne){return ln(ne,xt,ae)})}for(var Ie=[],Oe=0,Fe=ie.length;Oe<Fe;Oe++){var Ye=ie[Oe],ot=nr(Ye),ct=ve[ot];if(ct)Ie.push(ct.promise);else{var mt;Ye.extensions&&Ye.extensions[A.KHR_DRACO_MESH_COMPRESSION]?mt=we(Ye):mt=ln(new THREE.BufferGeometry,Ye,ae),ve[ot]={primitive:Ye,promise:mt},Ie.push(mt)}}return Promise.all(Ie)},wt.prototype.loadMesh=function(ie){for(var ae=this,ge=this.json,ve=this.extensions,we=ge.meshes[ie],Ie=we.primitives,Oe=[],Fe=0,Ye=Ie.length;Fe<Ye;Fe++){var ot=Ie[Fe].material===void 0?it(this.cache):this.getDependency("material",Ie[Fe].material);Oe.push(ot)}return Oe.push(ae.loadGeometries(Ie)),Promise.all(Oe).then(function(ct){for(var mt=ct.slice(0,ct.length-1),xt=ct[ct.length-1],ne=[],U=0,V=xt.length;U<V;U++){var ue=xt[U],De=Ie[U],Je,tt=mt[U];if(De.mode===ee.TRIANGLES||De.mode===ee.TRIANGLE_STRIP||De.mode===ee.TRIANGLE_FAN||De.mode===void 0)Je=we.isSkinnedMesh===!0?new THREE.SkinnedMesh(ue,tt):new THREE.Mesh(ue,tt),tt.isMeshStandardMaterial===!0&&tt.side===THREE.DoubleSide&&ue.getIndex()!==null&&ue.hasAttribute("position")===!0&&ue.hasAttribute("normal")===!0&&ue.hasAttribute("uv")===!0&&ue.hasAttribute("tangent")===!1&&(ue.computeTangents(),tt.vertexTangents=!0),Je.isSkinnedMesh===!0&&!Je.geometry.attributes.skinWeight.normalized&&Je.normalizeSkinWeights(),De.mode===ee.TRIANGLE_STRIP?Je.geometry=kt(Je.geometry,THREE.TriangleStripDrawMode):De.mode===ee.TRIANGLE_FAN&&(Je.geometry=kt(Je.geometry,THREE.TriangleFanDrawMode));else if(De.mode===ee.LINES)Je=new THREE.LineSegments(ue,tt);else if(De.mode===ee.LINE_STRIP)Je=new THREE.Line(ue,tt);else if(De.mode===ee.LINE_LOOP)Je=new THREE.LineLoop(ue,tt);else if(De.mode===ee.POINTS)Je=new THREE.Points(ue,tt);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+De.mode);Object.keys(Je.geometry.morphAttributes).length>0&&Wt(Je,we),Je.name=ae.createUniqueName(we.name||"mesh_"+ie),Mt(Je,we),De.extensions&&rt(ve,Je,De),ae.assignFinalMaterial(Je),ne.push(Je)}if(ne.length===1)return ne[0];for(var jt=new THREE.Group,U=0,V=ne.length;U<V;U++)jt.add(ne[U]);return jt})},wt.prototype.loadCamera=function(ie){var ae,ge=this.json.cameras[ie],ve=ge[ge.type];if(!ve){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return ge.type==="perspective"?ae=new THREE.PerspectiveCamera(THREE.MathUtils.radToDeg(ve.yfov),ve.aspectRatio||1,ve.znear||1,ve.zfar||2e6):ge.type==="orthographic"&&(ae=new THREE.OrthographicCamera(-ve.xmag,ve.xmag,ve.ymag,-ve.ymag,ve.znear,ve.zfar)),ge.name&&(ae.name=this.createUniqueName(ge.name)),Mt(ae,ge),Promise.resolve(ae)},wt.prototype.loadSkin=function(ie){var ae=this.json.skins[ie],ge={joints:ae.joints};return ae.inverseBindMatrices===void 0?Promise.resolve(ge):this.getDependency("accessor",ae.inverseBindMatrices).then(function(ve){return ge.inverseBindMatrices=ve,ge})},wt.prototype.loadAnimation=function(ie){for(var ae=this.json,ge=ae.animations[ie],ve=[],we=[],Ie=[],Oe=[],Fe=[],Ye=0,ot=ge.channels.length;Ye<ot;Ye++){var ct=ge.channels[Ye],mt=ge.samplers[ct.sampler],xt=ct.target,ne=xt.node!==void 0?xt.node:xt.id,U=ge.parameters!==void 0?ge.parameters[mt.input]:mt.input,V=ge.parameters!==void 0?ge.parameters[mt.output]:mt.output;ve.push(this.getDependency("node",ne)),we.push(this.getDependency("accessor",U)),Ie.push(this.getDependency("accessor",V)),Oe.push(mt),Fe.push(xt)}return Promise.all([Promise.all(ve),Promise.all(we),Promise.all(Ie),Promise.all(Oe),Promise.all(Fe)]).then(function(ue){for(var De=ue[0],Je=ue[1],tt=ue[2],jt=ue[3],wr=ue[4],Ar=[],Jt=0,ir=De.length;Jt<ir;Jt++){var ar=De[Jt],yn=Je[Jt],Ln=tt[Jt],An=jt[Jt],at=wr[Jt];if(ar!==void 0){ar.updateMatrix(),ar.matrixAutoUpdate=!0;var nt;switch(ye[at.path]){case ye.weights:nt=THREE.NumberKeyframeTrack;break;case ye.rotation:nt=THREE.QuaternionKeyframeTrack;break;case ye.position:case ye.scale:default:nt=THREE.VectorKeyframeTrack;break}var Et=ar.name?ar.name:ar.uuid,$t=An.interpolation!==void 0?Ne[An.interpolation]:THREE.InterpolateLinear,or=[];ye[at.path]===ye.weights?ar.traverse(function(Xr){Xr.isMesh===!0&&Xr.morphTargetInfluences&&or.push(Xr.name?Xr.name:Xr.uuid)}):or.push(Et);var pr=Ln.array;if(Ln.normalized){var cr;if(pr.constructor===Int8Array)cr=1/127;else if(pr.constructor===Uint8Array)cr=1/255;else if(pr.constructor==Int16Array)cr=1/32767;else if(pr.constructor===Uint16Array)cr=1/65535;else throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");for(var Pr=new Float32Array(pr.length),$r=0,Hr=pr.length;$r<Hr;$r++)Pr[$r]=pr[$r]*cr;pr=Pr}for(var $r=0,Hr=or.length;$r<Hr;$r++){var Xn=new nt(or[$r]+"."+ye[at.path],yn.array,pr,$t);An.interpolation==="CUBICSPLINE"&&(Xn.createInterpolant=function(ai){return new Y(this.times,this.values,this.getValueSize()/3,ai)},Xn.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),Ar.push(Xn)}}}var en=ge.name?ge.name:"animation_"+ie;return new THREE.AnimationClip(en,void 0,Ar)})},wt.prototype.loadNode=function(ie){var ae=this.json,ge=this.extensions,ve=this,we=ae.nodes[ie],Ie=we.name?ve.createUniqueName(we.name):"";return function(){var Oe=[];return we.mesh!==void 0&&Oe.push(ve.getDependency("mesh",we.mesh).then(function(Fe){var Ye=ve._getNodeRef(ve.meshCache,we.mesh,Fe);return we.weights!==void 0&&Ye.traverse(function(ot){if(ot.isMesh)for(var ct=0,mt=we.weights.length;ct<mt;ct++)ot.morphTargetInfluences[ct]=we.weights[ct]}),Ye})),we.camera!==void 0&&Oe.push(ve.getDependency("camera",we.camera).then(function(Fe){return ve._getNodeRef(ve.cameraCache,we.camera,Fe)})),ve._invokeAll(function(Fe){return Fe.createNodeAttachment&&Fe.createNodeAttachment(ie)}).forEach(function(Fe){Oe.push(Fe)}),Promise.all(Oe)}().then(function(Oe){var Fe;if(we.isBone===!0?Fe=new THREE.Bone:Oe.length>1?Fe=new THREE.Group:Oe.length===1?Fe=Oe[0]:Fe=new THREE.Object3D,Fe!==Oe[0])for(var Ye=0,ot=Oe.length;Ye<ot;Ye++)Fe.add(Oe[Ye]);if(we.name&&(Fe.userData.name=we.name,Fe.name=Ie),Mt(Fe,we),we.extensions&&rt(ge,Fe,we),we.matrix!==void 0){var ct=new THREE.Matrix4;ct.fromArray(we.matrix),Fe.applyMatrix4(ct)}else we.translation!==void 0&&Fe.position.fromArray(we.translation),we.rotation!==void 0&&Fe.quaternion.fromArray(we.rotation),we.scale!==void 0&&Fe.scale.fromArray(we.scale);return ve.associations.set(Fe,{type:"nodes",index:ie}),Fe})},wt.prototype.loadScene=function(){function ie(ae,ge,ve,we){var Ie=ve.nodes[ae];return we.getDependency("node",ae).then(function(Oe){if(Ie.skin===void 0)return Oe;var Fe;return we.getDependency("skin",Ie.skin).then(function(Ye){Fe=Ye;for(var ot=[],ct=0,mt=Fe.joints.length;ct<mt;ct++)ot.push(we.getDependency("node",Fe.joints[ct]));return Promise.all(ot)}).then(function(Ye){return Oe.traverse(function(ot){if(ot.isMesh){for(var ct=[],mt=[],xt=0,ne=Ye.length;xt<ne;xt++){var U=Ye[xt];if(U){ct.push(U);var V=new THREE.Matrix4;Fe.inverseBindMatrices!==void 0&&V.fromArray(Fe.inverseBindMatrices.array,xt*16),mt.push(V)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',Fe.joints[xt])}ot.bind(new THREE.Skeleton(ct,mt),ot.matrixWorld)}}),Oe})}).then(function(Oe){ge.add(Oe);var Fe=[];if(Ie.children)for(var Ye=Ie.children,ot=0,ct=Ye.length;ot<ct;ot++){var mt=Ye[ot];Fe.push(ie(mt,Oe,ve,we))}return Promise.all(Fe)})}return function(ge){var ve=this.json,we=this.extensions,Ie=this.json.scenes[ge],Oe=this,Fe=new THREE.Group;Ie.name&&(Fe.name=Oe.createUniqueName(Ie.name)),Mt(Fe,Ie),Ie.extensions&&rt(we,Fe,Ie);for(var Ye=Ie.nodes||[],ot=[],ct=0,mt=Ye.length;ct<mt;ct++)ot.push(ie(Ye[ct],Fe,ve,Oe));return Promise.all(ot).then(function(){return Fe})}}(),l}()},{}],60:[function(M,N,$){THREE.MTLLoader=function(l){THREE.Loader.call(this,l)},THREE.MTLLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.MTLLoader,load:function(l,w,A,E){var d=this,v=this.path===""?THREE.LoaderUtils.extractUrlBase(l):this.path,f=new THREE.FileLoader(this.manager);f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(l,function(m){try{w(d.parse(m,v))}catch(u){E?E(u):console.error(u),d.manager.itemError(l)}},A,E)},setMaterialOptions:function(l){return this.materialOptions=l,this},parse:function(l,w){for(var A=l.split(`
`),E={},d=/\s+/,v={},f=0;f<A.length;f++){var m=A[f];if(m=m.trim(),!(m.length===0||m.charAt(0)==="#")){var u=m.indexOf(" "),b=u>=0?m.substring(0,u):m;b=b.toLowerCase();var g=u>=0?m.substring(u+1):"";if(g=g.trim(),b==="newmtl")E={name:g},v[g]=E;else if(b==="ka"||b==="kd"||b==="ks"||b==="ke"){var y=g.split(d,3);E[b]=[parseFloat(y[0]),parseFloat(y[1]),parseFloat(y[2])]}else E[b]=g}}var x=new THREE.MTLLoader.MaterialCreator(this.resourcePath||w,this.materialOptions);return x.setCrossOrigin(this.crossOrigin),x.setManager(this.manager),x.setMaterials(v),x}}),THREE.MTLLoader.MaterialCreator=function(l,w){this.baseUrl=l||"",this.options=w,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(l){return this.crossOrigin=l,this},setManager:function(l){this.manager=l},setMaterials:function(l){this.materialsInfo=this.convert(l),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(l){if(!this.options)return l;var w={};for(var A in l){var E=l[A],d={};w[A]=d;for(var v in E){var f=!0,m=E[v],u=v.toLowerCase();switch(u){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(m=[m[0]/255,m[1]/255,m[2]/255]),this.options&&this.options.ignoreZeroRGBs&&m[0]===0&&m[1]===0&&m[2]===0&&(f=!1);break}f&&(d[u]=m)}}return w},preload:function(){for(var l in this.materialsInfo)this.create(l)},getIndex:function(l){return this.nameLookup[l]},getAsArray:function(){var l=0;for(var w in this.materialsInfo)this.materialsArray[l]=this.create(w),this.nameLookup[w]=l,l++;return this.materialsArray},create:function(l){return this.materials[l]===void 0&&this.createMaterial_(l),this.materials[l]},createMaterial_:function(l){var w=this,A=this.materialsInfo[l],E={name:l,side:this.side};function d(b,g){return typeof g!="string"||g===""?"":/^https?:\/\//i.test(g)?g:b+g}function v(b,g){if(!E[b]){var y=w.getTextureParams(g,E),x=w.loadTexture(d(w.baseUrl,y.url));x.repeat.copy(y.scale),x.offset.copy(y.offset),x.wrapS=w.wrap,x.wrapT=w.wrap,E[b]=x}}for(var f in A){var m=A[f],u;if(m!=="")switch(f.toLowerCase()){case"kd":E.color=new THREE.Color().fromArray(m);break;case"ks":E.specular=new THREE.Color().fromArray(m);break;case"ke":E.emissive=new THREE.Color().fromArray(m);break;case"map_kd":v("map",m);break;case"map_ks":v("specularMap",m);break;case"map_ke":v("emissiveMap",m);break;case"norm":v("normalMap",m);break;case"map_bump":case"bump":v("bumpMap",m);break;case"map_d":v("alphaMap",m),E.transparent=!0;break;case"ns":E.shininess=parseFloat(m);break;case"d":u=parseFloat(m),u<1&&(E.opacity=u,E.transparent=!0);break;case"tr":u=parseFloat(m),this.options&&this.options.invertTrProperty&&(u=1-u),u>0&&(E.opacity=1-u,E.transparent=!0);break}}return this.materials[l]=new THREE.MeshPhongMaterial(E),this.materials[l]},getTextureParams:function(l,w){var A={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},E=l.split(/\s+/),d;return d=E.indexOf("-bm"),d>=0&&(w.bumpScale=parseFloat(E[d+1]),E.splice(d,2)),d=E.indexOf("-s"),d>=0&&(A.scale.set(parseFloat(E[d+1]),parseFloat(E[d+2])),E.splice(d,4)),d=E.indexOf("-o"),d>=0&&(A.offset.set(parseFloat(E[d+1]),parseFloat(E[d+2])),E.splice(d,4)),A.url=E.join(" ").trim(),A},loadTexture:function(l,w,A,E,d){var v,f=this.manager!==void 0?this.manager:THREE.DefaultLoadingManager,m=f.getHandler(l);return m===null&&(m=new THREE.TextureLoader(f)),m.setCrossOrigin&&m.setCrossOrigin(this.crossOrigin),v=m.load(l,A,E,d),w!==void 0&&(v.mapping=w),v}}},{}],61:[function(M,N,$){THREE.OBJLoader=function(){var l=/^[og]\s*(.+)?/,w=/^mtllib /,A=/^usemtl /,E=/^usemap /,d=new THREE.Vector3,v=new THREE.Vector3,f=new THREE.Vector3,m=new THREE.Vector3,u=new THREE.Vector3;function b(){var y={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(x,L){if(this.object&&this.object.fromDeclaration===!1){this.object.name=x,this.object.fromDeclaration=L!==!1;return}var T=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:x||"",fromDeclaration:L!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(O,F){var z=this._finalize(!1);z&&(z.inherited||z.groupCount<=0)&&this.materials.splice(z.index,1);var re={index:this.materials.length,name:O||"",mtllib:Array.isArray(F)&&F.length>0?F[F.length-1]:"",smooth:z!==void 0?z.smooth:this.smooth,groupStart:z!==void 0?z.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(Y){var ee={index:typeof Y=="number"?Y:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return ee.clone=this.clone.bind(ee),ee}};return this.materials.push(re),re},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(O){var F=this.currentMaterial();if(F&&F.groupEnd===-1&&(F.groupEnd=this.geometry.vertices.length/3,F.groupCount=F.groupEnd-F.groupStart,F.inherited=!1),O&&this.materials.length>1)for(var z=this.materials.length-1;z>=0;z--)this.materials[z].groupCount<=0&&this.materials.splice(z,1);return O&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),F}},T&&T.name&&typeof T.clone=="function"){var R=T.clone(0);R.inherited=!0,this.object.materials.push(R)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(x,L){var T=parseInt(x,10);return(T>=0?T-1:T+L/3)*3},parseNormalIndex:function(x,L){var T=parseInt(x,10);return(T>=0?T-1:T+L/3)*3},parseUVIndex:function(x,L){var T=parseInt(x,10);return(T>=0?T-1:T+L/2)*2},addVertex:function(x,L,T){var R=this.vertices,O=this.object.geometry.vertices;O.push(R[x+0],R[x+1],R[x+2]),O.push(R[L+0],R[L+1],R[L+2]),O.push(R[T+0],R[T+1],R[T+2])},addVertexPoint:function(x){var L=this.vertices,T=this.object.geometry.vertices;T.push(L[x+0],L[x+1],L[x+2])},addVertexLine:function(x){var L=this.vertices,T=this.object.geometry.vertices;T.push(L[x+0],L[x+1],L[x+2])},addNormal:function(x,L,T){var R=this.normals,O=this.object.geometry.normals;O.push(R[x+0],R[x+1],R[x+2]),O.push(R[L+0],R[L+1],R[L+2]),O.push(R[T+0],R[T+1],R[T+2])},addFaceNormal:function(x,L,T){var R=this.vertices,O=this.object.geometry.normals;d.fromArray(R,x),v.fromArray(R,L),f.fromArray(R,T),u.subVectors(f,v),m.subVectors(d,v),u.cross(m),u.normalize(),O.push(u.x,u.y,u.z),O.push(u.x,u.y,u.z),O.push(u.x,u.y,u.z)},addColor:function(x,L,T){var R=this.colors,O=this.object.geometry.colors;R[x]!==void 0&&O.push(R[x+0],R[x+1],R[x+2]),R[L]!==void 0&&O.push(R[L+0],R[L+1],R[L+2]),R[T]!==void 0&&O.push(R[T+0],R[T+1],R[T+2])},addUV:function(x,L,T){var R=this.uvs,O=this.object.geometry.uvs;O.push(R[x+0],R[x+1]),O.push(R[L+0],R[L+1]),O.push(R[T+0],R[T+1])},addDefaultUV:function(){var x=this.object.geometry.uvs;x.push(0,0),x.push(0,0),x.push(0,0)},addUVLine:function(x){var L=this.uvs,T=this.object.geometry.uvs;T.push(L[x+0],L[x+1])},addFace:function(x,L,T,R,O,F,z,re,Y){var ee=this.vertices.length,J=this.parseVertexIndex(x,ee),ce=this.parseVertexIndex(L,ee),j=this.parseVertexIndex(T,ee);if(this.addVertex(J,ce,j),this.addColor(J,ce,j),z!==void 0&&z!==""){var oe=this.normals.length;J=this.parseNormalIndex(z,oe),ce=this.parseNormalIndex(re,oe),j=this.parseNormalIndex(Y,oe),this.addNormal(J,ce,j)}else this.addFaceNormal(J,ce,j);if(R!==void 0&&R!==""){var Z=this.uvs.length;J=this.parseUVIndex(R,Z),ce=this.parseUVIndex(O,Z),j=this.parseUVIndex(F,Z),this.addUV(J,ce,j),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(x){this.object.geometry.type="Points";for(var L=this.vertices.length,T=0,R=x.length;T<R;T++){var O=this.parseVertexIndex(x[T],L);this.addVertexPoint(O),this.addColor(O)}},addLineGeometry:function(x,L){this.object.geometry.type="Line";for(var T=this.vertices.length,R=this.uvs.length,O=0,F=x.length;O<F;O++)this.addVertexLine(this.parseVertexIndex(x[O],T));for(var z=0,F=L.length;z<F;z++)this.addUVLine(this.parseUVIndex(L[z],R))}};return y.startObject("",!1),y}function g(y){THREE.Loader.call(this,y),this.materials=null}return g.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:g,load:function(y,x,L,T){var R=this,O=new THREE.FileLoader(this.manager);O.setPath(this.path),O.setRequestHeader(this.requestHeader),O.setWithCredentials(this.withCredentials),O.load(y,function(F){try{x(R.parse(F))}catch(z){T?T(z):console.error(z),R.manager.itemError(y)}},L,T)},setMaterials:function(y){return this.materials=y,this},parse:function(y){var x=new b;y.indexOf(`\r
`)!==-1&&(y=y.replace(/\r\n/g,`
`)),y.indexOf(`\\
`)!==-1&&(y=y.replace(/\\\n/g,""));for(var L=y.split(`
`),T="",R="",O=0,F=[],z=typeof"".trimLeft=="function",re=0,Y=L.length;re<Y;re++)if(T=L[re],T=z?T.trimLeft():T.trim(),O=T.length,O!==0&&(R=T.charAt(0),R!=="#"))if(R==="v"){var ee=T.split(/\s+/);switch(ee[0]){case"v":x.vertices.push(parseFloat(ee[1]),parseFloat(ee[2]),parseFloat(ee[3])),ee.length>=7?x.colors.push(parseFloat(ee[4]),parseFloat(ee[5]),parseFloat(ee[6])):x.colors.push(void 0,void 0,void 0);break;case"vn":x.normals.push(parseFloat(ee[1]),parseFloat(ee[2]),parseFloat(ee[3]));break;case"vt":x.uvs.push(parseFloat(ee[1]),parseFloat(ee[2]));break}}else if(R==="f"){for(var J=T.substr(1).trim(),ce=J.split(/\s+/),j=[],oe=0,Z=ce.length;oe<Z;oe++){var ye=ce[oe];if(ye.length>0){var Ne=ye.split("/");j.push(Ne)}}for(var je=j[0],oe=1,Z=j.length-1;oe<Z;oe++){var ke=j[oe],it=j[oe+1];x.addFace(je[0],ke[0],it[0],je[1],ke[1],it[1],je[2],ke[2],it[2])}}else if(R==="l"){var rt=T.substring(1).trim().split(" "),Mt=[],Rt=[];if(T.indexOf("/")===-1)Mt=rt;else for(var Wt=0,nr=rt.length;Wt<nr;Wt++){var Dr=rt[Wt].split("/");Dr[0]!==""&&Mt.push(Dr[0]),Dr[1]!==""&&Rt.push(Dr[1])}x.addLineGeometry(Mt,Rt)}else if(R==="p"){var J=T.substr(1).trim(),wt=J.split(" ");x.addPointGeometry(wt)}else if((F=l.exec(T))!==null){var yr=(" "+F[0].substr(1).trim()).substr(1);x.startObject(yr)}else if(A.test(T))x.object.startMaterial(T.substring(7).trim(),x.materialLibraries);else if(w.test(T))x.materialLibraries.push(T.substring(7).trim());else if(E.test(T))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(R==="s"){if(F=T.split(" "),F.length>1){var ln=F[1].trim().toLowerCase();x.object.smooth=ln!=="0"&&ln!=="off"}else x.object.smooth=!0;var kt=x.object.currentMaterial();kt&&(kt.smooth=x.object.smooth)}else{if(T==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+T+'"')}x.finalize();var ie=new THREE.Group;ie.materialLibraries=[].concat(x.materialLibraries);var ae=!(x.objects.length===1&&x.objects[0].geometry.vertices.length===0);if(ae===!0)for(var re=0,Y=x.objects.length;re<Y;re++){var ge=x.objects[re],ve=ge.geometry,we=ge.materials,Ie=ve.type==="Line",Oe=ve.type==="Points",Fe=!1;if(ve.vertices.length!==0){var Ye=new THREE.BufferGeometry;Ye.setAttribute("position",new THREE.Float32BufferAttribute(ve.vertices,3)),ve.normals.length>0&&Ye.setAttribute("normal",new THREE.Float32BufferAttribute(ve.normals,3)),ve.colors.length>0&&(Fe=!0,Ye.setAttribute("color",new THREE.Float32BufferAttribute(ve.colors,3))),ve.hasUVIndices===!0&&Ye.setAttribute("uv",new THREE.Float32BufferAttribute(ve.uvs,2));for(var ot=[],ct=0,mt=we.length;ct<mt;ct++){var xt=we[ct],ne=xt.name+"_"+xt.smooth+"_"+Fe,kt=x.materials[ne];if(this.materials!==null){if(kt=this.materials.create(xt.name),Ie&&kt&&!(kt instanceof THREE.LineBasicMaterial)){var U=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(U,kt),U.color.copy(kt.color),kt=U}else if(Oe&&kt&&!(kt instanceof THREE.PointsMaterial)){var V=new THREE.PointsMaterial({size:10,sizeAttenuation:!1});THREE.Material.prototype.copy.call(V,kt),V.color.copy(kt.color),V.map=kt.map,kt=V}}kt===void 0&&(Ie?kt=new THREE.LineBasicMaterial:Oe?kt=new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):kt=new THREE.MeshPhongMaterial,kt.name=xt.name,kt.flatShading=!xt.smooth,kt.vertexColors=Fe,x.materials[ne]=kt),ot.push(kt)}var ue;if(ot.length>1){for(var ct=0,mt=we.length;ct<mt;ct++){var xt=we[ct];Ye.addGroup(xt.groupStart,xt.groupCount,ct)}Ie?ue=new THREE.LineSegments(Ye,ot):Oe?ue=new THREE.Points(Ye,ot):ue=new THREE.Mesh(Ye,ot)}else Ie?ue=new THREE.LineSegments(Ye,ot[0]):Oe?ue=new THREE.Points(Ye,ot[0]):ue=new THREE.Mesh(Ye,ot[0]);ue.name=ge.name,ie.add(ue)}}else if(x.vertices.length>0){var kt=new THREE.PointsMaterial({size:1,sizeAttenuation:!1}),Ye=new THREE.BufferGeometry;Ye.setAttribute("position",new THREE.Float32BufferAttribute(x.vertices,3)),x.colors.length>0&&x.colors[0]!==void 0&&(Ye.setAttribute("color",new THREE.Float32BufferAttribute(x.colors,3)),kt.vertexColors=!0);var De=new THREE.Points(Ye,kt);ie.add(De)}return ie}}),g}()},{}],62:[function(M,N,$){THREE.BufferGeometryUtils={computeTangents:function(l){l.computeTangents(),console.warn("THREE.BufferGeometryUtils: .computeTangents() has been removed. Use BufferGeometry.computeTangents() instead.")},mergeBufferGeometries:function(l,w){for(var A=l[0].index!==null,E=new Set(Object.keys(l[0].attributes)),d=new Set(Object.keys(l[0].morphAttributes)),v={},f={},m=l[0].morphTargetsRelative,u=new THREE.BufferGeometry,b=0,g=0;g<l.length;++g){var y=l[g],x=0;if(A!==(y.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+g+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(var L in y.attributes){if(!E.has(L))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+g+'. All geometries must have compatible attributes; make sure "'+L+'" attribute exists among all geometries, or in none of them.'),null;v[L]===void 0&&(v[L]=[]),v[L].push(y.attributes[L]),x++}if(x!==E.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+g+". Make sure all geometries have the same number of attributes."),null;if(m!==y.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+g+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(var L in y.morphAttributes){if(!d.has(L))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+g+".  .morphAttributes must be consistent throughout all geometries."),null;f[L]===void 0&&(f[L]=[]),f[L].push(y.morphAttributes[L])}if(u.userData.mergedUserData=u.userData.mergedUserData||[],u.userData.mergedUserData.push(y.userData),w){var T;if(A)T=y.index.count;else if(y.attributes.position!==void 0)T=y.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+g+". The geometry must have either an index or a position attribute"),null;u.addGroup(b,T,g),b+=T}}if(A){for(var R=0,O=[],g=0;g<l.length;++g){for(var F=l[g].index,z=0;z<F.count;++z)O.push(F.getX(z)+R);R+=l[g].attributes.position.count}u.setIndex(O)}for(var L in v){var re=this.mergeBufferAttributes(v[L]);if(!re)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+L+" attribute."),null;u.setAttribute(L,re)}for(var L in f){var Y=f[L][0].length;if(Y===0)break;u.morphAttributes=u.morphAttributes||{},u.morphAttributes[L]=[];for(var g=0;g<Y;++g){for(var ee=[],z=0;z<f[L].length;++z)ee.push(f[L][z][g]);var J=this.mergeBufferAttributes(ee);if(!J)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+L+" morphAttribute."),null;u.morphAttributes[L].push(J)}}return u},mergeBufferAttributes:function(l){for(var w,A,E,d=0,v=0;v<l.length;++v){var f=l[v];if(f.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(w===void 0&&(w=f.array.constructor),w!==f.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(A===void 0&&(A=f.itemSize),A!==f.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(E===void 0&&(E=f.normalized),E!==f.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;d+=f.array.length}for(var m=new w(d),u=0,v=0;v<l.length;++v)m.set(l[v].array,u),u+=l[v].array.length;return new THREE.BufferAttribute(m,A,E)},interleaveAttributes:function(l){for(var w,A=0,E=0,d=0,v=l.length;d<v;++d){var f=l[d];if(w===void 0&&(w=f.array.constructor),w!==f.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;A+=f.array.length,E+=f.itemSize}for(var m=new THREE.InterleavedBuffer(new w(A),E),u=0,b=[],g=["getX","getY","getZ","getW"],y=["setX","setY","setZ","setW"],x=0,v=l.length;x<v;x++){var f=l[x],L=f.itemSize,T=f.count,R=new THREE.InterleavedBufferAttribute(m,L,u,f.normalized);b.push(R),u+=L;for(var O=0;O<T;O++)for(var F=0;F<L;F++)R[y[F]](O,f[g[F]](O))}return b},estimateBytesUsed:function(l){var w=0;for(var A in l.attributes){var E=l.getAttribute(A);w+=E.count*E.itemSize*E.array.BYTES_PER_ELEMENT}var d=l.getIndex();return w+=d?d.count*d.itemSize*d.array.BYTES_PER_ELEMENT:0,w},mergeVertices:function(l,w=1e-4){w=Math.max(w,Number.EPSILON);for(var A={},E=l.getIndex(),d=l.getAttribute("position"),v=E?E.count:d.count,f=0,m=Object.keys(l.attributes),u={},b={},g=[],y=["getX","getY","getZ","getW"],x=0,L=m.length;x<L;x++){var T=m[x];u[T]=[];var R=l.morphAttributes[T];R&&(b[T]=new Array(R.length).fill().map(()=>[]))}for(var O=Math.log10(1/w),F=Math.pow(10,O),x=0;x<v;x++){for(var z=E?E.getX(x):x,re="",Y=0,L=m.length;Y<L;Y++)for(var T=m[Y],ee=l.getAttribute(T),J=ee.itemSize,ce=0;ce<J;ce++)re+=`${~~(ee[y[ce]](z)*F)},`;if(re in A)g.push(A[re]);else{for(var Y=0,L=m.length;Y<L;Y++)for(var T=m[Y],ee=l.getAttribute(T),R=l.morphAttributes[T],J=ee.itemSize,j=u[T],oe=b[T],ce=0;ce<J;ce++){var Z=y[ce];if(j.push(ee[Z](z)),R)for(var ye=0,Ne=R.length;ye<Ne;ye++)oe[ye].push(R[ye][Z](z))}A[re]=f,g.push(f),f++}}const je=l.clone();for(var x=0,L=m.length;x<L;x++){var T=m[x],ke=l.getAttribute(T),it=new ke.array.constructor(u[T]),ee=new THREE.BufferAttribute(it,ke.itemSize,ke.normalized);if(je.setAttribute(T,ee),T in b)for(var Y=0;Y<b[T].length;Y++){var rt=l.morphAttributes[T][Y],it=new rt.array.constructor(b[T][Y]),Mt=new THREE.BufferAttribute(it,rt.itemSize,rt.normalized);je.morphAttributes[T][Y]=Mt}}return je.setIndex(g),je},toTrianglesDrawMode:function(l,w){if(w===THREE.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),l;if(w===THREE.TriangleFanDrawMode||w===THREE.TriangleStripDrawMode){var A=l.getIndex();if(A===null){var E=[],d=l.getAttribute("position");if(d!==void 0){for(var v=0;v<d.count;v++)E.push(v);l.setIndex(E),A=l.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),l}var f=A.count-2,m=[];if(w===THREE.TriangleFanDrawMode)for(var v=1;v<=f;v++)m.push(A.getX(0)),m.push(A.getX(v)),m.push(A.getX(v+1));else for(var v=0;v<f;v++)v%2===0?(m.push(A.getX(v)),m.push(A.getX(v+1)),m.push(A.getX(v+2))):(m.push(A.getX(v+2)),m.push(A.getX(v+1)),m.push(A.getX(v)));m.length/3!==f&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var u=l.clone();return u.setIndex(m),u.clearGroups(),u}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",w),l},computeMorphedAttributes:function(l){if(l.geometry.isBufferGeometry!==!0)return console.error("THREE.BufferGeometryUtils: Geometry is not of type THREE.BufferGeometry."),null;var w=new THREE.Vector3,A=new THREE.Vector3,E=new THREE.Vector3,d=new THREE.Vector3,v=new THREE.Vector3,f=new THREE.Vector3,m=new THREE.Vector3,u=new THREE.Vector3,b=new THREE.Vector3;function g(nr,Dr,wt,yr,ln,kt,ie,ae,ge){w.fromBufferAttribute(wt,kt),A.fromBufferAttribute(wt,ie),E.fromBufferAttribute(wt,ae);var ve=nr.morphTargetInfluences;if(Dr.morphTargets&&yr&&ve){m.set(0,0,0),u.set(0,0,0),b.set(0,0,0);for(var we=0,Ie=yr.length;we<Ie;we++){var Oe=ve[we],yr=yr[we];Oe!==0&&(d.fromBufferAttribute(yr,kt),v.fromBufferAttribute(yr,ie),f.fromBufferAttribute(yr,ae),ln?(m.addScaledVector(d,Oe),u.addScaledVector(v,Oe),b.addScaledVector(f,Oe)):(m.addScaledVector(d.sub(w),Oe),u.addScaledVector(v.sub(A),Oe),b.addScaledVector(f.sub(E),Oe)))}w.add(m),A.add(u),E.add(b)}nr.isSkinnedMesh&&(nr.boneTransform(kt,w),nr.boneTransform(ie,A),nr.boneTransform(ae,E)),ge[kt*3+0]=w.x,ge[kt*3+1]=w.y,ge[kt*3+2]=w.z,ge[ie*3+0]=A.x,ge[ie*3+1]=A.y,ge[ie*3+2]=A.z,ge[ae*3+0]=E.x,ge[ae*3+1]=E.y,ge[ae*3+2]=E.z}var y=l.geometry,x=l.material,L,T,R,O=y.index,F=y.attributes.position,z=y.morphAttributes.position,re=y.morphTargetsRelative,Y=y.attributes.normal,ee=y.morphAttributes.position,J=y.groups,ce=y.drawRange,j,oe,Z,ye,Ne,je,ke,it,rt=new Float32Array(F.count*F.itemSize),Mt=new Float32Array(Y.count*Y.itemSize);if(O!==null)if(Array.isArray(x))for(j=0,Z=J.length;j<Z;j++)for(Ne=J[j],je=x[Ne.materialIndex],ke=Math.max(Ne.start,ce.start),it=Math.min(Ne.start+Ne.count,ce.start+ce.count),oe=ke,ye=it;oe<ye;oe+=3)L=O.getX(oe),T=O.getX(oe+1),R=O.getX(oe+2),g(l,je,F,z,re,L,T,R,rt),g(l,je,Y,ee,re,L,T,R,Mt);else for(ke=Math.max(0,ce.start),it=Math.min(O.count,ce.start+ce.count),j=ke,Z=it;j<Z;j+=3)L=O.getX(j),T=O.getX(j+1),R=O.getX(j+2),g(l,x,F,z,re,L,T,R,rt),g(l,x,Y,ee,re,L,T,R,Mt);else if(F!==void 0)if(Array.isArray(x))for(j=0,Z=J.length;j<Z;j++)for(Ne=J[j],je=x[Ne.materialIndex],ke=Math.max(Ne.start,ce.start),it=Math.min(Ne.start+Ne.count,ce.start+ce.count),oe=ke,ye=it;oe<ye;oe+=3)L=oe,T=oe+1,R=oe+2,g(l,je,F,z,re,L,T,R,rt),g(l,je,Y,ee,re,L,T,R,Mt);else for(ke=Math.max(0,ce.start),it=Math.min(F.count,ce.start+ce.count),j=ke,Z=it;j<Z;j+=3)L=j,T=j+1,R=j+2,g(l,x,F,z,re,L,T,R,rt),g(l,x,Y,ee,re,L,T,R,Mt);var Rt=new THREE.Float32BufferAttribute(rt,3),Wt=new THREE.Float32BufferAttribute(Mt,3);return{positionAttribute:F,normalAttribute:Y,morphedPositionAttribute:Rt,morphedNormalAttribute:Wt}}}},{}],63:[function(M,N,$){var l=M("layout-bmfont-text"),w=M("inherits"),A=M("quad-indices"),E=M("three-buffer-vertex-data"),d=M("object-assign"),v=M("./lib/vertices"),f=M("./lib/utils"),m=THREE.BufferGeometry;N.exports=function(g){return new u(g)};function u(b){m.call(this),typeof b=="string"&&(b={text:b}),this._opt=d({},b),b&&this.update(b)}w(u,m),u.prototype.update=function(b){if(typeof b=="string"&&(b={text:b}),b=d({},this._opt,b),!b.font)throw new TypeError("must specify a { font } in options");this.layout=l(b);var g=b.flipY!==!1,y=b.font,x=y.common.scaleW,L=y.common.scaleH,T=this.layout.glyphs.filter(function(re){var Y=re.data;return Y.width*Y.height>0});this.visibleGlyphs=T;var R=v.positions(T),O=v.uvs(T,x,L,g),F=A({clockwise:!0,type:"uint16",count:T.length});if(E.index(this,F,1,"uint16"),E.attr(this,"position",R,2),E.attr(this,"uv",O,2),!b.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(b.multipage){var z=v.pages(T);E.attr(this,"page",z,1)}},u.prototype.computeBoundingSphere=function(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var b=this.attributes.position.array,g=this.attributes.position.itemSize;if(!b||!g||b.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}f.computeSphere(b,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},u.prototype.computeBoundingBox=function(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var b=this.boundingBox,g=this.attributes.position.array,y=this.attributes.position.itemSize;if(!g||!y||g.length<2){b.makeEmpty();return}f.computeBox(g,b)}},{"./lib/utils":64,"./lib/vertices":65,inherits:30,"layout-bmfont-text":36,"object-assign":39,"quad-indices":51,"three-buffer-vertex-data":66}],64:[function(M,N,$){var l=2,w={min:[0,0],max:[0,0]};function A(E){var d=E.length/l;w.min[0]=E[0],w.min[1]=E[1],w.max[0]=E[0],w.max[1]=E[1];for(var v=0;v<d;v++){var f=E[v*l+0],m=E[v*l+1];w.min[0]=Math.min(f,w.min[0]),w.min[1]=Math.min(m,w.min[1]),w.max[0]=Math.max(f,w.max[0]),w.max[1]=Math.max(m,w.max[1])}}N.exports.computeBox=function(E,d){A(E),d.min.set(w.min[0],w.min[1],0),d.max.set(w.max[0],w.max[1],0)},N.exports.computeSphere=function(E,d){A(E);var v=w.min[0],f=w.min[1],m=w.max[0],u=w.max[1],b=m-v,g=u-f,y=Math.sqrt(b*b+g*g);d.center.set(v+b/2,f+g/2,0),d.radius=y/2}},{}],65:[function(M,N,$){N.exports.pages=function(w){var A=new Float32Array(w.length*4*1),E=0;return w.forEach(function(d){var v=d.data.page||0;A[E++]=v,A[E++]=v,A[E++]=v,A[E++]=v}),A},N.exports.uvs=function(w,A,E,d){var v=new Float32Array(w.length*4*2),f=0;return w.forEach(function(m){var u=m.data,b=u.x+u.width,g=u.y+u.height,y=u.x/A,x=u.y/E,L=b/A,T=g/E;d&&(x=(E-u.y)/E,T=(E-g)/E),v[f++]=y,v[f++]=x,v[f++]=y,v[f++]=T,v[f++]=L,v[f++]=T,v[f++]=L,v[f++]=x}),v},N.exports.positions=function(w){var A=new Float32Array(w.length*4*2),E=0;return w.forEach(function(d){var v=d.data,f=d.position[0]+v.xoffset,m=d.position[1]+v.yoffset,u=v.width,b=v.height;A[E++]=f,A[E++]=m,A[E++]=f,A[E++]=m+b,A[E++]=f+u,A[E++]=m+b,A[E++]=f+u,A[E++]=m}),A}},{}],66:[function(M,N,$){var l=M("flatten-vertex-data");N.exports.attr=A,N.exports.index=w;function w(d,v,f,m){typeof f!="number"&&(f=1),typeof m!="string"&&(m="uint16");var u=!d.index&&typeof d.setIndex!="function",b=u?d.getAttribute("index"):d.index,g=E(b,v,f,m);g&&(u?d.addAttribute("index",g):d.index=g)}function A(d,v,f,m,u){if(typeof m!="number"&&(m=3),typeof u!="string"&&(u="float32"),Array.isArray(f)&&Array.isArray(f[0])&&f[0].length!==m)throw new Error("Nested vertex array has unexpected size; expected "+m+" but found "+f[0].length);var b=d.getAttribute(v),g=E(b,f,m,u);d.setAttribute(v,g)}function E(d,v,f,m){return v=v||[],v=l(v,m),d=new THREE.BufferAttribute(v,f),d.itemSize=f,d.needsUpdate=!0,d}},{"flatten-vertex-data":23}],67:[function(M,N,$){(function(l,w){var A=M("process/browser.js").nextTick,E=Function.prototype.apply,d=Array.prototype.slice,v={},f=0;$.setTimeout=function(){return new m(E.call(setTimeout,window,arguments),clearTimeout)},$.setInterval=function(){return new m(E.call(setInterval,window,arguments),clearInterval)},$.clearTimeout=$.clearInterval=function(u){u.close()};function m(u,b){this._id=u,this._clearFn=b}m.prototype.unref=m.prototype.ref=function(){},m.prototype.close=function(){this._clearFn.call(window,this._id)},$.enroll=function(u,b){clearTimeout(u._idleTimeoutId),u._idleTimeout=b},$.unenroll=function(u){clearTimeout(u._idleTimeoutId),u._idleTimeout=-1},$._unrefActive=$.active=function(u){clearTimeout(u._idleTimeoutId);var b=u._idleTimeout;b>=0&&(u._idleTimeoutId=setTimeout(function(){u._onTimeout&&u._onTimeout()},b))},$.setImmediate=typeof l=="function"?l:function(u){var b=f++,g=arguments.length<2?!1:d.call(arguments,1);return v[b]=!0,A(function(){v[b]&&(g?u.apply(null,g):u.call(null),$.clearImmediate(b))}),b},$.clearImmediate=typeof w=="function"?w:function(u){delete v[u]}}).call(this,M("timers").setImmediate,M("timers").clearImmediate)},{"process/browser.js":49,timers:67}],68:[function(M,N,$){(function(l){/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(w,A){typeof $=="object"&&typeof N<"u"?N.exports=A():w.WebVRPolyfill=A()})(this,function(){var w=typeof window<"u"?window:typeof l<"u"?l:typeof self<"u"?self:{};function A(R){return R&&R.__esModule&&Object.prototype.hasOwnProperty.call(R,"default")?R.default:R}function E(R,O){return O={exports:{}},R(O,O.exports),O.exports}var d=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},v=function(O,F){for(var z=0,re=O.length;z<re;z++)F[z]=O[z]},f=function(O,F){for(var z in F)F.hasOwnProperty(z)&&(O[z]=F[z]);return O},m=E(function(R,O){/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(F,z){R.exports=z()})(w,function(){var F=function(I,k){if(!(I instanceof k))throw new TypeError("Cannot call a class as a function")},z=function(){function I(k,X){for(var q=0;q<X.length;q++){var de=X[q];de.enumerable=de.enumerable||!1,de.configurable=!0,"value"in de&&(de.writable=!0),Object.defineProperty(k,de.key,de)}}return function(k,X,q){return X&&I(k.prototype,X),q&&I(k,q),k}}(),re=function(){function I(k,X){var q=[],de=!0,Re=!1,Ge=void 0;try{for(var vt=k[Symbol.iterator](),pt;!(de=(pt=vt.next()).done)&&(q.push(pt.value),!(X&&q.length===X));de=!0);}catch(We){Re=!0,Ge=We}finally{try{!de&&vt.return&&vt.return()}finally{if(Re)throw Ge}}return q}return function(k,X){if(Array.isArray(k))return k;if(Symbol.iterator in Object(k))return I(k,X);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Y=.001,ee=1,J=function(k,X){return"data:"+k+","+encodeURIComponent(X)},ce=function(k,X,q){return k+(X-k)*q},j=function(){var I=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return I}}(),oe=function(){var I=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return I}}(),Z=function(){var I=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return I}}(),ye=function(){var I=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return I}}(),Ne=function(){var I=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),k=I?parseInt(I[1],10):null;return function(){return k}}(),je=function(){var I=!1;return I=j()&&Z()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return I}}(),ke=function(){var I=!1;if(Ne()===65){var k=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(k){var X=k[1].split("."),q=re(X,4);q[0],q[1];var de=q[2],Re=q[3];I=parseInt(de,10)===3325&&parseInt(Re,10)<148}}return function(){return I}}(),it=function(){var I=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return I}}(),rt=function(){var k=window.orientation==90||window.orientation==-90;return it()?!k:k},Mt=function(k){return!(isNaN(k)||k<=Y||k>ee)},Rt=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},Wt=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},nr=function(k){if(oe())return!1;if(k.requestFullscreen)k.requestFullscreen();else if(k.webkitRequestFullscreen)k.webkitRequestFullscreen();else if(k.mozRequestFullScreen)k.mozRequestFullScreen();else if(k.msRequestFullscreen)k.msRequestFullscreen();else return!1;return!0},Dr=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},wt=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},yr=function(k,X,q,de){var Re=k.createShader(k.VERTEX_SHADER);k.shaderSource(Re,X),k.compileShader(Re);var Ge=k.createShader(k.FRAGMENT_SHADER);k.shaderSource(Ge,q),k.compileShader(Ge);var vt=k.createProgram();k.attachShader(vt,Re),k.attachShader(vt,Ge);for(var pt in de)k.bindAttribLocation(vt,de[pt],pt);return k.linkProgram(vt),k.deleteShader(Re),k.deleteShader(Ge),vt},ln=function(k,X){for(var q={},de=k.getProgramParameter(X,k.ACTIVE_UNIFORMS),Re="",Ge=0;Ge<de;Ge++){var vt=k.getActiveUniform(X,Ge);Re=vt.name.replace("[0]",""),q[Re]=k.getUniformLocation(X,Re)}return q},kt=function(k,X,q,de,Re,Ge,vt){var pt=1/(X-q),We=1/(de-Re),et=1/(Ge-vt);return k[0]=-2*pt,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=-2*We,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=2*et,k[11]=0,k[12]=(X+q)*pt,k[13]=(Re+de)*We,k[14]=(vt+Ge)*et,k[15]=1,k},ie=function(){var k=!1;return function(X){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(X)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(X.substr(0,4)))&&(k=!0)}(navigator.userAgent||navigator.vendor||window.opera),k},ae=function(k,X){for(var q in X)X.hasOwnProperty(q)&&(k[q]=X[q]);return k},ge=function(k){if(j()){var X=k.style.width,q=k.style.height;k.style.width=parseInt(X)+1+"px",k.style.height=parseInt(q)+"px",setTimeout(function(){k.style.width=X,k.style.height=q},100)}window.canvas=k},ve=function(){var I=Math.PI/180,k=Math.PI*.25;function X(We,et,At,Ut){var Yt=Math.tan(et?et.upDegrees*I:k),er=Math.tan(et?et.downDegrees*I:k),Lr=Math.tan(et?et.leftDegrees*I:k),br=Math.tan(et?et.rightDegrees*I:k),ur=2/(Lr+br),cn=2/(Yt+er);return We[0]=ur,We[1]=0,We[2]=0,We[3]=0,We[4]=0,We[5]=cn,We[6]=0,We[7]=0,We[8]=-((Lr-br)*ur*.5),We[9]=(Yt-er)*cn*.5,We[10]=Ut/(At-Ut),We[11]=-1,We[12]=0,We[13]=0,We[14]=Ut*At/(At-Ut),We[15]=0,We}function q(We,et,At){var Ut=et[0],Yt=et[1],er=et[2],Lr=et[3],br=Ut+Ut,ur=Yt+Yt,cn=er+er,On=Ut*br,Hn=Ut*ur,Sn=Ut*cn,Qn=Yt*ur,oi=Yt*cn,si=er*cn,li=Lr*br,ci=Lr*ur,Xi=Lr*cn;return We[0]=1-(Qn+si),We[1]=Hn+Xi,We[2]=Sn-ci,We[3]=0,We[4]=Hn-Xi,We[5]=1-(On+si),We[6]=oi+li,We[7]=0,We[8]=Sn+ci,We[9]=oi-li,We[10]=1-(On+Qn),We[11]=0,We[12]=At[0],We[13]=At[1],We[14]=At[2],We[15]=1,We}function de(We,et,At){var Ut=At[0],Yt=At[1],er=At[2],Lr,br,ur,cn,On,Hn,Sn,Qn,oi,si,li,ci;return et===We?(We[12]=et[0]*Ut+et[4]*Yt+et[8]*er+et[12],We[13]=et[1]*Ut+et[5]*Yt+et[9]*er+et[13],We[14]=et[2]*Ut+et[6]*Yt+et[10]*er+et[14],We[15]=et[3]*Ut+et[7]*Yt+et[11]*er+et[15]):(Lr=et[0],br=et[1],ur=et[2],cn=et[3],On=et[4],Hn=et[5],Sn=et[6],Qn=et[7],oi=et[8],si=et[9],li=et[10],ci=et[11],We[0]=Lr,We[1]=br,We[2]=ur,We[3]=cn,We[4]=On,We[5]=Hn,We[6]=Sn,We[7]=Qn,We[8]=oi,We[9]=si,We[10]=li,We[11]=ci,We[12]=Lr*Ut+On*Yt+oi*er+et[12],We[13]=br*Ut+Hn*Yt+si*er+et[13],We[14]=ur*Ut+Sn*Yt+li*er+et[14],We[15]=cn*Ut+Qn*Yt+ci*er+et[15]),We}function Re(We,et){var At=et[0],Ut=et[1],Yt=et[2],er=et[3],Lr=et[4],br=et[5],ur=et[6],cn=et[7],On=et[8],Hn=et[9],Sn=et[10],Qn=et[11],oi=et[12],si=et[13],li=et[14],ci=et[15],Xi=At*br-Ut*Lr,Ya=At*ur-Yt*Lr,Yi=At*cn-er*Lr,Qi=Ut*ur-Yt*br,da=Ut*cn-er*br,Ti=Yt*cn-er*ur,Si=On*si-Hn*oi,qi=On*li-Sn*oi,fa=On*ci-Qn*oi,Ca=Hn*li-Sn*si,Qa=Hn*ci-Qn*si,wo=Sn*ci-Qn*li,Gn=Xi*wo-Ya*Qa+Yi*Ca+Qi*fa-da*qi+Ti*Si;return Gn?(Gn=1/Gn,We[0]=(br*wo-ur*Qa+cn*Ca)*Gn,We[1]=(Yt*Qa-Ut*wo-er*Ca)*Gn,We[2]=(si*Ti-li*da+ci*Qi)*Gn,We[3]=(Sn*da-Hn*Ti-Qn*Qi)*Gn,We[4]=(ur*fa-Lr*wo-cn*qi)*Gn,We[5]=(At*wo-Yt*fa+er*qi)*Gn,We[6]=(li*Yi-oi*Ti-ci*Ya)*Gn,We[7]=(On*Ti-Sn*Yi+Qn*Ya)*Gn,We[8]=(Lr*Qa-br*fa+cn*Si)*Gn,We[9]=(Ut*fa-At*Qa-er*Si)*Gn,We[10]=(oi*da-si*Yi+ci*Xi)*Gn,We[11]=(Hn*Yi-On*da-Qn*Xi)*Gn,We[12]=(br*qi-Lr*Ca-ur*Si)*Gn,We[13]=(At*Ca-Ut*qi+Yt*Si)*Gn,We[14]=(si*Ya-oi*Qi-li*Xi)*Gn,We[15]=(On*Qi-Hn*Ya+Sn*Xi)*Gn,We):null}var Ge=new Float32Array([0,0,0,1]),vt=new Float32Array([0,0,0]);function pt(We,et,At,Ut,Yt,er){X(We,Ut||null,er.depthNear,er.depthFar);var Lr=At.orientation||Ge,br=At.position||vt;q(et,Lr,br),Yt&&de(et,et,Yt),Re(et,et)}return function(We,et,At){return!We||!et?!1:(We.pose=et,We.timestamp=et.timestamp,pt(We.leftProjectionMatrix,We.leftViewMatrix,et,At._getFieldOfView("left"),At._getEyeOffset("left"),At),pt(We.rightProjectionMatrix,We.rightViewMatrix,et,At._getFieldOfView("right"),At._getEyeOffset("right"),At),!0)}}(),we=function(){var k=window.self!==window.top,X=Ie(document.referrer),q=Ie(window.location.href);return k&&X!==q},Ie=function(k){var X,q=k.indexOf("://");q!==-1?X=q+3:X=0;var de=k.indexOf("/",X);return de===-1&&(de=k.length),k.substring(0,de)},Oe=function(k){if(k.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var X=2*Math.acos(k.w);return X},Fe=function(){var I={};return function(k,X){I[k]===void 0&&(console.warn("webvr-polyfill: "+X),I[k]=!0)}}(),Ye=function(k,X){var q=X?"Please use "+X+" instead.":"";Fe(k,k+" has been deprecated. This may not work on native WebVR displays. "+q)};function ot(I,k,X){if(!k){X(I);return}for(var q=[],de=null,Re=0;Re<k.length;++Re){var Ge=k[Re];switch(Ge){case I.TEXTURE_BINDING_2D:case I.TEXTURE_BINDING_CUBE_MAP:var vt=k[++Re];if(vt<I.TEXTURE0||vt>I.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),q.push(null,null);break}de||(de=I.getParameter(I.ACTIVE_TEXTURE)),I.activeTexture(vt),q.push(I.getParameter(Ge),null);break;case I.ACTIVE_TEXTURE:de=I.getParameter(I.ACTIVE_TEXTURE),q.push(null);break;default:q.push(I.getParameter(Ge));break}}X(I);for(var Re=0;Re<k.length;++Re){var Ge=k[Re],pt=q[Re];switch(Ge){case I.ACTIVE_TEXTURE:break;case I.ARRAY_BUFFER_BINDING:I.bindBuffer(I.ARRAY_BUFFER,pt);break;case I.COLOR_CLEAR_VALUE:I.clearColor(pt[0],pt[1],pt[2],pt[3]);break;case I.COLOR_WRITEMASK:I.colorMask(pt[0],pt[1],pt[2],pt[3]);break;case I.CURRENT_PROGRAM:I.useProgram(pt);break;case I.ELEMENT_ARRAY_BUFFER_BINDING:I.bindBuffer(I.ELEMENT_ARRAY_BUFFER,pt);break;case I.FRAMEBUFFER_BINDING:I.bindFramebuffer(I.FRAMEBUFFER,pt);break;case I.RENDERBUFFER_BINDING:I.bindRenderbuffer(I.RENDERBUFFER,pt);break;case I.TEXTURE_BINDING_2D:var vt=k[++Re];if(vt<I.TEXTURE0||vt>I.TEXTURE31)break;I.activeTexture(vt),I.bindTexture(I.TEXTURE_2D,pt);break;case I.TEXTURE_BINDING_CUBE_MAP:var vt=k[++Re];if(vt<I.TEXTURE0||vt>I.TEXTURE31)break;I.activeTexture(vt),I.bindTexture(I.TEXTURE_CUBE_MAP,pt);break;case I.VIEWPORT:I.viewport(pt[0],pt[1],pt[2],pt[3]);break;case I.BLEND:case I.CULL_FACE:case I.DEPTH_TEST:case I.SCISSOR_TEST:case I.STENCIL_TEST:pt?I.enable(Ge):I.disable(Ge);break;default:console.log("No GL restore behavior for 0x"+Ge.toString(16));break}de&&I.activeTexture(de)}}var ct=ot,mt=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),xt=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function ne(I,k,X,q){this.gl=I,this.cardboardUI=k,this.bufferScale=X,this.dirtySubmitFrameBindings=q,this.ctxAttribs=I.getContextAttributes(),this.instanceExt=I.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=I.drawingBufferWidth,this.bufferHeight=I.drawingBufferHeight,this.realBindFramebuffer=I.bindFramebuffer,this.realEnable=I.enable,this.realDisable=I.disable,this.realColorMask=I.colorMask,this.realClearColor=I.clearColor,this.realViewport=I.viewport,j()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(I.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(I.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=yr(I,mt,xt,this.attribs),this.uniforms=ln(I,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=I.createBuffer(),this.indexBuffer=I.createBuffer(),this.indexCount=0,this.renderTarget=I.createTexture(),this.framebuffer=I.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=I.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=I.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=I.createRenderbuffer()),this.patch(),this.onResize()}ne.prototype.destroy=function(){var I=this.gl;this.unpatch(),I.deleteProgram(this.program),I.deleteBuffer(this.vertexBuffer),I.deleteBuffer(this.indexBuffer),I.deleteTexture(this.renderTarget),I.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&I.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&I.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&I.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},ne.prototype.onResize=function(){var I=this.gl,k=this,X=[I.RENDERBUFFER_BINDING,I.TEXTURE_BINDING_2D,I.TEXTURE0];ct(I,X,function(q){k.realBindFramebuffer.call(q,q.FRAMEBUFFER,null),k.scissorTest&&k.realDisable.call(q,q.SCISSOR_TEST),k.realColorMask.call(q,!0,!0,!0,!0),k.realViewport.call(q,0,0,q.drawingBufferWidth,q.drawingBufferHeight),k.realClearColor.call(q,0,0,0,1),q.clear(q.COLOR_BUFFER_BIT),k.realBindFramebuffer.call(q,q.FRAMEBUFFER,k.framebuffer),q.bindTexture(q.TEXTURE_2D,k.renderTarget),q.texImage2D(q.TEXTURE_2D,0,k.ctxAttribs.alpha?q.RGBA:q.RGB,k.bufferWidth,k.bufferHeight,0,k.ctxAttribs.alpha?q.RGBA:q.RGB,q.UNSIGNED_BYTE,null),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.framebufferTexture2D(q.FRAMEBUFFER,q.COLOR_ATTACHMENT0,q.TEXTURE_2D,k.renderTarget,0),k.ctxAttribs.depth&&k.ctxAttribs.stencil?(q.bindRenderbuffer(q.RENDERBUFFER,k.depthStencilBuffer),q.renderbufferStorage(q.RENDERBUFFER,q.DEPTH_STENCIL,k.bufferWidth,k.bufferHeight),q.framebufferRenderbuffer(q.FRAMEBUFFER,q.DEPTH_STENCIL_ATTACHMENT,q.RENDERBUFFER,k.depthStencilBuffer)):k.ctxAttribs.depth?(q.bindRenderbuffer(q.RENDERBUFFER,k.depthBuffer),q.renderbufferStorage(q.RENDERBUFFER,q.DEPTH_COMPONENT16,k.bufferWidth,k.bufferHeight),q.framebufferRenderbuffer(q.FRAMEBUFFER,q.DEPTH_ATTACHMENT,q.RENDERBUFFER,k.depthBuffer)):k.ctxAttribs.stencil&&(q.bindRenderbuffer(q.RENDERBUFFER,k.stencilBuffer),q.renderbufferStorage(q.RENDERBUFFER,q.STENCIL_INDEX8,k.bufferWidth,k.bufferHeight),q.framebufferRenderbuffer(q.FRAMEBUFFER,q.STENCIL_ATTACHMENT,q.RENDERBUFFER,k.stencilBuffer)),!q.checkFramebufferStatus(q.FRAMEBUFFER)===q.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),k.realBindFramebuffer.call(q,q.FRAMEBUFFER,k.lastBoundFramebuffer),k.scissorTest&&k.realEnable.call(q,q.SCISSOR_TEST),k.realColorMask.apply(q,k.colorMask),k.realViewport.apply(q,k.viewport),k.realClearColor.apply(q,k.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},ne.prototype.patch=function(){if(!this.isPatched){var I=this,k=this.gl.canvas,X=this.gl;j()||(k.width=Rt()*this.bufferScale,k.height=Wt()*this.bufferScale,Object.defineProperty(k,"width",{configurable:!0,enumerable:!0,get:function(){return I.bufferWidth},set:function(de){I.bufferWidth=de,I.realCanvasWidth.set.call(k,de),I.onResize()}}),Object.defineProperty(k,"height",{configurable:!0,enumerable:!0,get:function(){return I.bufferHeight},set:function(de){I.bufferHeight=de,I.realCanvasHeight.set.call(k,de),I.onResize()}})),this.lastBoundFramebuffer=X.getParameter(X.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(X.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(q,de){I.lastBoundFramebuffer=de||I.framebuffer,I.realBindFramebuffer.call(X,q,I.lastBoundFramebuffer)},this.cullFace=X.getParameter(X.CULL_FACE),this.depthTest=X.getParameter(X.DEPTH_TEST),this.blend=X.getParameter(X.BLEND),this.scissorTest=X.getParameter(X.SCISSOR_TEST),this.stencilTest=X.getParameter(X.STENCIL_TEST),X.enable=function(q){switch(q){case X.CULL_FACE:I.cullFace=!0;break;case X.DEPTH_TEST:I.depthTest=!0;break;case X.BLEND:I.blend=!0;break;case X.SCISSOR_TEST:I.scissorTest=!0;break;case X.STENCIL_TEST:I.stencilTest=!0;break}I.realEnable.call(X,q)},X.disable=function(q){switch(q){case X.CULL_FACE:I.cullFace=!1;break;case X.DEPTH_TEST:I.depthTest=!1;break;case X.BLEND:I.blend=!1;break;case X.SCISSOR_TEST:I.scissorTest=!1;break;case X.STENCIL_TEST:I.stencilTest=!1;break}I.realDisable.call(X,q)},this.colorMask=X.getParameter(X.COLOR_WRITEMASK),X.colorMask=function(q,de,Re,Ge){I.colorMask[0]=q,I.colorMask[1]=de,I.colorMask[2]=Re,I.colorMask[3]=Ge,I.realColorMask.call(X,q,de,Re,Ge)},this.clearColor=X.getParameter(X.COLOR_CLEAR_VALUE),X.clearColor=function(q,de,Re,Ge){I.clearColor[0]=q,I.clearColor[1]=de,I.clearColor[2]=Re,I.clearColor[3]=Ge,I.realClearColor.call(X,q,de,Re,Ge)},this.viewport=X.getParameter(X.VIEWPORT),X.viewport=function(q,de,Re,Ge){I.viewport[0]=q,I.viewport[1]=de,I.viewport[2]=Re,I.viewport[3]=Ge,I.realViewport.call(X,q,de,Re,Ge)},this.isPatched=!0,ge(k)}},ne.prototype.unpatch=function(){if(this.isPatched){var I=this.gl,k=this.gl.canvas;j()||(Object.defineProperty(k,"width",this.realCanvasWidth),Object.defineProperty(k,"height",this.realCanvasHeight)),k.width=this.bufferWidth,k.height=this.bufferHeight,I.bindFramebuffer=this.realBindFramebuffer,I.enable=this.realEnable,I.disable=this.realDisable,I.colorMask=this.realColorMask,I.clearColor=this.realClearColor,I.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&I.bindFramebuffer(I.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){ge(k)},1)}},ne.prototype.setTextureBounds=function(I,k){I||(I=[0,0,.5,1]),k||(k=[.5,0,.5,1]),this.viewportOffsetScale[0]=I[0],this.viewportOffsetScale[1]=I[1],this.viewportOffsetScale[2]=I[2],this.viewportOffsetScale[3]=I[3],this.viewportOffsetScale[4]=k[0],this.viewportOffsetScale[5]=k[1],this.viewportOffsetScale[6]=k[2],this.viewportOffsetScale[7]=k[3]},ne.prototype.submitFrame=function(){var I=this.gl,k=this,X=[];if(this.dirtySubmitFrameBindings||X.push(I.CURRENT_PROGRAM,I.ARRAY_BUFFER_BINDING,I.ELEMENT_ARRAY_BUFFER_BINDING,I.TEXTURE_BINDING_2D,I.TEXTURE0),ct(I,X,function(de){k.realBindFramebuffer.call(de,de.FRAMEBUFFER,null);var Re=0,Ge=0;k.instanceExt&&(Re=de.getVertexAttrib(k.attribs.position,k.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),Ge=de.getVertexAttrib(k.attribs.texCoord,k.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),k.cullFace&&k.realDisable.call(de,de.CULL_FACE),k.depthTest&&k.realDisable.call(de,de.DEPTH_TEST),k.blend&&k.realDisable.call(de,de.BLEND),k.scissorTest&&k.realDisable.call(de,de.SCISSOR_TEST),k.stencilTest&&k.realDisable.call(de,de.STENCIL_TEST),k.realColorMask.call(de,!0,!0,!0,!0),k.realViewport.call(de,0,0,de.drawingBufferWidth,de.drawingBufferHeight),(k.ctxAttribs.alpha||j())&&(k.realClearColor.call(de,0,0,0,1),de.clear(de.COLOR_BUFFER_BIT)),de.useProgram(k.program),de.bindBuffer(de.ELEMENT_ARRAY_BUFFER,k.indexBuffer),de.bindBuffer(de.ARRAY_BUFFER,k.vertexBuffer),de.enableVertexAttribArray(k.attribs.position),de.enableVertexAttribArray(k.attribs.texCoord),de.vertexAttribPointer(k.attribs.position,2,de.FLOAT,!1,20,0),de.vertexAttribPointer(k.attribs.texCoord,3,de.FLOAT,!1,20,8),k.instanceExt&&(Re!=0&&k.instanceExt.vertexAttribDivisorANGLE(k.attribs.position,0),Ge!=0&&k.instanceExt.vertexAttribDivisorANGLE(k.attribs.texCoord,0)),de.activeTexture(de.TEXTURE0),de.uniform1i(k.uniforms.diffuse,0),de.bindTexture(de.TEXTURE_2D,k.renderTarget),de.uniform4fv(k.uniforms.viewportOffsetScale,k.viewportOffsetScale),de.drawElements(de.TRIANGLES,k.indexCount,de.UNSIGNED_SHORT,0),k.cardboardUI&&k.cardboardUI.renderNoState(),k.realBindFramebuffer.call(k.gl,de.FRAMEBUFFER,k.framebuffer),k.ctxAttribs.preserveDrawingBuffer||(k.realClearColor.call(de,0,0,0,0),de.clear(de.COLOR_BUFFER_BIT)),k.dirtySubmitFrameBindings||k.realBindFramebuffer.call(de,de.FRAMEBUFFER,k.lastBoundFramebuffer),k.cullFace&&k.realEnable.call(de,de.CULL_FACE),k.depthTest&&k.realEnable.call(de,de.DEPTH_TEST),k.blend&&k.realEnable.call(de,de.BLEND),k.scissorTest&&k.realEnable.call(de,de.SCISSOR_TEST),k.stencilTest&&k.realEnable.call(de,de.STENCIL_TEST),k.realColorMask.apply(de,k.colorMask),k.realViewport.apply(de,k.viewport),(k.ctxAttribs.alpha||!k.ctxAttribs.preserveDrawingBuffer)&&k.realClearColor.apply(de,k.clearColor),k.instanceExt&&(Re!=0&&k.instanceExt.vertexAttribDivisorANGLE(k.attribs.position,Re),Ge!=0&&k.instanceExt.vertexAttribDivisorANGLE(k.attribs.texCoord,Ge))}),j()){var q=I.canvas;(q.width!=k.bufferWidth||q.height!=k.bufferHeight)&&(k.bufferWidth=q.width,k.bufferHeight=q.height,k.onResize())}},ne.prototype.updateDeviceInfo=function(I){var k=this.gl,X=this,q=[k.ARRAY_BUFFER_BINDING,k.ELEMENT_ARRAY_BUFFER_BINDING];ct(k,q,function(de){var Re=X.computeMeshVertices_(X.meshWidth,X.meshHeight,I);if(de.bindBuffer(de.ARRAY_BUFFER,X.vertexBuffer),de.bufferData(de.ARRAY_BUFFER,Re,de.STATIC_DRAW),!X.indexCount){var Ge=X.computeMeshIndices_(X.meshWidth,X.meshHeight);de.bindBuffer(de.ELEMENT_ARRAY_BUFFER,X.indexBuffer),de.bufferData(de.ELEMENT_ARRAY_BUFFER,Ge,de.STATIC_DRAW),X.indexCount=Ge.length}})},ne.prototype.computeMeshVertices_=function(I,k,X){for(var q=new Float32Array(2*I*k*5),de=X.getLeftEyeVisibleTanAngles(),Re=X.getLeftEyeNoLensTanAngles(),Ge=X.getLeftEyeVisibleScreenRect(Re),vt=0,pt=0;pt<2;pt++){for(var We=0;We<k;We++)for(var et=0;et<I;et++,vt++){var At=et/(I-1),Ut=We/(k-1),Yt=At,er=Ut,Lr=ce(de[0],de[2],At),br=ce(de[3],de[1],Ut),ur=Math.sqrt(Lr*Lr+br*br),cn=X.distortion.distortInverse(ur),On=Lr*cn/ur,Hn=br*cn/ur;At=(On-Re[0])/(Re[2]-Re[0]),Ut=(Hn-Re[3])/(Re[1]-Re[3]),At=(Ge.x+At*Ge.width-.5)*2,Ut=(Ge.y+Ut*Ge.height-.5)*2,q[vt*5+0]=At,q[vt*5+1]=Ut,q[vt*5+2]=Yt,q[vt*5+3]=er,q[vt*5+4]=pt}var Sn=de[2]-de[0];de[0]=-(Sn+de[0]),de[2]=Sn-de[2],Sn=Re[2]-Re[0],Re[0]=-(Sn+Re[0]),Re[2]=Sn-Re[2],Ge.x=1-(Ge.x+Ge.width)}return q},ne.prototype.computeMeshIndices_=function(I,k){for(var X=new Uint16Array(2*(I-1)*(k-1)*6),q=I/2,de=k/2,Re=0,Ge=0,vt=0;vt<2;vt++)for(var pt=0;pt<k;pt++)for(var We=0;We<I;We++,Re++)We==0||pt==0||(We<=q==pt<=de?(X[Ge++]=Re,X[Ge++]=Re-I-1,X[Ge++]=Re-I,X[Ge++]=Re-I-1,X[Ge++]=Re,X[Ge++]=Re-1):(X[Ge++]=Re-1,X[Ge++]=Re-I,X[Ge++]=Re,X[Ge++]=Re-I,X[Ge++]=Re-1,X[Ge++]=Re-I-1));return X},ne.prototype.getOwnPropertyDescriptor_=function(I,k){var X=Object.getOwnPropertyDescriptor(I,k);return(X.get===void 0||X.set===void 0)&&(X.configurable=!0,X.enumerable=!0,X.get=function(){return this.getAttribute(k)},X.set=function(q){this.setAttribute(k,q)}),X};var U=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),V=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),ue=Math.PI/180,De=60,Je=12,tt=20,jt=1,wr=.75,Ar=.3125,Jt=4,ir=28,ar=1.5;function yn(I){this.gl=I,this.attribs={position:0},this.program=yr(I,U,V,this.attribs),this.uniforms=ln(I,this.program),this.vertexBuffer=I.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}yn.prototype.destroy=function(){var I=this.gl;this.listener&&I.canvas.removeEventListener("click",this.listener,!1),I.deleteProgram(this.program),I.deleteBuffer(this.vertexBuffer)},yn.prototype.listen=function(I,k){var X=this.gl.canvas;this.listener=function(q){var de=X.clientWidth/2,Re=ir*ar;q.clientX>de-Re&&q.clientX<de+Re&&q.clientY>X.clientHeight-Re?I(q):q.clientX<Re&&q.clientY<Re&&k(q)},X.addEventListener("click",this.listener,!1)},yn.prototype.onResize=function(){var I=this.gl,k=this,X=[I.ARRAY_BUFFER_BINDING];ct(I,X,function(q){var de=[],Re=q.drawingBufferWidth/2,Ge=Math.max(screen.width,screen.height)*window.devicePixelRatio,vt=q.drawingBufferWidth/Ge,pt=vt*window.devicePixelRatio,We=Jt*pt/2,et=ir*ar*pt,At=ir*pt/2,Ut=(ir*ar-ir)*pt;de.push(Re-We,et),de.push(Re-We,q.drawingBufferHeight),de.push(Re+We,et),de.push(Re+We,q.drawingBufferHeight),k.gearOffset=de.length/2;function Yt(cn,On){var Hn=(90-cn)*ue,Sn=Math.cos(Hn),Qn=Math.sin(Hn);de.push(Ar*Sn*At+Re,Ar*Qn*At+At),de.push(On*Sn*At+Re,On*Qn*At+At)}for(var er=0;er<=6;er++){var Lr=er*De;Yt(Lr,jt),Yt(Lr+Je,jt),Yt(Lr+tt,wr),Yt(Lr+(De-tt),wr),Yt(Lr+(De-Je),jt)}k.gearVertexCount=de.length/2-k.gearOffset,k.arrowOffset=de.length/2;function br(cn,On){de.push(Ut+cn,q.drawingBufferHeight-Ut-On)}var ur=We/Math.sin(45*ue);br(0,At),br(At,0),br(At+ur,ur),br(ur,At+ur),br(ur,At-ur),br(0,At),br(At,At*2),br(At+ur,At*2-ur),br(ur,At-ur),br(0,At),br(ur,At-We),br(ir*pt,At-We),br(ur,At+We),br(ir*pt,At+We),k.arrowVertexCount=de.length/2-k.arrowOffset,q.bindBuffer(q.ARRAY_BUFFER,k.vertexBuffer),q.bufferData(q.ARRAY_BUFFER,new Float32Array(de),q.STATIC_DRAW)})},yn.prototype.render=function(){var I=this.gl,k=this,X=[I.CULL_FACE,I.DEPTH_TEST,I.BLEND,I.SCISSOR_TEST,I.STENCIL_TEST,I.COLOR_WRITEMASK,I.VIEWPORT,I.CURRENT_PROGRAM,I.ARRAY_BUFFER_BINDING];ct(I,X,function(q){q.disable(q.CULL_FACE),q.disable(q.DEPTH_TEST),q.disable(q.BLEND),q.disable(q.SCISSOR_TEST),q.disable(q.STENCIL_TEST),q.colorMask(!0,!0,!0,!0),q.viewport(0,0,q.drawingBufferWidth,q.drawingBufferHeight),k.renderNoState()})},yn.prototype.renderNoState=function(){var I=this.gl;I.useProgram(this.program),I.bindBuffer(I.ARRAY_BUFFER,this.vertexBuffer),I.enableVertexAttribArray(this.attribs.position),I.vertexAttribPointer(this.attribs.position,2,I.FLOAT,!1,8,0),I.uniform4f(this.uniforms.color,1,1,1,1),kt(this.projMat,0,I.drawingBufferWidth,0,I.drawingBufferHeight,.1,1024),I.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),I.drawArrays(I.TRIANGLE_STRIP,0,4),I.drawArrays(I.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),I.drawArrays(I.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function Ln(I){this.coefficients=I}Ln.prototype.distortInverse=function(I){for(var k=0,X=1,q=I-this.distort(k);Math.abs(X-k)>1e-4;){var de=I-this.distort(X),Re=X-de*((X-k)/(de-q));k=X,X=Re,q=de}return X},Ln.prototype.distort=function(I){for(var k=I*I,X=0,q=0;q<this.coefficients.length;q++)X=k*(X+this.coefficients[q]);return(X+1)*I};var An=Math.PI/180,at=180/Math.PI,nt=function(k,X,q){this.x=k||0,this.y=X||0,this.z=q||0};nt.prototype={constructor:nt,set:function(k,X,q){return this.x=k,this.y=X,this.z=q,this},copy:function(k){return this.x=k.x,this.y=k.y,this.z=k.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var k=this.length();if(k!==0){var X=1/k;this.multiplyScalar(X)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(k){this.x*=k,this.y*=k,this.z*=k},applyQuaternion:function(k){var X=this.x,q=this.y,de=this.z,Re=k.x,Ge=k.y,vt=k.z,pt=k.w,We=pt*X+Ge*de-vt*q,et=pt*q+vt*X-Re*de,At=pt*de+Re*q-Ge*X,Ut=-Re*X-Ge*q-vt*de;return this.x=We*pt+Ut*-Re+et*-vt-At*-Ge,this.y=et*pt+Ut*-Ge+At*-Re-We*-vt,this.z=At*pt+Ut*-vt+We*-Ge-et*-Re,this},dot:function(k){return this.x*k.x+this.y*k.y+this.z*k.z},crossVectors:function(k,X){var q=k.x,de=k.y,Re=k.z,Ge=X.x,vt=X.y,pt=X.z;return this.x=de*pt-Re*vt,this.y=Re*Ge-q*pt,this.z=q*vt-de*Ge,this}};var Et=function(k,X,q,de){this.x=k||0,this.y=X||0,this.z=q||0,this.w=de!==void 0?de:1};Et.prototype={constructor:Et,set:function(k,X,q,de){return this.x=k,this.y=X,this.z=q,this.w=de,this},copy:function(k){return this.x=k.x,this.y=k.y,this.z=k.z,this.w=k.w,this},setFromEulerXYZ:function(k,X,q){var de=Math.cos(k/2),Re=Math.cos(X/2),Ge=Math.cos(q/2),vt=Math.sin(k/2),pt=Math.sin(X/2),We=Math.sin(q/2);return this.x=vt*Re*Ge+de*pt*We,this.y=de*pt*Ge-vt*Re*We,this.z=de*Re*We+vt*pt*Ge,this.w=de*Re*Ge-vt*pt*We,this},setFromEulerYXZ:function(k,X,q){var de=Math.cos(k/2),Re=Math.cos(X/2),Ge=Math.cos(q/2),vt=Math.sin(k/2),pt=Math.sin(X/2),We=Math.sin(q/2);return this.x=vt*Re*Ge+de*pt*We,this.y=de*pt*Ge-vt*Re*We,this.z=de*Re*We-vt*pt*Ge,this.w=de*Re*Ge+vt*pt*We,this},setFromAxisAngle:function(k,X){var q=X/2,de=Math.sin(q);return this.x=k.x*de,this.y=k.y*de,this.z=k.z*de,this.w=Math.cos(q),this},multiply:function(k){return this.multiplyQuaternions(this,k)},multiplyQuaternions:function(k,X){var q=k.x,de=k.y,Re=k.z,Ge=k.w,vt=X.x,pt=X.y,We=X.z,et=X.w;return this.x=q*et+Ge*vt+de*We-Re*pt,this.y=de*et+Ge*pt+Re*vt-q*We,this.z=Re*et+Ge*We+q*pt-de*vt,this.w=Ge*et-q*vt-de*pt-Re*We,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var k=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return k===0?(this.x=0,this.y=0,this.z=0,this.w=1):(k=1/k,this.x=this.x*k,this.y=this.y*k,this.z=this.z*k,this.w=this.w*k),this},slerp:function(k,X){if(X===0)return this;if(X===1)return this.copy(k);var q=this.x,de=this.y,Re=this.z,Ge=this.w,vt=Ge*k.w+q*k.x+de*k.y+Re*k.z;if(vt<0?(this.w=-k.w,this.x=-k.x,this.y=-k.y,this.z=-k.z,vt=-vt):this.copy(k),vt>=1)return this.w=Ge,this.x=q,this.y=de,this.z=Re,this;var pt=Math.acos(vt),We=Math.sqrt(1-vt*vt);if(Math.abs(We)<.001)return this.w=.5*(Ge+this.w),this.x=.5*(q+this.x),this.y=.5*(de+this.y),this.z=.5*(Re+this.z),this;var et=Math.sin((1-X)*pt)/We,At=Math.sin(X*pt)/We;return this.w=Ge*et+this.w*At,this.x=q*et+this.x*At,this.y=de*et+this.y*At,this.z=Re*et+this.z*At,this},setFromUnitVectors:function(){var I,k,X=1e-6;return function(q,de){return I===void 0&&(I=new nt),k=q.dot(de)+1,k<X?(k=0,Math.abs(q.x)>Math.abs(q.z)?I.set(-q.y,q.x,0):I.set(0,-q.z,q.y)):I.crossVectors(q,de),this.x=I.x,this.y=I.y,this.z=I.z,this.w=k,this.normalize(),this}}()};function $t(I){this.width=I.width||Rt(),this.height=I.height||Wt(),this.widthMeters=I.widthMeters,this.heightMeters=I.heightMeters,this.bevelMeters=I.bevelMeters}var or=new $t({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),pr=new $t({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),cr={CardboardV1:new $r({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new $r({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function Pr(I,k){this.viewer=cr.CardboardV2,this.updateDeviceParams(I),this.distortion=new Ln(this.viewer.distortionCoefficients);for(var X=0;X<k.length;X++){var q=k[X];cr[q.id]=new $r(q)}}Pr.prototype.updateDeviceParams=function(I){this.device=this.determineDevice_(I)||this.device},Pr.prototype.getDevice=function(){return this.device},Pr.prototype.setViewer=function(I){this.viewer=I,this.distortion=new Ln(this.viewer.distortionCoefficients)},Pr.prototype.determineDevice_=function(I){if(!I)return j()?(console.warn("Using fallback iOS device measurements."),pr):(console.warn("Using fallback Android device measurements."),or);var k=.0254,X=k/I.xdpi,q=k/I.ydpi,de=Rt(),Re=Wt();return new $t({widthMeters:X*de,heightMeters:q*Re,bevelMeters:I.bevelMm*.001})},Pr.prototype.getDistortedFieldOfViewLeftEye=function(){var I=this.viewer,k=this.device,X=this.distortion,q=I.screenLensDistance,de=(k.widthMeters-I.interLensDistance)/2,Re=I.interLensDistance/2,Ge=I.baselineLensDistance-k.bevelMeters,vt=k.heightMeters-Ge,pt=at*Math.atan(X.distort(de/q)),We=at*Math.atan(X.distort(Re/q)),et=at*Math.atan(X.distort(Ge/q)),At=at*Math.atan(X.distort(vt/q));return{leftDegrees:Math.min(pt,I.fov),rightDegrees:Math.min(We,I.fov),downDegrees:Math.min(et,I.fov),upDegrees:Math.min(At,I.fov)}},Pr.prototype.getLeftEyeVisibleTanAngles=function(){var I=this.viewer,k=this.device,X=this.distortion,q=Math.tan(-An*I.fov),de=Math.tan(An*I.fov),Re=Math.tan(An*I.fov),Ge=Math.tan(-An*I.fov),vt=k.widthMeters/4,pt=k.heightMeters/2,We=I.baselineLensDistance-k.bevelMeters-pt,et=I.interLensDistance/2-vt,At=-We,Ut=I.screenLensDistance,Yt=X.distort((et-vt)/Ut),er=X.distort((At+pt)/Ut),Lr=X.distort((et+vt)/Ut),br=X.distort((At-pt)/Ut),ur=new Float32Array(4);return ur[0]=Math.max(q,Yt),ur[1]=Math.min(de,er),ur[2]=Math.min(Re,Lr),ur[3]=Math.max(Ge,br),ur},Pr.prototype.getLeftEyeNoLensTanAngles=function(){var I=this.viewer,k=this.device,X=this.distortion,q=new Float32Array(4),de=X.distortInverse(Math.tan(-An*I.fov)),Re=X.distortInverse(Math.tan(An*I.fov)),Ge=X.distortInverse(Math.tan(An*I.fov)),vt=X.distortInverse(Math.tan(-An*I.fov)),pt=k.widthMeters/4,We=k.heightMeters/2,et=I.baselineLensDistance-k.bevelMeters-We,At=I.interLensDistance/2-pt,Ut=-et,Yt=I.screenLensDistance,er=(At-pt)/Yt,Lr=(Ut+We)/Yt,br=(At+pt)/Yt,ur=(Ut-We)/Yt;return q[0]=Math.max(de,er),q[1]=Math.min(Re,Lr),q[2]=Math.min(Ge,br),q[3]=Math.max(vt,ur),q},Pr.prototype.getLeftEyeVisibleScreenRect=function(I){var k=this.viewer,X=this.device,q=k.screenLensDistance,de=(X.widthMeters-k.interLensDistance)/2,Re=k.baselineLensDistance-X.bevelMeters,Ge=(I[0]*q+de)/X.widthMeters,vt=(I[1]*q+Re)/X.heightMeters,pt=(I[2]*q+de)/X.widthMeters,We=(I[3]*q+Re)/X.heightMeters;return{x:Ge,y:We,width:pt-Ge,height:vt-We}},Pr.prototype.getFieldOfViewLeftEye=function(I){return I?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},Pr.prototype.getFieldOfViewRightEye=function(I){var k=this.getFieldOfViewLeftEye(I);return{leftDegrees:k.rightDegrees,rightDegrees:k.leftDegrees,upDegrees:k.upDegrees,downDegrees:k.downDegrees}},Pr.prototype.getUndistortedFieldOfViewLeftEye=function(){var I=this.getUndistortedParams_();return{leftDegrees:at*Math.atan(I.outerDist),rightDegrees:at*Math.atan(I.innerDist),downDegrees:at*Math.atan(I.bottomDist),upDegrees:at*Math.atan(I.topDist)}},Pr.prototype.getUndistortedViewportLeftEye=function(){var I=this.getUndistortedParams_(),k=this.viewer,X=this.device,q=k.screenLensDistance,de=X.widthMeters/q,Re=X.heightMeters/q,Ge=X.width/de,vt=X.height/Re,pt=Math.round((I.eyePosX-I.outerDist)*Ge),We=Math.round((I.eyePosY-I.bottomDist)*vt);return{x:pt,y:We,width:Math.round((I.eyePosX+I.innerDist)*Ge)-pt,height:Math.round((I.eyePosY+I.topDist)*vt)-We}},Pr.prototype.getUndistortedParams_=function(){var I=this.viewer,k=this.device,X=this.distortion,q=I.screenLensDistance,de=I.interLensDistance/2/q,Re=k.widthMeters/q,Ge=k.heightMeters/q,vt=Re/2-de,pt=(I.baselineLensDistance-k.bevelMeters)/q,We=I.fov,et=X.distortInverse(Math.tan(An*We)),At=Math.min(vt,et),Ut=Math.min(de,et),Yt=Math.min(pt,et),er=Math.min(Ge-pt,et);return{outerDist:At,innerDist:Ut,topDist:er,bottomDist:Yt,eyePosX:vt,eyePosY:pt}};function $r(I){this.id=I.id,this.label=I.label,this.fov=I.fov,this.interLensDistance=I.interLensDistance,this.baselineLensDistance=I.baselineLensDistance,this.screenLensDistance=I.screenLensDistance,this.distortionCoefficients=I.distortionCoefficients,this.inverseCoefficients=I.inverseCoefficients}Pr.Viewers=cr;var Hr=1,Xn="2019-11-09T17:36:14Z",en=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],Xr={format:Hr,last_updated:Xn,devices:en};function fn(I,k){if(this.dpdb=Xr,this.recalculateDeviceParams_(),I){this.onDeviceParamsUpdated=k;var X=new XMLHttpRequest,q=this;X.open("GET",I,!0),X.addEventListener("load",function(){q.loading=!1,X.status>=200&&X.status<=299?(q.dpdb=JSON.parse(X.response),q.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),X.send()}}fn.prototype.getDeviceParams=function(){return this.deviceParams},fn.prototype.recalculateDeviceParams_=function(){var I=this.calcDeviceParams_();I?(this.deviceParams=I,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},fn.prototype.calcDeviceParams_=function(){var I=this.dpdb;if(!I)return console.error("DPDB not available."),null;if(I.format!=1)return console.error("DPDB has unexpected format version."),null;if(!I.devices||!I.devices.length)return console.error("DPDB does not have a devices section."),null;var k=navigator.userAgent||navigator.vendor||window.opera,X=Rt(),q=Wt();if(!I.devices)return console.error("DPDB has no devices section."),null;for(var de=0;de<I.devices.length;de++){var Re=I.devices[de];if(!Re.rules){console.warn("Device["+de+"] has no rules section.");continue}if(Re.type!="ios"&&Re.type!="android"){console.warn("Device["+de+"] has invalid type.");continue}if(j()==(Re.type=="ios")){for(var Ge=!1,vt=0;vt<Re.rules.length;vt++){var pt=Re.rules[vt];if(this.ruleMatches_(pt,k,X,q)){Ge=!0;break}}if(Ge){var We=Re.dpi[0]||Re.dpi,et=Re.dpi[1]||Re.dpi;return new Mi({xdpi:We,ydpi:et,bevelMm:Re.bw})}}}return console.warn("No DPDB device match."),null},fn.prototype.ruleMatches_=function(I,k,X,q){if(!I.ua&&!I.res||(I.ua&&I.ua.substring(0,2)==="SM"&&(I.ua=I.ua.substring(0,7)),I.ua&&k.indexOf(I.ua)<0))return!1;if(I.res){if(!I.res[0]||!I.res[1])return!1;var de=I.res[0],Re=I.res[1];if(Math.min(X,q)!=Math.min(de,Re)||Math.max(X,q)!=Math.max(de,Re))return!1}return!0};function Mi(I){this.xdpi=I.xdpi,this.ydpi=I.ydpi,this.bevelMm=I.bevelMm}function ai(I,k){this.set(I,k)}ai.prototype.set=function(I,k){this.sample=I,this.timestampS=k},ai.prototype.copy=function(I){this.set(I.sample,I.timestampS)};function rn(I,k){this.kFilter=I,this.isDebug=k,this.currentAccelMeasurement=new ai,this.currentGyroMeasurement=new ai,this.previousGyroMeasurement=new ai,j()?this.filterQ=new Et(-1,0,0,1):this.filterQ=new Et(1,0,0,1),this.previousFilterQ=new Et,this.previousFilterQ.copy(this.filterQ),this.accelQ=new Et,this.isOrientationInitialized=!1,this.estimatedGravity=new nt,this.measuredGravity=new nt,this.gyroIntegralQ=new Et}rn.prototype.addAccelMeasurement=function(I,k){this.currentAccelMeasurement.set(I,k)},rn.prototype.addGyroMeasurement=function(I,k){this.currentGyroMeasurement.set(I,k);var X=k-this.previousGyroMeasurement.timestampS;Mt(X)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},rn.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var I=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,k=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,I);this.gyroIntegralQ.multiply(k),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(k);var X=new Et;X.copy(this.filterQ),X.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(X),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var q=new Et;q.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),q.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",at*Oe(q),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var de=new Et;de.copy(this.filterQ),de.multiply(q),this.filterQ.slerp(de,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},rn.prototype.getOrientation=function(){return this.filterQ},rn.prototype.accelToQuaternion_=function(I){var k=new nt;k.copy(I),k.normalize();var X=new Et;return X.setFromUnitVectors(new nt(0,0,-1),k),X.inverse(),X},rn.prototype.gyroToQuaternionDelta_=function(I,k){var X=new Et,q=new nt;return q.copy(I),q.normalize(),X.setFromAxisAngle(q,I.length()*k),X};function Ui(I,k){this.predictionTimeS=I,this.isDebug=k,this.previousQ=new Et,this.previousTimestampS=null,this.deltaQ=new Et,this.outQ=new Et}Ui.prototype.getPrediction=function(I,k,X){if(!this.previousTimestampS)return this.previousQ.copy(I),this.previousTimestampS=X,I;var q=new nt;q.copy(k),q.normalize();var de=k.length();if(de<An*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(at*de).toFixed(1)),this.outQ.copy(I),this.previousQ.copy(I),this.outQ;var Re=de*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(q,Re),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(I),this.previousTimestampS=X,this.outQ};function ei(I,k,X,q){this.yawOnly=X,this.accelerometer=new nt,this.gyroscope=new nt,this.filter=new rn(I,q),this.posePredictor=new Ui(k,q),this.isFirefoxAndroid=ye(),this.isIOS=j();var de=Ne();this.isDeviceMotionInRadians=!this.isIOS&&de&&de<66,this.isWithoutDeviceMotion=ke()||je(),this.filterToWorldQ=new Et,j()?this.filterToWorldQ.setFromAxisAngle(new nt(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new nt(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new Et,this.worldToScreenQ=new Et,this.originalPoseAdjustQ=new Et,this.originalPoseAdjustQ.setFromAxisAngle(new nt(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),rt()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new Et,this.orientationOut_=new Float32Array(4),this.start()}ei.prototype.getPosition=function(){return null},ei.prototype.getOrientation=function(){var I=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var de=new Et().setFromAxisAngle(new nt(0,0,-1),0),Re=new Et;return window.orientation===-90?Re.setFromAxisAngle(new nt(0,1,0),Math.PI/-2):Re.setFromAxisAngle(new nt(0,1,0),Math.PI/2),de.multiply(Re)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var de=new Et;return de.setFromAxisAngle(new nt(1,0,0),-Math.PI/2),de}(),I=this._deviceOrientationQ;var X=new Et;return X.copy(I),X.multiply(this.deviceOrientationFilterToWorldQ),X.multiply(this.resetQ),X.multiply(this.worldToScreenQ),X.multiplyQuaternions(this.deviceOrientationFixQ,X),this.yawOnly&&(X.x=0,X.z=0,X.normalize()),this.orientationOut_[0]=X.x,this.orientationOut_[1]=X.y,this.orientationOut_[2]=X.z,this.orientationOut_[3]=X.w,this.orientationOut_}else{var k=this.filter.getOrientation();I=this.posePredictor.getPrediction(k,this.gyroscope,this.previousTimestampS)}var X=new Et;return X.copy(this.filterToWorldQ),X.multiply(this.resetQ),X.multiply(I),X.multiply(this.worldToScreenQ),this.yawOnly&&(X.x=0,X.z=0,X.normalize()),this.orientationOut_[0]=X.x,this.orientationOut_[1]=X.y,this.orientationOut_[2]=X.z,this.orientationOut_[3]=X.w,this.orientationOut_},ei.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),rt()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},ei.prototype.onDeviceOrientation_=function(I){this._deviceOrientationQ=this._deviceOrientationQ||new Et;var k=I.alpha,X=I.beta,q=I.gamma;k=(k||0)*Math.PI/180,X=(X||0)*Math.PI/180,q=(q||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(X,k,-q)},ei.prototype.onDeviceMotion_=function(I){this.updateDeviceMotion_(I)},ei.prototype.updateDeviceMotion_=function(I){var k=I.accelerationIncludingGravity,X=I.rotationRate,q=I.timeStamp/1e3,de=q-this.previousTimestampS;if(de<0){Fe("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=q;return}else if(de<=Y||de>ee){Fe("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=q;return}this.accelerometer.set(-k.x,-k.y,-k.z),X&&(it()?this.gyroscope.set(-X.beta,X.alpha,X.gamma):this.gyroscope.set(X.alpha,X.beta,X.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,q)),this.filter.addAccelMeasurement(this.accelerometer,q),this.previousTimestampS=q},ei.prototype.onOrientationChange_=function(I){this.setScreenTransform_()},ei.prototype.onMessage_=function(I){var k=I.data;if(!(!k||!k.type)){var X=k.type.toLowerCase();X==="devicemotion"&&this.updateDeviceMotion_(k.deviceMotionEvent)}},ei.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new nt(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new nt(0,0,1),Math.PI/2);break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},ei.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),j()&&we()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},ei.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var Hi=60,ti=new nt(1,0,0),se=new nt(0,0,1),be=new Et;be.setFromAxisAngle(ti,-Math.PI/2),be.multiply(new Et().setFromAxisAngle(se,Math.PI/2));var Ve=function(){function I(k){F(this,I),this.config=k,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new Et,this._outQ=new Et,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return z(I,[{key:"init",value:function(){var X=null;try{X=new RelativeOrientationSensor({frequency:Hi,referenceFrame:"screen"}),X.addEventListener("error",this._onSensorError)}catch(q){this.errors.push(q),q.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):q.name==="ReferenceError"?this.useDeviceMotion():console.error(q)}X&&(this.api="sensor",this.sensor=X,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new ei(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var X=this.sensor.quaternion;this._sensorQ.set(X[0],X[1],X[2],X[3]);var q=this._outQ;return q.copy(be),q.multiply(this._sensorQ),this.config.YAW_ONLY&&(q.x=q.z=0,q.normalize()),this._out[0]=q.x,this._out[1]=q.y,this._out[2]=q.z,this._out[3]=q.w,this._out}},{key:"_onSensorError",value:function(X){this.errors.push(X.error),X.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):X.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(X.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),I}(),$e="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function Xe(){this.loadIcon_();var I=document.createElement("div"),Ge=I.style;Ge.position="fixed",Ge.top=0,Ge.right=0,Ge.bottom=0,Ge.left=0,Ge.backgroundColor="gray",Ge.fontFamily="sans-serif",Ge.zIndex=1e6;var k=document.createElement("img");k.src=this.icon;var Ge=k.style;Ge.marginLeft="25%",Ge.marginTop="25%",Ge.width="50%",I.appendChild(k);var X=document.createElement("div"),Ge=X.style;Ge.textAlign="center",Ge.fontSize="16px",Ge.lineHeight="24px",Ge.margin="24px 25%",Ge.width="50%",X.innerHTML="Place your phone into your Cardboard viewer.",I.appendChild(X);var q=document.createElement("div"),Ge=q.style;Ge.backgroundColor="#CFD8DC",Ge.position="fixed",Ge.bottom=0,Ge.width="100%",Ge.height="48px",Ge.padding="14px 24px",Ge.boxSizing="border-box",Ge.color="#656A6B",I.appendChild(q);var de=document.createElement("div");de.style.float="left",de.innerHTML="No Cardboard viewer?";var Re=document.createElement("a");Re.href="https://www.google.com/get/cardboard/get-cardboard/",Re.innerHTML="get one",Re.target="_blank";var Ge=Re.style;Ge.float="right",Ge.fontWeight=600,Ge.textTransform="uppercase",Ge.borderLeft="1px solid gray",Ge.paddingLeft="24px",Ge.textDecoration="none",Ge.color="#656A6B",q.appendChild(de),q.appendChild(Re),this.overlay=I,this.text=X,this.hide()}Xe.prototype.show=function(I){!I&&!this.overlay.parentElement?document.body.appendChild(this.overlay):I&&(this.overlay.parentElement&&this.overlay.parentElement!=I&&this.overlay.parentElement.removeChild(this.overlay),I.appendChild(this.overlay)),this.overlay.style.display="block";var k=this.overlay.querySelector("img"),X=k.style;rt()?(X.width="20%",X.marginLeft="40%",X.marginTop="3%"):(X.width="50%",X.marginLeft="25%",X.marginTop="25%")},Xe.prototype.hide=function(){this.overlay.style.display="none"},Xe.prototype.showTemporarily=function(I,k){this.show(k),this.timer=setTimeout(this.hide.bind(this),I)},Xe.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},Xe.prototype.update=function(){this.disableShowTemporarily(),!rt()&&ie()?this.show():this.hide()},Xe.prototype.loadIcon_=function(){this.icon=J("image/svg+xml",$e)};var ft="CardboardV1",Tt="WEBVR_CARDBOARD_VIEWER",Gt="webvr-polyfill-viewer-selector";function Ct(I){try{this.selectedKey=localStorage.getItem(Tt)}catch(k){console.error("Failed to load viewer profile: %s",k)}this.selectedKey||(this.selectedKey=I||ft),this.dialog=this.createDialog_(Pr.Viewers),this.root=null,this.onChangeCallbacks_=[]}Ct.prototype.show=function(I){this.root=I,I.appendChild(this.dialog);var k=this.dialog.querySelector("#"+this.selectedKey);k.checked=!0,this.dialog.style.display="block"},Ct.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},Ct.prototype.getCurrentViewer=function(){return Pr.Viewers[this.selectedKey]},Ct.prototype.getSelectedKey_=function(){var I=this.dialog.querySelector("input[name=field]:checked");return I?I.id:null},Ct.prototype.onChange=function(I){this.onChangeCallbacks_.push(I)},Ct.prototype.fireOnChange_=function(I){for(var k=0;k<this.onChangeCallbacks_.length;k++)this.onChangeCallbacks_[k](I)},Ct.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!Pr.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(Pr.Viewers[this.selectedKey]);try{localStorage.setItem(Tt,this.selectedKey)}catch(I){console.error("Failed to save viewer profile: %s",I)}this.hide()},Ct.prototype.createDialog_=function(I){var k=document.createElement("div");k.classList.add(Gt),k.style.display="none";var X=document.createElement("div"),Re=X.style;Re.position="fixed",Re.left=0,Re.top=0,Re.width="100%",Re.height="100%",Re.background="rgba(0, 0, 0, 0.3)",X.addEventListener("click",this.hide.bind(this));var q=280,de=document.createElement("div"),Re=de.style;Re.boxSizing="border-box",Re.position="fixed",Re.top="24px",Re.left="50%",Re.marginLeft=-q/2+"px",Re.width=q+"px",Re.padding="24px",Re.overflow="hidden",Re.background="#fafafa",Re.fontFamily="'Roboto', sans-serif",Re.boxShadow="0px 5px 20px #666",de.appendChild(this.createH1_("Select your viewer"));for(var Ge in I)de.appendChild(this.createChoice_(Ge,I[Ge].label));return de.appendChild(this.createButton_("Save",this.onSave_.bind(this))),k.appendChild(X),k.appendChild(de),k},Ct.prototype.createH1_=function(I){var k=document.createElement("h1"),X=k.style;return X.color="black",X.fontSize="20px",X.fontWeight="bold",X.marginTop=0,X.marginBottom="24px",k.innerHTML=I,k},Ct.prototype.createChoice_=function(I,k){var X=document.createElement("div");X.style.marginTop="8px",X.style.color="black";var q=document.createElement("input");q.style.fontSize="30px",q.setAttribute("id",I),q.setAttribute("type","radio"),q.setAttribute("value",I),q.setAttribute("name","field");var de=document.createElement("label");return de.style.marginLeft="4px",de.setAttribute("for",I),de.innerHTML=k,X.appendChild(q),X.appendChild(de),X},Ct.prototype.createButton_=function(I,k){var X=document.createElement("button");X.innerHTML=I;var q=X.style;return q.float="right",q.textTransform="uppercase",q.color="#1094f7",q.fontSize="14px",q.letterSpacing=0,q.border=0,q.background="none",q.marginTop="16px",X.addEventListener("click",k),X};var ut=typeof window<"u"?window:typeof w<"u"?w:typeof self<"u"?self:{};function Xt(I){return I&&I.__esModule&&Object.prototype.hasOwnProperty.call(I,"default")?I.default:I}function Kt(I,k){return k={exports:{}},I(k,k.exports),k.exports}var vr=Kt(function(I,k){(function(q,de){I.exports=de()})(ut,function(){return function(X){var q={};function de(Re){if(q[Re])return q[Re].exports;var Ge=q[Re]={i:Re,l:!1,exports:{}};return X[Re].call(Ge.exports,Ge,Ge.exports,de),Ge.l=!0,Ge.exports}return de.m=X,de.c=q,de.d=function(Re,Ge,vt){de.o(Re,Ge)||Object.defineProperty(Re,Ge,{configurable:!1,enumerable:!0,get:vt})},de.n=function(Re){var Ge=Re&&Re.__esModule?function(){return Re.default}:function(){return Re};return de.d(Ge,"a",Ge),Ge},de.o=function(Re,Ge){return Object.prototype.hasOwnProperty.call(Re,Ge)},de.p="",de(de.s=0)}([function(X,q,de){var Re=function(){function et(At,Ut){for(var Yt=0;Yt<Ut.length;Yt++){var er=Ut[Yt];er.enumerable=er.enumerable||!1,er.configurable=!0,"value"in er&&(er.writable=!0),Object.defineProperty(At,er.key,er)}}return function(At,Ut,Yt){return Ut&&et(At.prototype,Ut),Yt&&et(At,Yt),At}}();function Ge(et,At){if(!(et instanceof At))throw new TypeError("Cannot call a class as a function")}var vt=de(1),pt=typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,We=function(){function et(){Ge(this,et),pt?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",vt),this.noSleepVideo.addEventListener("timeupdate",(function(At){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}).bind(this)))}return Re(et,[{key:"enable",value:function(){pt?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){pt?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),et}();X.exports=We},function(X,q,de){X.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),bn=Xt(vr),Gr=1e3,Cr=[0,0,.5,1],Yr=[.5,0,.5,1],Tn=window.requestAnimationFrame,Jn=window.cancelAnimationFrame;function mr(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function Ir(I){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:I.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:I.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:I.canPresent},maxLayers:{writable:!1,enumerable:!0,value:I.maxLayers},hasOrientation:{enumerable:!0,get:function(){return Ye("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),I.hasOrientation}}})}function Br(I){I=I||{};var k="wakelock"in I?I.wakelock:!0;this.isPolyfilled=!0,this.displayId=Gr++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return Ye("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new Ir({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,k&&ie()&&(this.wakelock_=new bn)}Br.prototype.getFrameData=function(I){return ve(I,this._getPose(),this)},Br.prototype.getPose=function(){return Ye("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Br.prototype.resetPose=function(){return Ye("VRDisplay.prototype.resetPose"),this._resetPose()},Br.prototype.getImmediatePose=function(){return Ye("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Br.prototype.requestAnimationFrame=function(I){return Tn(I)},Br.prototype.cancelAnimationFrame=function(I){return Jn(I)},Br.prototype.wrapForFullscreen=function(I){if(j())return I;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var k=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",k.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==I)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=I,this.originalParent_=I.parentElement,this.originalParent_||document.body.appendChild(I),!this.fullscreenWrapper_.parentElement){var X=this.fullscreenElement_.parentElement;X.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),X.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var q=this;function de(){if(q.fullscreenElement_){var Re=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];q.fullscreenElement_.setAttribute("style",Re.join("; ")+";")}}return de(),this.fullscreenWrapper_},Br.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var I=this.fullscreenElement_;this.fullscreenElementCachedStyle_?I.setAttribute("style",this.fullscreenElementCachedStyle_):I.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var k=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(I),this.originalParent_===k?k.insertBefore(I,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(I),k.removeChild(this.fullscreenWrapper_),I}},Br.prototype.requestPresent=function(I){var k=this.isPresenting,X=this;return I instanceof Array||(Ye("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),I=[I]),new Promise(function(q,de){if(!X.capabilities.canPresent){de(new Error("VRDisplay is not capable of presenting."));return}if(I.length==0||I.length>X.capabilities.maxLayers){de(new Error("Invalid number of layers."));return}var Re=I[0];if(!Re.source){q();return}var Ge=Re.leftBounds||Cr,vt=Re.rightBounds||Yr;if(k){var pt=X.layer_;pt.source!==Re.source&&(pt.source=Re.source);for(var We=0;We<4;We++)pt.leftBounds[We]=Ge[We],pt.rightBounds[We]=vt[We];X.wrapForFullscreen(X.layer_.source),X.updatePresent_(),q();return}if(X.layer_={predistorted:Re.predistorted,source:Re.source,leftBounds:Ge.slice(0),rightBounds:vt.slice(0)},X.waitingForPresent_=!1,X.layer_&&X.layer_.source){var et=X.wrapForFullscreen(X.layer_.source),At=function(){var er=wt();X.isPresenting=et===er,X.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(Lr){console.error("screen.orientation.lock() failed due to",Lr.message)}),X.waitingForPresent_=!1,X.beginPresent_(),q()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),X.removeFullscreenWrapper(),X.disableWakeLock(),X.endPresent_(),X.removeFullscreenListeners_()),X.fireVRDisplayPresentChange_()},Ut=function(){X.waitingForPresent_&&(X.removeFullscreenWrapper(),X.removeFullscreenListeners_(),X.disableWakeLock(),X.waitingForPresent_=!1,X.isPresenting=!1,de(new Error("Unable to present.")))};X.addFullscreenListeners_(et,At,Ut),nr(et)?(X.enableWakeLock(),X.waitingForPresent_=!0):(j()||oe())&&(X.enableWakeLock(),X.isPresenting=!0,X.beginPresent_(),X.fireVRDisplayPresentChange_(),q())}!X.waitingForPresent_&&!j()&&(Dr(),de(new Error("Unable to present.")))})},Br.prototype.exitPresent=function(){var I=this.isPresenting,k=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(X,q){I?(!Dr()&&j()&&(k.endPresent_(),k.fireVRDisplayPresentChange_()),oe()&&(k.removeFullscreenWrapper(),k.removeFullscreenListeners_(),k.endPresent_(),k.fireVRDisplayPresentChange_()),X()):q(new Error("Was not presenting to VRDisplay."))})},Br.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Br.prototype.fireVRDisplayPresentChange_=function(){var I=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(I)},Br.prototype.fireVRDisplayConnect_=function(){var I=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(I)},Br.prototype.addFullscreenListeners_=function(I,k,X){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=I,this.fullscreenChangeHandler_=k,this.fullscreenErrorHandler_=X,k&&(document.fullscreenEnabled?I.addEventListener("fullscreenchange",k,!1):document.webkitFullscreenEnabled?I.addEventListener("webkitfullscreenchange",k,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",k,!1):document.msFullscreenEnabled&&I.addEventListener("msfullscreenchange",k,!1)),X&&(document.fullscreenEnabled?I.addEventListener("fullscreenerror",X,!1):document.webkitFullscreenEnabled?I.addEventListener("webkitfullscreenerror",X,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",X,!1):document.msFullscreenEnabled&&I.addEventListener("msfullscreenerror",X,!1))},Br.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var I=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var k=this.fullscreenChangeHandler_;I.removeEventListener("fullscreenchange",k,!1),I.removeEventListener("webkitfullscreenchange",k,!1),document.removeEventListener("mozfullscreenchange",k,!1),I.removeEventListener("msfullscreenchange",k,!1)}if(this.fullscreenErrorHandler_){var X=this.fullscreenErrorHandler_;I.removeEventListener("fullscreenerror",X,!1),I.removeEventListener("webkitfullscreenerror",X,!1),document.removeEventListener("mozfullscreenerror",X,!1),I.removeEventListener("msfullscreenerror",X,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Br.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Br.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Br.prototype.beginPresent_=function(){},Br.prototype.endPresent_=function(){},Br.prototype.submitFrame=function(I){},Br.prototype.getEyeParameters=function(I){return null};var gi={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},pn={LEFT:"left",RIGHT:"right"};function En(I){var k=ae({},gi);I=ae(k,I||{}),Br.call(this,{wakelock:I.MOBILE_WAKE_LOCK}),this.config=I,this.displayName="Cardboard VRDisplay",this.capabilities=new Ir({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new Ve(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new fn(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new Pr(this.dpdb_.getDeviceParams(),I.ADDITIONAL_VIEWERS),this.viewerSelector_=new Ct(I.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new Xe),j()&&window.addEventListener("resize",this.onResize_.bind(this))}return En.prototype=Object.create(Br.prototype),En.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},En.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},En.prototype._getFieldOfView=function(I){var k;if(I==pn.LEFT)k=this.deviceInfo_.getFieldOfViewLeftEye();else if(I==pn.RIGHT)k=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",I),null;return k},En.prototype._getEyeOffset=function(I){var k;if(I==pn.LEFT)k=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(I==pn.RIGHT)k=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",I),null;return k},En.prototype.getEyeParameters=function(I){var k=this._getEyeOffset(I),X=this._getFieldOfView(I),q={offset:k,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(q,"fieldOfView",{enumerable:!0,get:function(){return Ye("VRFieldOfView","VRFrameData's projection matrices"),X}}),q},En.prototype.onDeviceParamsUpdated_=function(I){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(I),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},En.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},En.prototype.beginPresent_=function(){var I=this.layer_.source.getContext("webgl");I||(I=this.layer_.source.getContext("experimental-webgl")),I||(I=this.layer_.source.getContext("webgl2")),I&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(I.canvas.width=Rt()*this.bufferScale_,I.canvas.height=Wt()*this.bufferScale_,this.cardboardUI_=new yn(I)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new yn(I)),this.distorter_=new ne(I,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen((function(k){this.viewerSelector_.show(this.layer_.source.parentElement),k.stopPropagation(),k.preventDefault()}).bind(this),(function(k){this.exitPresent(),k.stopPropagation(),k.preventDefault()}).bind(this)),this.rotateInstructions_&&(rt()&&ie()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},En.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},En.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},En.prototype.submitFrame=function(I){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var k=this.layer_.source.getContext("webgl");k||(k=this.layer_.source.getContext("experimental-webgl")),k||(k=this.layer_.source.getContext("webgl2"));var X=k.canvas;(X.width!=this.lastWidth||X.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=X.width,this.lastHeight=X.height,this.cardboardUI_.render()}},En.prototype.onOrientationChange_=function(I){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},En.prototype.onResize_=function(I){if(this.layer_){var k=this.layer_.source.getContext("webgl");k||(k=this.layer_.source.getContext("experimental-webgl")),k||(k=this.layer_.source.getContext("webgl2"));var X=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];k.canvas.setAttribute("style",X.join("; ")+";"),ge(k.canvas)}},En.prototype.onViewerChanged_=function(I){this.deviceInfo_.setViewer(I),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},En.prototype.fireVRDisplayDeviceParamsChange_=function(){var I=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(I)},En.VRFrameData=mr,En.VRDisplay=Br,En})}),u=A(m),b="0.10.12",g={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function y(R){this.config=f(f({},g),R),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&d())&&(this.enable(),this.getVRDisplays().then(function(O){O&&O[0]&&O[0].fireVRDisplayConnect_&&O[0].fireVRDisplayConnect_()}))}y.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(d()){var R=new u({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(R)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},y.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var R=this.native.VRFrameData,O=new this.native.VRFrameData,F=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(z){if(z instanceof R){F.call(this,z);return}F.call(this,O),z.pose=O.pose,v(O.leftProjectionMatrix,z.leftProjectionMatrix),v(O.rightProjectionMatrix,z.rightProjectionMatrix),v(O.leftViewMatrix,z.leftViewMatrix),v(O.rightViewMatrix,z.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=u.VRDisplay,window.VRFrameData=u.VRFrameData},y.prototype.getVRDisplays=function(){var R=this;return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then(function(O){return O.length>0?O:R.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},y.version=b,y.VRFrameData=u.VRFrameData,y.VRDisplay=u.VRDisplay;var x=Object.freeze({default:y}),L=x&&y||x;typeof w<"u"&&w.window&&(w.document||(w.document=w.window.document),w.navigator||(w.navigator=w.window.navigator));var T=L;return T})}).call(this,typeof Sa<"u"?Sa:typeof self<"u"?self:typeof window<"u"?window:{})},{}],69:[function(M,N,$){var l=/\n/,w=`
`,A=/\s/;N.exports=function(u,b){var g=N.exports.lines(u,b);return g.map(function(y){return u.substring(y.start,y.end)}).join(`
`)},N.exports.lines=function(b,g){if(g=g||{},g.width===0&&g.mode!=="nowrap")return[];b=b||"";var y=typeof g.width=="number"?g.width:Number.MAX_VALUE,x=Math.max(0,g.start||0),L=typeof g.end=="number"?g.end:b.length,T=g.mode,R=g.measure||m;return T==="pre"?v(R,b,x,L,y):f(R,b,x,L,y,T)};function E(u,b,g,y){var x=u.indexOf(b,g);return x===-1||x>y?y:x}function d(u){return A.test(u)}function v(u,b,g,y,x){for(var L=[],T=g,R=g;R<y&&R<b.length;R++){var O=b.charAt(R),F=l.test(O);if(F||R===y-1){var z=F?R:R+1,re=u(b,T,z,x);L.push(re),T=R+1}}return L}function f(u,b,g,y,x,L){var T=[],R=x;for(L==="nowrap"&&(R=Number.MAX_VALUE);g<y&&g<b.length;){for(var O=E(b,w,g,y);g<O&&d(b.charAt(g));)g++;var F=u(b,g,O,R),z=g+(F.end-F.start),re=z+w.length;if(z<O){for(;z>g&&!d(b.charAt(z));)z--;if(z===g)re>g+w.length&&re--,z=re;else for(re=z;z>g&&d(b.charAt(z-w.length));)z--}if(z>=g){var Y=u(b,g,z,R);T.push(Y)}g=re}return T}function m(u,b,g,y){var x=Math.min(y,g-b);return{start:b,end:b+x}}},{}],70:[function(M,N,$){var l=M("global/window"),w=M("is-function"),A=M("parse-headers"),E=M("xtend");N.exports=m,N.exports.default=m,m.XMLHttpRequest=l.XMLHttpRequest||g,m.XDomainRequest="withCredentials"in new m.XMLHttpRequest?m.XMLHttpRequest:l.XDomainRequest,d(["get","put","post","patch","head","delete"],function(y){m[y==="delete"?"del":y]=function(x,L,T){return L=f(x,L,T),L.method=y.toUpperCase(),u(L)}});function d(y,x){for(var L=0;L<y.length;L++)x(y[L])}function v(y){for(var x in y)if(y.hasOwnProperty(x))return!1;return!0}function f(y,x,L){var T=y;return w(x)?(L=x,typeof y=="string"&&(T={uri:y})):T=E(x,{uri:y}),T.callback=L,T}function m(y,x,L){return x=f(y,x,L),u(x)}function u(y){if(typeof y.callback>"u")throw new Error("callback argument missing");var x=!1,L=function(ke,it,rt){x||(x=!0,y.callback(ke,it,rt))};function T(){z.readyState===4&&setTimeout(F,0)}function R(){var je=void 0;if(z.response?je=z.response:je=z.responseText||b(z),Z)try{je=JSON.parse(je)}catch{}return je}function O(je){return clearTimeout(ye),je instanceof Error||(je=new Error(""+(je||"Unknown XMLHttpRequest Error"))),je.statusCode=0,L(je,Ne)}function F(){if(!Y){var je;clearTimeout(ye),y.useXDR&&z.status===void 0?je=200:je=z.status===1223?204:z.status;var ke=Ne,it=null;return je!==0?(ke={body:R(),statusCode:je,method:J,headers:{},url:ee,rawRequest:z},z.getAllResponseHeaders&&(ke.headers=A(z.getAllResponseHeaders()))):it=new Error("Internal XMLHttpRequest Error"),L(it,ke,ke.body)}}var z=y.xhr||null;z||(y.cors||y.useXDR?z=new m.XDomainRequest:z=new m.XMLHttpRequest);var re,Y,ee=z.url=y.uri||y.url,J=z.method=y.method||"GET",ce=y.body||y.data,j=z.headers=y.headers||{},oe=!!y.sync,Z=!1,ye,Ne={body:void 0,headers:{},statusCode:0,method:J,url:ee,rawRequest:z};if("json"in y&&y.json!==!1&&(Z=!0,j.accept||j.Accept||(j.Accept="application/json"),J!=="GET"&&J!=="HEAD"&&(j["content-type"]||j["Content-Type"]||(j["Content-Type"]="application/json"),ce=JSON.stringify(y.json===!0?ce:y.json))),z.onreadystatechange=T,z.onload=F,z.onerror=O,z.onprogress=function(){},z.onabort=function(){Y=!0},z.ontimeout=O,z.open(J,ee,!oe,y.username,y.password),oe||(z.withCredentials=!!y.withCredentials),!oe&&y.timeout>0&&(ye=setTimeout(function(){if(!Y){Y=!0,z.abort("timeout");var je=new Error("XMLHttpRequest timeout");je.code="ETIMEDOUT",O(je)}},y.timeout)),z.setRequestHeader)for(re in j)j.hasOwnProperty(re)&&z.setRequestHeader(re,j[re]);else if(y.headers&&!v(y.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in y&&(z.responseType=y.responseType),"beforeSend"in y&&typeof y.beforeSend=="function"&&y.beforeSend(z),z.send(ce||null),z}function b(y){try{if(y.responseType==="document")return y.responseXML;var x=y.responseXML&&y.responseXML.documentElement.nodeName==="parsererror";if(y.responseType===""&&!x)return y.responseXML}catch{}return null}function g(){}},{"global/window":27,"is-function":33,"parse-headers":47,xtend:72}],71:[function(M,N,$){N.exports=function(){return typeof self.DOMParser<"u"?function(w){var A=new self.DOMParser;return A.parseFromString(w,"application/xml")}:typeof self.ActiveXObject<"u"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(w){var A=new self.ActiveXObject("Microsoft.XMLDOM");return A.async="false",A.loadXML(w),A}:function(w){var A=document.createElement("div");return A.innerHTML=w,A}}()},{}],72:[function(M,N,$){N.exports=w;var l=Object.prototype.hasOwnProperty;function w(){for(var A={},E=0;E<arguments.length;E++){var d=arguments[E];for(var v in d)l.call(d,v)&&(A[v]=d[v])}return A}},{}],73:[function(M,N,$){N.exports={name:"aframe",version:"1.2.0",description:"A web framework for building virtual reality experiences.",homepage:"https://aframe.io/",main:"dist/aframe-master.js",scripts:{browserify:"browserify src/index.js -s 'AFRAME' -p browserify-derequire",build:"shx mkdir -p build/ && npm run browserify -- --debug -t [ envify --INSPECTOR_VERSION dev ] -o build/aframe.js",codecov:"codecov",dev:"npm run build && cross-env INSPECTOR_VERSION=dev node ./scripts/budo -t envify",dist:"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"npm run browserify -s -- --debug | exorcist dist/aframe-master.js.map > dist/aframe-master.js","dist:min":"npm run browserify -s -- --debug -p [ minifyify --map aframe-master.min.js.map --output dist/aframe-master.min.js.map ] -o dist/aframe-master.min.js",docs:"markserv --dir docs --port 9001",preghpages:"node ./scripts/preghpages.js",ghpages:"ghpages -p gh-pages/",lint:"semistandard -v | snazzy","lint:fix":"semistandard --fix",precommit:"npm run lint",prepush:"node scripts/testOnlyCheck.js",prerelease:"node scripts/release.js 1.0.4 1.1.0",start:"npm run dev","start:https":"cross-env SSL=true npm run dev",test:"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"mocha --ui tdd tests/node"},repository:"aframevr/aframe",license:"MIT",files:["dist/*","docs/**/*","src/**/*","vendor/**/*"],dependencies:{"custom-event-polyfill":"^1.0.6",debug:"ngokevin/debug#noTimestamp","deep-assign":"^2.0.0","document-register-element":"dmarcos/document-register-element#8ccc532b7f3744be954574caf3072a5fd260ca90","load-bmfont":"^1.2.3","object-assign":"^4.0.1",present:"0.0.6","promise-polyfill":"^3.1.0","super-animejs":"^3.1.0","super-three":"^0.125.1","three-bmfont-text":"dmarcos/three-bmfont-text#1babdf8507c731a18f8af3b807292e2b9740955e","webvr-polyfill":"^0.10.12"},devDependencies:{browserify:"^13.1.0","browserify-css":"^0.8.4","browserify-derequire":"^0.9.4","browserify-istanbul":"^2.0.0",budo:"^9.2.0",chai:"^3.5.0","chai-shallow-deep-equal":"^1.4.0",chalk:"^1.1.3",codecov:"^1.0.1","cross-env":"^5.0.1",envify:"^3.4.1",exorcist:"^0.4.0",ghpages:"0.0.8","git-rev":"^0.2.1",glob:"^7.1.1",husky:"^0.11.7",istanbul:"^0.4.5",jsdom:"^9.11.0",karma:"1.4.1","karma-browserify":"^5.1.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^1.2.0","karma-mocha":"^1.1.1","karma-mocha-reporter":"^2.1.0","karma-sinon-chai":"1.2.4",lolex:"^1.5.1",markserv:"github:sukima/markserv#feature/fix-broken-websoketio-link",minifyify:"^7.3.3",mocha:"^3.0.2","mozilla-download":"^1.1.1","replace-in-file":"^2.5.3",semistandard:"^9.0.0",shelljs:"^0.7.7",shx:"^0.2.2",sinon:"^1.17.5","sinon-chai":"2.8.0",snazzy:"^5.0.0","too-wordy":"ngokevin/too-wordy",uglifyjs:"^2.4.10","write-good":"^0.9.1"},link:!0,browserify:{transform:["browserify-css","envify"]},semistandard:{ignore:["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},keywords:["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","web-components","webvr"],"browserify-css":{minify:!0},engines:{node:">= 4.6.0",npm:"^2.15.9"}}},{}],74:[function(M,N,$){var l=M("super-animejs"),w=M("../core/component").components,A=M("../core/component").registerComponent,E=M("../lib/three"),d=M("../utils"),v=new E.Color,f=new E.Color,m=d.entity.getComponentProperty,u=d.entity.setComponentProperty,b={},g="color",y="position",x="rotation",L="scale",T="components",R="object3D";N.exports.Component=A("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(j){return j===!0||j==="true"?!0:j===!1||j==="false"?!1:parseInt(j,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var j=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){j.animationIsPlaying=!1,j.el.emit("animationcomplete",j.eventDetail,!1),j.id&&j.el.emit("animationcomplete__"+j.id,j.eventDetail,!1)}}},update:function(j){var oe=this.config,Z=this.data;this.animationIsPlaying=!1,this.data.enabled&&Z.property&&(oe.autoplay=!1,oe.direction=Z.dir,oe.duration=Z.dur,oe.easing=Z.easing,oe.elasticity=Z.elasticity,oe.loop=Z.loop,oe.round=Z.round,this.createAndStartAnimation())},tick:function(j,oe){this.animationIsPlaying&&(this.time+=oe,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var j=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=l(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!(!j.autoplay||j.startEvents&&j.startEvents.length)){if(j.delay){setTimeout(this.beginAnimation,j.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=l(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var j=this.config,oe=this.data,Z=this.el,ye,Ne,je;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){ye=oe.from===""?Y(Z,oe.property):oe.from,je=oe.to,this.setColorConfig(ye,je),ye=this.fromColor,je=this.toColor,this.targetsArray.length=0,this.targetsArray.push(ye),j.targets=this.targetsArray;for(Ne in je)j[Ne]=je[Ne];j.update=function(){var ke={};return function(it){var rt;rt=it.animatables[0].target,!(rt.r===ke.r&&rt.g===ke.g&&rt.b===ke.b)&&ee(Z,oe.property,rt,oe.type)}}()}},updateConfigForDefault:function(){var j=this.config,oe=this.data,Z=this.el,ye,Ne,je,ke;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(oe.from===""?ye=ce(oe)?Y(Z,oe.property):m(Z,oe.property):ye=oe.from,ke=oe.to,je=!isNaN(ye||ke),je?(ye=parseFloat(ye),ke=parseFloat(ke)):(ye=ye&&ye.toString(),ke=ke&&ke.toString()),Ne=oe.to==="true"||oe.to==="false"||oe.to===!0||oe.to===!1,Ne&&(ye=oe.from==="true"||oe.from===!0?1:0,ke=oe.to==="true"||oe.to===!0?1:0),this.targets.aframeProperty=ye,j.targets=this.targets,j.aframeProperty=ke,j.update=function(){var it;return function(rt){var Mt;Mt=rt.animatables[0].target.aframeProperty,Mt!==it&&(it=Mt,Ne&&(Mt=Mt>=1),ce(oe)?ee(Z,oe.property,Mt,oe.type):u(Z,oe.property,Mt))}}())},updateConfigForVector:function(){var j=this.config,oe=this.data,Z=this.el,ye,Ne,je;Ne=oe.from!==""?d.coordinates.parse(oe.from):m(Z,oe.property),je=d.coordinates.parse(oe.to),oe.property===x&&(F(Ne),F(je)),this.targetsArray.length=0,this.targetsArray.push(Ne),j.targets=this.targetsArray;for(ye in je)j[ye]=je[ye];if(oe.property===y||oe.property===x||oe.property===L){j.update=function(){var ke={};return function(it){var rt=it.animatables[0].target;oe.property===L&&(rt.x=Math.max(1e-4,rt.x),rt.y=Math.max(1e-4,rt.y),rt.z=Math.max(1e-4,rt.z)),!(rt.x===ke.x&&rt.y===ke.y&&rt.z===ke.z)&&(ke.x=rt.x,ke.y=rt.y,ke.z=rt.z,Z.object3D[oe.property].set(rt.x,rt.y,rt.z))}}();return}j.update=function(){var ke={};return function(it){var rt=it.animatables[0].target;rt.x===ke.x&&rt.y===ke.y&&rt.z===ke.z||(ke.x=rt.x,ke.y=rt.y,ke.z=rt.z,u(Z,oe.property,rt))}}()},updateConfig:function(){var j;j=O(this.el,this.data.property),ce(this.data)&&this.data.type===g?this.updateConfigForRawColor():j==="vec2"||j==="vec3"||j==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(j){var oe,Z=this.data,ye=this.el,Ne=this;return Z.from!==""||!Z.property.startsWith(T)||(oe=J(Z.property)[1],ye.components[oe])?!1:(ye.addEventListener("componentinitialized",function je(ke){ke.detail.name===oe&&(j(),Ne.animation=l(Ne.config),ye.removeEventListener("componentinitialized",je))}),!0)},stopRelatedAnimations:function(){var j,oe;for(oe in this.el.components)j=this.el.components[oe],oe!==this.attrName&&j.name==="animation"&&j.animationIsPlaying&&j.data.property===this.data.property&&(j.animationIsPlaying=!1)},addEventListeners:function(){var j=this.data,oe=this.el;z(oe,j.startEvents,this.onStartEvent),z(oe,j.pauseEvents,this.pauseAnimation),z(oe,j.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var j=this.data,oe=this.el;re(oe,j.startEvents,this.onStartEvent),re(oe,j.pauseEvents,this.pauseAnimation),re(oe,j.resumeEvents,this.resumeAnimation)},setColorConfig:function(j,oe){v.set(j),f.set(oe),j=this.fromColor,oe=this.toColor,j.r=v.r,j.g=v.g,j.b=v.b,oe.r=f.r,oe.g=f.g,oe.b=f.b}});function O(j,oe){var Z,ye,Ne,je;return Ne=oe.split("."),ye=Ne[0],je=Ne[1],Z=j.components[ye]||w[ye],!Z||je&&!Z.schema[je]?null:je?Z.schema[je].type:Z.schema.type}function F(j){j.x=E.Math.degToRad(j.x),j.y=E.Math.degToRad(j.y),j.z=E.Math.degToRad(j.z)}function z(j,oe,Z){var ye;for(ye=0;ye<oe.length;ye++)j.addEventListener(oe[ye],Z)}function re(j,oe,Z){var ye;for(ye=0;ye<oe.length;ye++)j.removeEventListener(oe[ye],Z)}function Y(j,oe){var Z,ye,Ne;for(ye=J(oe),Ne=j,Z=0;Z<ye.length;Z++)Ne=Ne[ye[Z]];if(Ne===void 0)throw console.log(j),new Error("[animation] property ("+oe+") could not be found");return Ne}function ee(j,oe,Z,ye){var Ne,je,ke,it;for(oe.startsWith("object3D.rotation")&&(Z=E.Math.degToRad(Z)),je=J(oe),it=j,Ne=0;Ne<je.length-1;Ne++)it=it[je[Ne]];if(ke=je[je.length-1],ye===g){"r"in it[ke]?(it[ke].r=Z.r,it[ke].g=Z.g,it[ke].b=Z.b):(it[ke].x=Z.r,it[ke].y=Z.g,it[ke].z=Z.b);return}it[ke]=Z}function J(j){return j in b||(b[j]=j.split(".")),b[j]}function ce(j){return j.isRawProperty||j.property.startsWith(T)||j.property.startsWith(R)}},{"../core/component":131,"../lib/three":179,"../utils":205,"super-animejs":56}],75:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../lib/three");N.exports.Component=l("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var A,E=this.el;A=this.camera=new w.PerspectiveCamera,E.setObject3D("camera",A)},update:function(A){var E=this.data,d=this.camera;d.aspect=E.aspect||window.innerWidth/window.innerHeight,d.far=E.far,d.fov=E.fov,d.near=E.near,d.zoom=E.zoom,d.updateProjectionMatrix(),this.updateActiveCamera(A),this.updateSpectatorCamera(A)},updateActiveCamera:function(A){var E=this.data,d=this.el,v=this.system;A&&A.active===E.active||E.spectator||(E.active&&v.activeCameraEl!==d?v.setActiveCamera(d):!E.active&&v.activeCameraEl===d&&v.disableActiveCamera())},updateSpectatorCamera:function(A){var E=this.data,d=this.el,v=this.system;A&&A.spectator===E.spectator||(E.spectator&&v.spectatorCameraEl!==d?v.setSpectatorCamera(d):!E.spectator&&v.spectatorCameraEl===d&&v.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},{"../core/component":131,"../lib/three":179}],76:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/"),A=w.bind,E={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},d={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},v={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},f={DOWN:["selectstart"],UP:["selectend"]},m="a-mouse-cursor-hover";N.exports.Component=l("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:w.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity"]}},init:function(){var u=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.updateCanvasBounds=w.debounce(function(){u.canvasBounds=u.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=A(this.onCursorDown,this),this.onCursorUp=A(this.onCursorUp,this),this.onIntersection=A(this.onIntersection,this),this.onIntersectionCleared=A(this.onIntersectionCleared,this),this.onMouseMove=A(this.onMouseMove,this),this.onEnterVR=A(this.onEnterVR,this)},update:function(u){this.data.rayOrigin!==u.rayOrigin&&this.updateMouseEventListeners()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var u=this.el;u.removeState(d.HOVERING),u.removeState(d.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(d.HOVERED),this.removeEventListeners()},addEventListeners:function(){var u,b=this.data,g=this.el,y=this;function x(){u=g.sceneEl.canvas,!(b.downEvents.length||b.upEvents.length)&&(v.DOWN.forEach(function(L){u.addEventListener(L,y.onCursorDown)}),v.UP.forEach(function(L){u.addEventListener(L,y.onCursorUp)}))}u=g.sceneEl.canvas,u?x():g.sceneEl.addEventListener("render-target-loaded",x),b.downEvents.forEach(function(L){g.addEventListener(L,y.onCursorDown)}),b.upEvents.forEach(function(L){g.addEventListener(L,y.onCursorUp)}),g.addEventListener("raycaster-intersection",this.onIntersection),g.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),g.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),g.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var u,b=this.data,g=this.el,y=this;u=g.sceneEl.canvas,u&&!b.downEvents.length&&!b.upEvents.length&&(v.DOWN.forEach(function(x){u.removeEventListener(x,y.onCursorDown)}),v.UP.forEach(function(x){u.removeEventListener(x,y.onCursorUp)})),b.downEvents.forEach(function(x){g.removeEventListener(x,y.onCursorDown)}),b.upEvents.forEach(function(x){g.removeEventListener(x,y.onCursorUp)}),g.removeEventListener("raycaster-intersection",this.onIntersection),g.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),u.removeEventListener("mousemove",this.onMouseMove),u.removeEventListener("touchstart",this.onMouseMove),u.removeEventListener("touchmove",this.onMouseMove),g.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),g.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var u,b=this.el;u=b.sceneEl.canvas,u.removeEventListener("mousemove",this.onMouseMove),u.removeEventListener("touchmove",this.onMouseMove),b.setAttribute("raycaster","useWorldCoordinates",!1),this.data.rayOrigin==="mouse"&&(u.addEventListener("mousemove",this.onMouseMove,!1),u.addEventListener("touchmove",this.onMouseMove,!1),b.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var u=new THREE.Vector3,b=new THREE.Vector2,g=new THREE.Vector3,y={origin:g,direction:u};return function(x){var L=this.canvasBounds,T=this.el.sceneEl.camera,R,O,F;T.parent.updateMatrixWorld(),x.type==="touchmove"||x.type==="touchstart"?O=x.touches.item(0):O=x,R=O.clientX-L.left,F=O.clientY-L.top,b.x=R/L.width*2-1,b.y=-(F/L.height)*2+1,g.setFromMatrixPosition(T.matrixWorld),u.set(b.x,b.y,.5).unproject(T).sub(g).normalize(),this.el.setAttribute("raycaster",y),x.type==="touchmove"&&x.preventDefault()}}(),onCursorDown:function(u){this.isCursorDown=!0,this.data.rayOrigin==="mouse"&&u.type==="touchstart"&&(this.onMouseMove(u),this.el.components.raycaster.checkIntersections(),u.preventDefault()),this.twoWayEmit(E.MOUSEDOWN),this.cursorDownEl=this.intersectedEl},onCursorUp:function(u){if(this.isCursorDown){this.isCursorDown=!1;var b=this.data;this.twoWayEmit(E.MOUSEUP),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(E.MOUSEUP,this.intersectedEventDetail)),(!b.fuse||b.rayOrigin==="mouse")&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(E.CLICK),this.cursorDownEl=null,u.type==="touchend"&&u.preventDefault()}},onIntersection:function(u){var b,g=this.el,y,x,L;y=u.detail.els[0]===g?1:0,L=u.detail.intersections[y],x=u.detail.els[y],x&&this.intersectedEl!==x&&(this.intersectedEl&&(b=this.el.components.raycaster.getIntersection(this.intersectedEl),b&&b.distance<=L.distance)||(this.clearCurrentIntersection(!0),this.setIntersection(x,L)))},onIntersectionCleared:function(u){var b=u.detail.clearedEls;b.indexOf(this.intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var u=this.el.sceneEl.xrSession,b=this;u&&this.data.rayOrigin!=="mouse"&&(f.DOWN.forEach(function(g){u.addEventListener(g,b.onCursorDown)}),f.UP.forEach(function(g){u.addEventListener(g,b.onCursorUp)}))},setIntersection:function(u,b){var g=this.el,y=this.data,x=this;this.intersectedEl!==u&&(this.intersectedEl=u,g.addState(d.HOVERING),u.addState(d.HOVERED),this.twoWayEmit(E.MOUSEENTER),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.add(m),!(y.fuseTimeout===0||!y.fuse)&&(g.addState(d.FUSING),this.twoWayEmit(E.FUSING),this.fuseTimeout=setTimeout(function(){g.removeState(d.FUSING),x.twoWayEmit(E.CLICK)},y.fuseTimeout)))},clearCurrentIntersection:function(u){var b,g,y,x=this.el;this.intersectedEl&&(this.intersectedEl.removeState(d.HOVERED),x.removeState(d.HOVERING),x.removeState(d.FUSING),this.twoWayEmit(E.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.remove(m),this.intersectedEl=null,clearTimeout(this.fuseTimeout),u!==!0&&(y=this.el.components.raycaster.intersections,y.length!==0&&(b=y[0].object.el===x?1:0,g=y[b],g&&this.setIntersection(g.object.el,g))))},twoWayEmit:function(u){var b=this.el,g=this.intersectedEl,y;y=this.el.components.raycaster.getIntersection(g),this.eventDetail.intersectedEl=g,this.eventDetail.intersection=y,b.emit(u,this.eventDetail),g&&(this.intersectedEventDetail.intersection=y,g.emit(u,this.intersectedEventDetail))}})},{"../core/component":131,"../utils/":205}],77:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/bind"),A=M("../utils/tracked-controls"),E=A.checkControllerPresentAndSetup,d=A.emitIfAxesChanged,v=A.onButtonEvent,f="https://cdn.aframe.io/controllers/google/",m=f+"vr_controller_daydream.obj",u=f+"vr_controller_daydream.mtl",b=M("../utils/").device.isWebXRAvailable,g="google-daydream",y="Daydream Controller",x=b?g:y,L={axes:{trackpad:[0,1]},buttons:["trackpad","menu","system"]},T={axes:{touchpad:[0,1]},buttons:["none","none","touchpad","menu","system"]},R=b?T:L;N.exports.Component=l("daydream-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:R,bindMethods:function(){this.onModelLoaded=w(this.onModelLoaded,this),this.onControllersUpdate=w(this.onControllersUpdate,this),this.checkIfControllerPresent=w(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=w(this.removeControllersUpdateListener,this),this.onAxisMoved=w(this.onAxisMoved,this)},init:function(){var O=this;this.onButtonChanged=w(this.onButtonChanged,this),this.onButtonDown=function(F){v(F.detail.id,"down",O)},this.onButtonUp=function(F){v(F.detail.id,"up",O)},this.onButtonTouchStart=function(F){v(F.detail.id,"touchstart",O)},this.onButtonTouchEnd=function(F){v(F.detail.id,"touchend",O)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var O=this.el;O.addEventListener("buttonchanged",this.onButtonChanged),O.addEventListener("buttondown",this.onButtonDown),O.addEventListener("buttonup",this.onButtonUp),O.addEventListener("touchstart",this.onButtonTouchStart),O.addEventListener("touchend",this.onButtonTouchEnd),O.addEventListener("model-loaded",this.onModelLoaded),O.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var O=this.el;O.removeEventListener("buttonchanged",this.onButtonChanged),O.removeEventListener("buttondown",this.onButtonDown),O.removeEventListener("buttonup",this.onButtonUp),O.removeEventListener("touchstart",this.onButtonTouchStart),O.removeEventListener("touchend",this.onButtonTouchEnd),O.removeEventListener("model-loaded",this.onModelLoaded),O.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){E(this,x,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var O=this.el,F=this.data;O.setAttribute("tracked-controls",{armModel:F.armModel,hand:F.hand,idPrefix:x,id:x,orientationOffset:F.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:m,mtl:u})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(O){var F=O.detail.model,z;this.data.model&&(z=this.buttonMeshes={},z.menu=F.getObjectByName("AppButton_AppButton_Cylinder.004"),z.system=F.getObjectByName("HomeButton_HomeButton_Cylinder.005"),z.trackpad=F.getObjectByName("TouchPad_TouchPad_Cylinder.003"),z.touchpad=F.getObjectByName("TouchPad_TouchPad_Cylinder.003"),F.position.set(0,0,-.04))},onAxisMoved:function(O){d(this,this.mapping.axes,O)},onButtonChanged:function(O){var F=this.mapping.buttons[O.detail.id];F&&this.el.emit(F+"changed",O.detail.state)},updateModel:function(O,F){this.data.model&&this.updateButtonModel(O,F)},updateButtonModel:function(O,F){var z=this.buttonMeshes;if(!(!z||!z[O])){var re;switch(F){case"down":re=this.data.buttonHighlightColor;break;case"touchstart":re=this.data.buttonTouchedColor;break;default:re=this.data.buttonColor}z[O].material.color.set(re)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],78:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/bind"),A=M("../utils/tracked-controls"),E=A.checkControllerPresentAndSetup,d=A.emitIfAxesChanged,v=A.onButtonEvent,f=M("../utils/").device.isWebXRAvailable,m="https://cdn.aframe.io/controllers/samsung/",u=m+"gear_vr_controller.obj",b=m+"gear_vr_controller.mtl",g="samsung-gearvr",y="Gear VR",x=f?g:y,L={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},T={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad","none","menu"]},R=f?T:L;N.exports.Component=l("gearvr-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:R,bindMethods:function(){this.onModelLoaded=w(this.onModelLoaded,this),this.onControllersUpdate=w(this.onControllersUpdate,this),this.checkIfControllerPresent=w(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=w(this.removeControllersUpdateListener,this),this.onAxisMoved=w(this.onAxisMoved,this)},init:function(){var O=this;this.onButtonChanged=w(this.onButtonChanged,this),this.onButtonDown=function(F){v(F.detail.id,"down",O)},this.onButtonUp=function(F){v(F.detail.id,"up",O)},this.onButtonTouchStart=function(F){v(F.detail.id,"touchstart",O)},this.onButtonTouchEnd=function(F){v(F.detail.id,"touchend",O)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var O=this.el;O.addEventListener("buttonchanged",this.onButtonChanged),O.addEventListener("buttondown",this.onButtonDown),O.addEventListener("buttonup",this.onButtonUp),O.addEventListener("touchstart",this.onButtonTouchStart),O.addEventListener("touchend",this.onButtonTouchEnd),O.addEventListener("model-loaded",this.onModelLoaded),O.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var O=this.el;O.removeEventListener("buttonchanged",this.onButtonChanged),O.removeEventListener("buttondown",this.onButtonDown),O.removeEventListener("buttonup",this.onButtonUp),O.removeEventListener("touchstart",this.onButtonTouchStart),O.removeEventListener("touchend",this.onButtonTouchEnd),O.removeEventListener("model-loaded",this.onModelLoaded),O.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){E(this,x,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var O=this.el,F=this.data;O.setAttribute("tracked-controls",{armModel:F.armModel,hand:F.hand,idPrefix:x,id:x,orientationOffset:F.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:u,mtl:b})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(O){var F=O.detail.model,z;this.data.model&&(z=this.buttonMeshes={},z.trigger=F.children[2],z.trackpad=F.children[1],z.touchpad=F.children[1])},onButtonChanged:function(O){var F=this.mapping.buttons[O.detail.id];F&&this.el.emit(F+"changed",O.detail.state)},onAxisMoved:function(O){d(this,this.mapping.axes,O)},updateModel:function(O,F){this.data.model&&this.updateButtonModel(O,F)},updateButtonModel:function(O,F){var z=this.buttonMeshes;if(!(!z||!z[O])){var re;switch(F){case"down":re=this.data.buttonHighlightColor;break;case"touchstart":re=this.data.buttonTouchedColor;break;default:re=this.data.buttonColor}z[O].material.color.set(re)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],79:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/bind"),A=M("../utils/tracked-controls"),E=A.checkControllerPresentAndSetup,d=A.emitIfAxesChanged,v=A.onButtonEvent,f="generic",m={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};N.exports.Component=l("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},mapping:m,bindMethods:function(){this.onControllersUpdate=w(this.onControllersUpdate,this),this.checkIfControllerPresent=w(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=w(this.removeControllersUpdateListener,this),this.onAxisMoved=w(this.onAxisMoved,this)},init:function(){var u=this;this.onButtonChanged=w(this.onButtonChanged,this),this.onButtonDown=function(b){v(b.detail.id,"down",u)},this.onButtonUp=function(b){v(b.detail.id,"up",u)},this.onButtonTouchStart=function(b){v(b.detail.id,"touchstart",u)},this.onButtonTouchEnd=function(b){v(b.detail.id,"touchend",u)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods(),this.el.addEventListener("controllerconnected",function(b){b.detail.name!==u.name&&(u.wasControllerConnected=!0,u.removeEventListeners(),u.removeControllersUpdateListener())})},addEventListeners:function(){var u=this.el;u.addEventListener("buttonchanged",this.onButtonChanged),u.addEventListener("buttondown",this.onButtonDown),u.addEventListener("buttonup",this.onButtonUp),u.addEventListener("touchstart",this.onButtonTouchStart),u.addEventListener("touchend",this.onButtonTouchEnd),u.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var u=this.el;u.removeEventListener("buttonchanged",this.onButtonChanged),u.removeEventListener("buttondown",this.onButtonDown),u.removeEventListener("buttonup",this.onButtonUp),u.removeEventListener("touchstart",this.onButtonTouchStart),u.removeEventListener("touchend",this.onButtonTouchEnd),u.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var u=this.data,b=u.hand?u.hand:void 0;E(this,f,{hand:b,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var u=this.el,b=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}u.setAttribute("tracked-controls",{hand:b.hand,idPrefix:f,orientationOffset:b.orientationOffset,iterateControllerProfiles:!0}),this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(u){var b=this.mapping.buttons[u.detail.id];b&&this.el.emit(b+"changed",u.detail.state)},onAxisMoved:function(u){d(this,this.mapping.axes,u)},initDefaultModel:function(){var u=this.modelEl=document.createElement("a-entity");u.setAttribute("geometry",{primitive:"sphere",radius:.03}),u.setAttribute("material",{color:this.data.color}),this.el.appendChild(u)}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],80:[function(M,N,$){var l=M("../core/geometry").geometries,w=M("../core/geometry").geometryNames,A=M("../core/component").registerComponent,E=M("../lib/three"),d=new E.BufferGeometry;N.exports.Component=A("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:w,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(v){var f=this.data,m=this.el,u,b=this.system;this.geometry&&(b.unuseGeometry(v),this.geometry=null),this.geometry=b.getOrCreateGeometry(f),u=m.getObject3D("mesh"),u?u.geometry=this.geometry:(u=new E.Mesh,u.geometry=this.geometry,this.el.getAttribute("material")||(u.material=new E.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5})),m.setObject3D("mesh",u))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=d,this.geometry=null},updateSchema:function(v){var f=this.oldData&&this.oldData.primitive,m=v.primitive,u=l[m]&&l[m].schema;if(!u)throw new Error("Unknown geometry schema `"+m+"`");f&&f===m||this.extendSchema(u)}})},{"../core/component":131,"../core/geometry":132,"../lib/three":179}],81:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../lib/three"),A=M("../utils/"),E=A.debug("components:gltf-model:warn");N.exports.Component=l("gltf-model",{schema:{type:"model"},init:function(){var d=this.system.getDRACOLoader();this.model=null,this.loader=new w.GLTFLoader,d&&this.loader.setDRACOLoader(d)},update:function(){var d=this,v=this.el,f=this.data;f&&(this.remove(),this.loader.load(f,function(u){d.model=u.scene||u.scenes[0],d.model.animations=u.animations,v.setObject3D("mesh",d.model),v.emit("model-loaded",{format:"gltf",model:d.model})},void 0,function(u){var b=u&&u.message?u.message:"Failed to load glTF model";E(b),v.emit("model-error",{format:"gltf",src:f})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{"../core/component":131,"../lib/three":179,"../utils/":205}],82:[function(M,N,$){var l=M("../core/component").registerComponent,w={toonLeft:"https://cdn.aframe.io/controllers/hands/leftHand.glb",toonRight:"https://cdn.aframe.io/controllers/hands/rightHand.glb",lowPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandLow.glb",lowPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandLow.glb",highPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandHigh.glb",highPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandHigh.glb"},A={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},E={};E[A.fist]="grip",E[A.thumbUp]="pistol",E[A.point]="pointing",N.exports.Component=l("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},init:function(){var f=this,m=this.el;this.gesture=A.open,this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){f.handleButton("grip","down")},this.onGripUp=function(){f.handleButton("grip","up")},this.onTrackpadDown=function(){f.handleButton("trackpad","down")},this.onTrackpadUp=function(){f.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){f.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){f.handleButton("trackpad","touchend")},this.onTriggerDown=function(){f.handleButton("trigger","down")},this.onTriggerUp=function(){f.handleButton("trigger","up")},this.onTriggerTouchStart=function(){f.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){f.handleButton("trigger","touchend")},this.onGripTouchStart=function(){f.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){f.handleButton("grip","touchend")},this.onThumbstickDown=function(){f.handleButton("thumbstick","down")},this.onThumbstickUp=function(){f.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){f.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){f.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){f.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){f.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){f.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){f.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),m.addEventListener("controllerconnected",this.onControllerConnected),m.addEventListener("controllerdisconnected",this.onControllerDisconnected),m.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(f,m){var u=this.el.getObject3D("mesh");!u||!u.mixer||u.mixer.update(m/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var f=this.el;f.addEventListener("gripdown",this.onGripDown),f.addEventListener("gripup",this.onGripUp),f.addEventListener("trackpaddown",this.onTrackpadDown),f.addEventListener("trackpadup",this.onTrackpadUp),f.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),f.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),f.addEventListener("triggerdown",this.onTriggerDown),f.addEventListener("triggerup",this.onTriggerUp),f.addEventListener("triggertouchstart",this.onTriggerTouchStart),f.addEventListener("triggertouchend",this.onTriggerTouchEnd),f.addEventListener("griptouchstart",this.onGripTouchStart),f.addEventListener("griptouchend",this.onGripTouchEnd),f.addEventListener("thumbstickdown",this.onThumbstickDown),f.addEventListener("thumbstickup",this.onThumbstickUp),f.addEventListener("abuttontouchstart",this.onAorXTouchStart),f.addEventListener("abuttontouchend",this.onAorXTouchEnd),f.addEventListener("bbuttontouchstart",this.onBorYTouchStart),f.addEventListener("bbuttontouchend",this.onBorYTouchEnd),f.addEventListener("xbuttontouchstart",this.onAorXTouchStart),f.addEventListener("xbuttontouchend",this.onAorXTouchEnd),f.addEventListener("ybuttontouchstart",this.onBorYTouchStart),f.addEventListener("ybuttontouchend",this.onBorYTouchEnd),f.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),f.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var f=this.el;f.removeEventListener("gripdown",this.onGripDown),f.removeEventListener("gripup",this.onGripUp),f.removeEventListener("trackpaddown",this.onTrackpadDown),f.removeEventListener("trackpadup",this.onTrackpadUp),f.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),f.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),f.removeEventListener("triggerdown",this.onTriggerDown),f.removeEventListener("triggerup",this.onTriggerUp),f.removeEventListener("triggertouchstart",this.onTriggerTouchStart),f.removeEventListener("triggertouchend",this.onTriggerTouchEnd),f.removeEventListener("griptouchstart",this.onGripTouchStart),f.removeEventListener("griptouchend",this.onGripTouchEnd),f.removeEventListener("thumbstickdown",this.onThumbstickDown),f.removeEventListener("thumbstickup",this.onThumbstickUp),f.removeEventListener("abuttontouchstart",this.onAorXTouchStart),f.removeEventListener("abuttontouchend",this.onAorXTouchEnd),f.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),f.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),f.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),f.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),f.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),f.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),f.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),f.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(f){var m,u=this.el,b=this.data.hand,g=this.data.handModelStyle,y=this.data.color,x=this;if(m={hand:b,model:!1},b!==f){var L=w[g+b.charAt(0).toUpperCase()+b.slice(1)];this.loader.load(L,function(T){var R=T.scene.children[0],O=b==="left"?Math.PI/2:-Math.PI/2;R.mixer=new THREE.AnimationMixer(R),x.clips=T.animations,u.setObject3D("mesh",R);var F=R.children[1].material;F.color=new THREE.Color(y),R.position.set(0,0,0),R.rotation.set(0,0,O),u.setAttribute("magicleap-controls",m),u.setAttribute("vive-controls",m),u.setAttribute("oculus-touch-controls",m),u.setAttribute("windows-motion-controls",m)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(f,m){var u,b=m==="down",g=m==="touchstart";if(m.indexOf("touch")===0){if(g===this.touchedButtons[f])return;this.touchedButtons[f]=g}else{if(b===this.pressedButtons[f])return;this.pressedButtons[f]=b}u=this.gesture,this.gesture=this.determineGesture(),this.gesture!==u&&(this.animateGesture(this.gesture,u),this.emitGestureEvents(this.gesture,u))},determineGesture:function(){var f,m=this.pressedButtons.grip,u=this.pressedButtons.surface||this.touchedButtons.surface,b=this.pressedButtons.trackpad||this.touchedButtons.trackpad,g=this.pressedButtons.trigger||this.touchedButtons.trigger,y=this.touchedButtons.AorX||this.touchedButtons.BorY,x=v(this.el.components["tracked-controls"]);return x?m||g?f=A.fist:b&&(f=A.point):m?u||y||b?f=g?A.fist:A.point:f=g?A.thumbUp:A.pointThumb:g&&(f=A.hold),f},getClip:function(f){var m,u;for(u=0;u<this.clips.length;u++)if(m=this.clips[u],m.name===f)return m},animateGesture:function(f,m){if(f){this.playAnimation(f||A.open,m,!1);return}this.playAnimation(m,m,!0)},emitGestureEvents:function(f,m){var u=this.el,b;m!==f&&(b=d(m,!1),b&&u.emit(b),b=d(f,!0),b&&u.emit(b))},playAnimation:function(f,m,u){var b,g,y=this.el.getObject3D("mesh"),x;if(y){if(y.mixer.stopAllAction(),b=this.getClip(f),x=y.mixer.clipAction(b),x.clampWhenFinished=!0,x.loop=THREE.LoopRepeat,x.repetitions=0,x.timeScale=u?-1:1,x.time=u?b.duration:0,x.weight=1,!m||f===m){y.mixer.stopAllAction(),x.play();return}b=this.getClip(m),g=y.mixer.clipAction(b),g.weight=.15,g.play(),x.play(),g.crossFadeTo(x,.15,!0)}}});function d(f,m){var u;if(f){if(u=E[f],u==="grip")return u+(m?"close":"open");if(u==="point")return u+(m?"up":"down");if(u==="pointing"||u==="pistol")return u+(m?"start":"end")}}function v(f){var m=f&&f.controller,u=m&&(m.id&&m.id.indexOf("OpenVR ")===0||m.profiles&&m.profiles[0]&&m.profiles[0]==="htc-vive-controller-mv");return u}},{"../core/component":131}],83:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/bind"),A=M("../utils/tracked-controls"),E=A.checkControllerPresentAndSetup,d="https://cdn.aframe.io/controllers/oculus-hands/unity/left.glb",v="https://cdn.aframe.io/controllers/oculus-hands/unity/right.glb",f={left:"b_l_",right:"b_r_"},m=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],u={wrist:"wrist","thumb-metacarpal":"thumb1","thumb-phalanx-proximal":"thumb2","thumb-phalanx-distal":"thumb3","thumb-tip":"thumb_null","index-finger-phalanx-proximal":"index1","index-finger-phalanx-intermediate":"index2","index-finger-phalanx-distal":"index3","index-finger-tip":"index_null","middle-finger-phalanx-proximal":"middle1","middle-finger-phalanx-intermediate":"middle2","middle-finger-phalanx-distal":"middle3","middle-finger-tip":"middle_null","ring-finger-phalanx-proximal":"ring1","ring-finger-phalanx-intermediate":"ring2","ring-finger-phalanx-distal":"ring3","ring-finger-tip":"ring_null","pinky-finger-metacarpal":"pinky0","pinky-finger-phalanx-proximal":"pinky1","pinky-finger-phalanx-intermediate":"pinky2","pinky-finger-phalanx-distal":"pinky3","pinky-finger-tip":"pinky_null"},b=.015,g=.03,y=.5;N.exports.Component=l("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"}},bindMethods:function(){this.onControllersUpdate=w(this.onControllersUpdate,this),this.checkIfControllerPresent=w(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=w(this.removeControllersUpdateListener,this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var x=0;x<this.jointEls.length;++x)this.jointEls[x].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var x=0;x<this.jointEls.length;++x)this.jointEls[x].object3D.visible=!1},init:function(){var x=this.el.sceneEl,L=x.getAttribute("webxr").optionalFeatures;L.push("hand-tracking"),x.setAttribute("webxr",{optionalFeatures:L}),this.onModelLoaded=this.onModelLoaded.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3},this.indexTipPosition=new THREE.Vector3,this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace)},updateReferenceSpace:function(){var x=this,L=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,!!L){var T=x.el.sceneEl.systems.webxr.sessionReferenceSpaceType;L.requestReferenceSpace(T).then(function(R){x.referenceSpace=R.getOffsetReferenceSpace(new XRRigidTransform({x:0,y:1.5,z:0}))}).catch(function(R){throw x.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(T,"tracked-controls-webxr uses reference space "+T),R})}},checkIfControllerPresent:function(){var x=this.data,L=x.hand?x.hand:void 0;E(this,"",{hand:L,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var x=this.el.sceneEl,L=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,T=x.frame,R=this.el.components["tracked-controls-webxr"];!L||!T||!R||L.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),T.getJointPose&&this.updateHandModel(),this.detectGesture())},updateHandModel:function(){this.data.modelStyle==="dots"&&this.updateHandDotsModel(),this.data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(x){for(var L=this.bones,T=0;T<L.length;T++)if(L[T].name===x)return L[T];return null},updateHandMeshModel:function(){var x=this.el.sceneEl.frame,L=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,T=this.referenceSpace;if(!(!L||!this.mesh||!T)){this.mesh.visible=!1;for(var R of L.hand.values()){var O,F,z;F=x.getJointPose(R,T),u[R.jointName]&&(O=this.getBone(f[this.data.hand]+u[R.jointName]),O!=null&&F&&(z=F.transform,this.mesh.visible=!0,O.position.copy(z.position).multiplyScalar(100),O.quaternion.set(z.orientation.x,z.orientation.y,z.orientation.z,z.orientation.w)))}}},updateHandDotsModel:function(){var x=this.el.sceneEl.frame,L=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,T=this.el.components["tracked-controls-webxr"],R=T.system.referenceSpace,O,F,z,re=0;for(var Y of L.hand.values())O=this.jointEls[re++],F=O.object3D,z=x.getJointPose(Y,R),O.object3D.visible=!!z,z&&(F.matrix.elements=z.transform.matrix,F.matrix.decompose(F.position,F.rotation,F.scale),O.setAttribute("scale",{x:z.radius,y:z.radius,z:z.radius}))},detectGesture:function(){this.detectPinch()},detectPinch:function(){var x=new THREE.Vector3;return function(){var L=this.el.sceneEl.frame,T=this.indexTipPosition,R=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,O=this.el.components["tracked-controls-webxr"],F=this.referenceSpace||O.system.referenceSpace,z=R.hand.get("index-finger-tip"),re=R.hand.get("thumb-tip");if(!(!z||!re)){var Y=L.getJointPose(z,F),ee=L.getJointPose(re,F);if(!(!Y||!ee)){x.copy(ee.transform.position),T.copy(Y.transform.position);var J=T.distanceTo(x);J<b&&this.isPinched===!1&&(this.isPinched=!0,this.pinchEventDetail.position.copy(T).lerp(x,y),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchstarted",this.pinchEventDetail)),J>g&&this.isPinched===!0&&(this.isPinched=!1,this.pinchEventDetail.position.copy(T).lerp(x,y),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchended",this.pinchEventDetail)),this.isPinched&&(this.pinchEventDetail.position.copy(T).lerp(x,y),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchmoved",this.pinchEventDetail)),T.y+=1.5}}}}(),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var x=this.el,L=this.data;x.setAttribute("tracked-controls",{hand:L.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var x;this.checkIfControllerPresent(),x=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,this.el.getObject3D("mesh")&&(!x||!x.hand||!x.hand[0])&&(this.el.getObject3D("mesh").visible=!1)},initDefaultModel:function(){this.el.getObject3D("mesh")||(this.data.modelStyle==="dots"&&this.initDotsModel(),this.data.modelStyle==="mesh"&&this.initMeshHandModel())},initDotsModel:function(){if(this.jointEls.length===0)for(var x=0;x<m.length;++x){var L=this.jointEl=document.createElement("a-entity");L.setAttribute("geometry",{primitive:"sphere",radius:1}),L.setAttribute("material",{color:this.data.modelColor}),L.object3D.visible=!1,this.el.appendChild(L),this.jointEls.push(L)}},initMeshHandModel:function(){var x=this.data.hand==="left"?d:v;this.el.setAttribute("gltf-model",x)},onModelLoaded:function(){var x=this.mesh=this.el.getObject3D("mesh").children[0],L=this.skinnedMesh=x.children[24];this.skinnedMesh&&(this.bones=L.skeleton.bones,this.el.removeObject3D("mesh"),x.position.set(0,1.5,0),x.rotation.set(0,0,0),L.frustumCulled=!1,L.material=new THREE.MeshStandardMaterial({skinning:!0,color:this.data.modelColor}),this.el.setObject3D("mesh",x))}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],84:[function(M,N,$){M("./animation"),M("./camera"),M("./cursor"),M("./daydream-controls"),M("./gearvr-controls"),M("./geometry"),M("./generic-tracked-controller-controls"),M("./gltf-model"),M("./hand-tracking-controls"),M("./hand-controls"),M("./layer"),M("./laser-controls"),M("./light"),M("./line"),M("./link"),M("./look-controls"),M("./magicleap-controls"),M("./material"),M("./obj-model"),M("./oculus-go-controls"),M("./oculus-touch-controls"),M("./position"),M("./raycaster"),M("./rotation"),M("./scale"),M("./shadow"),M("./sound"),M("./text"),M("./tracked-controls"),M("./tracked-controls-webvr"),M("./tracked-controls-webxr"),M("./visible"),M("./valve-index-controls"),M("./vive-controls"),M("./vive-focus-controls"),M("./wasd-controls"),M("./windows-motion-controls"),M("./scene/background"),M("./scene/debug"),M("./scene/device-orientation-permission-ui"),M("./scene/embedded"),M("./scene/inspector"),M("./scene/fog"),M("./scene/keyboard-shortcuts"),M("./scene/pool"),M("./scene/screenshot"),M("./scene/stats"),M("./scene/vr-mode-ui")},{"./animation":74,"./camera":75,"./cursor":76,"./daydream-controls":77,"./gearvr-controls":78,"./generic-tracked-controller-controls":79,"./geometry":80,"./gltf-model":81,"./hand-controls":82,"./hand-tracking-controls":83,"./laser-controls":85,"./layer":86,"./light":87,"./line":88,"./link":89,"./look-controls":90,"./magicleap-controls":91,"./material":92,"./obj-model":93,"./oculus-go-controls":94,"./oculus-touch-controls":95,"./position":96,"./raycaster":97,"./rotation":98,"./scale":99,"./scene/background":100,"./scene/debug":101,"./scene/device-orientation-permission-ui":102,"./scene/embedded":103,"./scene/fog":104,"./scene/inspector":105,"./scene/keyboard-shortcuts":106,"./scene/pool":107,"./scene/screenshot":108,"./scene/stats":109,"./scene/vr-mode-ui":110,"./shadow":111,"./sound":112,"./text":113,"./tracked-controls":116,"./tracked-controls-webvr":114,"./tracked-controls-webxr":115,"./valve-index-controls":117,"./visible":118,"./vive-controls":119,"./vive-focus-controls":120,"./wasd-controls":121,"./windows-motion-controls":122}],85:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/");l("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var A=this.config,E=this.data,d=this.el,v=this,f={hand:E.hand,model:E.model};d.setAttribute("daydream-controls",f),d.setAttribute("gearvr-controls",f),d.setAttribute("magicleap-controls",f),d.setAttribute("oculus-go-controls",f),d.setAttribute("oculus-touch-controls",f),d.setAttribute("valve-index-controls",f),d.setAttribute("vive-controls",f),d.setAttribute("vive-focus-controls",f),d.setAttribute("windows-motion-controls",f),d.setAttribute("generic-tracked-controller-controls",f),d.addEventListener("controllerconnected",m),d.addEventListener("controllerdisconnected",u),d.addEventListener("controllermodelready",function(b){m(b),v.modelReady=!0});function m(b){var g=A[b.detail.name];if(g){var y=w.extend({showLine:!0},g.raycaster||{});b.detail.rayOrigin&&(y.origin=b.detail.rayOrigin.origin,y.direction=b.detail.rayOrigin.direction,y.showLine=!0),b.detail.rayOrigin||!v.modelReady?d.setAttribute("raycaster",y):d.setAttribute("raycaster","showLine",!0),d.setAttribute("cursor",w.extend({fuse:!1},g.cursor))}}function u(){d.setAttribute("raycaster","showLine",!1)}},config:{"daydream-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"gearvr-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:.001,z:0}}},"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},{"../core/component":131,"../utils/":205}],86:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/"),A=w.debug("components:layer:warn");N.exports.Component=l("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var d=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=d.createFramebuffer();var v=this.el.sceneEl.getAttribute("webxr").requiredFeatures;v.push("layers"),this.el.sceneEl.getAttribute("webxr","requiredFeatures",v),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(d){this.data.src!==d.src&&this.updateSrc()},updateSrc:function(){var d=this.data.type;if(this.texture=void 0,d==="quad"){this.loadQuadImage();return}if(d==="monocubemap"||d==="stereocubemap"){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var d=this.data.type,v,f=this.xrGLFactory,m=this.el.sceneEl.frame,u=this.data.src;this.visibilityChanged=!1,this.layer&&(u.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,d==="monocubemap"?(v=f.getSubImage(this.layer,m),this.loadCubeMapImage(v.colorTexture,u,0)):(v=f.getSubImage(this.layer,m,"left"),this.loadCubeMapImage(v.colorTexture,u,0),v=f.getSubImage(this.layer,m,"right"),this.loadCubeMapImage(v.colorTexture,u,6)))},loadQuadImage:function(){var d=this.data.src,v=this;this.el.sceneEl.systems.material.loadTexture(d,{src:d},function(m){v.el.sceneEl.renderer.initTexture(m),v.texture=m,d.tagName==="VIDEO"&&setTimeout(function(){v.textureIsVideo=!0},1e3),v.layer&&(v.layer.height=v.data.height/2||v.texture.image.height/1e3,v.layer.width=v.data.width/2||v.texture.image.width/1e3,v.needsRedraw=!0),v.updateQuadPanel()})},preGenerateCubeMapTextures:function(d,v){this.data.type==="monocubemap"?this.generateCubeMapTextures(d,0,v):(this.generateCubeMapTextures(d,0,v),this.generateCubeMapTextures(d,6,v))},generateCubeMapTextures:function(d,v,f){for(var m=this.data,u=this.cubeFaceSize,b=Math.min(d.width,d.height),g=[],y,x,L=0;L<6;L++){var T=document.createElement("CANVAS");T.width=T.height=u;var R=T.getContext("2d");m.rotateCubemap&&(L===2||L===3)&&(R.save(),R.translate(u,u),R.rotate(Math.PI)),R.drawImage(d,(L+v)*b,0,b,b,0,0,u,u),R.restore(),f&&f(),g.push(T)}return m.rotateCubemap&&(y=g[0],x=g[1],g[0]=x,g[1]=y,y=g[4],x=g[5],g[4]=x,g[5]=y),f&&f(),g},loadCubeMapImage:function(d,v,f){var m=this.el.sceneEl.renderer.getContext(),u;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,!1),m.bindTexture(m.TEXTURE_CUBE_MAP,d),!v.complete||this.loadingScreen?u=this.loadingScreenImages:u=this.generateCubeMapTextures(v,f);var b=0;u.forEach(function(g,y){m.texSubImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,0,0,m.RGBA,m.UNSIGNED_BYTE,g),b=m.getError()}),b!==0&&console.log("renderingError, WebGL Error Code: "+b),m.bindTexture(m.TEXTURE_CUBE_MAP,null)},tick:function(){this.el.sceneEl.xrSession&&(!this.layer&&this.el.sceneEl.is("vr-mode")&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),!(!this.needsRedraw&&!this.layer.needsRedraw&&!this.textureIsVideo)&&(this.data.type==="quad"&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var d=this,v=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(f){d.visibilityChanged=f.session.visibilityState!=="hidden"},v==="quad"){this.initQuadLayer();return}if(v==="monocubemap"||v==="stereocubemap"){this.initCubeMapLayer();return}},initQuadLayer:function(){var d=this.el.sceneEl,v=d.renderer.getContext(),f=this.xrGLFactory=new XRWebGLBinding(d.xrSession,v);this.texture&&(this.layer=f.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),d.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var d=this.data.src,v=this.el.sceneEl,f=v.renderer.getContext(),m=f.getParameter(f.MAX_CUBE_MAP_TEXTURE_SIZE),u=this.cubeFaceSize=Math.min(m,Math.min(d.width,d.height)),b=this.xrGLFactory=new XRWebGLBinding(v.xrSession,f);this.layer=b.createCubeLayer({space:this.referenceSpace,viewPixelWidth:u,viewPixelHeight:u,layout:this.data.type==="monocubemap"?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),v.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var d=this.cubeFaceSize,v=this.loadingScreenImages=[],f=0;f<6;f++){var m=document.createElement("CANVAS");m.width=m.height=d;var u=m.getContext("2d");m.width=m.height=d,u.fillStyle="black",u.fillRect(0,0,d,d),f!==2&&f!==3&&(u.translate(d,0),u.scale(-1,1),u.fillStyle="white",u.font="30px Arial",u.fillText("Loading",d/2,d/2)),v.push(m)}},destroyLayer:function(){this.layer&&(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(d){this.layerEnabled=d,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var d=this.quadPanelEl;this.quadPanelEl||(d=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(d)),d.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),d.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){var d=this.el.sceneEl,v=this.el.sceneEl.renderer.getContext(),f=this.xrGLFactory.getSubImage(this.layer,d.frame),m=d.renderer.properties.get(this.texture).__webglTexture,u=v.getParameter(v.FRAMEBUFFER_BINDING);v.viewport(f.viewport.x,f.viewport.y,f.viewport.width,f.viewport.height),v.bindFramebuffer(v.FRAMEBUFFER,this.frameBuffer),v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,f.colorTexture,0),E(v,m,f,this.data.src),v.bindFramebuffer(v.FRAMEBUFFER,u)},updateTransform:function(){var d=this.el,v=this.position,f=this.quaternion;d.object3D.updateMatrixWorld(),v.setFromMatrixPosition(d.object3D.matrixWorld),f.setFromRotationMatrix(d.object3D.matrixWorld),this.layerEnabled||v.set(0,0,1e8),this.layer.transform=new XRRigidTransform(v,f)},onEnterVR:function(){var d=this.el.sceneEl,v=d.xrSession;if(!d.hasWebXR||!XRWebGLBinding||!v){A("The layer component requires WebXR and the layers API enabled");return}v.requestReferenceSpace("local").then(this.onRequestedReferenceSpace),this.needsRedraw=!0,this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(d){this.referenceSpace=d}});function E(d,v,f,m){var u=d.createFramebuffer();let b=f.viewport.x,g=f.viewport.y,y=f.viewport.x+f.viewport.width,x=f.viewport.y+f.viewport.height;m.tagName==="VIDEO"&&(d.bindTexture(d.TEXTURE_2D,v),d.texSubImage2D(d.TEXTURE_2D,0,0,0,m.width,m.height,d.RGB,d.UNSIGNED_BYTE,m)),d.bindFramebuffer(d.READ_FRAMEBUFFER,u),d.framebufferTexture2D(d.READ_FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,v,0),d.readBuffer(d.COLOR_ATTACHMENT0),d.blitFramebuffer(0,0,m.width,m.height,b,g,y,x,d.COLOR_BUFFER_BIT,d.NEAREST),d.bindFramebuffer(d.READ_FRAMEBUFFER,null),d.deleteFramebuffer(u)}},{"../core/component":131,"../utils/":205}],87:[function(M,N,$){var l=M("../utils/bind"),w=M("../utils").diff,A=M("../utils/debug"),E=M("../core/component").registerComponent,d=M("../lib/three"),v=d.Math.degToRad,f=A("components:light:warn");N.exports.Component=E("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color"},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var m=this.el;this.light=null,this.defaultTarget=null,this.rendererSystem=this.el.sceneEl.systems.renderer,this.system.registerLight(m)},update:function(m){var u=this.data,b=w(u,m),g=this.light,y=this.rendererSystem,x=this;if(g&&!("type"in b)){var L=!1;Object.keys(b).forEach(function(T){var R=u[T];switch(T){case"color":{g.color.set(R),y.applyColorCorrection(g.color);break}case"groundColor":{g.groundColor.set(R),y.applyColorCorrection(g.groundColor);break}case"angle":{g.angle=v(R);break}case"target":{R===null?(u.type==="spot"||u.type==="directional")&&(g.target=x.defaultTarget):R.hasLoaded?x.onSetTarget(R,g):R.addEventListener("loaded",l(x.onSetTarget,x,R,g));break}case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":L||(x.updateShadow(),L=!0);break;default:g[T]=R}});return}this.setLight(this.data),this.updateShadow()},setLight:function(m){var u=this.el,b=this.getLight(m);b&&(this.light&&u.removeObject3D("light"),this.light=b,this.light.el=u,u.setObject3D("light",this.light),(m.type==="spot"||m.type==="directional"||m.type==="hemisphere")&&u.getObject3D("light").translateY(-1),m.type==="spot"&&(u.setObject3D("light-target",this.defaultTarget),u.getObject3D("light-target").position.set(0,0,-1)))},updateShadow:function(){var m=this.el,u=this.data,b=this.light;b.castShadow=u.castShadow;var g=m.getObject3D("cameraHelper");if(u.shadowCameraVisible&&!g?m.setObject3D("cameraHelper",new d.CameraHelper(b.shadow.camera)):!u.shadowCameraVisible&&g&&m.removeObject3D("cameraHelper"),!u.castShadow)return b;b.shadow.bias=u.shadowBias,b.shadow.radius=u.shadowRadius,b.shadow.mapSize.height=u.shadowMapHeight,b.shadow.mapSize.width=u.shadowMapWidth,b.shadow.camera.near=u.shadowCameraNear,b.shadow.camera.far=u.shadowCameraFar,b.shadow.camera instanceof d.OrthographicCamera?(b.shadow.camera.top=u.shadowCameraTop,b.shadow.camera.right=u.shadowCameraRight,b.shadow.camera.bottom=u.shadowCameraBottom,b.shadow.camera.left=u.shadowCameraLeft):b.shadow.camera.fov=u.shadowCameraFov,b.shadow.camera.updateProjectionMatrix(),g&&g.update()},getLight:function(m){var u=m.angle,b=new d.Color(m.color);this.rendererSystem.applyColorCorrection(b),b=b.getHex();var g=m.decay,y=m.distance,x=new d.Color(m.groundColor);this.rendererSystem.applyColorCorrection(x),x=x.getHex();var L=m.intensity,T=m.type,R=m.target,O=null;switch(T.toLowerCase()){case"ambient":return new d.AmbientLight(b,L);case"directional":return O=new d.DirectionalLight(b,L),this.defaultTarget=O.target,R&&(R.hasLoaded?this.onSetTarget(R,O):R.addEventListener("loaded",l(this.onSetTarget,this,R,O))),O;case"hemisphere":return new d.HemisphereLight(b,x,L);case"point":return new d.PointLight(b,L,y,g);case"spot":return O=new d.SpotLight(b,L,y,v(u),m.penumbra,g),this.defaultTarget=O.target,R&&(R.hasLoaded?this.onSetTarget(R,O):R.addEventListener("loaded",l(this.onSetTarget,this,R,O))),O;default:f("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",T)}},onSetTarget:function(m,u){u.target=m.object3D},remove:function(){var m=this.el;m.removeObject3D("light"),m.getObject3D("cameraHelper")&&m.removeObject3D("cameraHelper")}})},{"../core/component":131,"../lib/three":179,"../utils":205,"../utils/bind":199,"../utils/debug":201}],88:[function(M,N,$){var l=M("../core/component").registerComponent;N.exports.Component=l("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var A=this.data,E,d;this.rendererSystem=this.el.sceneEl.systems.renderer,d=this.material=new THREE.LineBasicMaterial({color:A.color,opacity:A.opacity,transparent:A.opacity<1,visible:A.visible}),E=this.geometry=new THREE.BufferGeometry,E.setAttribute("position",new THREE.BufferAttribute(new Float32Array(2*3),3)),this.rendererSystem.applyColorCorrection(d.color),this.line=new THREE.Line(E,d),this.el.setObject3D(this.attrName,this.line)},update:function(A){var E=this.data,d=this.geometry,v=!1,f=this.material,m=d.attributes.position.array;w(E.start,A.start)||(m[0]=E.start.x,m[1]=E.start.y,m[2]=E.start.z,v=!0),w(E.end,A.end)||(m[3]=E.end.x,m[4]=E.end.y,m[5]=E.end.z,v=!0),v&&(d.attributes.position.needsUpdate=!0,d.computeBoundingSphere()),f.color.setStyle(E.color),this.rendererSystem.applyColorCorrection(f.color),f.opacity=E.opacity,f.transparent=E.opacity<1,f.visible=E.visible},remove:function(){this.el.removeObject3D("line",this.line)}});function w(A,E){return!A||!E?!1:A.x===E.x&&A.y===E.y&&A.z===E.z}},{"../core/component":131}],89:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../core/shader").registerShader,A=M("../lib/three");N.exports.Component=l("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new A.Quaternion,this.hiddenEls=[]},update:function(E){var d=this.data,v=this.el,f,m;d.visualAspectEnabled&&(this.initVisualAspect(),f=d.highlighted?d.highlightedColor:d.backgroundColor,m=d.highlighted?d.highlightedColor:d.borderColor,v.setAttribute("material","backgroundColor",f),v.setAttribute("material","strokeColor",m),d.on!==E.on&&this.updateEventListener(),E.peekMode!==void 0&&d.peekMode!==E.peekMode&&this.updatePeekMode(),!(!d.image||E.image===d.image)&&v.setAttribute("material","pano",typeof d.image=="string"?d.image:d.image.src))},updatePeekMode:function(){var E=this.el,d=this.sphereEl;this.data.peekMode?(this.hideAll(),E.getObject3D("mesh").visible=!1,d.setAttribute("visible",!0)):(this.showAll(),E.getObject3D("mesh").visible=!0,d.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var E=this.el;E.isPlaying&&(this.removeEventListener(),E.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var E=this.data.on;E&&this.el.removeEventListener(E,this.navigate)},initVisualAspect:function(){var E=this.el,d,v,f;!this.data.visualAspectEnabled||this.visualAspectInitialized||(f=this.textEl=this.textEl||document.createElement("a-entity"),v=this.sphereEl=this.sphereEl||document.createElement("a-entity"),d=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),E.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),E.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),f.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),f.setAttribute("position","0 1.5 0"),E.appendChild(f),d.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),d.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),d.setAttribute("rotation","0 180 0"),d.setAttribute("position","0 0 0"),d.setAttribute("visible",!1),E.appendChild(d),v.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),v.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),v.setAttribute("visible",!1),E.appendChild(v),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:function(){var E=new A.Vector3,d=new A.Vector3,v=new A.Quaternion,f=new A.Vector3;return function(){var m=this.el,u=m.object3D,b=m.sceneEl.camera,g,y,x=this.textEl;if(this.data.visualAspectEnabled)if(u.updateMatrixWorld(),b.parent.updateMatrixWorld(),b.updateMatrixWorld(),u.matrix.decompose(d,v,f),d.setFromMatrixPosition(u.matrixWorld),E.setFromMatrixPosition(b.matrixWorld),y=d.distanceTo(E),y>20)this.previousQuaternion||(this.quaternionClone.copy(v),this.previousQuaternion=this.quaternionClone),u.lookAt(E);else{if(g=this.calculateCameraPortalOrientation(),y<.5){if(this.semiSphereEl.getAttribute("visible")===!0)return;x.setAttribute("text","width",1.5),g<=0?(x.setAttribute("position","0 0 0.75"),x.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(x.setAttribute("position","0 0 -0.75"),x.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),m.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=g}else g<=0?x.setAttribute("rotation","0 180 0"):x.setAttribute("rotation","0 0 0"),x.setAttribute("text","width",5),x.setAttribute("position","0 1.5 0"),m.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(u.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}(),hideAll:function(){var E=this.el,d=this.hiddenEls,v=this;d.length>0||E.sceneEl.object3D.traverse(function(f){f&&f.el&&f.el.hasAttribute("link-controls")||!f.el||f===E.sceneEl.object3D||f.el===E||f.el===v.sphereEl||f.el===E.sceneEl.cameraEl||f.el.getAttribute("visible")===!1||f.el===v.textEl||f.el===v.semiSphereEl||(f.el.setAttribute("visible",!1),d.push(f.el))})},showAll:function(){this.hiddenEls.forEach(function(E){E.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var E=new A.Matrix4,d=new A.Vector3,v=new A.Vector3(0,0,1),f=new A.Vector3(0,0,0);return function(){var m=this.el,u=m.sceneEl.camera;return d.set(0,0,0),v.set(0,0,1),f.set(0,0,0),m.object3D.matrixWorld.extractRotation(E),v.applyMatrix4(E),m.object3D.updateMatrixWorld(),m.object3D.localToWorld(f),u.parent.parent.updateMatrixWorld(),u.parent.updateMatrixWorld(),u.updateMatrixWorld(),u.localToWorld(d),d.sub(f).normalize(),v.normalize(),Math.sign(v.dot(d))}}(),remove:function(){this.removeEventListener()}}),w("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join(`
`)})},{"../core/component":131,"../core/shader":141,"../lib/three":179}],90:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../lib/three"),A=M("../utils/"),E=A.bind,d=Math.PI/2;N.exports.Component=l("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new w.Vector3,this.hmdQuaternion=new w.Quaternion,this.magicWindowAbsoluteEuler=new w.Euler,this.magicWindowDeltaEuler=new w.Euler,this.position=new w.Vector3,this.magicWindowObject=new w.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new w.Vector3,rotation:new w.Euler},this.el.sceneEl.is("vr-mode")&&this.onEnterVR()},setupMagicWindowControls:function(){var v,f=this.data;A.device.isMobile()&&(v=this.magicWindowControls=new w.DeviceOrientationControls(this.magicWindowObject),typeof DeviceOrientationEvent<"u"&&DeviceOrientationEvent.requestPermission&&(v.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?v.enabled=f.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){v.enabled=f.magicWindowTrackingEnabled})))},update:function(v){var f=this.data;f.enabled!==v.enabled&&this.updateGrabCursor(f.enabled),v&&!f.magicWindowTrackingEnabled&&v.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=f.magicWindowTrackingEnabled),v&&!f.pointerLockEnabled!==v.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(v){var f=this.data;f.enabled&&this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=E(this.onMouseDown,this),this.onMouseMove=E(this.onMouseMove,this),this.onMouseUp=E(this.onMouseUp,this),this.onTouchStart=E(this.onTouchStart,this),this.onTouchMove=E(this.onTouchMove,this),this.onTouchEnd=E(this.onTouchEnd,this),this.onEnterVR=E(this.onEnterVR,this),this.onExitVR=E(this.onExitVR,this),this.onPointerLockChange=E(this.onPointerLockChange,this),this.onPointerLockError=E(this.onPointerLockError,this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new w.Object3D,this.yawObject=new w.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var v=this.el.sceneEl,f=v.canvas;if(!f){v.addEventListener("render-target-loaded",E(this.addEventListeners,this));return}f.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),f.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",this.onTouchEnd),v.addEventListener("enter-vr",this.onEnterVR),v.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var v=this.el.sceneEl,f=v&&v.canvas;f&&(f.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),f.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),v.removeEventListener("enter-vr",this.onEnterVR),v.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var v=new w.Matrix4;return function(){var f=this.el.object3D,m=this.pitchObject,u=this.yawObject,b,g=this.el.sceneEl;if(g.is("vr-mode")&&g.checkHeadsetConnected()){g.hasWebXR&&(b=g.renderer.xr.getCameraPose(),b&&(v.elements=b.transform.matrix,v.decompose(f.position,f.rotation,f.scale)));return}this.updateMagicWindowOrientation(),f.rotation.x=this.magicWindowDeltaEuler.x+m.rotation.x,f.rotation.y=this.magicWindowDeltaEuler.y+u.rotation.y,f.rotation.z=this.magicWindowDeltaEuler.z}}(),updateMagicWindowOrientation:function(){var v=this.magicWindowAbsoluteEuler,f=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),v.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),!this.previousMagicWindowYaw&&v.y!==0&&(this.previousMagicWindowYaw=v.y),this.previousMagicWindowYaw&&(f.x=v.x,f.y+=v.y-this.previousMagicWindowYaw,f.z=v.z,this.previousMagicWindowYaw=v.y))},onMouseMove:function(v){var f,m,u,b=this.pitchObject,g=this.previousMouseEvent,y=this.yawObject;!this.data.enabled||!this.mouseDown&&!this.pointerLocked||(this.pointerLocked?(m=v.movementX||v.mozMovementX||0,u=v.movementY||v.mozMovementY||0):(m=v.screenX-g.screenX,u=v.screenY-g.screenY),this.previousMouseEvent.screenX=v.screenX,this.previousMouseEvent.screenY=v.screenY,f=this.data.reverseMouseDrag?1:-1,y.rotation.y+=m*.002*f,b.rotation.x+=u*.002*f,b.rotation.x=Math.max(-d,Math.min(d,b.rotation.x)))},onMouseDown:function(v){var f=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||f.is("vr-mode")&&f.checkHeadsetConnected())&&v.button===0){var m=f&&f.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=v.screenX,this.previousMouseEvent.screenY=v.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(m.requestPointerLock?m.requestPointerLock():m.mozRequestPointerLock&&m.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(v){v.touches.length!==1||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||(this.touchStart={x:v.touches[0].pageX,y:v.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(v){var f,m=this.el.sceneEl.canvas,u,b=this.yawObject;!this.touchStarted||!this.data.touchEnabled||(u=2*Math.PI*(v.touches[0].pageX-this.touchStart.x)/m.clientWidth,f=this.data.reverseTouchDrag?1:-1,b.rotation.y-=u*.5*f,this.touchStart={x:v.touches[0].pageX,y:v.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var v=this.el.sceneEl;v.checkHeadsetConnected()&&(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),v.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(v){var f=this.el.sceneEl;function m(){f.canvas.classList.add("a-grab-cursor")}function u(){f.canvas.classList.remove("a-grab-cursor")}if(!f.canvas){v?f.addEventListener("render-target-loaded",m):f.addEventListener("render-target-loaded",u);return}if(v){m();return}u()},saveCameraPose:function(){var v=this.el;this.savedPose.position.copy(v.object3D.position),this.savedPose.rotation.copy(v.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var v=this.el,f=this.savedPose;this.hasSavedPose&&(v.object3D.position.copy(f.position),v.object3D.rotation.copy(f.rotation),this.hasSavedPose=!1)}})},{"../core/component":131,"../lib/three":179,"../utils/":205}],91:[function(M,N,$){var l=M("../utils/bind"),w=M("../core/component").registerComponent,A=M("../utils/tracked-controls"),E=A.checkControllerPresentAndSetup,d=A.emitIfAxesChanged,v=A.onButtonEvent,f="magicleap",m="-one",u=f+m,b="https://cdn.aframe.io/controllers/magicleap/magicleap-one-controller.glb",g={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};N.exports.Component=w("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:g,init:function(){var y=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=l(this.onButtonChanged,this),this.onButtonDown=function(x){v(x.detail.id,"down",y)},this.onButtonUp=function(x){v(x.detail.id,"up",y)},this.onButtonTouchEnd=function(x){v(x.detail.id,"touchend",y)},this.onButtonTouchStart=function(x){v(x.detail.id,"touchstart",y)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var y=this.data;this.controllerIndex=y.hand==="right"?0:y.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=l(this.onModelLoaded,this),this.onControllersUpdate=l(this.onControllersUpdate,this),this.checkIfControllerPresent=l(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=l(this.removeControllersUpdateListener,this),this.onAxisMoved=l(this.onAxisMoved,this)},addEventListeners:function(){var y=this.el;y.addEventListener("buttonchanged",this.onButtonChanged),y.addEventListener("buttondown",this.onButtonDown),y.addEventListener("buttonup",this.onButtonUp),y.addEventListener("touchstart",this.onButtonTouchStart),y.addEventListener("touchend",this.onButtonTouchEnd),y.addEventListener("axismove",this.onAxisMoved),y.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var y=this.el;y.removeEventListener("buttonchanged",this.onButtonChanged),y.removeEventListener("buttondown",this.onButtonDown),y.removeEventListener("buttonup",this.onButtonUp),y.removeEventListener("touchstart",this.onButtonTouchStart),y.removeEventListener("touchend",this.onButtonTouchEnd),y.removeEventListener("axismove",this.onAxisMoved),y.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var y=this.data;E(this,u,{index:this.controllerIndex,hand:y.hand})},injectTrackedControls:function(){var y=this.el,x=this.data;y.setAttribute("tracked-controls",{idPrefix:u,hand:x.hand,controller:this.controllerIndex,orientationOffset:x.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",b)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(y){var x=this.mapping.buttons[y.detail.id],L;x&&(x==="trigger"&&(L=y.detail.state.value,console.log("analog value of trigger press: "+L)),this.el.emit(x+"changed",y.detail.state))},onModelLoaded:function(y){var x=y.detail.model;x.scale.set(.01,.01,.01)},onAxisMoved:function(y){d(this,this.mapping.axes,y)},updateModel:function(y,x){},setButtonColor:function(y,x){}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],92:[function(M,N,$){var l=M("../utils/"),w=M("../core/component"),A=M("../lib/three"),E=M("../core/shader"),d=l.debug("components:material:error"),v=w.registerComponent,f=E.shaders,m=E.shaderNames;N.exports.Component=v("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:m,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColors:{type:"string",default:"none",oneOf:["face","vertex"]},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0}},init:function(){this.material=null},update:function(x){var L=this.data;(!this.shader||L.shader!==x.shader)&&this.updateShader(L.shader),this.shader.update(this.data),this.updateMaterial(x)},updateSchema:function(x){var L,T,R,O;T=x&&x.shader,L=this.oldData&&this.oldData.shader,O=T||L,R=f[O]&&f[O].schema,R||d("Unknown shader schema "+O),!(L&&T===L)&&(this.extendSchema(R),this.updateBehavior())},updateBehavior:function(){var x,L=this.el.sceneEl,T=this.schema,R=this,O;function F(z,re){var Y;for(Y in O)O[Y]=z;R.shader.update(O)}this.tick=void 0,O={};for(x in T)T[x].type==="time"&&(this.tick=F,O[x]=!0);L&&(this.tick?L.addBehavior(this):L.removeBehavior(this))},updateShader:function(x){var L=this.data,T=f[x]&&f[x].Shader,R;if(!T)throw new Error("Unknown shader "+x);R=this.shader=new T,R.el=this.el,R.init(L),this.setMaterial(R.material),this.updateSchema(L)},updateMaterial:function(x){var L=this.data,T=this.material,R;T.alphaTest=L.alphaTest,T.depthTest=L.depthTest!==!1,T.depthWrite=L.depthWrite!==!1,T.opacity=L.opacity,T.flatShading=L.flatShading,T.side=u(L.side),T.transparent=L.transparent!==!1||L.opacity<1,T.vertexColors=b(L.vertexColors),T.visible=L.visible,T.blending=g(L.blending),T.dithering=L.dithering;for(R in x)break;R&&(x.alphaTest!==L.alphaTest||x.side!==L.side||x.vertexColors!==L.vertexColors)&&(T.needsUpdate=!0)},remove:function(){var x=new A.MeshBasicMaterial,L=this.material,T=this.el.getObject3D("mesh");T&&(T.material=x),y(L,this.system)},setMaterial:function(x){var L=this.el,T,R=this.system;this.material&&y(this.material,R),this.material=x,R.registerMaterial(x),T=L.getObject3D("mesh"),T?T.material=x:L.addEventListener("object3dset",function O(F){F.detail.type!=="mesh"||F.target!==L||(L.getObject3D("mesh").material=x,L.removeEventListener("object3dset",O))})}});function u(x){switch(x){case"back":return A.BackSide;case"double":return A.DoubleSide;default:return A.FrontSide}}function b(x){switch(x){case"face":return A.FaceColors;case"vertex":return A.VertexColors;default:return A.NoColors}}function g(x){switch(x){case"none":return A.NoBlending;case"additive":return A.AdditiveBlending;case"subtractive":return A.SubtractiveBlending;case"multiply":return A.MultiplyBlending;default:return A.NormalBlending}}function y(x,L){x.dispose(),L.unregisterMaterial(x)}},{"../core/component":131,"../core/shader":141,"../lib/three":179,"../utils/":205}],93:[function(M,N,$){var l=M("../utils/debug"),w=M("../core/component").registerComponent,A=M("../lib/three"),E=l("components:obj-model:warn");N.exports.Component=w("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var d=this;this.model=null,this.objLoader=new A.OBJLoader,this.mtlLoader=new A.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(v){d.model&&v.detail.name==="material"&&d.applyMaterial()})},update:function(){var d=this.data;d.obj&&(this.resetMesh(),this.loadObj(d.obj,d.mtl))},remove:function(){this.model&&this.resetMesh()},resetMesh:function(){this.el.removeObject3D("mesh")},loadObj:function(d,v){var f=this,m=this.el,u=this.mtlLoader,b=this.objLoader,g=this.el.sceneEl.systems.renderer,y=v.substr(0,v.lastIndexOf("/")+1);if(v){m.hasAttribute("material")&&E("Material component properties are ignored when a .MTL is provided"),u.setResourcePath(y),u.load(v,function(x){x.preload(),b.setMaterials(x),b.load(d,function(L){f.model=L,f.model.traverse(function(T){if(T.isMesh){var R=T.material;R.color&&g.applyColorCorrection(R.color),R.map&&g.applyColorCorrection(R.map),R.emissive&&g.applyColorCorrection(R.emissive),R.emissiveMap&&g.applyColorCorrection(R.emissiveMap)}}),m.setObject3D("mesh",L),m.emit("model-loaded",{format:"obj",model:L})})});return}b.load(d,function(L){f.model=L,f.applyMaterial(),m.setObject3D("mesh",L),m.emit("model-loaded",{format:"obj",model:L})})},applyMaterial:function(){var d=this.el.components.material;d&&this.model.traverse(function(v){v instanceof A.Mesh&&(v.material=d.material)})}})},{"../core/component":131,"../lib/three":179,"../utils/debug":201}],94:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/bind"),A=M("../utils/tracked-controls"),E=A.checkControllerPresentAndSetup,d=A.emitIfAxesChanged,v=A.onButtonEvent,f=M("../utils/").device.isWebXRAvailable,m="oculus-go",u="Oculus Go",b="https://cdn.aframe.io/controllers/oculus/go/oculus-go-controller.gltf",g=f?m:u,y={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},x={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]},L=f?x:y;N.exports.Component=l("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:L,bindMethods:function(){this.onModelLoaded=w(this.onModelLoaded,this),this.onControllersUpdate=w(this.onControllersUpdate,this),this.checkIfControllerPresent=w(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=w(this.removeControllersUpdateListener,this),this.onAxisMoved=w(this.onAxisMoved,this)},init:function(){var T=this;this.onButtonChanged=w(this.onButtonChanged,this),this.onButtonDown=function(R){v(R.detail.id,"down",T)},this.onButtonUp=function(R){v(R.detail.id,"up",T)},this.onButtonTouchStart=function(R){v(R.detail.id,"touchstart",T)},this.onButtonTouchEnd=function(R){v(R.detail.id,"touchend",T)},this.controllerPresent=!1,this.lastControllerCheck=0,this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},addEventListeners:function(){var T=this.el;T.addEventListener("buttonchanged",this.onButtonChanged),T.addEventListener("buttondown",this.onButtonDown),T.addEventListener("buttonup",this.onButtonUp),T.addEventListener("touchstart",this.onButtonTouchStart),T.addEventListener("touchend",this.onButtonTouchEnd),T.addEventListener("model-loaded",this.onModelLoaded),T.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var T=this.el;T.removeEventListener("buttonchanged",this.onButtonChanged),T.removeEventListener("buttondown",this.onButtonDown),T.removeEventListener("buttonup",this.onButtonUp),T.removeEventListener("touchstart",this.onButtonTouchStart),T.removeEventListener("touchend",this.onButtonTouchEnd),T.removeEventListener("model-loaded",this.onModelLoaded),T.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){E(this,g,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var T=this.el,R=this.data;T.setAttribute("tracked-controls",{armModel:R.armModel,hand:R.hand,idPrefix:g,orientationOffset:R.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",b)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(T){var R=T.detail.model,O;this.data.model&&(O=this.buttonMeshes={},O.trigger=R.getObjectByName("oculus_go_button_trigger"),O.trackpad=R.getObjectByName("oculus_go_touchpad"),O.touchpad=R.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(T){var R=this.mapping.buttons[T.detail.id];R&&this.el.emit(R+"changed",T.detail.state)},onAxisMoved:function(T){d(this,this.mapping.axes,T)},updateModel:function(T,R){this.data.model&&this.updateButtonModel(T,R)},updateButtonModel:function(T,R){var O=this.buttonMeshes;if(!(!O||!O[T])){var F,z;switch(R){case"down":F=this.data.buttonHighlightColor;break;case"touchstart":F=this.data.buttonTouchedColor;break;default:F=this.data.buttonColor}z=O[T],z.material.color.set(F),this.rendererSystem.applyColorCorrection(z.material.color)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],95:[function(M,N,$){var l=M("../utils/bind"),w=M("../core/component").registerComponent,A=M("../lib/three"),E=M("../utils/tracked-controls"),d=E.checkControllerPresentAndSetup,v=E.emitIfAxesChanged,f=E.onButtonEvent,m=M("../utils/").device.isWebXRAvailable,u="oculus-touch",b="Oculus Touch",g=m?u:b,y="https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-",x={left:{modelUrl:y+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new A.Vector3(-.005,.003,-.055),modelPivotRotation:new A.Euler(0,0,0)},right:{modelUrl:y+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new A.Vector3(.005,.003,-.055),modelPivotRotation:new A.Euler(0,0,0)}},L={left:{modelUrl:y+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new A.Vector3(-.005,.036,-.037),modelPivotRotation:new A.Euler(Math.PI/4.5,0,0)},right:{modelUrl:y+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new A.Vector3(.005,.036,-.037),modelPivotRotation:new A.Euler(Math.PI/4.5,0,0)}},T=m?L:x,R="oculus-touch",O={"oculus-touch":T,"oculus-touch-v2":{left:{modelUrl:y+"gen2-left.gltf",rayOrigin:{origin:{x:-.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new A.Vector3(0,0,0),modelPivotRotation:new A.Euler(0,0,0)},right:{modelUrl:y+"gen2-right.gltf",rayOrigin:{origin:{x:.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new A.Vector3(0,0,0),modelPivotRotation:new A.Euler(0,0,0)}},"oculus-touch-v3":{left:{modelUrl:y+"v3-left.glb",rayOrigin:{origin:{x:.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new A.Vector3(.01,-.01,.05),modelPivotRotation:new A.Euler(Math.PI/4,0,0)},right:{modelUrl:y+"v3-right.glb",rayOrigin:{origin:{x:-.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new A.Vector3(-.01,-.01,.05),modelPivotRotation:new A.Euler(Math.PI/4,0,0)}}},F={left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},z={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}},re=m?z:F;N.exports.Component=w("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},mapping:re,bindMethods:function(){this.onModelLoaded=l(this.onModelLoaded,this),this.onControllersUpdate=l(this.onControllersUpdate,this),this.checkIfControllerPresent=l(this.checkIfControllerPresent,this),this.onAxisMoved=l(this.onAxisMoved,this)},init:function(){var Y=this;this.onButtonChanged=l(this.onButtonChanged,this),this.onButtonDown=function(ee){f(ee.detail.id,"down",Y,Y.data.hand)},this.onButtonUp=function(ee){f(ee.detail.id,"up",Y,Y.data.hand)},this.onButtonTouchStart=function(ee){f(ee.detail.id,"touchstart",Y,Y.data.hand)},this.onButtonTouchEnd=function(ee){f(ee.detail.id,"touchend",Y,Y.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},addEventListeners:function(){var Y=this.el;Y.addEventListener("buttonchanged",this.onButtonChanged),Y.addEventListener("buttondown",this.onButtonDown),Y.addEventListener("buttonup",this.onButtonUp),Y.addEventListener("touchstart",this.onButtonTouchStart),Y.addEventListener("touchend",this.onButtonTouchEnd),Y.addEventListener("axismove",this.onAxisMoved),Y.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var Y=this.el;Y.removeEventListener("buttonchanged",this.onButtonChanged),Y.removeEventListener("buttondown",this.onButtonDown),Y.removeEventListener("buttonup",this.onButtonUp),Y.removeEventListener("touchstart",this.onButtonTouchStart),Y.removeEventListener("touchend",this.onButtonTouchEnd),Y.removeEventListener("axismove",this.onAxisMoved),Y.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){d(this,g,{hand:this.data.hand})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(Y){var ee=this.data,J;if(ee.model){if(this.displayModel=O[ee.controllerType]||O[R],ee.controllerType==="auto"){var ce=this.el.sceneEl.systems["tracked-controls-webvr"];if(ce&&ce.vrDisplay){var j=ce.vrDisplay.displayName;/^Oculus Quest$/.test(j)&&(this.displayModel=O["oculus-touch-v2"])}else J=R,J=Y.profiles.indexOf("oculus-touch-v2")!==-1?"oculus-touch-v2":J,J=Y.profiles.indexOf("oculus-touch-v3")!==-1?"oculus-touch-v3":J,this.displayModel=O[J]}var oe=this.displayModel[ee.hand].modelUrl;this.el.setAttribute("gltf-model",oe)}},injectTrackedControls:function(Y){var ee=this.data,J=u,ce=ee.hand==="right"?"Oculus Touch (Right)":"Oculus Touch (Left)",j=m?J:ce;this.el.setAttribute("tracked-controls",{id:j,hand:ee.hand,orientationOffset:ee.orientationOffset,handTrackingEnabled:!1}),this.loadModel(Y)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(Y){var ee=this.mapping[this.data.hand].buttons[Y.detail.id],J=this.buttonMeshes,ce;ee&&((ee==="trigger"||ee==="grip")&&(ce=Y.detail.state.value),J&&(ee==="trigger"&&J.trigger&&(J.trigger.rotation.x=this.originalXRotationTrigger-ce*(Math.PI/26)),ee==="grip"&&J.grip&&(J.grip.position.x=this.originalXPositionGrip+(this.data.hand==="left"?-1:1)*ce*.004)),this.el.emit(ee+"changed",Y.detail.state))},onModelLoaded:function(Y){var ee=this.controllerObject3D=Y.detail.model,J;this.data.model&&(J=this.buttonMeshes={},J.grip=ee.getObjectByName("buttonHand"),this.originalXPositionGrip=J.grip&&J.grip.position.x,J.thumbstick=ee.getObjectByName("stick"),J.trigger=ee.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=J.trigger&&J.trigger.rotation.x,J.xbutton=ee.getObjectByName("buttonX"),J.abutton=ee.getObjectByName("buttonA"),J.ybutton=ee.getObjectByName("buttonY"),J.bbutton=ee.getObjectByName("buttonB"),ee.position.copy(this.displayModel[this.data.hand].modelPivotOffset),ee.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin}))},onAxisMoved:function(Y){v(this,this.mapping[this.data.hand].axes,Y)},updateModel:function(Y,ee){this.data.model&&this.updateButtonModel(Y,ee)},updateButtonModel:function(Y,ee){var J,ce=ee==="up"||ee==="touchend"?this.data.buttonColor:ee==="touchstart"?this.data.buttonTouchColor:this.data.buttonHighlightColor,j=this.buttonMeshes;this.data.model&&j&&j[Y]&&(J=j[Y],J.material.color.set(ce),this.rendererSystem.applyColorCorrection(J.material.color))}})},{"../core/component":131,"../lib/three":179,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],96:[function(M,N,$){var l=M("../core/component").registerComponent;N.exports.Component=l("position",{schema:{type:"vec3"},update:function(){var w=this.el.object3D,A=this.data;w.position.set(A.x,A.y,A.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},{"../core/component":131}],97:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../lib/three"),A=M("../utils/"),E=A.debug("components:raycaster:warn"),d=/^[\w\s-.,[\]#]*$/,v={childList:!0,attributes:!0,subtree:!0},f={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared"};N.exports.Component=l("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new w.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new w.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new w.Vector3,this.otherLineEndVec3=new w.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(u){var b=this.data,g=this.el,y=this.raycaster;y.far=b.far,y.near=b.near,b.showLine&&(b.far!==u.far||b.origin!==u.origin||b.direction!==u.direction||!u.showLine)&&(this.unitLineEndVec3.copy(b.origin).add(b.direction).normalize(),this.drawLine()),!b.showLine&&u.showLine&&g.removeAttribute("line"),b.objects!==u.objects&&!d.test(b.objects)&&E('[raycaster] Selector "'+b.objects+'" may not update automatically with DOM changes.'),b.objects||E('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),b.autoRefresh!==u.autoRefresh&&g.isPlaying&&(b.autoRefresh?this.addEventListeners():this.removeEventListeners()),u.enabled&&!b.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){this.data.autoRefresh&&(this.observer.observe(this.el.sceneEl,v),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var u=this.data,b;b=u.objects?this.el.sceneEl.querySelectorAll(u.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(b),this.dirty=!1},tock:function(u){var b=this.data,g=this.prevCheckTime;b.enabled&&(g&&u-g<b.interval||(this.prevCheckTime=u,this.checkIntersections()))},checkIntersections:function(){var u=this.clearedIntersectedEls,b=this.el,g=this.data,y,x=this.intersectedEls,L,T=this.intersections,R=this.newIntersectedEls,O=this.newIntersections,F=this.prevIntersectedEls,z=this.rawIntersections;for(this.dirty&&this.refreshObjects(),m(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),z.length=0,this.raycaster.intersectObjects(this.objects,!0,z),T.length=0,x.length=0,y=0;y<z.length;y++)L=z[y],!(g.showLine&&L.object===b.getObject3D("line"))&&L.object.el&&(T.push(L),x.push(L.object.el));for(O.length=0,R.length=0,y=0;y<T.length;y++)F.indexOf(T[y].object.el)===-1&&(O.push(T[y]),R.push(T[y].object.el));for(u.length=0,y=0;y<F.length;y++)x.indexOf(F[y])===-1&&(F[y].emit(f.INTERSECT_CLEAR,this.intersectedClearedDetail),u.push(F[y]));for(u.length&&b.emit(f.INTERSECTION_CLEAR,this.intersectionClearedDetail),y=0;y<R.length;y++)R[y].emit(f.INTERSECT,this.intersectedDetail);O.length&&(this.intersectionDetail.els=R,this.intersectionDetail.intersections=O,b.emit(f.INTERSECTION,this.intersectionDetail)),g.showLine&&setTimeout(this.updateLine)},updateLine:function(){var u=this.el,b=this.intersections,g;b.length&&(b[0].object.el===u&&b[1]?g=b[1].distance:g=b[0].distance),this.drawLine(g)},getIntersection:function(u){var b,g;for(b=0;b<this.intersections.length;b++)if(g=this.intersections[b],g.object.el===u)return g;return null},updateOriginDirection:function(){var u=new w.Vector3,b=new w.Vector3;return function(){var y=this.el,x=this.data;if(x.useWorldCoordinates){this.raycaster.set(x.origin,x.direction);return}y.object3D.updateMatrixWorld(),b.setFromMatrixPosition(y.object3D.matrixWorld),(x.origin.x!==0||x.origin.y!==0||x.origin.z!==0)&&(b=y.object3D.localToWorld(b.copy(x.origin))),u.copy(x.direction).transformDirection(y.object3D.matrixWorld).normalize(),this.raycaster.set(b,u)}}(),drawLine:function(u){var b=this.data,g=this.el,y;y=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,u===void 0&&(u=b.far===1/0?1e3:b.far),this.lineData.start=b.origin,this.lineData.end=y.copy(this.unitLineEndVec3).multiplyScalar(u),this.lineData.color=b.lineColor,this.lineData.opacity=b.lineOpacity,g.setAttribute("line",this.lineData)},flattenObject3DMaps:function(u){var b,g,y=this.objects;for(y.length=0,g=0;g<u.length;g++)if(u[g].isEntity&&u[g].object3D)for(b in u[g].object3DMap)y.push(u[g].getObject3D(b));return y},clearAllIntersections:function(){var u;for(u=0;u<this.intersectedEls.length;u++)this.intersectedEls[u].emit(f.INTERSECT_CLEAR,this.intersectedClearedDetail);m(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(f.INTERSECTION_CLEAR,this.intersectionClearedDetail)}});function m(u,b){var g;for(u.length=b.length,g=0;g<b.length;g++)u[g]=b[g]}},{"../core/component":131,"../lib/three":179,"../utils/":205}],98:[function(M,N,$){var l=M("../lib/three").Math.degToRad,w=M("../core/component").registerComponent;N.exports.Component=w("rotation",{schema:{type:"vec3"},update:function(){var A=this.data,E=this.el.object3D;E.rotation.set(l(A.x),l(A.y),l(A.z)),E.rotation.order="YXZ"},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},{"../core/component":131,"../lib/three":179}],99:[function(M,N,$){var l=M("../core/component").registerComponent,w=1e-5;N.exports.Component=l("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var A=this.data,E=this.el.object3D,d=A.x===0?w:A.x,v=A.y===0?w:A.y,f=A.z===0?w:A.z;E.scale.set(d,v,f)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},{"../core/component":131}],100:[function(M,N,$){var l=M("../../core/component").registerComponent,w=M("../../core/component").components;N.exports.Component=l("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},update:function(){var A=this.data,E=this.el.object3D;if(A.transparent){E.background=null;return}E.background=new THREE.Color(A.color)},remove:function(){var A=this.data,E=this.el.object3D;if(A.transparent){E.background=null;return}E.background=w[this.name].schema.color.default}})},{"../../core/component":131}],101:[function(M,N,$){var l=M("../../core/component").registerComponent;N.exports.Component=l("debug",{schema:{default:!0}})},{"../../core/component":131}],102:[function(M,N,$){var l=M("../../core/component").registerComponent,w=M("../../utils/"),A=w.bind,E=M("../../constants/"),d="a-modal",v="a-dialog",f="a-dialog-text",m="a-dialog-text-container",u="a-dialog-buttons-container",b="a-dialog-button",g="a-dialog-allow-button",y="a-dialog-deny-button",x="a-dialog-ok-button";N.exports.Component=l("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},mobileDesktopMessage:{default:"Set your browser to request the mobile version of the site and reload the page to enjoy immersive mode."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},init:function(){var O=this;if(this.data.enabled){if(location.hostname!=="localhost"&&location.hostname!=="127.0.0.1"&&location.protocol==="http:"&&this.showHTTPAlert(),w.device.isMobileDeviceRequestingDesktopSite()){this.showMobileDesktopModeAlert();return}if(typeof DeviceOrientationEvent>"u"||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=A(this.onDeviceMotionDialogAllowClicked,this),this.onDeviceMotionDialogDenyClicked=A(this.onDeviceMotionDialogDenyClicked,this),DeviceOrientationEvent.requestPermission().catch(function(){O.devicePermissionDialogEl=L(O.data.denyButtonText,O.data.allowButtonText,O.data.deviceMotionMessage,O.onDeviceMotionDialogAllowClicked,O.onDeviceMotionDialogDenyClicked),O.el.appendChild(O.devicePermissionDialogEl)}).then(function(){O.el.emit("deviceorientationpermissiongranted"),O.permissionGranted=!0})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showMobileDesktopModeAlert:function(){var O=this,F=T(O.data.cancelButtonText,O.data.mobileDesktopMessage,function(){O.el.removeChild(F)});this.el.appendChild(F)},showHTTPAlert:function(){var O=this,F=T(O.data.cancelButtonText,O.data.httpsMessage,function(){O.el.removeChild(F)});this.el.appendChild(F)},onDeviceMotionDialogAllowClicked:function(){var O=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(F){F==="granted"?(O.el.emit("deviceorientationpermissiongranted"),O.permissionGranted=!0):O.el.emit("deviceorientationpermissionrejected"),O.remove()}).catch(console.error)}});function L(O,F,z,re,Y){var ee,J,ce;return ee=document.createElement("div"),ee.classList.add(u),J=document.createElement("button"),J.classList.add(b,y),J.setAttribute(E.AFRAME_INJECTED,""),J.innerHTML=O,ee.appendChild(J),ce=document.createElement("button"),ce.classList.add(b,g),ce.setAttribute(E.AFRAME_INJECTED,""),ce.innerHTML=F,ee.appendChild(ce),ce.addEventListener("click",function(j){j.stopPropagation(),re()}),J.addEventListener("click",function(j){j.stopPropagation(),Y()}),R(z,ee)}function T(O,F,z){var re,Y;return re=document.createElement("div"),re.classList.add(u),Y=document.createElement("button"),Y.classList.add(b,x),Y.setAttribute(E.AFRAME_INJECTED,""),Y.innerHTML=O,re.appendChild(Y),Y.addEventListener("click",function(ee){ee.stopPropagation(),z()}),R(F,re)}function R(O,F){var z,re,Y,ee;return z=document.createElement("div"),z.classList.add(d),z.setAttribute(E.AFRAME_INJECTED,""),re=document.createElement("div"),re.className=v,re.setAttribute(E.AFRAME_INJECTED,""),z.appendChild(re),Y=document.createElement("div"),Y.classList.add(m),re.appendChild(Y),ee=document.createElement("div"),ee.classList.add(f),ee.innerHTML=O,Y.appendChild(ee),re.appendChild(F),z}},{"../../constants/":123,"../../core/component":131,"../../utils/":205}],103:[function(M,N,$){var l=M("../../core/component").registerComponent;N.exports.Component=l("embedded",{dependencies:["vr-mode-ui"],schema:{default:!0},update:function(){var w=this.el,A=w.querySelector(".a-enter-vr");this.data===!0?(A&&A.classList.add("embedded"),w.removeFullScreenStyles()):(A&&A.classList.remove("embedded"),w.addFullScreenStyles())}})},{"../../core/component":131}],104:[function(M,N,$){var l=M("../../core/component").registerComponent,w=M("../../lib/three"),A=M("../../utils/debug"),E=A("components:fog:warn");N.exports.Component=l("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},update:function(){var v=this.data,f=this.el,m=this.el.object3D.fog;if(!f.isScene){E("Fog component can only be applied to <a-scene>");return}if(!m||v.type!==m.name){f.object3D.fog=d(v),f.systems.material.updateMaterials();return}Object.keys(this.schema).forEach(function(u){var b=v[u];u==="color"&&(b=new w.Color(b)),m[u]=b})},remove:function(){var v=this.el.object3D.fog;v&&(v.far=0,v.near=.1)}});function d(v){var f;return v.type==="exponential"?f=new w.FogExp2(v.color,v.density):f=new w.Fog(v.color,v.near,v.far),f.name=v.type,f}},{"../../core/component":131,"../../lib/three":179,"../../utils/debug":201}],105:[function(M,N,$){(function(l){var w=M("../../constants").AFRAME_INJECTED,A=M("../../../package"),E=M("../../core/component").registerComponent,d=M("../../utils/");function v(y){var x=y.split(".");return x[2]="x",x.join(".")}var f="https://aframe.io/aframe-inspector/dist/aframe-inspector.js",m="https://unpkg.com/aframe-inspector@"+v(A.version)+"/dist/aframe-inspector.min.js",u=l.env.INSPECTOR_VERSION==="dev"?f:m,b="Loading Inspector",g="Error loading Inspector";N.exports.Component=E("inspector",{schema:{url:{default:u}},init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var y;this.firstPlay&&(y=d.getUrlParameter("inspector"),y!=="false"&&y&&(this.openInspector(),this.firstPlay=!1))},initOverlay:function(){var y='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML=b+y},remove:function(){this.removeEventListeners()},onKeydown:function(y){var x=y.keyCode===73&&(y.ctrlKey&&y.altKey||y.getModifierState("AltGraph"));x&&this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(y){y.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(y){var x=this,L;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(y);return}this.showLoader(),L=document.createElement("script"),L.src=this.data.url,L.setAttribute("data-name","aframe-inspector"),L.setAttribute(w,""),L.onload=function(){AFRAME.INSPECTOR.open(y),x.hideLoader(),x.removeEventListeners()},L.onerror=function(){x.loadingMessageEl.innerHTML=g},document.head.appendChild(L),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})}).call(this,M("_process"))},{"../../../package":73,"../../constants":123,"../../core/component":131,"../../utils/":205,_process:49}],106:[function(M,N,$){var l=M("../../core/component").registerComponent,w=M("../../utils/").shouldCaptureKeyEvent;N.exports.Component=l("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(A){var E=this.data;this.enterVREnabled=E.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(A){var E=this.el;w(A)&&(this.enterVREnabled&&A.keyCode===70&&E.enterVR(),this.enterVREnabled&&A.keyCode===27&&E.exitVR())}})},{"../../core/component":131,"../../utils/":205}],107:[function(M,N,$){var l=M("../../utils/debug"),w=M("../../core/component").registerComponent,A=l("components:pool:warn");N.exports.Component=w("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},multiple:!0,initPool:function(){var E;for(this.availableEls=[],this.usedEls=[],this.data.mixin||A("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||A("Container "+this.data.container+" not found.")),this.container=this.container||this.el,E=0;E<this.data.size;++E)this.createEntity()},update:function(E){var d=this.data;(E.mixin!==d.mixin||E.size!==d.size)&&this.initPool()},createEntity:function(){var E;E=document.createElement("a-entity"),E.play=this.wrapPlay(E.play),E.setAttribute("mixin",this.data.mixin),E.object3D.visible=!1,E.pause(),this.container.appendChild(E),this.availableEls.push(E)},wrapPlay:function(E){var d=this.usedEls;return function(){d.indexOf(this)!==-1&&E.call(this)}},requestEntity:function(){var E;if(this.availableEls.length===0){if(this.data.dynamic===!1){A("Requested entity from empty pool: "+this.attrName);return}else A("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}return E=this.availableEls.shift(),this.usedEls.push(E),E.object3D.visible=!0,E},returnEntity:function(E){var d=this.usedEls.indexOf(E);if(d===-1){A("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(d,1),this.availableEls.push(E),E.object3D.visible=!1,E.pause(),E}})},{"../../core/component":131,"../../utils/debug":201}],108:[function(M,N,$){var l=M("../../core/component").registerComponent,w=M("../../lib/three"),A=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),E=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join(`
`);N.exports.Component=l("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},init:function(){var d=this.el,v=this;d.renderer?f():d.addEventListener("render-target-loaded",f);function f(){var m=d.renderer.getContext();m&&(v.cubeMapSize=m.getParameter(m.MAX_CUBE_MAP_TEXTURE_SIZE),v.material=new w.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:A,fragmentShader:E,side:w.DoubleSide}),v.quad=new w.Mesh(new w.PlaneBufferGeometry(1,1),v.material),v.quad.visible=!1,v.camera=new w.OrthographicCamera(-1/2,1/2,1/2,-1/2,-1e4,1e4),v.canvas=document.createElement("canvas"),v.ctx=v.canvas.getContext("2d"),d.object3D.add(v.quad),v.onKeyDown=v.onKeyDown.bind(v))}},getRenderTarget:function(d,v){return new w.WebGLRenderTarget(d,v,{minFilter:w.LinearFilter,magFilter:w.LinearFilter,wrapS:w.ClampToEdgeWrapping,wrapT:w.ClampToEdgeWrapping,format:w.RGBAFormat,type:w.UnsignedByteType})},resize:function(d,v){this.quad.scale.set(d,v,1),this.camera.left=-1*d/2,this.camera.right=d/2,this.camera.top=v/2,this.camera.bottom=-1*v/2,this.camera.updateProjectionMatrix(),this.canvas.width=d,this.canvas.height=v},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(d){var v=d.keyCode===83&&d.ctrlKey&&d.altKey;if(!(!this.data||!v)){var f=d.shiftKey?"equirectangular":"perspective";this.capture(f)}},setCapture:function(d){var v=this.el,f,m,u,b;return d==="perspective"?(this.quad.visible=!1,m=this.data.camera&&this.data.camera.components.camera.camera||v.camera,f={width:this.data.width,height:this.data.height}):(m=this.camera,b=new w.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:w.RGBFormat,generateMipmaps:!0,minFilter:w.LinearMipmapLinearFilter,encoding:w.sRGBEncoding}),u=new w.CubeCamera(v.camera.near,v.camera.far,b),v.camera.getWorldPosition(u.position),v.camera.getWorldQuaternion(u.quaternion),u.update(v.renderer,v.object3D),this.quad.material.uniforms.map.value=u.renderTarget.texture,f={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:m,size:f,projection:d}},capture:function(d){var v=this.el.renderer.xr.enabled,f=this.el.renderer,m;f.xr.enabled=!1,m=this.setCapture(d),this.renderCapture(m.camera,m.size,m.projection),this.saveCapture(),f.xr.enabled=v},getCanvas:function(d){var v=this.el.renderer.xr.enabled,f=this.el.renderer,m=this.setCapture(d);return f.xr.enabled=!1,this.renderCapture(m.camera,m.size,m.projection),f.xr.enabled=v,this.canvas},renderCapture:function(d,v,f){var m=this.el.renderer.autoClear,u=this.el,b,g,y,x=u.renderer;g=this.getRenderTarget(v.width,v.height),y=new Uint8Array(4*v.width*v.height),this.resize(v.width,v.height),x.autoClear=!0,x.clear(),x.setRenderTarget(g),x.render(u.object3D,d),x.autoClear=m,x.readRenderTargetPixels(g,0,0,v.width,v.height,y),x.setRenderTarget(null),f==="perspective"&&(y=this.flipPixelsVertically(y,v.width,v.height)),b=new ImageData(new Uint8ClampedArray(y),v.width,v.height),this.quad.visible=!1,this.ctx.putImageData(b,0,0)},flipPixelsVertically:function(d,v,f){for(var m=d.slice(0),u=0;u<v;++u)for(var b=0;b<f;++b)m[u*4+b*v*4]=d[u*4+(f-b)*v*4],m[u*4+1+b*v*4]=d[u*4+1+(f-b)*v*4],m[u*4+2+b*v*4]=d[u*4+2+(f-b)*v*4],m[u*4+3+b*v*4]=d[u*4+3+(f-b)*v*4];return m},saveCapture:function(){this.canvas.toBlob(function(d){var v="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",f=document.createElement("a"),m=URL.createObjectURL(d);f.href=m,f.setAttribute("download",v),f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout(function(){f.click(),document.body.removeChild(f)},1)},"image/png")}})},{"../../core/component":131,"../../lib/three":179}],109:[function(M,N,$){var l=M("../../core/component").registerComponent,w=M("../../../vendor/rStats"),A=M("../../utils");M("../../../vendor/rStats.extras"),M("../../lib/rStatsAframe");var E=window.aframeStats,d=A.bind,v="a-hidden",f=window.threeStats;N.exports.Component=l("stats",{schema:{default:!0},init:function(){var u=this.el;A.getUrlParameter("stats")!=="false"&&(this.stats=m(u),this.statsEl=document.querySelector(".rs-base"),this.hideBound=d(this.hide,this),this.showBound=d(this.show,this),u.addEventListener("enter-vr",this.hideBound),u.addEventListener("exit-vr",this.showBound))},update:function(){if(this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var u=this.stats;u&&(u("rAF").tick(),u("FPS").frame(),u().update())},hide:function(){this.statsEl.classList.add(v)},show:function(){this.statsEl.classList.remove(v)}});function m(u){var b=new f(u.renderer),g=new E(u),y=u.isMobile?[]:[b,g];return new w({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:y})}},{"../../../vendor/rStats":217,"../../../vendor/rStats.extras":216,"../../core/component":131,"../../lib/rStatsAframe":178,"../../utils":205}],110:[function(M,N,$){var l=M("../../core/component").registerComponent,w=M("../../constants/"),A=M("../../utils/"),E=A.bind,d="a-enter-vr",v="a-enter-ar",f="a-enter-vr-button",m="a-enter-ar-button",u="a-hidden",b="a-orientation-modal";N.exports.Component=l("vr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},enterVRButton:{default:""},enterARButton:{default:""}},init:function(){var T=this,R=this.el;A.getUrlParameter("ui")!=="false"&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),R.addEventListener("enter-vr",this.updateEnterInterfaces),R.addEventListener("exit-vr",this.updateEnterInterfaces),R.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(O){O.data.type==="loaderReady"&&(T.insideLoader=!0,T.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=E(this.onEnterVRButtonClick,this),this.onEnterARButtonClick=E(this.onEnterARButtonClick,this),this.onModalClick=E(this.onModalClick,this),this.toggleOrientationModalIfNeeded=E(this.toggleOrientationModalIfNeeded,this),this.updateEnterInterfaces=E(this.updateEnterInterfaces,this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var T=this.data,R=this.el;if(!T.enabled||this.insideLoader||A.getUrlParameter("ui")==="false")return this.remove();this.enterVREl||this.enterAREl||this.orientationModalEl||(T.enterVRButton?(this.enterVREl=document.querySelector(T.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=g(this.onEnterVRButtonClick),R.appendChild(this.enterVREl)),T.enterARButton?(this.enterAREl=document.querySelector(T.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=y(this.onEnterARButtonClick),R.appendChild(this.enterAREl)),this.orientationModalEl=x(this.onModalClick),R.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(T){T&&T.parentNode&&T.parentNode.removeChild(T)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var T=this.el;this.enterVREl&&(T.is("vr-mode")?this.enterVREl.classList.add(u):this.enterVREl.classList.remove(u))},toggleEnterARButtonIfNeeded:function(){var T=this.el;this.enterAREl&&(T.is("vr-mode")||!A.device.checkARSupport()?this.enterAREl.classList.add(u):this.enterAREl.classList.remove(u))},toggleOrientationModalIfNeeded:function(){var T=this.el,R=this.orientationModalEl;!R||!T.isMobile||(!A.device.isLandscape()&&T.is("vr-mode")?R.classList.remove(u):R.classList.add(u))}});function g(T){var R,O;return O=document.createElement("div"),O.classList.add(d),O.setAttribute(w.AFRAME_INJECTED,""),R=document.createElement("button"),R.className=f,R.setAttribute("title","Enter VR mode with a headset or fullscreen mode on a desktop. Visit https://webvr.rocks or https://webvr.info for more information."),R.setAttribute(w.AFRAME_INJECTED,""),A.device.isMobile()&&L(R),O.appendChild(R),R.addEventListener("click",function(F){T(),F.stopPropagation()}),O}function y(T){var R,O;return O=document.createElement("div"),O.classList.add(v),O.setAttribute(w.AFRAME_INJECTED,""),R=document.createElement("button"),R.className=m,R.setAttribute("title","Enter AR mode with a headset or handheld device. Visit https://webvr.rocks or https://webvr.info for more information."),R.setAttribute(w.AFRAME_INJECTED,""),A.device.isMobile()&&L(R),O.appendChild(R),R.addEventListener("click",function(F){T(),F.stopPropagation()}),O}function x(T){var R=document.createElement("div");R.className=b,R.classList.add(u),R.setAttribute(w.AFRAME_INJECTED,"");var O=document.createElement("button");return O.setAttribute(w.AFRAME_INJECTED,""),O.innerHTML="Exit VR",O.addEventListener("click",T),R.appendChild(O),R}function L(T){T.addEventListener("touchstart",function(){T.classList.remove("resethover")}),T.addEventListener("touchend",function(){T.classList.add("resethover")})}},{"../../constants/":123,"../../core/component":131,"../../utils/":205}],111:[function(M,N,$){var l=M("../core/component"),w=M("../lib/three"),A=M("../utils/bind"),E=l.registerComponent;N.exports.Component=E("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=A(this.update,this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var d=this.data;this.updateDescendants(d.cast,d.receive)},remove:function(){var d=this.el;d.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(d,v){var f=this.el.sceneEl;this.el.object3D.traverse(function(m){if(m instanceof w.Mesh&&(m.castShadow=d,m.receiveShadow=v,f.hasLoaded&&m.material))for(var u=Array.isArray(m.material)?m.material:[m.material],b=0;b<u.length;b++)u[b].needsUpdate=!0})}})},{"../core/component":131,"../lib/three":179,"../utils/bind":199}],112:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/debug"),A=M("../lib/three"),E=w("components:sound:warn");N.exports.Component=l("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var d=this;this.listener=null,this.audioLoader=new A.AudioLoader,this.pool=new A.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){d.playSound()}},update:function(d){var v=this.data,f,m,u=v.src!==d.src;if(u){if(!v.src)return;this.setupSound()}for(f=0;f<this.pool.children.length;f++)m=this.pool.children[f],v.positional&&(m.setDistanceModel(v.distanceModel),m.setMaxDistance(v.maxDistance),m.setRefDistance(v.refDistance),m.setRolloffFactor(v.rolloffFactor)),m.setLoop(v.loop),m.setVolume(v.volume),m.isPaused=!1;if(v.on!==d.on&&this.updateEventListener(d.on),u){var b=this;this.loaded=!1,this.audioLoader.load(v.src,function(g){for(f=0;f<b.pool.children.length;f++)m=b.pool.children[f],m.setBuffer(g);b.loaded=!0,A.Cache.remove(v.src),(b.data.autoplay||b.mustPlay)&&b.playSound(),b.el.emit("sound-loaded",b.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var d,v;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(d=0;d<this.pool.children.length;d++)v=this.pool.children[d],v.disconnect()}catch{E("Audio source not properly disconnected")}},updateEventListener:function(d){var v=this.el;d&&v.removeEventListener(d,this.playSoundBound),v.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var d=this.el,v,f=d.sceneEl,m=this,u;this.pool.children.length>0&&(this.stopSound(),d.removeObject3D("sound"));var b=this.listener=f.audioListener||new A.AudioListener;for(f.audioListener=b,f.camera&&f.camera.add(b),f.addEventListener("camera-set-active",function(g){g.detail.cameraEl.getObject3D("camera").add(b)}),this.pool=new A.Group,v=0;v<this.data.poolSize;v++)u=this.data.positional?new A.PositionalAudio(b):new A.Audio(b),this.pool.add(u);for(d.setObject3D(this.attrName,this.pool),v=0;v<this.pool.children.length;v++)u=this.pool.children[v],u.onEnded=function(){this.isPlaying=!1,m.el.emit("sound-ended",m.evtDetail,!1)}},pauseSound:function(){var d,v;for(this.isPlaying=!1,d=0;d<this.pool.children.length;d++)v=this.pool.children[d],!(!v.source||!v.source.buffer||!v.isPlaying||v.isPaused)&&(v.isPaused=!0,v.pause())},playSound:function(d){var v,f,m;if(!this.loaded){E("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0;return}for(v=!1,this.isPlaying=!0,f=0;f<this.pool.children.length;f++)if(m=this.pool.children[f],!m.isPlaying&&m.buffer&&!v){d&&d(m),m.play(),m.isPaused=!1,v=!0;continue}if(!v){E("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1},stopSound:function(){var d,v;for(this.isPlaying=!1,d=0;d<this.pool.children.length;d++){if(v=this.pool.children[d],!v.source||!v.source.buffer)return;v.stop()}}})},{"../core/component":131,"../lib/three":179,"../utils/debug":201}],113:[function(M,N,$){var l=M("three-bmfont-text"),w=M("load-bmfont"),A=M("../core/component").registerComponent,E=M("../core/shader"),d=M("../lib/three"),v=M("../utils/"),f=v.debug("components:text:error"),m=E.shaders,u=v.debug("components:text:warn"),b=1,g=16,y="https://cdn.aframe.io/fonts/",x={aileronsemibold:y+"Aileron-Semibold.fnt",dejavu:y+"DejaVu-sdf.fnt",exo2bold:y+"Exo2Bold.fnt",exo2semibold:y+"Exo2SemiBold.fnt",kelsonsans:y+"KelsonSans.fnt",monoid:y+"Monoid.fnt",mozillavr:y+"mozillavr.fnt",roboto:y+"Roboto-msdf.json",sourcecodepro:y+"SourceCodePro.fnt"},L=["roboto"],T="roboto";N.exports.FONTS=x;var R=new oe,O={},F={},z=/^\w+:/;N.exports.Component=A("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:T},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:m},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=l(),this.createOrUpdateMaterial()},update:function(Z){var ye=this.data,Ne=this.currentFont;if(F[ye.font]?this.texture=F[ye.font]:(this.texture=F[ye.font]=new d.Texture,this.texture.anisotropy=g),this.createOrUpdateMaterial(),Z.font!==ye.font){this.updateFont();return}Ne&&(this.updateGeometry(this.geometry,Ne),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var Z=this.data,ye,Ne=this.material,je,ke=this.shaderData,it;if(it=Z.shader,L.indexOf(Z.font)!==-1||Z.font.indexOf("-msdf.")>=0?it="msdf":Z.font in x&&L.indexOf(Z.font)===-1&&(it="sdf"),ye=(this.shaderObject&&this.shaderObject.name)!==it,ke.alphaTest=Z.alphaTest,ke.color=Z.color,ke.map=this.texture,ke.opacity=Z.opacity,ke.side=re(Z.side),ke.transparent=Z.transparent,ke.negate=Z.negate,!ye){this.shaderObject.update(ke),Ne.transparent=ke.transparent,Ne.side=ke.side;return}je=J(this.el,it,ke),this.material=je.material,this.shaderObject=je.shader,this.material.side=ke.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var Z=this.data,ye=this.el,Ne,je=this.geometry,ke=this;Z.font||u("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),Ne=this.lookupFont(Z.font||T)||Z.font,R.get(Ne,function(){return Y(Ne,Z.yOffset)}).then(function(rt){var Mt;if(rt.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");O[Ne]||(rt.widthFactor=O[rt]=j(rt)),ke.currentFont=rt,Mt=ke.getFontImageSrc(),R.get(Mt,function(){return ee(Mt)}).then(function(Rt){var Wt=ke.texture;Wt.image=Rt,Wt.needsUpdate=!0,F[Z.font]=Wt,ke.texture=Wt,ke.initMesh(),ke.currentFont=rt,ke.updateGeometry(je,rt),ke.updateLayout(),ke.mesh.visible=!0,ye.emit("textfontset",{font:Z.font,fontObj:rt})}).catch(function(Rt){f(Rt.message),f(Rt.stack)})}).catch(function(it){f(it.message),f(it.stack)})},initMesh:function(){this.mesh||(this.mesh=new d.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var Z=this.lookupFont(this.data.font||T)||this.data.font,ye=this.currentFont.pages[0];return ye.match(z)&&ye.indexOf("http")!==0?Z.replace(/(\.fnt)|(\.json)/,".png"):d.LoaderUtils.extractUrlBase(Z)+ye},updateLayout:function(){var Z,ye,Ne=this.el,je=this.data,ke=this.geometry,it,rt,Mt,Rt=this.mesh,Wt,nr,Dr,wt,yr;if(!(!Rt||!ke.layout)){if(it=Ne.getAttribute("geometry"),Dr=je.width||it&&it.width||b,Wt=ce(je.wrapPixels,je.wrapCount,this.currentFont.widthFactor),nr=Dr/Wt,Mt=ke.layout,rt=nr*(Mt.height+Mt.descender),it&&it.primitive==="plane"&&(it.width||Ne.setAttribute("geometry","width",Dr),it.height||Ne.setAttribute("geometry","height",rt)),Z=je.anchor==="align"?je.align:je.anchor,Z==="left")wt=0;else if(Z==="right")wt=-1*Mt.width;else if(Z==="center")wt=-1*Mt.width/2;else throw new TypeError("Invalid text.anchor property value",Z);if(ye=je.baseline,ye==="bottom")yr=0;else if(ye==="top")yr=-1*Mt.height+Mt.ascender;else if(ye==="center")yr=-1*Mt.height/2;else throw new TypeError("Invalid text.baseline property value",ye);Rt.position.x=wt*nr+je.xOffset,Rt.position.y=yr*nr,Rt.position.z=je.zOffset,Rt.scale.set(nr,-1*nr,nr)}},lookupFont:function(Z){return x[Z]},updateGeometry:function(){var Z={},ye={},Ne=/\\n/g,je=/\\t/g;return function(ke,it){var rt=this.data;ye.font=it,ye.lineHeight=rt.lineHeight&&isFinite(rt.lineHeight)?rt.lineHeight:it.common.lineHeight,ye.text=rt.value.toString().replace(Ne,`
`).replace(je,"	"),ye.width=ce(rt.wrapPixels,rt.wrapCount,it.widthFactor),ke.update(v.extend(Z,rt,ye))}}()});function re(Z){switch(Z){case"back":return d.FrontSide;case"double":return d.DoubleSide;default:return d.BackSide}}function Y(Z,ye){return new Promise(function(Ne,je){w(Z,function(ke,it){if(ke){f("Error loading font",Z),je(ke);return}Z.indexOf("/Roboto-msdf.json")>=0&&(ye=30),ye&&it.chars.map(function(Mt){Mt.yoffset+=ye}),Ne(it)})})}function ee(Z){return new Promise(function(ye,Ne){new d.ImageLoader().load(Z,function(je){ye(je)},void 0,function(){f("Error loading font image",Z),Ne(null)})})}function J(Z,ye,Ne){var je,ke;return ke=new m[ye].Shader,ke.el=Z,ke.init(Ne),ke.update(Ne),je=ke.material,je.transparent=Ne.transparent,{material:je,shader:ke}}function ce(Z,ye,Ne){return Z||(.5+ye)*Ne}function j(Z){var ye=0,Ne=0,je=0;return Z.chars.map(function(ke){ye+=ke.xadvance,ke.id>=48&&ke.id<=57&&(je++,Ne+=ke.xadvance)}),je?Ne/je:ye/Z.chars.length}function oe(){var Z=this.cache={};this.get=function(ye,Ne){return ye in Z||(Z[ye]=Ne()),Z[ye]}}},{"../core/component":131,"../core/shader":141,"../lib/three":179,"../utils/":205,"load-bmfont":37,"three-bmfont-text":63}],114:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/tracked-controls"),A=M("../constants").DEFAULT_CAMERA_HEIGHT,E=M("../lib/three"),d=M("../constants").DEFAULT_HANDEDNESS,v={x:.175,y:-.3,z:-.03},f={x:0,y:0,z:-.175},m={touches:[]},u={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};N.exports.Component=l("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new E.Vector3,this.controllerQuaternion=new E.Quaternion,this.controllerEuler=new E.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(b,g){var y=this.el.getObject3D("mesh");y&&y.update&&y.update(g/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return A},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var b=this.data,g=w.findMatchingControllerWebVR(this.system.controllers,b.id,b.idPrefix,b.hand,b.controller);this.controller=g,this.el.components["tracked-controls"].controller=g,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(b){var g=this.controller,y=this.controllerEuler,x=this.controllerQuaternion,L=this.deltaControllerPosition,T,R,O,F,z;R=this.getHeadElement(),O=R.object3D,z=this.defaultUserHeight(),F=g.pose,T=(g?g.hand:void 0)||d,b.copy(O.position),L.set(v.x*(T==="left"?-1:T==="right"?1:0),v.y,v.z),L.multiplyScalar(z),L.applyAxisAngle(O.up,O.rotation.y),b.add(L),L.set(f.x,f.y,f.z),L.multiplyScalar(z),F.orientation?x.fromArray(F.orientation):x.copy(O.quaternion),y.setFromQuaternion(x),y.set(y.x,y.y,0),L.applyEuler(y),b.add(L)},updatePose:function(){var b=this.controller,g=this.data,y=this.el.object3D,x,L=this.system.vrDisplay,T;b&&(x=b.pose,x.position?y.position.fromArray(x.position):g.armModel&&this.applyArmModel(y.position),x.orientation&&y.quaternion.fromArray(x.orientation),L&&x.position&&(T=this.el.sceneEl.renderer.xr.getStandingMatrix(),y.matrix.compose(y.position,y.quaternion,y.scale),y.matrix.multiplyMatrices(T,y.matrix),y.matrix.decompose(y.position,y.quaternion,y.scale)),y.rotateX(this.data.orientationOffset.x*E.Math.DEG2RAD),y.rotateY(this.data.orientationOffset.y*E.Math.DEG2RAD),y.rotateZ(this.data.orientationOffset.z*E.Math.DEG2RAD))},updateButtons:function(){var b,g=this.controller,y;if(g){for(y=0;y<g.buttons.length;++y)this.buttonStates[y]||(this.buttonStates[y]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[y]||(this.buttonEventDetails[y]={id:y,state:this.buttonStates[y]}),b=g.buttons[y],this.handleButton(y,b);this.handleAxes()}},handleButton:function(b,g){var y;return y=this.handlePress(b,g)|this.handleTouch(b,g)|this.handleValue(b,g),y?(this.el.emit(u.BUTTONCHANGED,this.buttonEventDetails[b],!1),!0):!1},handleAxes:function(){var b=!1,g=this.controller.axes,y,x=this.axis,L=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),y=0;y<g.length;++y)L.push(x[y]!==g[y]),L[y]&&(b=!0);if(!b)return!1;for(this.axis.splice(0,this.axis.length),y=0;y<g.length;y++)this.axis.push(g[y]);return this.el.emit(u.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(b,g){var y,x=this.buttonStates[b];return g.pressed===x.pressed?!1:(y=g.pressed?u.BUTTONDOWN:u.BUTTONUP,this.el.emit(y,this.buttonEventDetails[b],!1),x.pressed=g.pressed,!0)},handleTouch:function(b,g){var y,x=this.buttonStates[b];return g.touched===x.touched?!1:(y=g.touched?u.TOUCHSTART:u.TOUCHEND,this.el.emit(y,this.buttonEventDetails[b],!1,m),x.touched=g.touched,!0)},handleValue:function(b,g){var y=this.buttonStates[b];return g.value===y.value?!1:(y.value=g.value,!0)}})},{"../constants":123,"../core/component":131,"../lib/three":179,"../utils/tracked-controls":214}],115:[function(M,N,$){var l=M("../utils/tracked-controls"),w=M("../core/component").registerComponent,A={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};N.exports.Component=w("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var E=this.el.sceneEl;this.updateController(),E.addEventListener("controllersupdated",this.updateController)},pause:function(){var E=this.el.sceneEl;E.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(E){return!(!this.controller||this.controller.gamepad||E.inputSource.handedness!=="none"&&E.inputSource.handedness!==this.data.hand)},updateController:function(){this.controller=l.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var E=this.el.sceneEl,d=this.controller,v=E.frame;!d||!E.frame||!this.system.referenceSpace||d.hand||(this.pose=v.getPose(d.targetRaySpace,this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var E=this.el.object3D,d=this.pose;d&&(E.matrix.elements=d.transform.matrix,E.matrix.decompose(E.position,E.rotation,E.scale))},updateButtons:function(){var E,d,v=this.controller,f;if(!(!v||!v.gamepad)){for(f=v.gamepad,d=0;d<f.buttons.length;++d)this.buttonStates[d]||(this.buttonStates[d]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[d]||(this.buttonEventDetails[d]={id:d,state:this.buttonStates[d]}),E=f.buttons[d],this.handleButton(d,E);this.handleAxes()}},handleButton:function(E,d){var v;return v=this.handlePress(E,d)|this.handleTouch(E,d)|this.handleValue(E,d),v?(this.el.emit(A.BUTTONCHANGED,this.buttonEventDetails[E],!1),!0):!1},handleAxes:function(){var E=!1,d=this.controller.gamepad.axes,v,f=this.axis,m=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),v=0;v<d.length;++v)m.push(f[v]!==d[v]),m[v]&&(E=!0);if(!E)return!1;for(this.axis.splice(0,this.axis.length),v=0;v<d.length;v++)this.axis.push(d[v]);return this.el.emit(A.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(E,d){var v,f=this.buttonStates[E];return d.pressed===f.pressed?!1:(v=d.pressed?A.BUTTONDOWN:A.BUTTONUP,this.el.emit(v,this.buttonEventDetails[E],!1),f.pressed=d.pressed,!0)},handleTouch:function(E,d){var v,f=this.buttonStates[E];return d.touched===f.touched?!1:(v=d.touched?A.TOUCHSTART:A.TOUCHEND,this.el.emit(v,this.buttonEventDetails[E],!1),f.touched=d.touched,!0)},handleValue:function(E,d){var v=this.buttonStates[E];return d.value===v.value?!1:(v.value=d.value,!0)}})},{"../core/component":131,"../utils/tracked-controls":214}],116:[function(M,N,$){var l=M("../core/component").registerComponent;N.exports.Component=l("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1}},update:function(){var w=this.data,A=this.el;A.sceneEl.hasWebXR?A.setAttribute("tracked-controls-webxr",{id:w.id,hand:w.hand,index:w.controller,iterateControllerProfiles:w.iterateControllerProfiles,handTrackingEnabled:w.handTrackingEnabled}):A.setAttribute("tracked-controls-webvr",w)}})},{"../core/component":131}],117:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/bind"),A=M("../lib/three"),E=M("../utils/tracked-controls"),d=E.checkControllerPresentAndSetup,v=E.emitIfAxesChanged,f=E.onButtonEvent,m="https://cdn.aframe.io/controllers/valve/index/valve-index-",u={left:m+"left.glb",right:m+"right.glb"},b="valve",g=M("../utils/").device.isWebXRAvailable,y={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},x={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},L={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},T={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},R=g?T:L,O=g?x:y;N.exports.Component=l("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var F=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=w(this.onButtonChanged,this),this.onButtonDown=function(z){f(z.detail.id,"down",F)},this.onButtonUp=function(z){f(z.detail.id,"up",F)},this.onButtonTouchEnd=function(z){f(z.detail.id,"touchend",F)},this.onButtonTouchStart=function(z){f(z.detail.id,"touchstart",F)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=w(this.onModelLoaded,this),this.onControllersUpdate=w(this.onControllersUpdate,this),this.checkIfControllerPresent=w(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=w(this.removeControllersUpdateListener,this),this.onAxisMoved=w(this.onAxisMoved,this)},addEventListeners:function(){var F=this.el;F.addEventListener("buttonchanged",this.onButtonChanged),F.addEventListener("buttondown",this.onButtonDown),F.addEventListener("buttonup",this.onButtonUp),F.addEventListener("touchend",this.onButtonTouchEnd),F.addEventListener("touchstart",this.onButtonTouchStart),F.addEventListener("model-loaded",this.onModelLoaded),F.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var F=this.el;F.removeEventListener("buttonchanged",this.onButtonChanged),F.removeEventListener("buttondown",this.onButtonDown),F.removeEventListener("buttonup",this.onButtonUp),F.removeEventListener("touchend",this.onButtonTouchEnd),F.removeEventListener("touchstart",this.onButtonTouchStart),F.removeEventListener("model-loaded",this.onModelLoaded),F.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var F=this.data,z=F.hand==="right"?0:F.hand==="left"?1:2;d(this,b,{index:z,iterateControllerProfiles:!0,hand:F.hand})},injectTrackedControls:function(){var F=this.el,z=this.data;F.setAttribute("tracked-controls",{idPrefix:b,controller:z.hand==="right"?1:z.hand==="left"?0:2,hand:z.hand,orientationOffset:z.orientationOffset}),this.loadModel()},loadModel:function(){var F=this.data;F.model&&this.el.setAttribute("gltf-model",""+u[F.hand])},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(F){var z=this.mapping.buttons[F.detail.id],re=this.buttonMeshes,Y;z&&(z==="trigger"&&(Y=F.detail.state.value,re&&re.trigger&&(re.trigger.rotation.x=this.triggerOriginalRotationX-Y*(Math.PI/40))),this.el.emit(z+"changed",F.detail.state))},onModelLoaded:function(F){var z,re=F.detail.model,Y=this;this.data.model&&(z=this.buttonMeshes={},z.grip={left:re.getObjectByName("leftgrip"),right:re.getObjectByName("rightgrip")},z.menu=re.getObjectByName("menubutton"),z.system=re.getObjectByName("systembutton"),z.trackpad=re.getObjectByName("touchpad"),z.trigger=re.getObjectByName("trigger"),this.triggerOriginalRotationX=z.trigger.rotation.x,Object.keys(z).forEach(function(ee){Y.setButtonColor(ee,Y.data.buttonColor)}),re.position.copy(O[this.data.hand]),re.rotation.copy(R[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controlls",model:this.data.model,rayOrigin:new A.Vector3(0,0,0)}))},onAxisMoved:function(F){v(this,this.mapping.axes,F)},updateModel:function(F,z){var re,Y;this.data.model&&(Y=z.indexOf("touch")!==-1,!Y&&(re=z==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(F,re)))},setButtonColor:function(F,z){}})},{"../core/component":131,"../lib/three":179,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],118:[function(M,N,$){var l=M("../core/component").registerComponent;N.exports.Component=l("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},{"../core/component":131}],119:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/bind"),A=M("../utils/tracked-controls"),E=A.checkControllerPresentAndSetup,d=A.emitIfAxesChanged,v=A.onButtonEvent,f="https://cdn.aframe.io/controllers/vive/vr_controller_vive.obj",m="https://cdn.aframe.io/controllers/vive/vr_controller_vive.mtl",u=M("../utils/").device.isWebXRAvailable,b="htc-vive-controller-mv",g="OpenVR ",y=u?b:g,x={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},L={axes:{thumbstick:[0,1]},buttons:["trigger","grip","trackpad","none","menu"]},T=u?L:x;N.exports.Component=l("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:T,init:function(){var R=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=w(this.onButtonChanged,this),this.onButtonDown=function(O){v(O.detail.id,"down",R)},this.onButtonUp=function(O){v(O.detail.id,"up",R)},this.onButtonTouchEnd=function(O){v(O.detail.id,"touchend",R)},this.onButtonTouchStart=function(O){v(O.detail.id,"touchstart",R)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var R=this.data;this.controllerIndex=R.hand==="right"?0:R.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=w(this.onModelLoaded,this),this.onControllersUpdate=w(this.onControllersUpdate,this),this.checkIfControllerPresent=w(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=w(this.removeControllersUpdateListener,this),this.onAxisMoved=w(this.onAxisMoved,this)},addEventListeners:function(){var R=this.el;R.addEventListener("buttonchanged",this.onButtonChanged),R.addEventListener("buttondown",this.onButtonDown),R.addEventListener("buttonup",this.onButtonUp),R.addEventListener("touchend",this.onButtonTouchEnd),R.addEventListener("touchstart",this.onButtonTouchStart),R.addEventListener("model-loaded",this.onModelLoaded),R.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var R=this.el;R.removeEventListener("buttonchanged",this.onButtonChanged),R.removeEventListener("buttondown",this.onButtonDown),R.removeEventListener("buttonup",this.onButtonUp),R.removeEventListener("touchend",this.onButtonTouchEnd),R.removeEventListener("touchstart",this.onButtonTouchStart),R.removeEventListener("model-loaded",this.onModelLoaded),R.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var R=this.data;E(this,y,{index:this.controllerIndex,hand:R.hand})},injectTrackedControls:function(){var R=this.el,O=this.data;R.setAttribute("tracked-controls",{idPrefix:y,hand:O.hand,controller:this.controllerIndex,orientationOffset:O.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:f,mtl:m})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(R){var O=this.mapping.buttons[R.detail.id],F=this.buttonMeshes,z;O&&(O==="trigger"&&(z=R.detail.state.value,F&&F.trigger&&(F.trigger.rotation.x=-z*(Math.PI/12))),this.el.emit(O+"changed",R.detail.state))},onModelLoaded:function(R){var O,F=R.detail.model,z=this;this.data.model&&(O=this.buttonMeshes={},O.grip={left:F.getObjectByName("leftgrip"),right:F.getObjectByName("rightgrip")},O.menu=F.getObjectByName("menubutton"),O.system=F.getObjectByName("systembutton"),O.trackpad=F.getObjectByName("touchpad"),O.trigger=F.getObjectByName("trigger"),Object.keys(O).forEach(function(re){z.setButtonColor(re,z.data.buttonColor)}),F.position.set(0,-.015,.04))},onAxisMoved:function(R){d(this,this.mapping.axes,R)},updateModel:function(R,O){var F,z;this.data.model&&(z=O.indexOf("touch")!==-1,!z&&(F=O==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(R,F)))},setButtonColor:function(R,O){var F=this.buttonMeshes,z=this.rendererSystem;if(F){if(R==="grip"){F.grip.left.material.color.set(O),F.grip.right.material.color.set(O),z.applyColorCorrection(F.grip.left.material.color),z.applyColorCorrection(F.grip.right.material.color);return}F[R].material.color.set(O),z.applyColorCorrection(F[R].material.color)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],120:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/bind"),A=M("../utils/tracked-controls"),E=A.checkControllerPresentAndSetup,d=A.emitIfAxesChanged,v=A.onButtonEvent,f="HTC Vive Focus",m="https://cdn.aframe.io/controllers/vive/focus-controller/focus-controller.gltf";N.exports.Component=l("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=w(this.onModelLoaded,this),this.onControllersUpdate=w(this.onControllersUpdate,this),this.checkIfControllerPresent=w(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=w(this.removeControllersUpdateListener,this),this.onAxisMoved=w(this.onAxisMoved,this)},init:function(){var u=this;this.onButtonChanged=w(this.onButtonChanged,this),this.onButtonDown=function(b){v(b.detail.id,"down",u)},this.onButtonUp=function(b){v(b.detail.id,"up",u)},this.onButtonTouchStart=function(b){v(b.detail.id,"touchstart",u)},this.onButtonTouchEnd=function(b){v(b.detail.id,"touchend",u)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var u=this.el;u.addEventListener("buttonchanged",this.onButtonChanged),u.addEventListener("buttondown",this.onButtonDown),u.addEventListener("buttonup",this.onButtonUp),u.addEventListener("touchstart",this.onButtonTouchStart),u.addEventListener("touchend",this.onButtonTouchEnd),u.addEventListener("model-loaded",this.onModelLoaded),u.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var u=this.el;u.removeEventListener("buttonchanged",this.onButtonChanged),u.removeEventListener("buttondown",this.onButtonDown),u.removeEventListener("buttonup",this.onButtonUp),u.removeEventListener("touchstart",this.onButtonTouchStart),u.removeEventListener("touchend",this.onButtonTouchEnd),u.removeEventListener("model-loaded",this.onModelLoaded),u.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){E(this,f,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var u=this.el,b=this.data;u.setAttribute("tracked-controls",{armModel:b.armModel,idPrefix:f,orientationOffset:b.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",m)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(u){var b=u.detail.model,g;this.data.model&&(g=this.buttonMeshes={},g.trigger=b.getObjectByName("BumperKey"),g.triggerPressed=b.getObjectByName("BumperKey_Press"),g.triggerPressed&&(g.triggerPressed.visible=!1),g.trackpad=b.getObjectByName("TouchPad"),g.trackpadPressed=b.getObjectByName("TouchPad_Press"),g.trackpadPressed&&(g.trackpadPressed.visible=!1))},onButtonChanged:function(u){var b=this.mapping.buttons[u.detail.id];b&&this.el.emit(b+"changed",u.detail.state)},onAxisMoved:function(u){d(this,this.mapping.axes,u)},updateModel:function(u,b){this.data.model&&this.updateButtonModel(u,b)},updateButtonModel:function(u,b){var g=this.buttonMeshes,y=u+"Pressed";if(!(!g||!g[u]||!g[y])){var x;switch(b){case"down":x=this.data.buttonHighlightColor;break;case"touchstart":x=this.data.buttonTouchedColor;break}x&&g[y].material.color.set(x),g[y].visible=!!x,g[u].visible=!x}}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],121:[function(M,N,$){var l=M("../constants").keyboardevent.KEYCODE_TO_CODE,w=M("../core/component").registerComponent,A=M("../lib/three"),E=M("../utils/"),d=E.bind,v=E.shouldCaptureKeyEvent,f=1e-5,m=.2,u=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];N.exports.Component=w("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},init:function(){this.keys={},this.easing=1.1,this.velocity=new A.Vector3,this.onBlur=d(this.onBlur,this),this.onContextMenu=d(this.onContextMenu,this),this.onFocus=d(this.onFocus,this),this.onKeyDown=d(this.onKeyDown,this),this.onKeyUp=d(this.onKeyUp,this),this.onVisibilityChange=d(this.onVisibilityChange,this),this.attachVisibilityEventListeners()},tick:function(g,y){var x=this.data,L=this.el,T=this.velocity;!T[x.adAxis]&&!T[x.wsAxis]&&b(this.keys)||(y=y/1e3,this.updateVelocity(y),!(!T[x.adAxis]&&!T[x.wsAxis])&&L.object3D.position.add(this.getMovementVector(y)))},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(g){var y,x,L,T=this.data,R=this.keys,O=this.velocity,F,z;if(x=T.adAxis,F=T.wsAxis,g>m){O[x]=0,O[F]=0;return}var re=Math.pow(1/this.easing,g*60);O[x]!==0&&(O[x]=O[x]*re),O[F]!==0&&(O[F]=O[F]*re),Math.abs(O[x])<f&&(O[x]=0),Math.abs(O[F])<f&&(O[F]=0),T.enabled&&(y=T.acceleration,T.adEnabled&&(L=T.adInverted?-1:1,(R.KeyA||R.ArrowLeft)&&(O[x]-=L*y*g),(R.KeyD||R.ArrowRight)&&(O[x]+=L*y*g)),T.wsEnabled&&(z=T.wsInverted?-1:1,(R.KeyW||R.ArrowUp)&&(O[F]-=z*y*g),(R.KeyS||R.ArrowDown)&&(O[F]+=z*y*g)))},getMovementVector:function(){var g=new A.Vector3(0,0,0),y=new A.Euler(0,0,0,"YXZ");return function(x){var L=this.el.getAttribute("rotation"),T=this.velocity,R;return g.copy(T),g.multiplyScalar(x),L&&(R=this.data.fly?L.x:0,y.set(A.Math.degToRad(R),A.Math.degToRad(L.y),0),g.applyEuler(y)),g}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var g=Object.keys(this.keys),y=0;y<g.length;y++)delete this.keys[g[y]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(g){var y;v(g)&&(y=g.code||l[g.keyCode],u.indexOf(y)!==-1&&(this.keys[y]=!0))},onKeyUp:function(g){var y;y=g.code||l[g.keyCode],delete this.keys[y]}});function b(g){var y;for(y in g)return!1;return!0}},{"../constants":123,"../core/component":131,"../lib/three":179,"../utils/":205}],122:[function(M,N,$){var l=M("../core/component").registerComponent,w=M("../utils/bind"),A=M("../utils/tracked-controls"),E=A.checkControllerPresentAndSetup,d=A.emitIfAxesChanged,v=A.onButtonEvent,f=M("../utils/"),m=f.debug("components:windows-motion-controls:debug"),u=f.debug("components:windows-motion-controls:warn"),b=M("../constants").DEFAULT_HANDEDNESS,g="https://cdn.aframe.io/controllers/microsoft/",y={left:"left.glb",right:"right.glb",default:"universal.glb"},x=M("../utils/").device.isWebXRAvailable,L="windows-mixed-reality",T="Spatial Controller (Spatial Interaction Source) ",R=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,O=x?L:T,F={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},z={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},re=x?z:F;N.exports.Component=l("windows-motion-controls",{schema:{hand:{default:b},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},mapping:re,bindMethods:function(){this.onModelError=w(this.onModelError,this),this.onModelLoaded=w(this.onModelLoaded,this),this.onControllersUpdate=w(this.onControllersUpdate,this),this.checkIfControllerPresent=w(this.checkIfControllerPresent,this),this.onAxisMoved=w(this.onAxisMoved,this)},init:function(){var Y=this,ee=this.el;this.onButtonChanged=w(this.onButtonChanged,this),this.onButtonDown=function(J){v(J.detail.id,"down",Y)},this.onButtonUp=function(J){v(J.detail.id,"up",Y)},this.onButtonTouchStart=function(J){v(J.detail.id,"touchstart",Y)},this.onButtonTouchEnd=function(J){v(J.detail.id,"touchend",Y)},this.onControllerConnected=function(){Y.setModelVisibility(!0)},this.onControllerDisconnected=function(){Y.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},ee.addEventListener("controllerconnected",this.onControllerConnected),ee.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var Y=this.el;Y.addEventListener("buttonchanged",this.onButtonChanged),Y.addEventListener("buttondown",this.onButtonDown),Y.addEventListener("buttonup",this.onButtonUp),Y.addEventListener("touchstart",this.onButtonTouchStart),Y.addEventListener("touchend",this.onButtonTouchEnd),Y.addEventListener("axismove",this.onAxisMoved),Y.addEventListener("model-error",this.onModelError),Y.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var Y=this.el;Y.removeEventListener("buttonchanged",this.onButtonChanged),Y.removeEventListener("buttondown",this.onButtonDown),Y.removeEventListener("buttonup",this.onButtonUp),Y.removeEventListener("touchstart",this.onButtonTouchStart),Y.removeEventListener("touchend",this.onButtonTouchEnd),Y.removeEventListener("axismove",this.onAxisMoved),Y.removeEventListener("model-error",this.onModelError),Y.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){E(this,O,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var Y=this.createControllerModelUrl();this.loadModel(Y)},createControllerModelUrl:function(Y){var ee=this.el.components["tracked-controls"],J=ee?ee.controller:null,ce="default",j=this.data.hand,oe;if(J&&!window.hasNativeWebXRImplementation&&(j=J.hand,!Y)){var Z=J.id.match(R);ce=Z&&Z[0]||ce}return oe=y[j]||y.default,g+ce+"/"+oe},injectTrackedControls:function(){var Y=this.data;this.el.setAttribute("tracked-controls",{idPrefix:O,controller:Y.pair,hand:Y.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(Y){var ee=this.createControllerModelUrl(!0);Y.detail.src!==ee?(u("Failed to load controller model for device, attempting to load default."),this.loadModel(ee)):u("Failed to load default controller model.")},loadModel:function(Y){this.el.setAttribute("gltf-model","url("+Y+")")},onModelLoaded:function(Y){var ee=this.controllerModel=Y.detail.model,J=this.loadedMeshInfo,ce,j,oe,Z;if(m("Processing model"),J.buttonMeshes={},J.axisMeshes={},ee){for(ce=0;ce<this.mapping.buttons.length;ce++){if(j=this.mapping.buttonMeshNames[this.mapping.buttons[ce]],!j){m("Skipping unknown button at index: "+ce+" with mapped name: "+this.mapping.buttons[ce]);continue}if(oe=ee.getObjectByName(j),!oe){u("Missing button mesh with name: "+j);continue}Z={index:ce,value:ye(oe,"VALUE"),pressed:ye(oe,"PRESSED"),unpressed:ye(oe,"UNPRESSED")},Z.value&&Z.pressed&&Z.unpressed?J.buttonMeshes[this.mapping.buttons[ce]]=Z:u("Missing button submesh under mesh with name: "+j+"(VALUE: "+!!Z.value+", PRESSED: "+!!Z.pressed+", UNPRESSED:"+!!Z.unpressed+")")}for(ce=0;ce<this.mapping.axisMeshNames.length;ce++){if(j=this.mapping.axisMeshNames[ce],!j){m("Skipping unknown axis at index: "+ce);continue}if(oe=ee.getObjectByName(j),!oe){u("Missing axis mesh with name: "+j);continue}Z={index:ce,value:ye(oe,"VALUE"),min:ye(oe,"MIN"),max:ye(oe,"MAX")},Z.value&&Z.min&&Z.max?J.axisMeshes[ce]=Z:u("Missing axis submesh under mesh with name: "+j+"(VALUE: "+!!Z.value+", MIN: "+!!Z.min+", MAX:"+!!Z.max+")")}this.calculateRayOriginFromMesh(ee),this.setModelVisibility()}m("Model load complete.");function ye(Ne,je){for(var ke=0,it=Ne.children.length;ke<it;ke++){var rt=Ne.children[ke];if(rt&&rt.name===je)return rt}}},calculateRayOriginFromMesh:function(){var Y=new THREE.Quaternion;return function(ee){var J;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,J=ee.getObjectByName(this.mapping.pointingPoseMeshName),J){var ce=ee.parent;ce&&(ee.parent=null,ee.updateMatrixWorld(!0),ee.parent=ce),J.getWorldPosition(this.rayOrigin.origin),J.getWorldQuaternion(Y),this.rayOrigin.direction.applyQuaternion(Y),ce&&ee.updateMatrixWorld(!0)}else m("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var Y=new THREE.Quaternion;return function(ee,J){var ce=this.loadedMeshInfo.axisMeshes[ee];if(ce){var j=ce.min,oe=ce.max,Z=ce.value,ye=J*.5+.5;Z.setRotationFromQuaternion(Y.copy(j.quaternion).slerp(oe.quaternion,ye)),Z.position.lerpVectors(j.position,oe.position,ye)}}}(),lerpButtonTransform:function(){var Y=new THREE.Quaternion;return function(ee,J){var ce=this.loadedMeshInfo.buttonMeshes[ee];if(ce){var j=ce.unpressed,oe=ce.pressed,Z=ce.value;Z.setRotationFromQuaternion(Y.copy(j.quaternion).slerp(oe.quaternion,J)),Z.position.lerpVectors(j.position,oe.position,J)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(Y){var ee=this.mapping.buttons[Y.detail.id];ee&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(ee,Y.detail.state.value),this.el.emit(ee+"changed",Y.detail.state))},onAxisMoved:function(Y){var ee=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var J=0;J<ee;J++)this.lerpAxisTransform(J,Y.detail.axis[J]||0);d(this,this.mapping.axes,Y)},setModelVisibility:function(Y){var ee=this.el.getObject3D("mesh");Y=Y!==void 0?Y:this.modelVisible,this.modelVisible=Y,ee&&(ee.visible=Y)}})},{"../constants":123,"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],123:[function(M,N,$){N.exports={AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:M("./keyboardevent")}},{"./keyboardevent":124}],124:[function(M,N,$){N.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},{}],125:[function(M,N,$){var l=M("./a-node"),w=M("../utils/bind"),A=M("../utils/debug"),E=M("./a-register-element").registerElement,d=M("../lib/three"),v=new d.FileLoader,f=A("core:a-assets:warn");N.exports=E("a-assets",{prototype:Object.create(l.prototype,{createdCallback:{value:function(){this.isAssets=!0,this.fileLoader=v,this.timeout=null}},attachedCallback:{value:function(){var L=this,T,R=[],O,F,z,re,Y;if(!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(re=this.querySelectorAll("img"),T=0;T<re.length;T++)z=u(re[T]),R.push(new Promise(function(ee,J){d.Cache.files[re[T].getAttribute("src")]=z,z.onload=ee,z.onerror=J}));for(F=this.querySelectorAll("audio, video"),T=0;T<F.length;T++)O=u(F[T]),!O.src&&!O.srcObject&&f("Audio/video asset has neither `src` nor `srcObject` attributes."),R.push(m(O));Promise.all(R).then(w(this.load,this)),Y=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){L.hasLoaded||(f("Asset loading timed out in ",Y,"ms"),L.emit("timeout"),L.load())},Y)}},detachedCallback:{value:function(){this.timeout&&clearTimeout(this.timeout)}},load:{value:function(){l.prototype.load.call(this,null,function(T){return T.isAssetItem&&T.hasAttribute("src")})}}})}),E("a-asset-item",{prototype:Object.create(l.prototype,{createdCallback:{value:function(){this.data=null,this.isAssetItem=!0}},attachedCallback:{value:function(){var L=this,T=this.getAttribute("src");v.setResponseType(this.getAttribute("response-type")||y(T)),v.load(T,function(O){L.data=O,setTimeout(function(){l.prototype.load.call(L)})},function(O){L.emit("progress",{loadedBytes:O.loaded,totalBytes:O.total,xhr:O})},function(O){L.emit("error",{xhr:O})})}}})});function m(L){if(!(!L.hasAttribute("autoplay")&&L.getAttribute("preload")!=="auto"))return new Promise(function(T,R){if(L.readyState===4)return T();if(L.error)return R();L.addEventListener("loadeddata",O,!1),L.addEventListener("progress",O,!1),L.addEventListener("error",R,!1);function O(){for(var F=0,z=0;z<L.buffered.length;z++)F+=L.buffered.end(z)-L.buffered.start(z);F>=L.duration&&(L.tagName==="VIDEO"&&(d.Cache.files[L.getAttribute("src")]=L),T())}})}function u(L){var T=b(L);return T.tagName&&T.tagName.toLowerCase()==="video"&&(T.setAttribute("playsinline",""),T.setAttribute("webkit-playsinline","")),T!==L&&(L.parentNode.appendChild(T),L.parentNode.removeChild(L)),T}function b(L){var T,R;return L.hasAttribute("crossorigin")||(R=L.getAttribute("src"),R!==null&&(R.indexOf("://")===-1||g(R)===window.location.host))?L:(f('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',R),L.crossOrigin="anonymous",T=L.cloneNode(!0),T)}function g(L){var T=L.indexOf("://")>-1?L.split("/")[2]:L.split("/")[0];return T.substring(0,T.indexOf(":"))}function y(L){var T=x(L),R=T.lastIndexOf(".");if(R>=0){var O=T.slice(R,L.search(/\?|#|$/));if(O===".glb")return"arraybuffer"}return"text"}N.exports.inferResponseType=y;function x(L){var T=document.createElement("a");T.href=L;var R=T.search.replace(/^\?/,""),O=L.replace(R,"").replace("?","");return O.substring(O.lastIndexOf("/")+1)}N.exports.getFileNameFromURL=x},{"../lib/three":179,"../utils/bind":199,"../utils/debug":201,"./a-node":129,"./a-register-element":130}],126:[function(M,N,$){var l=M("../utils/debug"),w=M("./a-register-element").registerElement,A=l("core:cubemap:warn");N.exports=w("a-cubemap",{prototype:Object.create(window.HTMLElement.prototype,{attachedCallback:{value:function(){this.srcs=this.validate()},writable:window.debug},validate:{value:function(){var E=this.querySelectorAll("[src]"),d,v=[];if(E.length===6){for(d=0;d<E.length;d++)v.push(E[d].getAttribute("src"));return v}A("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")},writable:window.debug}})})},{"../utils/debug":201,"./a-register-element":130}],127:[function(M,N,$){var l=M("./a-node"),w=M("./component").components,A=M("./a-register-element").registerElement,E=M("../lib/three"),d=M("../utils/"),v,f=d.debug("core:a-entity:debug"),m=d.debug("core:a-entity:warn"),u="__",b=["position","rotation","scale","visible"],g={once:!0},y=Object.create(l.prototype,{createdCallback:{value:function(){this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new E.Group,this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}},attributeChangedCallback:{value:function(F,z,re){var Y=this.components[F];if(Y&&Y.justInitialized&&re===""){delete Y.justInitialized;return}!Y&&re===null||this.setEntityAttribute(F,z,re)}},attachedCallback:{value:function(){var F,z=this.sceneEl,re=this;if(this.addToParent(),!this.isScene){if(!z){this.load();return}if(F=z.querySelector("a-assets"),F&&!F.hasLoaded){F.addEventListener("loaded",function(){re.load()});return}this.load()}}},detachedCallback:{value:function(){var F;if(this.parentEl){for(F in this.components)this.removeComponent(F,!1);this.isScene||(this.removeFromParent(),l.prototype.detachedCallback.call(this),this.object3D.el=null)}}},getObject3D:{value:function(F){return this.object3DMap[F]}},setObject3D:{value:function(F,z){var re,Y=this;if(!(z instanceof E.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");re=this.getObject3D(F),re&&this.object3D.remove(re),z.el=this,z.children.length&&z.traverse(function(J){J.el=Y}),this.object3D.add(z),this.object3DMap[F]=z,this.emit("object3dset",{object:z,type:F})}},removeObject3D:{value:function(F){var z=this.getObject3D(F);if(!z){m("Tried to remove `Object3D` of type:",F,"which was not defined.");return}this.object3D.remove(z),delete this.object3DMap[F],this.emit("object3dremove",{type:F})}},getOrCreateObject3D:{value:function(F,z){var re=this.getObject3D(F);return!re&&z&&(re=new z,this.setObject3D(F,re)),m("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),re}},add:{value:function(F){if(!F.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(F.object3D),this.emit("child-attached",{el:F})}},addToParent:{value:function(){var F=this.parentEl=this.parentNode;!F||!F.add||this.attachedToParent||(F.add(this),this.attachedToParent=!0)}},removeFromParent:{value:function(){var F=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,F.emit("child-detached",{el:this})}},load:{value:function(){var F=this;this.hasLoaded||!this.parentEl||l.prototype.load.call(this,function(){F.parentEl&&(F.updateComponents(),(F.isScene||F.parentEl.isPlaying)&&F.play())})},writable:window.debug},remove:{value:function(F){F?this.object3D.remove(F.object3D):this.parentNode.removeChild(this)}},getChildEntities:{value:function(){for(var F=this.children,z=[],re=0;re<F.length;re++){var Y=F[re];Y instanceof v&&z.push(Y)}return z}},initComponent:{value:function(F,z,re){var Y,ee,J,ce,j;if(J=d.split(F,u),ce=J[0],ee=J.length>2?J.slice(1).join("__"):J[1],!!w[ce]&&(j=x(this,F)||z!==void 0,!(!j&&!re)&&!(F in this.components))){if(this.initComponentDependencies(ce),ee&&!w[ce].multiple)throw new Error("Trying to initialize multiple components of type `"+ce+"`. There can only be one component of this type per entity.");Y=new w[ce].Component(this,z,ee),this.isPlaying&&Y.play(),this.hasAttribute(F)||(Y.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,F,"")),f("Component initialized: %s",F)}},writable:window.debug},initComponentDependencies:{value:function(F){var z=this,re=w[F],Y,ee;if(re&&(Y=w[F].dependencies,!!Y))for(ee=0;ee<Y.length;ee++)z.initComponent(Y[ee],window.HTMLElement.prototype.getAttribute.call(z,Y[ee])||void 0,!0)}},removeComponent:{value:function(F,z){var re;if(re=this.components[F],!!re){if(!re.initialized){this.addEventListener("componentinitialized",function Y(ee){ee.detail.name===F&&(this.removeComponent(F,z),this.removeEventListener("componentinitialized",Y))});return}re.pause(),re.remove(),z&&(re.destroy(),delete this.components[F]),this.emit("componentremoved",re.evtDetail,!1)}},writable:window.debug},updateComponents:{value:function(){var F,z,re,Y,ee=this.componentsToUpdate;if(this.hasLoaded){for(re=0;re<this.mixinEls.length;re++)for(Y in this.mixinEls[re].componentCache)R(Y)&&(ee[Y]=!0);if(this.getExtraComponents){z=this.getExtraComponents();for(Y in z)R(Y)&&(ee[Y]=!0)}for(re=0;re<this.attributes.length;++re)Y=this.attributes[re].name,b.indexOf(Y)===-1&&R(Y)&&(ee[Y]=!0);for(re=0;re<b.length;re++)Y=b[re],this.hasAttribute(Y)&&this.updateComponent(Y,this.getDOMAttribute(Y));for(Y in ee)F=T(this.getDOMAttribute(Y),z&&z[Y]),this.updateComponent(Y,F),delete ee[Y]}},writable:window.debug},updateComponent:{value:function(F,z,re){var Y=this.components[F];if(Y){if(z===null&&!x(this,F)){this.removeComponent(F,!0);return}Y.updateProperties(z,re);return}this.initComponent(F,z,!1)}},removeAttribute:{value:function(F,z){var re=this.components[F];if(re&&z===void 0&&this.removeComponent(F,!0),re&&z!==void 0){re.resetProperty(z);return}F==="mixin"&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,F)}},play:{value:function(){var F,z,re;if(!(this.isPlaying||!this.hasLoaded)){this.isPlaying=!0;for(re in this.components)this.components[re].play();for(F=this.getChildEntities(),z=0;z<F.length;z++)F[z].play();this.emit("play")}},writable:!0},pause:{value:function(){var F,z,re;if(this.isPlaying){this.isPlaying=!1;for(re in this.components)this.components[re].pause();for(F=this.getChildEntities(),z=0;z<F.length;z++)F[z].pause();this.emit("pause")}},writable:!0},setEntityAttribute:{value:function(F,z,re){if(w[F]||this.components[F]){this.updateComponent(F,re);return}if(F==="mixin"){if(re===this.computedMixinStr)return;this.mixinUpdate(re,z)}}},mixinUpdate:{value:function(){var F=[];return function(z,re){var Y,ee,J,ce,j=this;if(!this.hasLoaded){this.addEventListener("loaded",function(){j.mixinUpdate(z,re)},g);return}for(re=re||this.getAttribute("mixin"),J=this.updateMixins(z,re),F.length=0,ce=0;ce<this.mixinEls.length;ce++)for(Y in this.mixinEls[ce].componentCache)F.indexOf(Y)===-1&&(this.components[Y]?this.components[Y].handleMixinUpdate():this.initComponent(Y,null),F.push(Y));for(ce=0;ce<J.oldMixinIds.length;ce++)if(ee=document.getElementById(J.oldMixinIds[ce]),!!ee)for(Y in ee.componentCache)F.indexOf(Y)===-1&&this.components[Y]&&(this.getDOMAttribute(Y)?this.components[Y].handleMixinUpdate():this.removeComponent(Y,!0))}}()},setAttribute:{value:function(){var F={};return function(z,re,Y){var ee,J,ce,j,oe,Z;if(j=z.indexOf(u),ce=j>0?z.substring(0,j):z,!w[ce]){z==="mixin"&&this.mixinUpdate(re),l.prototype.setAttribute.call(this,z,re);return}if(!this.components[z]&&this.hasAttribute(z)&&this.updateComponent(z,window.HTMLElement.prototype.getAttribute.call(this,z)),typeof Y<"u"&&typeof re=="string"&&re.length>0&&typeof d.styleParser.parse(re)=="string"){for(Z in F)delete F[Z];ee=F,ee[re]=Y,J=!1}else ee=re,J=Y===!0;this.updateComponent(z,ee,J),oe=this.sceneEl&&this.sceneEl.getAttribute("debug"),oe&&this.components[z].flushToDOM()}}(),writable:window.debug},flushToDOM:{value:function(F){var z=this.components,re,Y=this.children,ee,J;for(J in z)z[J].flushToDOM();if(F)for(ee=0;ee<Y.length;++ee)re=Y[ee],re.flushToDOM&&re.flushToDOM(F)}},getAttribute:{value:function(F){var z;return F==="position"?this.object3D.position:F==="rotation"?O(this):F==="scale"?this.object3D.scale:F==="visible"?this.object3D.visible:(z=this.components[F],z?z.data:window.HTMLElement.prototype.getAttribute.call(this,F))},writable:window.debug},getDOMAttribute:{value:function(F){var z=this.components[F];return z?z.attrValue:window.HTMLElement.prototype.getAttribute.call(this,F)},writable:window.debug},addState:{value:function(F){this.is(F)||(this.states.push(F),this.emit("stateadded",F))}},removeState:{value:function(F){var z=this.states.indexOf(F);z!==-1&&(this.states.splice(z,1),this.emit("stateremoved",F))}},is:{value:function(F){return this.states.indexOf(F)!==-1}},inspect:{value:function(){this.sceneEl.components.inspector.openInspector(this)}},destroy:{value:function(){var F;if(this.parentNode){m("Entity can only be destroyed if detached from scenegraph.");return}for(F in this.components)this.components[F].destroy()}}});function x(F,z){return F.components[z]&&F.components[z].attrValue?!0:L(z,F.mixinEls)}function L(F,z){var re,Y=!1;for(re=0;re<z.length&&(Y=z[re].hasAttribute(F),!Y);++re);return Y}function T(F,z){return z?z.constructor===Object?d.extend(z,d.styleParser.parse(F||{})):F||z:F}function R(F){return F.indexOf(u)!==-1&&(F=d.split(F,u)[0]),!!w[F]}function O(F){var z=E.Math.radToDeg,re=F.object3D.rotation,Y=F.rotationObj;return Y.x=z(re.x),Y.y=z(re.y),Y.z=z(re.z),Y}v=A("a-entity",{prototype:y}),N.exports=v},{"../lib/three":179,"../utils/":205,"./a-node":129,"./a-register-element":130,"./component":131}],128:[function(M,N,$){var l=M("./a-node"),w=M("./a-register-element").registerElement,A=M("./component").components,E=M("../utils"),d="__";N.exports=w("a-mixin",{prototype:Object.create(l.prototype,{createdCallback:{value:function(){this.componentCache={},this.id=this.getAttribute("id"),this.isMixin=!0}},attributeChangedCallback:{value:function(v,f,m){this.cacheAttribute(v,m),this.updateEntities()}},attachedCallback:{value:function(){this.sceneEl=this.closestScene(),this.cacheAttributes(),this.updateEntities(),this.load()}},setAttribute:{value:function(v,f){window.HTMLElement.prototype.setAttribute.call(this,v,f),this.cacheAttribute(v,f)}},cacheAttribute:{value:function(v,f){var m,u;u=E.split(v,d)[0],m=A[u],m&&(f===void 0&&(f=window.HTMLElement.prototype.getAttribute.call(this,v)),this.componentCache[v]=m.parseAttrValueForCache(f))}},getAttribute:{value:function(v){return this.componentCache[v]||window.HTMLElement.prototype.getAttribute.call(this,v)}},cacheAttributes:{value:function(){var v=this.attributes,f,m;for(m=0;m<v.length;m++)f=v[m].name,this.cacheAttribute(f)}},updateEntities:{value:function(){var v,f,m;if(this.sceneEl)for(f=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),m=0;m<f.length;m++)v=f[m],!(!v.hasLoaded||v.isMixin)&&v.mixinUpdate(this.id)}}})})},{"../utils":205,"./a-node":129,"./a-register-element":130,"./component":131}],129:[function(M,N,$){var l=M("./a-register-element").registerElement,w=M("./a-register-element").isNode,A=M("../utils/"),E=A.debug("core:a-node:warn"),d=A.debug("core:a-node:error");N.exports=l("a-node",{prototype:Object.create(window.HTMLElement.prototype,{createdCallback:{value:function(){this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]},writable:window.debug},attachedCallback:{value:function(){var v;this.sceneEl=this.closestScene(),this.sceneEl||E("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(v=this.getAttribute("mixin"),v&&this.updateMixins(v))},writable:window.debug},attributeChangedCallback:{value:function(v,f,m){m!==this.computedMixinStr&&v==="mixin"&&!this.isMixin&&this.updateMixins(m,f)}},closestScene:{value:function(){for(var f=this;f&&!f.isScene;)f=f.parentElement;return f}},closest:{value:function(f){for(var m=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,u=this;u&&!m.call(u,f);)u=u.parentElement;return u}},detachedCallback:{value:function(){this.hasLoaded=!1}},load:{value:function(v,f){var m,u,b=this;this.hasLoaded||(f=f||w,m=this.getChildren(),u=m.filter(f).map(function(g){return new Promise(function(x){if(g.hasLoaded)return x();g.addEventListener("loaded",x)})}),Promise.all(u).then(function(){b.hasLoaded=!0,v&&v(),b.emit("loaded",void 0,!1)}).catch(function(g){d("Failure loading node: ",g)}))},writable:!0},getChildren:{value:function(){return Array.prototype.slice.call(this.children,0)}},updateMixins:{value:function(){var v=[],f=[],m={};return function(u,b){var g,y,x;for(v.length=0,f.length=0,y=u?A.split(u.trim(),/\s+/):v,x=b?A.split(b.trim(),/\s+/):f,m.newMixinIds=y,m.oldMixinIds=x,g=0;g<x.length;g++)y.indexOf(x[g])===-1&&this.unregisterMixin(x[g]);for(this.computedMixinStr="",this.mixinEls.length=0,g=0;g<y.length;g++)this.registerMixin(document.getElementById(y[g]));return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),m}}()},registerMixin:{value:function(v){var f,m,u;if(v){if(u=v.getAttribute("mixin"),u)for(f=A.split(u.trim(),/\s+/),m=0;m<f.length;m++)this.registerMixin(document.getElementById(f[m]));this.computedMixinStr=this.computedMixinStr+" "+v.id,this.mixinEls.push(v)}}},setAttribute:{value:function(v,f){v==="mixin"&&this.updateMixins(f),window.HTMLElement.prototype.setAttribute.call(this,v,f)}},unregisterMixin:{value:function(v){var f,m=this.mixinEls,u;for(f=0;f<m.length;++f)if(u=m[f],v===u.id){m.splice(f,1);break}}},emit:{value:function(){var v={};return function(f,m,u,b){u===void 0&&(u=!0),v.bubbles=!!u,v.detail=m,b&&(v=A.extend({},b,v)),this.dispatchEvent(new CustomEvent(f,v))}}(),writable:window.debug}})})},{"../utils/":205,"./a-register-element":130}],130:[function(M,N,$){M("document-register-element");var l,w,A=N.exports.knownTags={};function E(b){A[b.toLowerCase()]=!0}N.exports.isNode=function(b){return b.tagName.toLowerCase()in A||b.isNode},N.exports.registerElement=function(b,g){var y=Object.getPrototypeOf(g.prototype),x=g,L=l&&y===l.prototype,T=w&&y===w.prototype;return(L||T)&&E(b),L&&(x=d(g.prototype),x={prototype:Object.create(y,x)}),T&&(x=v(g.prototype),x={prototype:Object.create(y,x)}),Object.getOwnPropertyNames(x.prototype).forEach(function(R){var O=x.prototype[R];typeof O=="function"&&(O.displayName=R)}),document.registerElement(b,x)};function d(b){var g={},y=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"];return f(g,y,b,l.prototype),u(b,g),g}function v(b){var g={},y=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],x=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"];return f(g,y,b,l.prototype),f(g,x,b,w.prototype),u(b,g),g}function f(b,g,y,x){g.forEach(function(L){m(b,L,y,x)})}N.exports.wrapMethods=f;function m(b,g,y,x){var L=y[g],T=x[g];!L||!T||L!==T&&(b[g]={value:function(){return T.apply(this,arguments),L.apply(this,arguments)},writable:window.debug})}function u(b,g){var y=Object.getOwnPropertyNames(b);y.forEach(function(x){var L;g[x]||(L=Object.getOwnPropertyDescriptor(b,x),g[x]={value:b[x],writable:L.writable})})}l=M("./a-node"),w=M("./a-entity")},{"./a-entity":127,"./a-node":129,"document-register-element":12}],131:[function(M,N,$){var l=M("./schema"),w=M("./scene/scenes"),A=M("./system"),E=M("../utils/"),d=N.exports.components={},v=l.parseProperties,f=l.parseProperty,m=l.process,u=l.isSingleProperty,b=l.stringifyProperties,g=l.stringifyProperty,y=E.styleParser,x=E.debug("core:component:warn"),L=document.currentScript,T=new RegExp("[A-Z]+"),R={},O=N.exports.Component=function(Z,ye,Ne){var je=this;this.el=Z,this.id=Ne,this.attrName=this.name+(Ne?"__"+Ne:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.isSingleProperty=u(this.schema),this.isSinglePropertyObject=this.isSingleProperty&&j(f(void 0,this.schema))&&!(this.schema.default instanceof window.HTMLElement),this.isObjectBased=!this.isSingleProperty||this.isSinglePropertyObject,this.el.components[this.attrName]=this,this.objectPool=R[this.name];const ke=this.events;this.events={},F(this,ke),this.attrValue=void 0,this.isObjectBased?(this.nextData=this.objectPool.use(),E.objectPool.removeUnusedKeys(this.nextData,this.schema),this.oldData=this.objectPool.use(),E.objectPool.removeUnusedKeys(this.oldData,this.schema),this.previousOldData=this.objectPool.use(),E.objectPool.removeUnusedKeys(this.previousOldData,this.schema),this.parsingAttrValue=this.objectPool.use(),E.objectPool.removeUnusedKeys(this.parsingAttrValue,this.schema)):(this.nextData=void 0,this.oldData=void 0,this.previousOldData=void 0,this.parsingAttrValue=void 0),this.throttledEmitComponentChanged=E.throttle(function(){Z.emit("componentchanged",je.evtDetail,!1)},200),this.updateProperties(ye)};O.prototype={schema:{},init:function(){},events:{},update:function(Z){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},parse:function(Z,ye){var Ne=this.schema;return this.isSingleProperty?f(Z,Ne):v(y.parse(Z),Ne,!0,this.name,ye)},stringify:function(Z){var ye=this.schema;return typeof Z=="string"?Z:this.isSingleProperty?g(Z,ye):(Z=b(Z,ye),y.stringify(Z))},updateCachedAttrValue:function(Z,ye){var Ne,je,ke;if(Z!==void 0){if(Z===null){this.isObjectBased&&this.attrValue&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0;return}if(Z instanceof Object&&!(Z instanceof window.HTMLElement)?(je=this.objectPool.use(),Ne=E.extend(je,Z)):Ne=this.parseAttrValueForCache(Z),this.isObjectBased&&!ye&&this.attrValue)for(ke in this.attrValue)Ne[ke]===void 0&&(Ne[ke]=this.attrValue[ke]);this.isObjectBased&&!this.attrValue&&(this.attrValue=this.objectPool.use()),E.objectPool.clearObject(this.attrValue),this.attrValue=Y(this.attrValue,Ne,this.isObjectBased),E.objectPool.clearObject(je)}},parseAttrValueForCache:function(Z){var ye;return typeof Z!="string"?Z:(this.isSingleProperty?(ye=this.schema.parse(Z),typeof ye=="string"&&(ye=Z)):(E.objectPool.clearObject(this.parsingAttrValue),ye=y.parse(Z,this.parsingAttrValue)),ye)},flushToDOM:function(Z){var ye=Z?this.data:this.attrValue;ye!=null&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(ye))},updateProperties:function(Z,ye){var Ne=this.el;if(!Ne.hasLoaded){this.updateCachedAttrValue(Z);return}Z!==null&&(Z=this.parseAttrValueForCache(Z)),this.updateCachedAttrValue(Z,ye),this.initialized?(this.updateComponent(Z,ye),this.callUpdateHandler()):this.initComponent()},initComponent:function(){var Z=this.el,ye;this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!1,!0)),this.data=this.buildData(this.attrValue),!Z.initializingComponents[this.name]&&(Z.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete Z.initializingComponents[this.name],this.oldData=Y(this.oldData,this.data,this.isObjectBased),ye=this.isObjectBased?this.objectPool.use():void 0,this.update(ye),this.isObjectBased&&this.objectPool.recycle(ye),Z.isPlaying&&this.play(),Z.emit("componentinitialized",this.evtDetail,!1))},updateComponent:function(Z,ye){var Ne,je;if(ye){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}if(this.isSingleProperty){this.isObjectBased&&f(Z,this.schema),this.data=Z;return}if(v(Z,this.schema,!0,this.name),this.schemaChangeKeys.length){for(Ne in Z)if(this.schema[Ne].schemaChange){je=!0;break}}if(je){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}for(Ne in Z)Z[Ne]!==void 0&&(this.data[Ne]=Z[Ne])},callUpdateHandler:function(){var Z;this.previousOldData instanceof Object&&E.objectPool.clearObject(this.previousOldData),this.isObjectBased?re(this.previousOldData,this.oldData):this.previousOldData=this.oldData,Z=!E.deepEqual(this.oldData,this.data),!(!this.isPositionRotationScale&&!Z)&&(this.oldData instanceof Object&&E.objectPool.clearObject(this.oldData),this.oldData=Y(this.oldData,this.data,this.isObjectBased),this.update(this.previousOldData),this.throttledEmitComponentChanged())},handleMixinUpdate:function(){this.data=this.buildData(this.attrValue),this.callUpdateHandler()},resetProperty:function(Z){if(this.isObjectBased){if(!(Z in this.attrValue))return;delete this.attrValue[Z],this.data[Z]=this.schema[Z].default}else this.attrValue=this.schema.default,this.data=this.schema.default;this.updateProperties(this.attrValue)},extendSchema:function(Z){var ye;ye=E.extend({},d[this.name].schema),E.extend(ye,Z),this.schema=m(ye),this.el.emit("schemachanged",this.evtDetail)},buildData:function(Z,ye,Ne){var je,ke,it,rt,Mt,Rt=this.nextData,Wt=this.schema,nr,Dr=this.el.mixinEls,wt;if(je=Z&&Z.constructor===Array?Z.length:Z!=null,this.isObjectBased&&E.objectPool.clearObject(Rt),this.isSingleProperty)this.isObjectBased?ke=re(Rt,Wt.default):ke=oe(Wt.default)?E.clone(Wt.default):Wt.default;else{wt=!ye&&this.attrValue,ke=wt instanceof Object?re(Rt,wt):Rt;for(rt in Wt)it=Wt[rt].default,ke[rt]===void 0&&(ke[rt]=oe(it)?E.clone(it):it)}for(nr=0;nr<Dr.length;nr++)Mt=Dr[nr].getAttribute(this.attrName),Mt&&(ke=Y(ke,Mt,this.isObjectBased));if(je){if(this.isSingleProperty)return j(Z)?(re(this.parsingAttrValue,Z),f(this.parsingAttrValue,Wt)):f(Z,Wt);ke=Y(ke,Z,this.isObjectBased)}else if(this.isSingleProperty)return f(ke,Wt);return v(ke,Wt,void 0,this.name,Ne)},eventsAttach:function(){var Z;this.eventsDetach();for(Z in this.events)this.el.addEventListener(Z,this.events[Z])},eventsDetach:function(){var Z;for(Z in this.events)this.el.removeEventListener(Z,this.events[Z])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.oldData),this.objectPool.recycle(this.parsingAttrValue),this.attrValue=this.oldData=this.parsingAttrValue=void 0}};function F(Z,ye){var Ne;for(Ne in ye)Z.events[Ne]=ye[Ne].bind(Z)}if(window.debug)var z=N.exports.registrationOrderWarnings={};N.exports.registerComponent=function(Z,ye){var Ne,je,ke={},it,rt;if(document.currentScript&&document.currentScript!==L&&w.forEach(function(Rt){Rt.hasLoaded||document.currentScript.compareDocumentPosition(Rt)!==Node.DOCUMENT_POSITION_FOLLOWING&&(x("The component `"+Z+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(z[Z]=!0))}),T.test(Z)===!0&&x("The component name `"+Z+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+Z.toLowerCase()+"`"),Z.indexOf("__")!==-1)throw new Error("The component name `"+Z+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(ye).forEach(function(Mt){ke[Mt]={value:ye[Mt],writable:!0}}),d[Z])throw new Error("The component `"+Z+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");if(Ne=function(Mt,Rt,Wt){O.call(this,Mt,Rt,Wt)},Ne.prototype=Object.create(O.prototype,ke),Ne.prototype.name=Z,Ne.prototype.isPositionRotationScale=Z==="position"||Z==="rotation"||Z==="scale",Ne.prototype.constructor=Ne,Ne.prototype.system=A&&A.systems[Z],Ne.prototype.play=ce(Ne.prototype.play),Ne.prototype.pause=J(Ne.prototype.pause),it=E.extend(m(Ne.prototype.schema,Ne.prototype.name)),rt=u(Ne.prototype.schema),!rt){Ne.prototype.schemaChangeKeys=[];for(je in it)it[je].schemaChange&&Ne.prototype.schemaChangeKeys.push(je)}return R[Z]=E.objectPool.createPool(),d[Z]={Component:Ne,dependencies:Ne.prototype.dependencies,isSingleProp:rt,multiple:Ne.prototype.multiple,name:Z,parse:Ne.prototype.parse,parseAttrValueForCache:Ne.prototype.parseAttrValueForCache,schema:it,stringify:Ne.prototype.stringify,type:Ne.prototype.type},Ne};function re(Z,ye){var Ne,je;for(je in ye)ye[je]!==void 0&&(Ne=ye[je],Z[je]=oe(Ne)?E.clone(Ne):Ne);return Z}function Y(Z,ye,Ne){var je;if(Ne&&ye.constructor===Object){for(je in ye)ye[je]!==void 0&&(ye[je]&&ye[je].constructor===Object?Z[je]=E.clone(ye[je]):Z[je]=ye[je]);return Z}return ye}function ee(Z){return Z.tick||Z.tock}function J(Z){return function(){var Ne=this.el.sceneEl;this.isPlaying&&(Z.call(this),this.isPlaying=!1,this.eventsDetach(),ee(this)&&Ne.removeBehavior(this))}}function ce(Z){return function(){var Ne=this.el.sceneEl,je=this.el.isPlaying&&!this.isPlaying;!this.initialized||!je||(Z.call(this),this.isPlaying=!0,this.eventsAttach(),ee(this)&&Ne.addBehavior(this))}}function j(Z){return Z&&Z.constructor===Object&&!(Z instanceof window.HTMLElement)}function oe(Z){return Z&&(Z.constructor===Object||Z.constructor===Array)&&!(Z instanceof window.HTMLElement)}},{"../utils/":205,"./scene/scenes":138,"./schema":140,"./system":142}],132:[function(M,N,$){var l=M("./schema"),w=l.process,A=N.exports.geometries={},E=N.exports.geometryNames=[],d=M("../lib/three"),v=N.exports.Geometry=function(){};v.prototype={schema:{},init:function(f){return this.geometry=new d.BufferGeometry,this.geometry},update:function(f){}},N.exports.registerGeometry=function(f,m){var u,b={};if(Object.keys(m).forEach(function(y){b[y]={value:m[y],writable:!0}}),A[f])throw new Error("The geometry `"+f+"` has been already registered");return u=function(){v.call(this)},u.prototype=Object.create(v.prototype,b),u.prototype.name=f,u.prototype.constructor=u,A[f]={Geometry:u,schema:w(u.prototype.schema)},E.push(f),u}},{"../lib/three":179,"./schema":140}],133:[function(M,N,$){var l=M("../utils/coordinates"),w=M("debug"),A=w("core:propertyTypes:warn"),E=w("core:propertyTypes:warn"),d=N.exports.propertyTypes={},v=/[,> .[\]:]/,f=/\url\((.+)\)/;m("audio","",g),m("array",[],u,b),m("asset","",g),m("boolean",!1,L),m("color","#FFF",y,x),m("int",0,T),m("number",0,R),m("map","",g),m("model","",g),m("selector",null,O,z),m("selectorAll",null,F,re),m("src","",Y),m("string","",y,x),m("time",0,T),m("vec2",{x:0,y:0},ee,l.stringify),m("vec3",{x:0,y:0,z:0},ee,l.stringify),m("vec4",{x:0,y:0,z:0,w:1},ee,l.stringify);function m(j,oe,Z,ye){if("type"in d){A("Property type "+j+" is already registered.");return}d[j]={default:oe,parse:Z||y,stringify:ye||x}}N.exports.registerPropertyType=m;function u(j){if(Array.isArray(j))return j;if(!j||typeof j!="string")return[];return j.split(",").map(oe);function oe(Z){return Z.trim()}}function b(j){return j.join(", ")}function g(j){var oe,Z;if(typeof j!="string")return j;if(Z=j.match(f),Z)return Z[1];if(j.charAt(0)==="#"){if(oe=document.getElementById(j.substring(1)),oe)return oe.tagName==="CANVAS"||oe.tagName==="VIDEO"||oe.tagName==="IMG"?oe:oe.getAttribute("src");E('"'+j+'" asset not found.');return}return j}function y(j){return j}function x(j){return j===null?"null":j.toString()}function L(j){return j!=="false"&&j!==!1}function T(j){return parseInt(j,10)}function R(j){return parseFloat(j,10)}function O(j){return j?typeof j!="string"?j:j[0]==="#"&&!v.test(j)?document.getElementById(j.substring(1)):document.querySelector(j):null}function F(j){return j?typeof j!="string"?j:Array.prototype.slice.call(document.querySelectorAll(j),0):null}function z(j){return j.getAttribute?"#"+j.getAttribute("id"):x(j)}function re(j){return j instanceof Array?j.map(function(oe){return"#"+oe.getAttribute("id")}).join(", "):x(j)}function Y(j){return E("`src` property type is deprecated. Use `asset` instead."),g(j)}function ee(j){return l.parse(j,this.default)}function J(j,oe){return j==="audio"&&typeof oe!="string"||j==="array"&&!Array.isArray(oe)||j==="asset"&&typeof oe!="string"||j==="boolean"&&typeof oe!="boolean"||j==="color"&&typeof oe!="string"||j==="int"&&typeof oe!="number"||j==="number"&&typeof oe!="number"||j==="map"&&typeof oe!="string"||j==="model"&&typeof oe!="string"||j==="selector"&&typeof oe!="string"&&oe!==null||j==="selectorAll"&&typeof oe!="string"&&oe!==null||j==="src"&&typeof oe!="string"||j==="string"&&typeof oe!="string"||j==="time"&&typeof oe!="number"?!1:j==="vec2"?ce(oe,2):j==="vec3"?ce(oe,3):j==="vec4"?ce(oe,4):!0}N.exports.isValidDefaultValue=J;function ce(j,oe){if(j===null)return!0;if(typeof j!="object"||Object.keys(j).length!==oe)return!1;var Z=j.x,ye=j.y,Ne=j.z,je=j.w;return!(typeof Z!="number"||typeof ye!="number"||oe>2&&typeof Ne!="number"||oe>3&&typeof je!="number")}N.exports.isValidDefaultCoordinate=ce},{"../utils/coordinates":200,debug:8}],134:[function(M,N,$){var l=M("./metaTags").inject,w=M("./wakelock"),A=M("./loadingScreen"),E=M("../a-register-element"),d=M("./scenes"),v=M("../system").systems,f=M("../../lib/three"),m=M("../../utils/"),u=M("../a-entity"),b=M("../a-node"),g=M("./postMessage"),y=m.bind,x=m.device.isIOS(),L=m.device.isMobile(),T=m.device.isWebXRAvailable,R=E.registerElement,O=m.debug("core:a-scene:warn");x&&M("../../utils/ios-orientationchange-blank-bug"),N.exports.AScene=R("a-scene",{prototype:Object.create(u.prototype,{createdCallback:{value:function(){this.clock=new f.Clock,this.isIOS=x,this.isMobile=L,this.hasWebXR=T,this.isAR=!1,this.isScene=!0,this.object3D=new f.Scene;var J=this;this.object3D.onAfterRender=function(ce,j,oe){J.isPlaying&&J.tock(J.time,J.delta,oe)},this.resize=y(this.resize,this),this.render=y(this.render,this),this.systems={},this.systemNames=[],this.time=this.delta=0,this.behaviors={tick:[],tock:[]},this.hasLoaded=!1,this.isPlaying=!1,this.originalHTML=this.innerHTML,this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("vr-mode-ui",""),this.setAttribute("device-orientation-permission-ui","")}},addFullScreenStyles:{value:function(){document.documentElement.classList.add("a-fullscreen")}},removeFullScreenStyles:{value:function(){document.documentElement.classList.remove("a-fullscreen")}},attachedCallback:{value:function(){var J=this,ce=this.hasAttribute("embedded");ee(this),this.setupRenderer(),A.setup(this,F),this.resize(),ce||this.addFullScreenStyles(),g(this),l(this),w(this),this.onVRPresentChangeBound=y(this.onVRPresentChange,this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){J.enterVR()},this.exitVRBound=function(){J.exitVR()},this.exitVRTrueBound=function(){J.exitVR(!0)},this.pointerRestrictedBound=function(){J.pointerRestricted()},this.pointerUnrestrictedBound=function(){J.pointerUnrestricted()},T||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){J.attachedCallbackPostCamera()}),this.initSystems(),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){J.enterVR()})}},attachedCallbackPostCamera:{value:function(){var J,ce=this;window.addEventListener("load",J),window.addEventListener("resize",function(){ce.isIOS?setTimeout(ce.resize,100):ce.resize()}),this.play(),d.push(this)},writable:window.debug},initSystems:{value:function(){var J;this.initSystem("camera");for(J in v)J!=="camera"&&this.initSystem(J)}},initSystem:{value:function(J){this.systems[J]||(this.systems[J]=new v[J](this),this.systemNames.push(J))}},detachedCallback:{value:function(){var J=d.indexOf(this);d.splice(J,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.xr.dispose()}},addBehavior:{value:function(J){var ce,j=this.behaviors,oe;for(oe in j)J[oe]&&(ce=this.behaviors[oe],ce.indexOf(J)===-1&&ce.push(J))}},getPointerLockElement:{value:function(){return document.pointerLockElement},writable:window.debug},checkHeadsetConnected:{value:m.device.checkHeadsetConnected,writable:window.debug},enterAR:{value:function(){var J;if(!this.hasWebXR)throw J="Failed to enter AR mode, WebXR not supported.",new Error(J);if(!m.device.checkARSupport())throw J="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.",new Error(J);return this.enterVR(!0)}},enterVR:{value:function(J){var ce=this,j,oe=ce.renderer.xr,Z;if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile)if(oe.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var ye=this.sceneEl.systems.webxr.sessionReferenceSpaceType;oe.setReferenceSpaceType(ye);var Ne=J?"immersive-ar":"immersive-vr";return Z=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(Mt,Rt){navigator.xr.requestSession(Ne,Z).then(function(nr){ce.xrSession=nr,oe.layersEnabled=Z.requiredFeatures.indexOf("layers")!==-1,oe.setSession(nr),nr.addEventListener("end",ce.exitVRBound),it(Mt)},function(nr){var Dr=Ne==="immersive-ar",wt=Dr?"AR":"VR";throw new Error("Failed to enter "+wt+" mode (`requestSession`) "+nr)})})}else{if(j=m.device.getVRDisplay(),oe.setDevice(j),j.isPresenting&&!window.hasNativeWebVRImplementation)return it(),Promise.resolve();var je=this.getAttribute("renderer"),ke={highRefreshRate:je.highRefreshRate,foveationLevel:je.foveationLevel};return j.requestPresent([{source:this.canvas,attributes:ke}]).then(it,rt)}return it(),Promise.resolve();function it(Mt){var Rt;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&(Rt=new CustomEvent("vrdisplaypresentchange",{detail:{display:m.device.getVRDisplay()}}),window.dispatchEvent(Rt)),J?ce.addState("ar-mode"):ce.addState("vr-mode"),ce.emit("enter-vr",{target:ce}),!T&&ce.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),ce.addFullScreenStyles(),!ce.isMobile&&!ce.checkHeadsetConnected()&&re(ce.canvas),ce.renderer.setAnimationLoop(ce.render),ce.resize(),Mt&&Mt()}function rt(Mt){throw ce.removeState("vr-mode"),Mt&&Mt.message?new Error("Failed to enter VR mode (`requestPresent`): "+Mt.message):new Error("Failed to enter VR mode (`requestPresent`).")}},writable:!0},exitVR:{value:function(){var J=this,ce,j=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(j.enabled=!1,ce=m.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0,j.setSession(null);else if(ce.isPresenting)return ce.exitPresent().then(oe,Z)}else Y();return oe(),Promise.resolve();function oe(){J.removeState("vr-mode"),J.removeState("ar-mode"),J.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),J.hasAttribute("embedded")&&J.removeFullScreenStyles(),J.resize(),J.isIOS&&m.forceCanvasResizeSafariMobile(J.canvas),J.renderer.setPixelRatio(window.devicePixelRatio),J.emit("exit-vr",{target:J})}function Z(ye){throw ye&&ye.message?new Error("Failed to exit VR mode (`exitPresent`): "+ye.message):new Error("Failed to exit VR mode (`exitPresent`).")}},writable:!0},pointerRestricted:{value:function(){if(this.canvas){var J=this.getPointerLockElement();J&&J!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}},pointerUnrestricted:{value:function(){var J=this.getPointerLockElement();J&&J===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}},onVRPresentChange:{value:function(J){var ce=J.display||J.detail.display;if(ce&&ce.isPresenting){this.enterVR();return}this.exitVR()}},getAttribute:{value:function(J){var ce=this.systems[J];return ce?ce.data:u.prototype.getAttribute.call(this,J)}},getComputedAttribute:{value:function(J){O("`getComputedAttribute` is deprecated. Use `getAttribute` instead."),this.getAttribute(J)}},getDOMAttribute:{value:function(J){var ce=this.systems[J];return ce?ce.data:u.prototype.getDOMAttribute.call(this,J)}},setAttribute:{value:function(J,ce,j){var oe=this.systems[J];if(oe){b.prototype.setAttribute.call(this,J,ce),oe.updateProperties(ce);return}u.prototype.setAttribute.call(this,J,ce,j)}},removeBehavior:{value:function(J){var ce,j,oe=this.behaviors,Z;for(j in oe)J[j]&&(ce=this.behaviors[j],Z=ce.indexOf(J),Z!==-1&&ce.splice(Z,1))}},resize:{value:function(){var J=this.camera,ce=this.canvas,j,oe,Z,ye=this.renderer.xr.isPresenting;oe=this.renderer.xr.enabled&&ye,!(!J||!ce||this.is("vr-mode")&&(this.isMobile||oe))&&(j=this.getAttribute("embedded")&&!this.is("vr-mode"),Z=F(ce,j,this.maxCanvasSize,this.is("vr-mode")),J.aspect=Z.width/Z.height,J.updateProjectionMatrix(),this.renderer.setSize(Z.width,Z.height,!1),this.emit("rendererresize",null,!1))},writable:!0},setupRenderer:{value:function(){var J=this,ce,j,oe,Z;Z={alpha:!0,antialias:!L,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:1920,width:1920},this.hasAttribute("renderer")&&(oe=this.getAttribute("renderer"),j=m.styleParser.parse(oe),j.precision&&(Z.precision=j.precision+"p"),j.antialias&&j.antialias!=="auto"&&(Z.antialias=j.antialias==="true"),j.logarithmicDepthBuffer&&j.logarithmicDepthBuffer!=="auto"&&(Z.logarithmicDepthBuffer=j.logarithmicDepthBuffer==="true"),j.alpha&&(Z.alpha=j.alpha==="true"),this.maxCanvasSize={width:j.maxCanvasWidth?parseInt(j.maxCanvasWidth):this.maxCanvasSize.width,height:j.maxCanvasHeight?parseInt(j.maxCanvasHeight):this.maxCanvasSize.height}),ce=this.renderer=new f.WebGLRenderer(Z),ce.setPixelRatio(window.devicePixelRatio),ce.sortObjects=!1,this.camera&&ce.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){ce.xr.setPoseTarget(J.camera.el.object3D)})},writable:window.debug},play:{value:function(){var J=this,ce=this;if(this.renderStarted){u.prototype.play.call(this);return}this.addEventListener("loaded",function(){var j=this.renderer,oe,Z=this.renderer.xr;u.prototype.play.call(this),!ce.renderStarted&&(ce.resize(),ce.renderer&&(window.performance&&window.performance.mark("render-started"),A.remove(),oe=m.device.getVRDisplay(),oe&&oe.isPresenting&&(Z.setDevice(oe),Z.enabled=!0,ce.enterVR()),j.setAnimationLoop(this.render),ce.renderStarted=!0,ce.emit("renderstart")))}),setTimeout(function(){u.prototype.load.call(J)})}},updateComponent:{value:function(J){J in v||u.prototype.updateComponent.apply(this,arguments)}},tick:{value:function(J,ce){var j,oe=this.systems;for(j=0;j<this.behaviors.tick.length;j++)this.behaviors.tick[j].el.isPlaying&&this.behaviors.tick[j].tick(J,ce);for(j=0;j<this.systemNames.length;j++)oe[this.systemNames[j]].tick&&oe[this.systemNames[j]].tick(J,ce)}},tock:{value:function(J,ce,j){var oe,Z=this.systems;for(oe=0;oe<this.behaviors.tock.length;oe++)this.behaviors.tock[oe].el.isPlaying&&this.behaviors.tock[oe].tock(J,ce,j);for(oe=0;oe<this.systemNames.length;oe++)Z[this.systemNames[oe]].tock&&Z[this.systemNames[oe]].tock(J,ce,j)}},render:{value:function(J,ce){var j=this.renderer;this.frame=ce,this.delta=this.clock.getDelta()*1e3,this.time=this.clock.elapsedTime*1e3,this.isPlaying&&this.tick(this.time,this.delta);var oe=null;this.is("ar-mode")&&(oe=this.object3D.background,this.object3D.background=null),j.render(this.object3D,this.camera),oe&&(this.object3D.background=oe)},writable:!0}})});function F(J,ce,j,oe){return J.parentElement?ce?{height:J.parentElement.offsetHeight,width:J.parentElement.offsetWidth}:z(j,oe):{height:0,width:0}}function z(J,ce){var j,oe,Z=window.devicePixelRatio;return oe={height:document.body.offsetHeight,width:document.body.offsetWidth},!J||ce||J.width===-1&&J.height===-1||oe.width*Z<J.width&&oe.height*Z<J.height||(j=oe.width/oe.height,oe.width*Z>J.width&&J.width!==-1&&(oe.width=Math.round(J.width/Z),oe.height=Math.round(J.width/j/Z)),oe.height*Z>J.height&&J.height!==-1&&(oe.height=Math.round(J.height/Z),oe.width=Math.round(J.height*j/Z))),oe}function re(J){var ce=J.requestFullscreen||J.webkitRequestFullscreen||J.mozRequestFullScreen||J.msRequestFullscreen;ce.apply(J,[{navigationUI:"hide"}])}function Y(){var J=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;J&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function ee(J){var ce;ce=document.createElement("canvas"),ce.classList.add("a-canvas"),ce.dataset.aframeCanvas=!0,J.appendChild(ce),document.addEventListener("fullscreenchange",j),document.addEventListener("mozfullscreenchange",j),document.addEventListener("webkitfullscreenchange",j),document.addEventListener("MSFullscreenChange",j),ce.addEventListener("touchmove",function(oe){oe.preventDefault()}),J.canvas=ce,J.emit("render-target-loaded",{target:ce}),setTimeout(y(J.resize,J),0);function j(){var oe=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;oe||J.exitVR(),document.activeElement.blur(),document.body.focus()}}N.exports.setupCanvas=ee},{"../../lib/three":179,"../../utils/":205,"../../utils/ios-orientationchange-blank-bug":206,"../a-entity":127,"../a-node":129,"../a-register-element":130,"../system":142,"./loadingScreen":135,"./metaTags":136,"./postMessage":137,"./scenes":138,"./wakelock":139}],135:[function(M,N,$){var l=M("../../utils/"),w=l.styleParser,A,E,d,v="loading-screen",f="a-loader-title";N.exports.setup=function(g,y){A=g,d=y;var x=A.hasAttribute(v)?w.parse(A.getAttribute(v)):void 0,L=x&&x.dotsColor||"white",T=x&&x.backgroundColor||"#24CAFF",R=x===void 0||x.enabled==="true"||x.enabled===void 0,O,F,z,re,Y,ee,J,ce,j,oe;R&&(O=new THREE.Scene,F=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),z=new THREE.MeshBasicMaterial({color:L}),re=new THREE.Mesh(F,z),Y=re.clone(),ee=re.clone(),J=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),ce=new THREE.Clock,j=0,oe=function(){A.renderer.render(O,J),j=ce.getElapsedTime()%4,re.visible=j>=1,Y.visible=j>=2,ee.visible=j>=3},O.background=new THREE.Color(T),O.add(J),re.position.set(-1,0,-15),Y.position.set(0,0,-15),ee.position.set(1,0,-15),J.add(re),J.add(Y),J.add(ee),u(),setTimeout(function(){A.hasLoaded||(m(J),E.style.display="block",window.addEventListener("resize",function(){m(J)}),A.renderer.setAnimationLoop(oe))},200))},N.exports.remove=function(){window.removeEventListener("resize",m),E&&(E.style.display="none")};function m(b){var g=A.hasAttribute("embedded"),y=d(A.canvas,g,A.maxCanvasSize,A.is("vr-mode"));b.aspect=y.width/y.height,b.updateProjectionMatrix(),A.renderer.setSize(y.width,y.height,!1)}function u(){E=document.createElement("div"),E.className=f,E.innerHTML=document.title,E.style.display="none",A.appendChild(E)}},{"../../utils/":205}],136:[function(M,N,$){var l=M("../../constants/"),w=M("../../utils").extend,A=N.exports.MOBILE_HEAD_TAGS=[d({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),d({name:"mobile-web-app-capable",content:"yes"}),d({name:"theme-color",content:"black"})],E=[d({name:"apple-mobile-web-app-capable",content:"yes"}),d({name:"apple-mobile-web-app-status-bar-style",content:"black"}),v({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function d(m){return{tagName:"meta",attributes:m,exists:function(){return document.querySelector('meta[name="'+m.name+'"]')}}}function v(m){return{tagName:"link",attributes:m,exists:function(){return document.querySelector('link[rel="'+m.rel+'"]')}}}N.exports.inject=function(u){var b=document.head,g=b.querySelector("script"),y,x=[];return A.forEach(L),u.isIOS&&E.forEach(L),x;function L(T){!T||T.exists()||(y=f(T),y&&(g?g.parentNode.insertBefore(y,g):b.appendChild(y),x.push(y)))}};function f(m){if(!(!m||!m.tagName)){var u=document.createElement(m.tagName);return u.setAttribute(l.AFRAME_INJECTED,""),w(u,m.attributes)}}},{"../../constants/":123,"../../utils":205}],137:[function(M,N,$){var l=M("../../utils/bind"),w=M("../../utils/").isIframed;N.exports=function(d){w()&&window.addEventListener("message",l(A,d))};function A(E){var d=this;if(E.data)switch(E.data.type){case"vr":switch(E.data.data){case"enter":d.enterVR();break;case"exit":d.exitVR();break}}}},{"../../utils/":205,"../../utils/bind":199}],138:[function(M,N,$){N.exports=[]},{}],139:[function(M,N,$){var l=M("../../../vendor/wakelock/wakelock");N.exports=function(A){if(A.isMobile){var E=A.wakelock=new l;A.addEventListener("enter-vr",function(){E.request()}),A.addEventListener("exit-vr",function(){E.release()})}}},{"../../../vendor/wakelock/wakelock":220}],140:[function(M,N,$){var l=M("../utils/"),w=M("./propertyTypes"),A=l.debug,E=w.isValidDefaultValue,d=w.propertyTypes,v=A("core:schema:warn");function f(g){return"type"in g?typeof g.type=="string":"default"in g}N.exports.isSingleProperty=f,N.exports.process=function(g,y){var x;if(f(g))return m(g,y);for(x in g)g[x]=m(g[x],y);return g};function m(g,y){var x=g.default,L,T,R=g.type;return g.type?g.type==="bool"?R="boolean":g.type==="float"&&(R="number"):x!==void 0&&(typeof x=="boolean"||typeof x=="number")?R=typeof x:Array.isArray(x)?R="array":R="string",T=d[R],T||v("Unknown property type for component `"+y+"`: "+R),L=!!g.parse,g.parse=g.parse||T.parse,g.stringify=g.stringify||T.stringify,g.type=R,"default"in g?!L&&!E(R,x)&&v("Default value `"+x+"` does not match type `"+R+"` in component `"+y+"`"):g.default=T.default,g}N.exports.processPropertyDefinition=m,N.exports.parseProperties=function(){var g=[];return function(y,x,L,T,R){var O,F,z,re;g.length=0;for(F in L?y:x)L&&y[F]===void 0||g.push(F);if(y===null||typeof y!="object")return y;for(F in y)y[F]!==void 0&&!x[F]&&!R&&v("Unknown property `"+F+"` for component/system `"+T+"`.");for(O=0;O<g.length;O++){if(F=g[O],z=x[F],re=y[F],!x[F])return;y[F]=u(re,z)}return y}}();function u(g,y){return(g==null||g==="")&&(g=y.default,Array.isArray(g)&&(g=g.slice())),y.parse(g,y.default)}N.exports.parseProperty=u,N.exports.stringifyProperties=function(g,y){var x,L,T,R={},O;for(x in g)L=y[x],T=g[x],O=T,typeof O=="object"&&(O=b(T,L),L||v("Unknown component property: "+x)),R[x]=O;return R};function b(g,y){return typeof g!="object"?g:!y||g===null?JSON.stringify(g):y.stringify(g)}N.exports.stringifyProperty=b},{"../utils/":205,"./propertyTypes":133}],141:[function(M,N,$){var l=M("./schema"),w=l.process,A=N.exports.shaders={},E=N.exports.shaderNames=[],d=M("../lib/three"),v=M("../utils"),f={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},m=N.exports.Shader=function(){};m.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(u){return this.attributes=this.initVariables(u,"attribute"),this.uniforms=this.initVariables(u,"uniform"),this.material=new(this.raw?d.RawShaderMaterial:d.ShaderMaterial)({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initVariables:function(u,b){var g,y=this.schema,x={},L;for(g in y)y[g].is===b&&(L=f[y[g].type],x[g]={type:L,value:void 0});return x},update:function(u){this.updateVariables(u,"attribute"),this.updateVariables(u,"uniform")},updateVariables:function(u,b){var g,y,x=this.schema,L;L=b==="uniform"?this.uniforms:this.attributes;for(g in u)if(!(!x[g]||x[g].is!==b)){if(x[g].type==="map"){if(!L[g]||L[g].value===u[g])continue;y="_texture_"+g,this.setMapOnTextureLoad(L,g,y),v.material.updateMapMaterialFromData(y,g,this,u);continue}L[g].value=this.parseValue(x[g].type,u[g]),L[g].needsUpdate=!0}},parseValue:function(u,b){var g;switch(u){case"vec2":return new d.Vector2(b.x,b.y);case"vec3":return new d.Vector3(b.x,b.y,b.z);case"vec4":return new d.Vector4(b.x,b.y,b.z,b.w);case"color":return g=new d.Color(b),new d.Vector3(g.r,g.g,g.b);case"map":return d.ImageUtils.loadTexture(b);default:return b}},setMapOnTextureLoad:function(u,b,g){var y=this;this.el.addEventListener("materialtextureloaded",function(){u[b].value=y.material[g],u[b].needsUpdate=!0})}},N.exports.registerShader=function(u,b){var g,y={};if(Object.keys(b).forEach(function(x){y[x]={value:b[x],writable:!0}}),A[u])throw new Error("The shader "+u+" has been already registered");return g=function(){m.call(this)},g.prototype=Object.create(m.prototype,y),g.prototype.name=u,g.prototype.constructor=g,A[u]={Shader:g,schema:w(g.prototype.schema)},E.push(u),g}},{"../lib/three":179,"../utils":205,"./schema":140}],142:[function(M,N,$){var l=M("./component"),w=M("./schema"),A=M("../utils/"),E=w.parseProperties,d=w.parseProperty,v=w.process,f=w.isSingleProperty,m=A.styleParser,u=N.exports.systems={},b=N.exports.System=function(g){var y=l&&l.components[this.name];this.el=g,this.sceneEl=g,y&&(y.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};b.prototype={schema:{},init:function(){},update:function(g){},updateProperties:function(g){var y=this.data;Object.keys(w).length&&(this.buildData(g),this.update(y))},buildData:function(g){var y=this.schema;Object.keys(y).length&&(g=g||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),f(y)?this.data=d(g,y):this.data=E(m.parse(g)||{},y))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},N.exports.registerSystem=function(g,y){var x,L,T={},R=A.findAllScenes(document);if(Object.keys(y).forEach(function(O){T[O]={value:y[O],writable:!0}}),u[g])throw new Error("The system `"+g+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");for(L=function(O){b.call(this,O)},L.prototype=Object.create(b.prototype,T),L.prototype.name=g,L.prototype.constructor=L,L.prototype.schema=A.extend(v(L.prototype.schema)),u[g]=L,x=0;x<R.length;x++)R[x].initSystem(g)}},{"../utils/":205,"./component":131,"./schema":140}],143:[function(M,N,$){M("./pivot")},{"./pivot":144}],144:[function(M,N,$){var l=M("../../core/component").registerComponent,w=M("../../lib/three"),A=new w.Vector3,E=new w.Vector3;l("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var d=this.data,v=this.el,f=v.object3D.parent,m=v.object3D,u=new w.Group;A.copy(m.position),E.copy(m.rotation),f.remove(m),u.add(m),f.add(u),v.object3D=u,m.position.set(-1*d.x,-1*d.y,-1*d.z),u.position.set(d.x+A.x,d.y+A.y,d.z+A.z),u.rotation.copy(m.rotation),m.rotation.set(0,0,0)}})},{"../../core/component":131,"../../lib/three":179}],145:[function(M,N,$){var l=M("../../core/component").components,w=M("../../core/shader").shaders,A=M("../../utils/"),E={};Object.keys(l.material.schema).forEach(d),Object.keys(w.standard.schema).forEach(d);function d(v){var f=v.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();v==="fog"&&(f="material-fog"),v==="visible"&&(f="material-visible"),E[f]="material."+v}N.exports=function(){return{defaultComponents:{material:{}},mappings:A.extend({},E)}}},{"../../core/component":131,"../../core/shader":141,"../../utils/":205}],146:[function(M,N,$){M("./primitives/a-camera"),M("./primitives/a-cursor"),M("./primitives/a-curvedimage"),M("./primitives/a-gltf-model"),M("./primitives/a-image"),M("./primitives/a-light"),M("./primitives/a-link"),M("./primitives/a-obj-model"),M("./primitives/a-sky"),M("./primitives/a-sound"),M("./primitives/a-text"),M("./primitives/a-video"),M("./primitives/a-videosphere"),M("./primitives/meshPrimitives")},{"./primitives/a-camera":148,"./primitives/a-cursor":149,"./primitives/a-curvedimage":150,"./primitives/a-gltf-model":151,"./primitives/a-image":152,"./primitives/a-light":153,"./primitives/a-link":154,"./primitives/a-obj-model":155,"./primitives/a-sky":156,"./primitives/a-sound":157,"./primitives/a-text":158,"./primitives/a-video":159,"./primitives/a-videosphere":160,"./primitives/meshPrimitives":161}],147:[function(M,N,$){var l=M("../../core/a-entity"),w=M("../../core/component").components,A=M("../../core/a-register-element").registerElement,E=M("../../utils/"),d=E.debug,v=E.entity.setComponentProperty,f=d("extras:primitives:debug"),m=d("extras:primitives:warn"),u=N.exports.primitives={};N.exports.registerPrimitive=function(x,L){x=x.toLowerCase(),f("Registering <%s>",x),L.defaultAttributes&&m("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var T=A(x,{prototype:Object.create(l.prototype,{defaultComponentsFromPrimitive:{value:L.defaultComponents||L.defaultAttributes||{}},deprecated:{value:L.deprecated||null},deprecatedMappings:{value:L.deprecatedMappings||{}},mappings:{value:L.mappings||{}},createdCallback:{value:function(){L.deprecated&&console.warn(L.deprecated),this.resolveMappingCollisions()}},resolveMappingCollisions:{value:function(){var R=this.mappings,O=this;Object.keys(R).forEach(function(z){var re;z!==z.toLowerCase()&&m("Mapping keys should be specified in lower case. The mapping key "+z+" may not be recognized"),w[z]&&(re=R[z].replace(".","-"),R[re]=R[z],delete R[z],console.warn("The primitive "+O.tagName.toLowerCase()+" has a mapping collision. The attribute "+z+" has the same name as a registered component and has been renamed to "+re))})}},getExtraComponents:{value:function(){var R,O,F,z,re,Y,ee=this;for(O=E.clone(this.defaultComponentsFromPrimitive),re=this.getAttribute("mixin"),re&&(re=re.trim().split(" "),re.forEach(function(ye){var Ne=ee.sceneEl.querySelector("#"+ye).componentCache;Object.keys(Ne).forEach(function(ke){O[ke]=J(O[ke],Ne[ke])})})),F=0;F<this.attributes.length;F++)if(R=this.attributes[F],z=this.mappings[R.name],z){Y=E.entity.getComponentPropertyPath(z),Y.constructor===Array?(O[Y[0]]=O[Y[0]]||{},O[Y[0]][Y[1]]=R.value.trim()):O[Y]=R.value.trim();continue}return O;function J(Z,ye){return ce(Z)?j(ye):ce(ye)?j(Z):oe(Z)&&oe(ye)?E.extendDeep(Z,ye):j(ye)}function ce(Z){return typeof Z>"u"}function j(Z){return oe(Z)?E.extendDeep({},Z):Z}function oe(Z){return Z!==null&&Z.constructor===Object}}},attributeChangedCallback:{value:function(R,O,F){var z=this.mappings[R];R in this.deprecatedMappings&&console.warn(this.deprecatedMappings[R]),!(!R||!z)&&v(this,z,F)}}})});return u[x]=T,T};function b(y,x){var L=w[y].schema;Object.keys(L).map(function(T){var R=T.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();x[R]!==void 0&&(R=y+"-"+T),x[R]=y+"."+T})}function g(y,x,L){L=L||{},Object.keys(x).map(function(R){b(R,L)}),N.exports.registerPrimitive(y,E.extendDeep({},null,{defaultComponents:x,mappings:L}))}N.exports.definePrimitive=g},{"../../core/a-entity":127,"../../core/a-register-element":130,"../../core/component":131,"../../utils/":205}],148:[function(M,N,$){var l=M("../primitives").registerPrimitive;l("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},{"../primitives":147}],149:[function(M,N,$){var l=M("../getMeshMixin"),w=M("../primitives").registerPrimitive,A=M("../../../utils/");w("a-cursor",A.extendDeep({},l(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],150:[function(M,N,$){var l=M("../getMeshMixin"),w=M("../primitives").registerPrimitive,A=M("../../../utils/");w("a-curvedimage",A.extendDeep({},l(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],151:[function(M,N,$){var l=M("../primitives").registerPrimitive;l("a-gltf-model",{mappings:{src:"gltf-model"}})},{"../primitives":147}],152:[function(M,N,$){var l=M("../getMeshMixin"),w=M("../primitives").registerPrimitive,A=M("../../../utils/");w("a-image",A.extendDeep({},l(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],153:[function(M,N,$){var l=M("../primitives").registerPrimitive;l("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target"}})},{"../primitives":147}],154:[function(M,N,$){var l=M("../primitives").registerPrimitive;l("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},{"../primitives":147}],155:[function(M,N,$){var l=M("../getMeshMixin")(),w=M("../primitives").registerPrimitive,A=M("../../../utils/");w("a-obj-model",A.extendDeep({},l,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],156:[function(M,N,$){var l=M("../getMeshMixin"),w=M("../primitives").registerPrimitive,A=M("../../../utils/"),E=M("./meshPrimitives");w("a-sky",A.extendDeep({},l(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:A.extendDeep({},E["a-sphere"].prototype.mappings)}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147,"./meshPrimitives":161}],157:[function(M,N,$){var l=M("../primitives").registerPrimitive;l("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},{"../primitives":147}],158:[function(M,N,$){var l=M("../primitives").definePrimitive;l("a-text",{text:{anchor:"align",width:5}})},{"../primitives":147}],159:[function(M,N,$){var l=M("../getMeshMixin"),w=M("../primitives").registerPrimitive,A=M("../../../utils/");w("a-video",A.extendDeep({},l(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],160:[function(M,N,$){var l=M("../getMeshMixin"),w=M("../primitives").registerPrimitive,A=M("../../../utils/");w("a-videosphere",A.extendDeep({},l(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],161:[function(M,N,$){var l=M("../getMeshMixin"),w=M("../../../core/geometry").geometries,A=M("../../../core/geometry").geometryNames,E=M("../primitives").registerPrimitive,d=M("../../../utils/"),v=N.exports={};A.forEach(function(u){var b=w[u],g=f(u),y={};Object.keys(b.schema).forEach(function(R){y[f(R)]="geometry."+R});var x="a-"+g,L=E(x,d.extendDeep({},l(),{defaultComponents:{geometry:{primitive:u}},mappings:y}));v[x]=L});function f(m){return m.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},{"../../../core/geometry":132,"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],162:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three");l("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(A){this.geometry=new w.BoxGeometry(A.width,A.height,A.depth,A.segmentsWidth,A.segmentsHeight,A.segmentsDepth)}})},{"../core/geometry":132,"../lib/three":179}],163:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three"),A=w.Math.degToRad;l("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(E){this.geometry=new w.CircleGeometry(E.radius,E.segments,A(E.thetaStart),A(E.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],164:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three"),A=w.Math.degToRad;l("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(E){this.geometry=new w.CylinderGeometry(E.radiusTop,E.radiusBottom,E.height,E.segmentsRadial,E.segmentsHeight,E.openEnded,A(E.thetaStart),A(E.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],165:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three"),A=w.Math.degToRad;l("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(E){this.geometry=new w.CylinderGeometry(E.radius,E.radius,E.height,E.segmentsRadial,E.segmentsHeight,E.openEnded,A(E.thetaStart),A(E.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],166:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three");l("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(A){this.geometry=new w.DodecahedronGeometry(A.radius,A.detail)}})},{"../core/geometry":132,"../lib/three":179}],167:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three");l("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(A){this.geometry=new w.IcosahedronGeometry(A.radius,A.detail)}})},{"../core/geometry":132,"../lib/three":179}],168:[function(M,N,$){M("./box.js"),M("./circle.js"),M("./cone.js"),M("./cylinder.js"),M("./dodecahedron.js"),M("./icosahedron.js"),M("./octahedron.js"),M("./plane.js"),M("./ring.js"),M("./sphere.js"),M("./tetrahedron.js"),M("./torus.js"),M("./torusKnot.js"),M("./triangle.js")},{"./box.js":162,"./circle.js":163,"./cone.js":164,"./cylinder.js":165,"./dodecahedron.js":166,"./icosahedron.js":167,"./octahedron.js":169,"./plane.js":170,"./ring.js":171,"./sphere.js":172,"./tetrahedron.js":173,"./torus.js":174,"./torusKnot.js":175,"./triangle.js":176}],169:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three");l("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(A){this.geometry=new w.OctahedronGeometry(A.radius,A.detail)}})},{"../core/geometry":132,"../lib/three":179}],170:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three");l("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(A){this.geometry=new w.PlaneGeometry(A.width,A.height,A.segmentsWidth,A.segmentsHeight)}})},{"../core/geometry":132,"../lib/three":179}],171:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three"),A=w.Math.degToRad;l("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(E){this.geometry=new w.RingGeometry(E.radiusInner,E.radiusOuter,E.segmentsTheta,E.segmentsPhi,A(E.thetaStart),A(E.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],172:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three"),A=w.Math.degToRad;l("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(E){this.geometry=new w.SphereGeometry(E.radius,E.segmentsWidth,E.segmentsHeight,A(E.phiStart),A(E.phiLength),A(E.thetaStart),A(E.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],173:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three");l("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(A){this.geometry=new w.TetrahedronGeometry(A.radius,A.detail)}})},{"../core/geometry":132,"../lib/three":179}],174:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three"),A=w.Math.degToRad;l("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(E){this.geometry=new w.TorusGeometry(E.radius,E.radiusTubular*2,E.segmentsRadial,E.segmentsTubular,A(E.arc))}})},{"../core/geometry":132,"../lib/three":179}],175:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three");l("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(A){this.geometry=new w.TorusKnotGeometry(A.radius,A.radiusTubular*2,A.segmentsTubular,A.segmentsRadial,A.p,A.q)}})},{"../core/geometry":132,"../lib/three":179}],176:[function(M,N,$){var l=M("../core/geometry").registerGeometry,w=M("../lib/three"),A=new w.Quaternion,E=new w.Vector3(0,0,1),d=new w.Vector2,v=new w.Vector2,f=new w.Vector2;l("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(m){var u,b,g,y,x,L,T,R,O;g=new w.Triangle,g.a.set(m.vertexA.x,m.vertexA.y,m.vertexA.z),g.b.set(m.vertexB.x,m.vertexB.y,m.vertexB.z),g.c.set(m.vertexC.x,m.vertexC.y,m.vertexC.z),b=g.getNormal(new w.Vector3),A.setFromUnitVectors(b,E),y=g.a.clone().applyQuaternion(A),x=g.b.clone().applyQuaternion(A),L=g.c.clone().applyQuaternion(A),d.set(Math.min(y.x,x.x,L.x),Math.min(y.y,x.y,L.y)),v.set(Math.max(y.x,x.x,L.x),Math.max(y.y,x.y,L.y)),f.set(0,0).subVectors(v,d),y=new w.Vector2().subVectors(y,d).divide(f),x=new w.Vector2().subVectors(x,d).divide(f),L=new w.Vector2().subVectors(L,d).divide(f),u=this.geometry=new w.BufferGeometry,T=[g.a.x,g.a.y,g.a.z,g.b.x,g.b.y,g.b.z,g.c.x,g.c.y,g.c.z],R=[b.x,b.y,b.z,b.x,b.y,b.z,b.x,b.y,b.z],O=[y.x,y.y,x.x,x.y,L.x,L.y],u.setAttribute("position",new w.Float32BufferAttribute(T,3)),u.setAttribute("normal",new w.Float32BufferAttribute(R,3)),u.setAttribute("uv",new w.Float32BufferAttribute(O,2))}})},{"../core/geometry":132,"../lib/three":179}],177:[function(M,N,$){if(window.Promise=window.Promise||M("promise-polyfill"),window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=navigator.xr!==void 0,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var l=M("./utils/isIOSOlderThan10"),w=l(window.navigator.userAgent)?1/window.devicePixelRatio:1,A=M("webvr-polyfill"),E={BUFFER_SCALE:w,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new A(E)}var d=M("./utils/"),v=d.debug;d.isIE11&&(M("custom-event-polyfill"),M("../vendor/starts-with-polyfill"));var f=v("A-Frame:error"),m=v("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&m("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),!window.cordova&&window.location.protocol==="file:"&&f("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/0.5.0/introduction/getting-started.html#using-a-local-server."),M("present"),d.device.isBrowserEnvironment&&(M("./style/aframe.css"),M("./style/rStats.css"));var u=M("./core/scene/a-scene").AScene,b=M("./core/component").components,g=M("./core/component").registerComponent,y=M("./core/geometry").registerGeometry,x=M("./extras/primitives/primitives").registerPrimitive,L=M("./core/shader").registerShader,T=M("./core/system").registerSystem,R=M("./core/shader").shaders,O=M("./core/system").systems,F=window.THREE=M("./lib/three"),z=M("../package");M("./components/index"),M("./geometries/index"),M("./shaders/index"),M("./systems/index");var re=M("./core/a-node"),Y=M("./core/a-entity");M("./core/a-assets"),M("./core/a-cubemap"),M("./core/a-mixin"),M("./extras/components/"),M("./extras/primitives/"),console.log("A-Frame Version: 1.2.0 (Date 2021-02-05, Commit #b220fa00)"),console.log("THREE Version (https://github.com/supermedium/three.js):",z.dependencies["super-three"]),console.log("WebVR Polyfill Version:",z.dependencies["webvr-polyfill"]),N.exports=window.AFRAME={AComponent:M("./core/component").Component,AEntity:Y,ANode:re,ANIME:M("super-animejs"),AScene:u,components:b,coreComponents:Object.keys(b),geometries:M("./core/geometry").geometries,registerComponent:g,registerElement:M("./core/a-register-element").registerElement,registerGeometry:y,registerPrimitive:x,registerShader:L,registerSystem:T,primitives:{getMeshMixin:M("./extras/primitives/getMeshMixin"),primitives:M("./extras/primitives/primitives").primitives},scenes:M("./core/scene/scenes"),schema:M("./core/schema"),shaders:R,systems:O,THREE:F,utils:d,version:z.version}},{"../package":73,"../vendor/starts-with-polyfill":218,"./components/index":84,"./core/a-assets":125,"./core/a-cubemap":126,"./core/a-entity":127,"./core/a-mixin":128,"./core/a-node":129,"./core/a-register-element":130,"./core/component":131,"./core/geometry":132,"./core/scene/a-scene":134,"./core/scene/scenes":138,"./core/schema":140,"./core/shader":141,"./core/system":142,"./extras/components/":143,"./extras/primitives/":146,"./extras/primitives/getMeshMixin":145,"./extras/primitives/primitives":147,"./geometries/index":168,"./lib/three":179,"./shaders/index":181,"./style/aframe.css":186,"./style/rStats.css":187,"./systems/index":191,"./utils/":205,"./utils/isIOSOlderThan10":208,"custom-event-polyfill":7,present:48,"promise-polyfill":50,"super-animejs":56,"webvr-polyfill":68}],178:[function(M,N,$){window.aframeStats=function(l){var w=null,A=l,E={te:{caption:"Entities"},lt:{caption:"Load Time"}},d=[{caption:"A-Frame",values:["te","lt"]}];function v(){w("te").set(f()),window.performance.getEntriesByName&&w("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function f(){var g=A.querySelectorAll("*");return Array.prototype.slice.call(g).filter(function(y){return y.isEntity}),g.length}function m(){}function u(){}function b(g){w=g}return{update:v,start:m,end:u,attach:b,values:E,groups:d,fractions:[]}},typeof N=="object"&&(N.exports={aframeStats:window.aframeStats})},{}],179:[function(M,N,$){(function(l){var w=l.THREE=M("super-three");w.TextureLoader&&(w.TextureLoader.prototype.crossOrigin="anonymous"),w.ImageLoader&&(w.ImageLoader.prototype.crossOrigin="anonymous"),w.Cache&&(w.Cache.enabled=!0),M("../../vendor/DeviceOrientationControls"),M("super-three/examples/js/loaders/DRACOLoader"),M("super-three/examples/js/loaders/GLTFLoader"),M("super-three/examples/js/loaders/OBJLoader"),M("super-three/examples/js/loaders/MTLLoader"),M("super-three/examples/js/utils/BufferGeometryUtils"),w.DRACOLoader.prototype.crossOrigin="anonymous",w.GLTFLoader.prototype.crossOrigin="anonymous",w.MTLLoader.prototype.crossOrigin="anonymous",w.OBJLoader.prototype.crossOrigin="anonymous",N.exports=w}).call(this,typeof Sa<"u"?Sa:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../vendor/DeviceOrientationControls":215,"super-three":57,"super-three/examples/js/loaders/DRACOLoader":58,"super-three/examples/js/loaders/GLTFLoader":59,"super-three/examples/js/loaders/MTLLoader":60,"super-three/examples/js/loaders/OBJLoader":61,"super-three/examples/js/utils/BufferGeometryUtils":62}],180:[function(M,N,$){var l=M("../core/shader").registerShader,w=M("../lib/three"),A=M("../utils/");N.exports.Shader=l("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(d){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new w.Color},this.textureSrc=null,E(d,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.material=new w.MeshBasicMaterial(this.materialData),A.material.updateMap(this,d)},update:function(d){this.updateMaterial(d),A.material.updateMap(this,d)},updateMaterial:function(d){var v;E(d,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color);for(v in this.materialData)this.material[v]=this.materialData[v]}});function E(d,v){return v.color.set(d.color),v.fog=d.fog,v.wireframe=d.wireframe,v.wireframeLinewidth=d.wireframeLinewidth,v}},{"../core/shader":141,"../lib/three":179,"../utils/":205}],181:[function(M,N,$){M("./flat"),M("./standard"),M("./sdf"),M("./msdf"),M("./ios10hls")},{"./flat":180,"./ios10hls":182,"./msdf":183,"./sdf":184,"./standard":185}],182:[function(M,N,$){var l=M("../core/shader").registerShader;N.exports.Shader=l("ios10hls",{schema:{src:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:["varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),fragmentShader:["uniform sampler2D src;","uniform float opacity;","varying vec2 vUV;","void main() {","  vec2 offset = vec2(0, 0);","  vec2 repeat = vec2(1, 1);","  vec4 color = texture2D(src, vec2(vUV.x / repeat.x + offset.x, (1.0 - vUV.y) / repeat.y + offset.y)).bgra;","  gl_FragColor = vec4(color.rgb, opacity);","}"].join(`
`)})},{"../core/shader":141}],183:[function(M,N,$){var l=M("../core/shader").registerShader,w=!!document.createElement("canvas").getContext("webgl2"),A=["attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),E=["#version 300 es","in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),d=w?E:A,v=["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture2D(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","}"].join(`
`),f=["#version 300 es","precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  fragColor = vec4(color.xyz, alpha * opacity);","}"].join(`
`),m=w?f:v;N.exports.Shader=l("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:d,fragmentShader:m})},{"../core/shader":141}],184:[function(M,N,$){var l=M("../core/shader").registerShader;N.exports.Shader=l("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:["#version 300 es","in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),fragmentShader:["#version 300 es","precision highp float;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","#ifdef GL_OES_standard_derivatives","  float contour(float width, float value) {","    return smoothstep(0.5 - value, 0.5 + value, width);","  }","#else","  float aastep(float value, float afwidth) {","    return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","  }","#endif","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","void main() {","  #ifdef GL_OES_standard_derivatives","    vec2 uv = vUV;","    vec4 texColor = texture(map, uv);","    float dist = texColor.a;","    float width = fwidth(dist);","    float alpha = contour(dist, width);","    float dscale = 0.353505;","    vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","    float isBigEnough = max(abs(duv.x), abs(duv.y));","    if (isBigEnough > BIG_ENOUGH) {","      float ratio = BIG_ENOUGH / isBigEnough;","      alpha = ratio * alpha + (1.0 - ratio) * dist;","    }","    if (isBigEnough <= BIG_ENOUGH) {","      vec4 box = vec4 (uv - duv, uv + duv);","      alpha = (alpha + 0.5 * (","        contour(texture(map, box.xy).a, width)","        + contour(texture(map, box.zw).a, width)","        + contour(texture(map, box.xw).a, width)","        + contour(texture(map, box.zy).a, width)","      )) / 3.0;","    }","    if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  #else","    vec4 texColor = texture(map, vUV);","    float value = texColor.a;","    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","    float alpha = aastep(value, afwidth);","    float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);","    if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }","    alpha = alpha * ratio + (1.0 - ratio) * value;","    if (ratio < 1.0 && alpha <= DISCARD_ALPHA) { discard; return; }","  #endif","  fragColor = vec4(color, opacity * alpha);","}"].join(`
`)})},{"../core/shader":141}],185:[function(M,N,$){var l=M("../core/shader").registerShader,w=M("../lib/three"),A=M("../utils/"),E=new w.CubeTextureLoader,d={};N.exports.Shader=l("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(f){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new w.Color,emissive:new w.Color},v(f,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive),this.material=new w.MeshStandardMaterial(this.materialData),A.material.updateMap(this,f),f.normalMap&&A.material.updateDistortionMap("normal",this,f),f.displacementMap&&A.material.updateDistortionMap("displacement",this,f),f.ambientOcclusionMap&&A.material.updateDistortionMap("ambientOcclusion",this,f),f.metalnessMap&&A.material.updateDistortionMap("metalness",this,f),f.roughnessMap&&A.material.updateDistortionMap("roughness",this,f),this.updateEnvMap(f)},update:function(f){this.updateMaterial(f),A.material.updateMap(this,f),f.normalMap&&A.material.updateDistortionMap("normal",this,f),f.displacementMap&&A.material.updateDistortionMap("displacement",this,f),f.ambientOcclusionMap&&A.material.updateDistortionMap("ambientOcclusion",this,f),f.metalnessMap&&A.material.updateDistortionMap("metalness",this,f),f.roughnessMap&&A.material.updateDistortionMap("roughness",this,f),this.updateEnvMap(f)},updateMaterial:function(f){var m,u=this.material;v(f,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive);for(m in this.materialData)u[m]=this.materialData[m]},updateEnvMap:function(f){var m=this,u=this.material,b=f.envMap,g=f.sphericalEnvMap;if(!b&&!g||this.isLoadingEnvMap){u.envMap=null,u.needsUpdate=!0;return}if(this.isLoadingEnvMap=!0,g){this.el.sceneEl.systems.material.loadTexture(g,{src:g},function(x){m.isLoadingEnvMap=!1,x.mapping=w.SphericalReflectionMapping,u.envMap=x,A.material.handleTextureEvents(m.el,x),u.needsUpdate=!0});return}if(d[b]){d[b].then(function(y){m.isLoadingEnvMap=!1,u.envMap=y,A.material.handleTextureEvents(m.el,y),u.needsUpdate=!0});return}d[b]=new Promise(function(y){A.srcLoader.validateCubemapSrc(b,function(L){E.load(L,function(T){m.isLoadingEnvMap=!1,u.envMap=T,A.material.handleTextureEvents(m.el,T),y(T)})})})}});function v(f,m){return m.color.set(f.color),m.emissive.set(f.emissive),m.emissiveIntensity=f.emissiveIntensity,m.fog=f.fog,m.metalness=f.metalness,m.roughness=f.roughness,m.wireframe=f.wireframe,m.wireframeLinewidth=f.wireframeLinewidth,f.normalMap&&(m.normalScale=f.normalScale),f.ambientOcclusionMap&&(m.aoMapIntensity=f.ambientOcclusionMapIntensity),f.displacementMap&&(m.displacementScale=f.displacementScale,m.displacementBias=f.displacementBias),m}},{"../core/shader":141,"../lib/three":179,"../utils/":205}],186:[function(M,N,$){var l=`html.a-fullscreen{bottom:0;left:0;position:fixed;right:0;top:0}html.a-fullscreen body{height:100%;margin:0;overflow:hidden;padding:0;width:100%}html.a-fullscreen .a-canvas{width:100%!important;height:100%!important;top:0!important;left:0!important;right:0!important;bottom:0!important;position:fixed!important}html:not(.a-fullscreen) .a-enter-ar,html:not(.a-fullscreen) .a-enter-vr{right:5px;bottom:5px}:-webkit-full-screen{background-color:transparent}.a-hidden{display:none!important}.a-canvas{height:100%;left:0;position:absolute;top:0;width:100%}.a-canvas.a-grab-cursor:hover{cursor:grab;cursor:-moz-grab;cursor:-webkit-grab}canvas.a-canvas.a-mouse-cursor-hover:hover{cursor:pointer}.a-inspector-loader{background-color:#ed3160;position:fixed;left:3px;top:3px;padding:6px 10px;color:#fff;text-decoration:none;font-size:12px;font-family:Roboto,sans-serif;text-align:center;z-index:99999;width:204px}@keyframes dots-1{from{opacity:0}25%{opacity:1}}@keyframes dots-2{from{opacity:0}50%{opacity:1}}@keyframes dots-3{from{opacity:0}75%{opacity:1}}@-webkit-keyframes dots-1{from{opacity:0}25%{opacity:1}}@-webkit-keyframes dots-2{from{opacity:0}50%{opacity:1}}@-webkit-keyframes dots-3{from{opacity:0}75%{opacity:1}}.a-inspector-loader .dots span{animation:dots-1 2s infinite steps(1);-webkit-animation:dots-1 2s infinite steps(1)}.a-inspector-loader .dots span:first-child+span{animation-name:dots-2;-webkit-animation-name:dots-2}.a-inspector-loader .dots span:first-child+span+span{animation-name:dots-3;-webkit-animation-name:dots-3}a-scene{display:block;position:relative;height:100%;width:100%}a-assets,a-scene audio,a-scene img,a-scene video{display:none}.a-enter-vr-modal,.a-orientation-modal{font-family:Consolas,Andale Mono,Courier New,monospace}.a-enter-vr-modal a{border-bottom:1px solid #fff;padding:2px 0;text-decoration:none;transition:.1s color ease-in}.a-enter-vr-modal a:hover{background-color:#fff;color:#111;padding:2px 4px;position:relative;left:-4px}.a-enter-ar,.a-enter-vr{font-family:sans-serif,monospace;font-size:13px;width:100%;font-weight:200;line-height:16px;position:absolute;right:20px;bottom:20px}.a-enter-ar{right:80px}.a-enter-vr-button,.a-enter-vr-modal,.a-enter-vr-modal a{color:#fff;user-select:none;outline:0}.a-enter-vr-button{background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat rgba(0,0,0,.35)}.a-enter-ar-button{background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat rgba(0,0,0,.2)}.a-enter-ar-button,.a-enter-vr-button{background-size:90% 90%;border:0;bottom:0;cursor:pointer;min-width:58px;min-height:34px;padding-right:0;padding-top:0;position:absolute;right:0;transition:background-color .05s ease;-webkit-transition:background-color .05s ease;z-index:9999;border-radius:8px;touch-action:manipulation}.a-enter-ar-button{background-size:100% 90%;margin-right:10px;border-radius:7px}.a-enter-ar-button:active,.a-enter-ar-button:hover,.a-enter-vr-button:active,.a-enter-vr-button:hover{background-color:#ef2d5e}.a-enter-vr-button.resethover{background-color:rgba(0,0,0,.35)}[data-a-enter-vr-no-webvr] .a-enter-vr-button{border-color:#666;opacity:.65}[data-a-enter-vr-no-webvr] .a-enter-vr-button:active,[data-a-enter-vr-no-webvr] .a-enter-vr-button:hover{background-color:rgba(0,0,0,.35);cursor:not-allowed}.a-enter-vr-modal{background-color:#666;border-radius:0;display:none;min-height:32px;margin-right:70px;padding:9px;width:280px;right:2%;position:absolute}.a-enter-vr-modal:after{border-bottom:10px solid transparent;border-left:10px solid #666;border-top:10px solid transparent;display:inline-block;content:'';position:absolute;right:-5px;top:5px;width:0;height:0}.a-enter-vr-modal a,.a-enter-vr-modal p{display:inline}.a-enter-vr-modal p{margin:0}.a-enter-vr-modal p:after{content:' '}[data-a-enter-vr-no-headset].a-enter-vr:hover .a-enter-vr-modal,[data-a-enter-vr-no-webvr].a-enter-vr:hover .a-enter-vr-modal{display:block}.a-orientation-modal{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center/50% 50% no-repeat rgba(244,244,244,1);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-orientation-modal:after{color:#666;content:"Insert phone into Cardboard holder.";display:block;position:absolute;text-align:center;top:70%;transform:translateY(-70%);width:100%}.a-orientation-modal button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;border:none;height:50px;text-indent:-9999px;width:50px}.a-loader-title{background-color:rgba(0,0,0,.6);font-family:sans-serif,monospace;text-align:center;font-size:20px;height:50px;font-weight:300;line-height:50px;position:absolute;right:0;left:0;top:0;color:#fff}.a-modal{background:0 0/50% 50% rgba(0,0,0,.6);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-dialog{position:relative;left:50%;top:50%;transform:translate(-50%,-50%);z-index:199995;width:300px;height:200px;background-size:contain;background-color:#fff;font-family:sans-serif,monospace;font-size:20px;border-radius:3px;padding:6px}.a-dialog-text-container{width:100%;height:70%;align-self:flex-start;display:flex;justify-content:center;align-content:center;flex-direction:column}.a-dialog-text{display:inline-block;font-weight:400;font-size:14pt;margin:8px}.a-dialog-buttons-container{display:inline-flex;align-self:flex-end;width:100%;height:30%}.a-dialog-button{cursor:pointer;align-self:center;opacity:.9;height:80%;width:50%;font-size:12pt;margin:4px;border-radius:2px;text-align:center;border:none;display:inline-block;-webkit-transition:all .25s ease-in-out;transition:all .25s ease-in-out;box-shadow:0 1px 3px rgba(0,0,0,.1),0 1px 2px rgba(0,0,0,.2);user-select:none}.a-dialog-permission-button:hover{box-shadow:0 7px 14px rgba(0,0,0,.2),0 2px 2px rgba(0,0,0,.2)}.a-dialog-allow-button{background-color:#00ceff}.a-dialog-deny-button{background-color:#ff005b}.a-dialog-ok-button{background-color:#00ceff;width:100%}`;M("browserify-css").createStyle(l,{href:"src/style/aframe.css"}),N.exports=l},{"browserify-css":4}],187:[function(M,N,$){var l=".rs-base{background-color:#333;color:#fafafa;border-radius:0;font:10px monospace;left:5px;line-height:1em;opacity:.85;overflow:hidden;padding:10px;position:fixed;top:5px;width:300px;z-index:10000}.rs-base div.hidden{display:none}.rs-base h1{color:#fff;cursor:pointer;font-size:1.4em;font-weight:300;margin:0 0 5px;padding:0}.rs-group{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column-reverse;flex-direction:column-reverse;margin-bottom:5px}.rs-group:last-child{margin-bottom:0}.rs-counter-base{align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:10px;-webkit-justify-content:space-between;justify-content:space-between;margin:2px 0}.rs-counter-base.alarm{color:#b70000;text-shadow:0 0 0 #b70000,0 0 1px #fff,0 0 1px #fff,0 0 2px #fff,0 0 2px #fff,0 0 3px #fff,0 0 3px #fff,0 0 4px #fff,0 0 4px #fff}.rs-counter-id{font-weight:300;-webkit-box-ordinal-group:0;-webkit-order:0;order:0;width:54px}.rs-counter-value{font-weight:300;-webkit-box-ordinal-group:1;-webkit-order:1;order:1;text-align:right;width:35px}.rs-canvas{-webkit-box-ordinal-group:2;-webkit-order:2;order:2}@media (min-width:480px){.rs-base{left:20px;top:20px}}";M("browserify-css").createStyle(l,{href:"src/style/rStats.css"}),N.exports=l},{"browserify-css":4}],188:[function(M,N,$){var l=M("../constants/"),w=M("../core/system").registerSystem,A="data-aframe-default-camera";N.exports.System=w("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var d,v,f=this.sceneEl,m=this;if(f.camera&&!f.camera.el.getAttribute("camera").spectator){f.emit("cameraready",{cameraEl:f.camera.el});return}if(d=f.querySelectorAll("a-camera, [camera]"),!d.length){this.createDefaultCamera();return}for(this.numUserCameras=d.length,v=0;v<d.length;v++)d[v].addEventListener("object3dset",function(u){u.detail.type==="camera"&&m.checkUserCamera(this)}),d[v].isNode?d[v].load():d[v].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(d){var v,f=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(v=d.getAttribute("camera"),!v.active||v.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,f.camera=d.getObject3D("camera"),f.emit("cameraready",{cameraEl:d})}},createDefaultCamera:function(){var d,v=this.sceneEl;d=document.createElement("a-entity"),d.setAttribute("camera",{active:!0}),d.setAttribute("position",{x:0,y:l.DEFAULT_CAMERA_HEIGHT,z:0}),d.setAttribute("wasd-controls",""),d.setAttribute("look-controls",""),d.setAttribute(l.AFRAME_INJECTED,""),d.addEventListener("object3dset",function(f){f.detail.type==="camera"&&(v.camera=f.detail.object,v.emit("cameraready",{cameraEl:d}))}),v.appendChild(d)},disableActiveCamera:function(){var d,v;d=this.sceneEl.querySelectorAll("[camera]"),v=d[d.length-1],v.setAttribute("camera","active",!0)},setActiveCamera:function(d){var v,f,m,u,b=this.activeCameraEl,g=this.sceneEl;if(u=d.getObject3D("camera"),!(!u||d===this.activeCameraEl)){var y=g.querySelector("["+A+"]"),x=y&&y.querySelector("[camera]");for(d!==x&&E(g),this.activeCameraEl=d,this.activeCameraEl.play(),g.camera=u,b&&b.setAttribute("camera","active",!1),f=g.querySelectorAll("[camera]"),m=0;m<f.length;m++)v=f[m],!(!v.isEntity||d===v)&&(v.setAttribute("camera","active",!1),v.pause());g.emit("camera-set-active",{cameraEl:d})}},setSpectatorCamera:function(d){var v,f=this.spectatorCameraEl,m=this.sceneEl,u;v=d.getObject3D("camera"),!(!v||d===this.spectatorCameraEl)&&(f&&f.setAttribute("camera","spectator",!1),u=this.spectatorCameraEl=d,m.addEventListener("enter-vr",this.wrapRender),m.addEventListener("exit-vr",this.unwrapRender),u.setAttribute("camera","active",!1),u.play(),m.emit("camera-set-spectator",{cameraEl:d}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){!this.spectatorCameraEl||this.originalRender||(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){this.originalRender&&(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(d,v){var f,m=this.sceneEl,u;f=m.renderer.xr.enabled,this.originalRender.call(m.renderer,d,v),!(!this.spectatorCameraEl||m.isMobile||!f)&&(u=this.spectatorCameraEl.components.camera.camera,m.renderer.xr.enabled=!1,this.originalRender.call(m.renderer,d,u),m.renderer.xr.enabled=f)}});function E(d){var v,f=d.camera;f&&(v=d.querySelector("["+A+"]"),v&&d.removeChild(v))}},{"../constants/":123,"../core/system":142}],189:[function(M,N,$){var l=M("../core/geometry").geometries,w=M("../core/system").registerSystem;N.exports.System=w("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(v){var f=this.cache,m,u;return v.skipCache?A(v):(u=this.hash(v),m=f[u],d(this.cacheCount,u),m||(m=A(v),f[u]=m,m))},unuseGeometry:function(v){var f=this.cache,m=this.cacheCount,u,b;v.skipCache||(b=this.hash(v),f[b]&&(E(m,b),!(m[b]>0)&&(u=f[b],u.dispose(),delete f[b],delete m[b])))},hash:function(v){return JSON.stringify(v)}});function A(v){var f=v.primitive,m=l[f]&&l[f].Geometry,u=new m;if(!m)throw new Error("Unknown geometry `"+f+"`");return u.init(v),u.geometry}function E(v,f){v[f]--}function d(v,f){v[f]=v[f]===void 0?1:v[f]+1}},{"../core/geometry":132,"../core/system":142}],190:[function(M,N,$){var l=M("../core/system").registerSystem,w=M("../lib/three");N.exports.System=l("gltf-model",{schema:{dracoDecoderPath:{default:""}},init:function(){var A=this.data.dracoDecoderPath;this.dracoLoader=new w.DRACOLoader,this.dracoLoader.setDecoderPath(A)},update:function(){var A;this.dracoLoader||(A=this.data.dracoDecoderPath,this.dracoLoader=new w.DRACOLoader,this.dracoLoader.setDecoderPath(A))},getDRACOLoader:function(){return this.dracoLoader}})},{"../core/system":142,"../lib/three":179}],191:[function(M,N,$){M("./camera"),M("./geometry"),M("./gltf-model"),M("./light"),M("./material"),M("./renderer"),M("./shadow"),M("./tracked-controls-webvr"),M("./tracked-controls-webxr"),M("./webxr")},{"./camera":188,"./geometry":189,"./gltf-model":190,"./light":192,"./material":193,"./renderer":194,"./shadow":195,"./tracked-controls-webvr":196,"./tracked-controls-webxr":197,"./webxr":198}],192:[function(M,N,$){var l=M("../core/system").registerSystem,w=M("../utils/bind"),A=M("../constants/"),E="data-aframe-default-light";N.exports.System=l("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",w(this.setupDefaultLights,this))},registerLight:function(d){d.hasAttribute(E)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var d,v=this.sceneEl;if(this.defaultLights){d=document.querySelectorAll("["+E+"]");for(var f=0;f<d.length;f++)v.removeChild(d[f]);this.defaultLights=!1}},setupDefaultLights:function(){var d=this.sceneEl,v,f;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||(v=document.createElement("a-entity"),v.setAttribute("light",{color:"#BBB",type:"ambient"}),v.setAttribute(E,""),v.setAttribute(A.AFRAME_INJECTED,""),d.appendChild(v),f=document.createElement("a-entity"),f.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),f.setAttribute("position",{x:-.5,y:1,z:1}),f.setAttribute(E,""),f.setAttribute(A.AFRAME_INJECTED,""),d.appendChild(f),this.defaultLights=!0)}})},{"../constants/":123,"../core/system":142,"../utils/bind":199}],193:[function(M,N,$){var l=M("../core/system").registerSystem,w=M("../lib/three"),A=M("../utils/"),E=M("../utils/material").isHLS,d=A.bind,v=A.debug,f=v("components:texture:error"),m=new w.TextureLoader,u=v("components:texture:warn");m.setCrossOrigin("anonymous"),N.exports.System=l("material",{init:function(){this.materials={},this.textureCounts={},this.textureCache={},this.sceneEl.addEventListener("materialtextureloaded",d(this.onMaterialTextureLoaded,this))},clearTextureCache:function(){this.textureCache={}},loadTexture:function(T,R,O){var F=this;if(T.tagName==="CANVAS"){this.loadCanvas(T,R,O);return}if(T.tagName==="VIDEO"){!T.src&&!T.srcObject&&!T.childElementCount&&u("Video element was defined with neither `source` elements nor `src` / `srcObject` attributes."),this.loadVideo(T,R,O);return}A.srcLoader.validateSrc(T,z,re);function z(Y){F.loadImage(Y,R,O)}function re(Y){F.loadVideo(Y,R,O)}},loadImage:function(T,R,O){var F=this.hash(R),z=this.textureCache;if(z[F]){z[F].then(O);return}z[F]=g(T,R),z[F].then(O)},loadCanvas:function(T,R,O){var F;F=new w.CanvasTexture(T),y(F,R),O(F)},loadVideo:function(T,R,O){var F,z,re=this.textureCache,Y,ee;function J(ce){ce.texture.needsUpdate=!0,O(ce.texture,ce.videoEl)}if(typeof T!="string"){if(Y=T,F=this.hashVideo(R,Y),re[F]){re[F].then(J);return}L(Y)}if(Y=Y||x(T,R.width,R.height),F=this.hashVideo(R,Y),re[F]){re[F].then(J);return}z=new w.VideoTexture(Y),z.minFilter=w.LinearFilter,y(z,R),this.sceneEl.isIOS&&E(Y.src||Y.getAttribute("src"),Y.type||Y.getAttribute("type"))&&(z.format=w.RGBAFormat,z.needsCorrectionBGRA=!0,z.flipY=!1,z.needsCorrectionFlipY=!0),ee={texture:z,videoEl:Y},re[F]=Promise.resolve(ee),J(ee)},hash:function(T){return T.src.tagName&&(T=A.extendDeep({},T),T.src=T.src.src),JSON.stringify(T)},hashVideo:function(T,R){return b(T,R)},registerMaterial:function(T){this.materials[T.uuid]=T},unregisterMaterial:function(T){delete this.materials[T.uuid];var R=this.textureCounts;Object.keys(T).filter(function(O){return T[O]&&T[O].isTexture}).forEach(function(O){R[T[O].uuid]--,R[T[O].uuid]<=0&&T[O].dispose()})},updateMaterials:function(T){var R=this.materials;Object.keys(R).forEach(function(O){R[O].needsUpdate=!0})},onMaterialTextureLoaded:function(T){this.textureCounts[T.detail.texture.uuid]||(this.textureCounts[T.detail.texture.uuid]=0),this.textureCounts[T.detail.texture.uuid]++}});function b(T,R){var O,F=R.getAttribute("id"),z,re;if(F)return F;for(z="",re=T||{},O=0;O<R.attributes.length;O++)re[R.attributes[O].name]=R.attributes[O].value;return Object.keys(re).sort().forEach(function(Y){z+=Y+":"+re[Y]+";"}),z}function g(T,R){return new Promise(O);function O(F,z){var re=typeof T!="string";function Y(ee){y(ee,R),ee.needsUpdate=!0,F(ee)}if(re){Y(new w.Texture(T));return}m.load(T,Y,function(){},function(ee){f("`$s` could not be fetched (Error code: %s; Response: %s)",ee.status,ee.statusText)})}}function y(T,R){var O=R.offset||{x:0,y:0},F=R.repeat||{x:1,y:1},z=R.npot||!1;z&&(T.wrapS=w.ClampToEdgeWrapping,T.wrapT=w.ClampToEdgeWrapping,T.magFilter=w.LinearFilter,T.minFilter=w.LinearFilter),(F.x!==1||F.y!==1)&&(T.wrapS=w.RepeatWrapping,T.wrapT=w.RepeatWrapping,T.repeat.set(F.x,F.y)),(O.x!==0||O.y!==0)&&T.offset.set(O.x,O.y)}function x(T,R,O){var F=document.createElement("video");return F.width=R,F.height=O,F.setAttribute("playsinline",""),F.setAttribute("webkit-playsinline",""),F.autoplay=!0,F.loop=!0,F.crossOrigin="anonymous",F.addEventListener("error",function(){u("`$s` is not a valid video",T)},!0),F.src=T,F}function L(T){return T.autoplay=T.hasAttribute("autoplay")&&T.getAttribute("autoplay")!=="false",T.controls=T.hasAttribute("controls")&&T.getAttribute("controls")!=="false",T.getAttribute("loop")==="false"&&T.removeAttribute("loop"),T.getAttribute("preload")==="false"&&(T.preload="none"),T.crossOrigin=T.crossOrigin||"anonymous",T.setAttribute("playsinline",""),T.setAttribute("webkit-playsinline",""),T}},{"../core/system":142,"../lib/three":179,"../utils/":205,"../utils/material":209}],194:[function(M,N,$){var l=M("../core/system").registerSystem,w=M("../utils/"),A=M("../lib/three"),E=w.debug,d=E("components:renderer:warn");N.exports.System=l("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:w.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:1920},maxCanvasHeight:{default:1920},physicallyCorrectLights:{default:!1},precision:{default:"high",oneOf:["high","medium","low"]},sortObjects:{default:!1},colorManagement:{default:!1},gammaOutput:{default:!1},alpha:{default:!0},foveationLevel:{default:0}},init:function(){var v=this.data,f=this.el,m=f.renderer;m.sortObjects=v.sortObjects,m.physicallyCorrectLights=v.physicallyCorrectLights,(v.colorManagement||v.gammaOutput)&&(m.outputEncoding=A.sRGBEncoding,v.gammaOutput&&d('Property `gammaOutput` is deprecated. Use `renderer="colorManagement: true;"` instead.')),f.hasAttribute("antialias")&&d('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),f.hasAttribute("logarithmicDepthBuffer")&&d('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.')},applyColorCorrection:function(v){!this.data.colorManagement||!v||(v.isColor?v.convertSRGBToLinear():v.isTexture&&(v.encoding=A.sRGBEncoding))}})},{"../core/system":142,"../lib/three":179,"../utils/":205}],195:[function(M,N,$){var l=M("../core/system").registerSystem,w=M("../lib/three"),A={basic:w.BasicShadowMap,pcf:w.PCFShadowMap,pcfsoft:w.PCFSoftShadowMap};N.exports.System=l("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var E=this.sceneEl,d=this.data;this.shadowMapEnabled=!1,E.renderer&&(E.renderer.shadowMap.type=A[d.type],E.renderer.shadowMap.autoUpdate=d.autoUpdate,this.setShadowMapEnabled(this.shadowMapEnabled))},update:function(E){E.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.data.enabled)},setShadowMapEnabled:function(E){var d=this.sceneEl.renderer;this.shadowMapEnabled=this.data.enabled&&E,d&&(d.shadowMap.enabled=this.shadowMapEnabled)}})},{"../core/system":142,"../lib/three":179}],196:[function(M,N,$){var l=M("../core/system").registerSystem,w=M("../utils"),A=w.device.isWebXRAvailable;N.exports.System=l("tracked-controls-webvr",{init:function(){var E=this;this.controllers=[],this.isChrome=navigator.userAgent.indexOf("Chrome")!==-1,this.updateControllerList(),this.throttledUpdateControllerList=w.throttle(this.updateControllerList,500,this),!A&&navigator.getVRDisplays&&this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(d){d.length&&(E.vrDisplay=d[0])})})},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var E=this.controllers,d,v,f,m;if(v=navigator.getGamepads&&navigator.getGamepads(),!!v){for(m=E.length,E.length=0,f=0;f<v.length;++f)d=v[f],d&&d.pose&&E.push(d);E.length!==m&&this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":142,"../utils":205}],197:[function(M,N,$){var l=M("../core/system").registerSystem,w=M("../utils");N.exports.System=l("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=w.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var A=this,E=this.el.xrSession;if(!E){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var d=A.el.sceneEl.systems.webxr.sessionReferenceSpaceType;E.requestReferenceSpace(d).then(function(v){A.referenceSpace=v}).catch(function(v){throw A.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(d,'tracked-controls-webxr uses reference space "'+d+'".'),v})},updateControllerList:function(){var A=this.el.xrSession,E=this.oldControllers,d;if(!A){if(this.oldControllersLength===0)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(A.inputSources){if(this.controllers=A.inputSources,this.oldControllersLength===this.controllers.length){var v=!0;for(d=0;d<this.controllers.length;++d)if(!(this.controllers[d]===E[d]&&this.controllers[d].gamepad===E[d].gamepad)){v=!1;break}if(v)return}for(E.length=0,d=0;d<this.controllers.length;d++)E.push(this.controllers[d]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":142,"../utils":205}],198:[function(M,N,$){var l=M("../core/system").registerSystem,w=M("../utils/"),A=w.debug("systems:webxr:warn");N.exports.System=l("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var E=this.data;this.sessionConfiguration={requiredFeatures:E.requiredFeatures,optionalFeatures:E.optionalFeatures},this.sessionReferenceSpaceType=E.referenceSpaceType,E.overlayElement&&(this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:E.overlayElement})},wasFeatureRequested:function(E){return!!(E==="viewer"||E==="local"||this.sessionConfiguration.requiredFeatures.includes(E)||this.sessionConfiguration.optionalFeatures.includes(E))},warnIfFeatureNotRequested:function(E,d){if(!this.wasFeatureRequested(E)){var v='Please add the feature "'+E+`" to a-scene's webxr system options in requiredFeatures/optionalFeatures.`;A((d?d+" ":"")+v)}}})},{"../core/system":142,"../utils/":205}],199:[function(M,N,$){N.exports=function(w,A){return function(E){return function(){var v=E.concat(Array.prototype.slice.call(arguments,0));return w.apply(A,v)}}(Array.prototype.slice.call(arguments,2))}},{}],200:[function(M,N,$){var l=M("./debug"),w=M("object-assign"),A=l("utils:coordinates:warn"),E=["x","y","z","w"],d=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;N.exports.regex=d;var v="object",f=/\s+/g;function m(y,x){var L,T,R,O,F,z,re,Y,ee;if(y&&y instanceof Object)return z=y.x===void 0?x&&x.x:y.x,re=y.y===void 0?x&&x.y:y.y,Y=y.z===void 0?x&&x.z:y.z,ee=y.w===void 0?x&&x.w:y.w,z!=null&&(y.x=g(z)),re!=null&&(y.y=g(re)),Y!=null&&(y.z=g(Y)),ee!=null&&(y.w=g(ee)),y;if(y==null)return typeof x===v?w({},x):x;for(L=y.trim().split(f),F={},O=0;O<E.length;O++)if(R=E[O],L[O])F[R]=parseFloat(L[O],10);else{if(T=x&&x[R],T===void 0)continue;F[R]=g(T)}return F}N.exports.parse=m;function u(y){var x;return typeof y!==v?y:(x=y.x+" "+y.y,y.z!=null&&(x+=" "+y.z),y.w!=null&&(x+=" "+y.w),x)}N.exports.stringify=u;function b(y){return d.test(y)}N.exports.isCoordinates=b,N.exports.isCoordinate=function(y){return A("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),b(y)};function g(y){return y!=null&&y.constructor===String?parseFloat(y,10):y}N.exports.toVector3=function(y){return new THREE.Vector3(y.x,y.y,y.z)}},{"./debug":201,"object-assign":39}],201:[function(M,N,$){(function(l){var w=M("debug"),A=M("object-assign"),E={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}},d=function(b){var g=w(b);return g.color=f(b),g};A(d,w);function v(b){var g=b.split(":");return g[g.length-1]}function f(b){var g=v(b),y=E.colors&&E.colors[g];return y||null}function m(){try{return window.localStorage}catch{}}var u=m();u&&(parseInt(u.logs,10)||u.logs==="true")?d.enable("*"):d.enable("*:error,*:info,*:warn"),l.browser&&(window.logs=d),N.exports=d}).call(this,M("_process"))},{_process:49,debug:8,"object-assign":39}],202:[function(M,N,$){(function(l){var w=M("debug")("device:error"),A,E=!1,d=!1,v=N.exports.isWebXRAvailable=!window.debug&&navigator.xr!==void 0;if(window.addEventListener("vrdisplayactivate",function(re){var Y;v||(Y=document.createElement("canvas"),A=re.display,Y.getContext("webgl",{}),A.requestPresent([{source:Y}]).then(function(){},function(){}))}),v){var f=function(){var re=document.querySelector("a-scene");if(!re){window.addEventListener("DOMContentLoaded",f);return}re.hasLoaded?re.components["vr-mode-ui"].updateEnterInterfaces():re.addEventListener("loaded",f)},m=function(re){w("WebXR session support error: "+re.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(re){E=re,f()}).catch(m),navigator.xr.isSessionSupported("immersive-ar").then(function(re){d=re,f()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){E=!0,f()}).catch(m),navigator.xr.supportsSession("immersive-ar").then(function(){d=!0,f()}).catch(function(){})):w("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(re){var Y=document.querySelector("a-scene");A=re.length&&re[0],Y&&Y.emit("displayconnected",{vrDisplay:A})});function u(){return A}N.exports.getVRDisplay=u;function b(){return E||d||!!u()}N.exports.checkHeadsetConnected=b;function g(){return d}N.exports.checkARSupport=g;var y=function(){var re=!1;return function(Y){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(Y)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(Y.substr(0,4)))&&(re=!0),(L()||x()||z())&&(re=!0),F()&&(re=!1)}(window.navigator.userAgent||window.navigator.vendor||window.opera),function(){return re}}();N.exports.isMobile=y;function x(re){var Y=re||window.navigator.userAgent;return/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(Y)}N.exports.isTablet=x;function L(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}N.exports.isIOS=L;function T(){return!y()&&!F()&&window.orientation!==void 0}N.exports.isMobileDeviceRequestingDesktopSite=T;function R(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}N.exports.isOculusBrowser=R;function O(){return/(Mobile VR)/i.test(window.navigator.userAgent)}N.exports.isFirefoxReality=O;function F(){return R()||O()}N.exports.isMobileVR=F;function z(){return/R7 Build/.test(window.navigator.userAgent)}N.exports.isR7=z,N.exports.isLandscape=function(){var re=window.orientation;return z()&&(re+=90),re===90||re===-90},N.exports.isBrowserEnvironment=!!(!l||l.browser),N.exports.isNodeEnvironment=!N.exports.isBrowserEnvironment}).call(this,M("_process"))},{_process:49,debug:8}],203:[function(M,N,$){var l={};function w(A,E){return E=E||".",l[E]||(l[E]={}),A.indexOf(E)!==-1?l[E][A]=A.split(E):l[E][A]=A,l[E][A]}N.exports.getComponentPropertyPath=w,N.exports.propertyPathCache=l,N.exports.getComponentProperty=function(A,E,d){var v;return d=d||".",E.indexOf(d)!==-1?(v=w(E,d),v.constructor===String?A.getAttribute(v):A.getAttribute(v[0])[v[1]]):A.getAttribute(E)},N.exports.setComponentProperty=function(A,E,d,v){var f;if(v=v||".",E.indexOf(v)!==-1){f=w(E,v),f.constructor===String?A.setAttribute(f,d):A.setAttribute(f[0],f[1],d);return}A.setAttribute(E,d)}},{}],204:[function(M,N,$){N.exports=function(w){var A=w.style.width,E=w.style.height;w.style.width=parseInt(A,10)+1+"px",w.style.height=parseInt(E,10)+1+"px",setTimeout(function(){w.style.width=A,w.style.height=E},200)}},{}],205:[function(M,N,$){var l=M("./debug"),w=M("deep-assign"),A=M("./device"),E=M("object-assign"),d=M("./object-pool"),v=l("utils:warn");N.exports.bind=M("./bind"),N.exports.coordinates=M("./coordinates"),N.exports.debug=l,N.exports.device=A,N.exports.entity=M("./entity"),N.exports.forceCanvasResizeSafariMobile=M("./forceCanvasResizeSafariMobile"),N.exports.isIE11=M("./is-ie11"),N.exports.material=M("./material"),N.exports.objectPool=d,N.exports.split=M("./split").split,N.exports.styleParser=M("./styleParser"),N.exports.trackedControls=M("./tracked-controls"),N.exports.checkHeadsetConnected=function(){return v("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),A.checkHeadsetConnected(arguments)},N.exports.isGearVR=N.exports.device.isGearVR=function(){v("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},N.exports.isIOS=function(){return v("`utils.isIOS` has moved to `utils.device.isIOS`"),A.isIOS(arguments)},N.exports.isOculusGo=N.exports.device.isOculusGo=function(){v("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},N.exports.isMobile=function(){return v("`utils.isMobile has moved to `utils.device.isMobile`"),A.isMobile(arguments)},N.exports.throttle=function(m,u,b){var g;return b&&(m=N.exports.bind(m,b)),function(){var y=Date.now(),x=typeof g>"u"?u:y-g;(typeof g>"u"||x>=u)&&(g=y,m.apply(null,arguments))}},N.exports.throttleTick=function(m,u,b){var g;return b&&(m=N.exports.bind(m,b)),function(y,x){var L=typeof g>"u"?x:y-g;(typeof g>"u"||L>=u)&&(g=y,m(y,L))}},N.exports.debounce=function(m,u,b){var g;return function(){var y=this,x=arguments,L=function(){g=null,b||m.apply(y,x)},T=b&&!g;clearTimeout(g),g=setTimeout(L,u),T&&m.apply(y,x)}},N.exports.extend=E,N.exports.extendDeep=w,N.exports.clone=function(m){return JSON.parse(JSON.stringify(m))};var f=function(){var m=d.createPool(function(){return[]});return function(u,b){var g,y,x,L,T,R;if(u===void 0||b===void 0||u===null||b===null||!(u&&b&&u.constructor===Object&&b.constructor===Object||u.constructor===Array&&b.constructor===Array))return u===b;y=m.use(),x=m.use(),y.length=0,x.length=0;for(g in u)y.push(g);for(g in b)x.push(g);if(y.length!==x.length)return m.recycle(y),m.recycle(x),!1;for(L=0;L<y.length;++L)if(T=u[y[L]],R=b[y[L]],typeof T=="object"||typeof R=="object"||Array.isArray(T)&&Array.isArray(R)){if(T===R)continue;if(!f(T,R))return m.recycle(y),m.recycle(x),!1}else if(T!==R)return m.recycle(y),m.recycle(x),!1;return m.recycle(y),m.recycle(x),!0}}();N.exports.deepEqual=f,N.exports.diff=function(){var m=[];return function(u,b,g){var y,x,L,T,R,O,F;T=g||{},m.length=0;for(R in u)m.push(R);if(!b)return T;for(L in b)m.indexOf(L)===-1&&m.push(L);for(O=0;O<m.length;O++)R=m[O],y=u[R],x=b[R],F=y&&x&&y.constructor===Object&&x.constructor===Object,(F&&!f(y,x)||!F&&y!==x)&&(T[R]=x);return T}}(),N.exports.shouldCaptureKeyEvent=function(m){return m.metaKey?!1:document.activeElement===document.body},N.exports.splitString=function(m,u){typeof u>"u"&&(u=" ");var b=new RegExp(u,"g");return m=(m||"").replace(b,u),m.split(u)},N.exports.getElData=function(m,u){u=u||{};var b={};Object.keys(u).forEach(g);function g(y){m.hasAttribute(y)&&(b[y]=m.getAttribute(y))}return b},N.exports.getUrlParameter=function(m){m=m.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var u=new RegExp("[\\?&]"+m+"=([^&#]*)"),b=u.exec(location.search);return b===null?"":decodeURIComponent(b[1].replace(/\+/g," "))},N.exports.isIframed=function(){return window.top!==window.self},N.exports.findAllScenes=function(m){for(var u=[],b=m.getElementsByTagName("*"),g=0,y=b.length;g<y;g++)b[g].isScene&&u.push(b[g]);return u},N.exports.srcLoader=M("./src-loader")},{"./bind":199,"./coordinates":200,"./debug":201,"./device":202,"./entity":203,"./forceCanvasResizeSafariMobile":204,"./is-ie11":207,"./material":209,"./object-pool":210,"./split":211,"./src-loader":212,"./styleParser":213,"./tracked-controls":214,"deep-assign":10,"object-assign":39}],206:[function(M,N,$){window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},{}],207:[function(M,N,$){function l(){var w=-1,A=navigator.userAgent,E;return navigator.appName==="Microsoft Internet Explorer"?(E=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),E.exec(A)!=null&&(w=parseFloat(RegExp.$1))):navigator.appName==="Netscape"&&(E=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})"),E.exec(A)!=null&&(w=parseFloat(RegExp.$1))),w}N.exports=l()===11},{}],208:[function(M,N,$){N.exports=function(w){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(w)}},{}],209:[function(M,N,$){var l=M("../lib/three"),w=["application/x-mpegurl","application/vnd.apple.mpegurl"],A=new Set(["emissiveMap","envMap","map","specularMap"]);N.exports.updateMapMaterialFromData=function(d,v,f,m){var u=f.el,b=f.material,g=u.sceneEl.systems.renderer,y=m[v];if(f.materialSrcs||(f.materialSrcs={}),!y){delete f.materialSrcs[d],L(null);return}if(y===f.materialSrcs[d])return;f.materialSrcs[d]=y,y instanceof l.Texture?L(y):u.sceneEl.systems.material.loadTexture(y,{src:y,repeat:m.repeat,offset:m.offset,npot:m.npot},x);function x(T){f.materialSrcs[d]===y&&L(T)}function L(T){b[d]=T,T&&A.has(d)&&g.applyColorCorrection(T),b.needsUpdate=!0,E(u,T)}},N.exports.updateMap=function(d,v){return N.exports.updateMapMaterialFromData("map","src",d,v)},N.exports.updateDistortionMap=function(d,v,f){var m=d;d==="ambientOcclusion"&&(m="ao");var u=v.el,b=v.material,g=u.sceneEl.systems.renderer,y=f[d+"Map"],x={};if(x.src=y,x.offset=f[d+"TextureOffset"],x.repeat=f[d+"TextureRepeat"],x.wrap=f[d+"TextureWrap"],y){if(y===v[d+"TextureSrc"])return;v[d+"TextureSrc"]=y,u.sceneEl.systems.material.loadTexture(y,x,L);return}if(!b.map)return;L(null);function L(T){var R=m+"Map";b[R]=T,T&&A.has(R)&&g.applyColorCorrection(T),b.needsUpdate=!0,E(u,T)}};function E(d,v){v&&(d.emit("materialtextureloaded",{src:v.image,texture:v}),!(!v.image||v.image.tagName!=="VIDEO")&&(v.image.addEventListener("loadeddata",function(){!d.components||!d.components.material||(v.needsCorrectionBGRA&&v.needsCorrectionFlipY&&["standard","flat"].indexOf(d.components.material.data.shader)!==-1&&d.setAttribute("material","shader","ios10hls"),d.emit("materialvideoloadeddata",{src:v.image,texture:v}))}),v.image.addEventListener("ended",function(){d.emit("materialvideoended",{src:v.image,texture:v})})))}N.exports.handleTextureEvents=E,N.exports.isHLS=function(d,v){return!!(v&&w.includes(v.toLowerCase())||d&&d.toLowerCase().indexOf(".m3u8")>0)}},{"../lib/three":179}],210:[function(M,N,$){var l=Object.freeze(Object.create(null));function w(){return{}}N.exports.createPool=function(v){var f=[],m=null;v=v||w;function u(){var x;return(m===null||m===f.length)&&g(f.length||5),x=f[m],f[m++]=l,A(x),x}function b(x){if(x instanceof Object){if(m===null||m===-1){f[f.length]=x;return}f[--m]=x}}function g(x){var L,T;if(x=x===void 0?f.length:x,x>0&&m==null&&(m=0),x>0)for(L=f.length,f.length+=Number(x),T=L;T<f.length;T++)f[T]=v();return f.length}function y(){return f.length}return{grow:g,pool:f,recycle:b,size:y,use:u}};function A(d){var v;if(!(!d||d.constructor!==Object))for(v in d)d[v]=void 0}N.exports.clearObject=A;function E(d,v){var f;if(!(!d||d.constructor!==Object))for(f in d)f in v||delete d[f]}N.exports.removeUnusedKeys=E},{}],211:[function(M,N,$){N.exports.split=function(){var l={};return function(w,A){return A in l||(l[A]={}),w in l[A]||(l[A][w]=w.split(A)),l[A][w]}}()},{}],212:[function(M,N,$){var l=M("./debug"),w=l("utils:src-loader:warn");function A(u,b,g){v(u,function(x){if(x){b(u);return}g(u)})}function E(u,b){var g,y="",x,L,T=[];for(x=0;x<5;x++)y+="(url\\((?:[^\\)]+)\\),\\s*)";y+="(url\\((?:[^\\)]+)\\)\\s*)",L=u.match(new RegExp(y));function R(O){T.push(O),T.length===6&&b(T)}if(L){for(x=1;x<7;x++)A(d(L[x]),R);return}if(g=m(u),!!g){if(g.tagName==="A-CUBEMAP"&&g.srcs)return b(g.srcs);w('Selector "%s" does not point to <a-cubemap>',u)}}function d(u){var b=u.match(/\url\((.+)\)/);if(b)return b[1]}function v(u,b){var g;if(u.tagName){b(u.tagName==="IMG");return}g=new XMLHttpRequest,g.open("HEAD",u),g.addEventListener("load",function(y){var x;g.status>=200&&g.status<300?(x=g.getResponseHeader("Content-Type"),x==null?f(u,b):x.startsWith("image")?b(!0):b(!1)):f(u,b),g.abort()}),g.send()}function f(u,b){var g=new Image;g.addEventListener("load",y);function y(){b(!0)}g.addEventListener("error",x);function x(){b(!1)}g.src=u}function m(u){try{var b=document.querySelector(u);return b||w('No element was found matching the selector: "%s"',u),b}catch{w('"%s" is not a valid selector',u);return}}N.exports={parseUrl:d,validateSrc:A,validateCubemapSrc:E}},{"./debug":201}],213:[function(M,N,$){var l=/-([a-z])/g;N.exports.parse=function(m,u){var b;return typeof m!="string"||(b=d(m,u),b[""])?m:A(b)},N.exports.stringify=function(m){return typeof m=="string"?m:v(m)};function w(m){return m.replace(l,f)}N.exports.toCamelCase=w;function A(m){var u,b;for(b in m)u=w(b),b!==u&&(m[u]=m[b],delete m[b]);return m}N.exports.transformKeysToCamelCase=A;var E=function(){var m=[],u=/url\([^)]+$/;return function(g){var y="",x,L=0,T=";";for(m.length=0;L<g.length;){if(x=g.indexOf(T,L),x===-1&&(x=g.length),y+=g.substring(L,x),u.test(y)){y+=";",L=x+1;continue}m.push(y.trim()),y="",L=x+1}return m}}();function d(m,u){var b,g,y,x,L,T;for(u=u||{},b=E(m),g=0;g<b.length;g++)y=b[g],y&&(x=y.indexOf(":"),L=y.substr(0,x).trim(),T=y.substr(x+1).trim(),u[L]=T);return u}function v(m){var u,b=0,g=0,y="";for(u in m)b++;for(u in m)y+=u+": "+m[u],g<b-1&&(y+="; "),g++;return y}function f(m){return m[1].toUpperCase()}},{}],214:[function(M,N,$){var l=M("../constants").DEFAULT_HANDEDNESS,w=["x","y","z","w"],A=2;N.exports.checkControllerPresentAndSetup=function(m,u,b){var g=m.el,y,x=g.sceneEl.hasWebXR,L=x?d:E,T;if(y=L(m,u,b),T=!!y,m.controllerPresent&&!m.controllerEventsActive&&!x&&m.addEventListeners(),T===m.controllerPresent)return T;m.controllerPresent=T,T?(m.addEventListeners(),m.injectTrackedControls(y),g.emit("controllerconnected",{name:m.name,component:m})):(m.removeEventListeners(),g.emit("controllerdisconnected",{name:m.name,component:m}))};function E(m,u,b){var g,y=m.el.sceneEl,x,L=b.index||0;return!u||(x=y&&y.systems["tracked-controls-webvr"],!x)||(g=x.controllers,!g.length)?!1:!!v(g,null,u,b.hand,L)}function d(m,u,b){var g,y=m.el.sceneEl,x=y&&y.systems["tracked-controls-webxr"];return!x||(g=x.controllers,!g||!g.length)?!1:f(g,u,b.hand,b.index,b.iterateControllerProfiles,b.handTracking)}N.exports.isControllerPresentWebVR=E,N.exports.isControllerPresentWebXR=d;function v(m,u,b,g,y){var x,L,T=0,R=y>=0?y:0;for(L=0;L<m.length;L++)if(x=m[L],!(b&&!x.id.startsWith(b))&&!(!b&&x.id!==u)&&!(g&&x.hand&&g!==x.hand)){if(g&&!x.hand)R=A*y+(g===l?0:1);else return x;if(T===R)return x;++T}}function f(m,u,b,g,y,x){var L,T,R,O=!1,F,z;for(L=0;L<m.length;L++){if(R=m[L],z=R.profiles,x)O=R.hand;else if(y)for(T=0;T<z.length&&(O=z[T].startsWith(u),!O);T++);else O=z.length>0&&z[0].startsWith(u);if(O){if(F=R.handedness==="right"||R.handedness==="left",F){if(R.handedness===b)return m[L]}else if(L===g)return m[L]}}}N.exports.findMatchingControllerWebVR=v,N.exports.findMatchingControllerWebXR=f,N.exports.emitIfAxesChanged=function(m,u,b){var g,y,x,L,T;for(y in u){for(g=u[y],x=!1,T=0;T<g.length;T++)b.detail.changed[g[T]]&&(x=!0);if(x){for(L={},T=0;T<g.length;T++)L[w[T]]=b.detail.axis[g[T]];m.el.emit(y+"moved",L)}}},N.exports.onButtonEvent=function(m,u,b,g){var y=g?b.mapping[g]:b.mapping,x=y.buttons[m];b.el.emit(x+u),b.updateModel&&b.updateModel(x,u)}},{"../constants":123}],215:[function(M,N,$){THREE.DeviceOrientationControls=function(l){var w=this;this.object=l,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var A=function(v){w.deviceOrientation=v},E=function(){w.screenOrientation=window.orientation||0},d=function(){var v=new THREE.Vector3(0,0,1),f=new THREE.Euler,m=new THREE.Quaternion,u=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(b,g,y,x,L){f.set(y,g,-x,"YXZ"),b.setFromEuler(f),b.multiply(u),b.multiply(m.setFromAxisAngle(v,-L))}}();this.connect=function(){E(),window.addEventListener("orientationchange",E,!1),window.addEventListener("deviceorientation",A,!1),w.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",E,!1),window.removeEventListener("deviceorientation",A,!1),w.enabled=!1},this.update=function(){if(w.enabled!==!1){var v=w.deviceOrientation;if(v){var f=v.alpha?THREE.Math.degToRad(v.alpha)+w.alphaOffset:0,m=v.beta?THREE.Math.degToRad(v.beta):0,u=v.gamma?THREE.Math.degToRad(v.gamma):0,b=w.screenOrientation?THREE.Math.degToRad(w.screenOrientation):0;d(w.object.quaternion,f,m,u,b)}}},this.dispose=function(){w.disconnect()},this.connect()}},{}],216:[function(M,N,$){window.glStats=function(){var l=null,w=0,A=0,E=0,d=0,v=0,f=0,m=0;function u(O,F){return function(){F.apply(this,arguments),O.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=u(WebGLRenderingContext.prototype.drawArrays,function(){w++,arguments[0]==this.POINTS?f+=arguments[2]:v+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=u(WebGLRenderingContext.prototype.drawElements,function(){A++,d+=arguments[1]/3,v+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=u(WebGLRenderingContext.prototype.useProgram,function(){E++}),WebGLRenderingContext.prototype.bindTexture=u(WebGLRenderingContext.prototype.bindTexture,function(){m++});var b={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},g=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],y=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function x(){l("allcalls").set(w+A),l("drawElements").set(A),l("drawArrays").set(w),l("bindTexture").set(m),l("useProgram").set(E),l("glfaces").set(d),l("glvertices").set(v),l("glpoints").set(f)}function L(){w=0,A=0,E=0,d=0,v=0,f=0,m=0}function T(){}function R(O){l=O}return{update:x,start:L,end:T,attach:R,values:b,groups:g,fractions:y}},window.threeStats=function(l){var w=null,A={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},E=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],d=[];function v(){w("renderer.info.memory.geometries").set(l.info.memory.geometries),w("renderer.info.programs").set(l.info.programs.length),w("renderer.info.memory.textures").set(l.info.memory.textures),w("renderer.info.render.calls").set(l.info.render.calls),w("renderer.info.render.triangles").set(l.info.render.triangles),w("renderer.info.render.points").set(l.info.render.points)}function f(){}function m(){}function u(b){w=b}return{update:v,start:f,end:m,attach:u,values:A,groups:E,fractions:d}},window.BrowserStats=function(){var l=null,w=0,A=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var E={memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},d=[{caption:"Browser",values:["memory","total"]}],v=[{base:"total",steps:["memory"]}],f=Math.log(1024);function m(x){var L=100,T=Math.floor(Math.log(x)/f);return Math.round(x*L/Math.pow(1024,T))/L}function u(){w=m(performance.memory.usedJSHeapSize),A=m(performance.memory.totalJSHeapSize),l("memory").set(w),l("total").set(A)}function b(){w=0}function g(){}function y(x){l=x}return{update:u,start:b,end:g,attach:y,values:E,groups:d,fractions:v}},typeof N=="object"&&(N.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats})},{}],217:[function(M,N,$){(function(){"performance"in window||(window.performance={});var l=window.performance;if(!("now"in l)){var w=Date.now();l.timing&&l.timing.navigationStart&&(w=l.timing.navigationStart),l.now=function(){return Date.now()-w}}l.mark||(l.mark=function(){}),l.measure||(l.measure=function(){})})(),window.rStats=function(w){function A(Y,ee){for(var J=Object.keys(Y),ce=0,j=J.length;ce<j;ce++)ee(J[ce])}function E(Y){var ee=document.createElement("link");ee.href=Y,ee.rel="stylesheet",ee.type="text/css",document.getElementsByTagName("head")[0].appendChild(ee)}var d=w||{},v=d.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],f="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",m=(d.CSSPath?d.CSSPath:"")+"rStats.css",u=d.css||[f,m];u.forEach(function(Y){E(Y)}),d.values||(d.values={});var b,g,y=10,x=200,L={};function T(Y,ee,J){var ce=J||{},j=document.createElement("canvas"),oe=j.getContext("2d"),Z=0,ye=0,Ne=ce.color?ce.color:"#666666",je=document.createElement("canvas"),ke=je.getContext("2d");je.width=1,je.height=2*y,ke.fillStyle="#444444",ke.fillRect(0,0,1,2*y),ke.fillStyle=Ne,ke.fillRect(0,y,1,y),ke.fillStyle="#ffffff",ke.globalAlpha=.5,ke.fillRect(0,y,1,1),ke.globalAlpha=1;var it=document.createElement("canvas"),rt=it.getContext("2d");it.width=1,it.height=2*y,rt.fillStyle="#444444",rt.fillRect(0,0,1,2*y),rt.fillStyle="#b70000",rt.fillRect(0,y,1,y),rt.globalAlpha=.5,rt.fillStyle="#ffffff",rt.fillRect(0,y,1,1),rt.globalAlpha=1;function Mt(){j.width=x,j.height=y,j.style.width=j.width+"px",j.style.height=j.height+"px",j.className="rs-canvas",Y.appendChild(j),oe.fillStyle="#444444",oe.fillRect(0,0,j.width,j.height)}function Rt(Wt,nr){ye+=(Wt-ye)*.1,Z*=.99,ye>Z&&(Z=ye),oe.drawImage(j,1,0,j.width-1,j.height,0,0,j.width-1,j.height),nr?oe.drawImage(it,j.width-1,j.height-ye*j.height/Z-y):oe.drawImage(je,j.width-1,j.height-ye*j.height/Z-y)}return Mt(),{draw:Rt}}function R(Y,ee){var J=document.createElement("canvas"),ce=J.getContext("2d");function j(){J.width=x,J.height=y*ee,J.style.width=J.width+"px",J.style.height=J.height+"px",J.className="rs-canvas",Y.appendChild(J),ce.fillStyle="#444444",ce.fillRect(0,0,J.width,J.height)}function oe(Z){ce.drawImage(J,1,0,J.width-1,J.height,0,0,J.width-1,J.height);var ye=0;A(Z,function(Ne){var je=Z[Ne]*J.height;ce.fillStyle=v[Ne],ce.fillRect(J.width-1,ye,1,je),ye+=je})}return j(),{draw:oe}}function O(Y,ee){var J=Y,ce,j=0,oe=0,Z=0,ye=0,Ne=performance.now(),je=0,ke=document.createElement("div"),it=document.createElement("span"),rt=document.createElement("div"),Mt=document.createTextNode(""),Rt=d?d.values[J.toLowerCase()]:null,Wt=new T(ke,J,Rt),nr=!1;it.className="rs-counter-id",it.textContent=Rt&&Rt.caption?Rt.caption:J,rt.className="rs-counter-value",rt.appendChild(Mt),ke.appendChild(it),ke.appendChild(rt),ee?ee.div.appendChild(ke):g.appendChild(ke),ce=performance.now();function Dr(ge){if(Rt&&Rt.average){ye+=ge,je++;var ve=performance.now();ve-Ne>=(Rt.avgMs||1e3)&&(Z=ye/je,ye=0,Ne=ve,je=0)}}function wt(){ce=performance.now(),d.userTimingAPI&&performance.mark(J+"-start"),nr=!0}function yr(){j=performance.now()-ce,d.userTimingAPI&&(performance.mark(J+"-end"),nr&&performance.measure(J,J+"-start",J+"-end")),Dr(j)}function ln(){yr(),wt()}function kt(){var ge=Rt&&Rt.average?Z:j;Mt.nodeValue=Math.round(ge*100)/100;var ve=Rt&&(Rt.below&&j<Rt.below||Rt.over&&j>Rt.over);Wt.draw(j,ve),ke.className=ve?"rs-counter-base alarm":"rs-counter-base"}function ie(){var ge=performance.now(),ve=ge-ce;oe++,ve>1e3&&(Rt&&Rt.interpolate===!1?j=oe:j=oe*1e3/ve,oe=0,ce=ge,Dr(j))}function ae(ge){j=ge,Dr(j)}return{set:ae,start:wt,tick:ln,end:yr,frame:ie,value:function(){return j},draw:kt}}function F(Y){var ee=Y.toLowerCase();if(ee===void 0&&(ee="default"),L[ee])return L[ee];var J=null;d&&d.groups&&A(d.groups,function(j){var oe=d.groups[parseInt(j,10)];!J&&oe.values.indexOf(ee.toLowerCase())!==-1&&(J=oe)});var ce=new O(ee,J);return L[ee]=ce,ce}function z(){if(d.plugins){d.values||(d.values={}),d.groups||(d.groups=[]),d.fractions||(d.fractions=[]);for(var Y=0;Y<d.plugins.length;Y++)d.plugins[Y].attach(F),A(d.plugins[Y].values,function(ee){d.values[ee]=d.plugins[Y].values[ee]}),d.groups=d.groups.concat(d.plugins[Y].groups),d.fractions=d.fractions.concat(d.plugins[Y].fractions)}else d.plugins={};b=document.createElement("div"),b.className="rs-base",g=document.createElement("div"),g.className="rs-container",g.style.height="auto",b.appendChild(g),document.body.appendChild(b),d&&(d.groups&&A(d.groups,function(ee){var J=d.groups[parseInt(ee,10)],ce=document.createElement("div");ce.className="rs-group",J.div=ce;var j=document.createElement("h1");j.textContent=J.caption,j.addEventListener("click",(function(oe){this.classList.toggle("hidden"),oe.preventDefault()}).bind(ce)),g.appendChild(j),g.appendChild(ce)}),d.fractions&&A(d.fractions,function(ee){var J=d.fractions[parseInt(ee,10)],ce=document.createElement("div");ce.className="rs-fraction";var j=document.createElement("div");j.className="rs-legend";var oe=0;A(d.fractions[ee].steps,function(ye){var Ne=document.createElement("p");Ne.textContent=d.fractions[ee].steps[ye],Ne.style.color=v[oe],j.appendChild(Ne),oe++}),ce.appendChild(j),ce.style.height=oe*y+"px",J.div=ce;var Z=new R(ce,oe);J.graph=Z,g.appendChild(ce)}))}function re(){A(d.plugins,function(Y){d.plugins[Y].update()}),A(L,function(Y){L[Y].draw()}),d&&d.fractions&&A(d.fractions,function(Y){var ee=d.fractions[parseInt(Y,10)],J=[],ce=L[ee.base.toLowerCase()];ce&&(ce=ce.value(),A(d.fractions[Y].steps,function(j){var oe=d.fractions[Y].steps[parseInt(j,10)].toLowerCase(),Z=L[oe];Z&&J.push(Z.value()/ce)})),ee.graph.draw(J)})}return z(),function(Y){return Y?F(Y):{element:b,update:re}}},typeof N=="object"&&(N.exports=window.rStats)},{}],218:[function(M,N,$){String.prototype.startsWith||(String.prototype.startsWith=function(l,w){return w=w||0,this.substr(w,l.length)===l})},{}],219:[function(M,N,$){var l={};l.base64=function(w,A){return"data:"+w+";base64,"+A},l.isMobile=function(){var w=!1;return function(A){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(A)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(A.substr(0,4)))&&(w=!0)}(navigator.userAgent||navigator.vendor||window.opera),w},l.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},l.isIFrame=function(){try{return window.self!==window.top}catch{return!0}},l.appendQueryParameter=function(w,A,E){var d=w.indexOf("?")<0?"?":"&";return w+=d+A+"="+E,w},l.getQueryParameter=function(w){w=w.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var A=new RegExp("[\\?&]"+w+"=([^&#]*)"),E=A.exec(location.search);return E===null?"":decodeURIComponent(E[1].replace(/\+/g," "))},l.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90},N.exports=l},{}],220:[function(M,N,$){var l=M("./util.js");function w(){var d=document.createElement("video");d.addEventListener("ended",function(){d.play()}),this.request=function(){d.paused&&(d.src=l.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),d.play())},this.release=function(){d.pause(),d.src=""}}function A(){var d=null;this.request=function(){d||(d=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){d&&(clearInterval(d),d=null)}}function E(){var d=navigator.userAgent||navigator.vendor||window.opera;return d.match(/iPhone/i)||d.match(/iPod/i)?A:w}N.exports=E()},{"./util.js":219}]},{},[177])(177)})})(ap);var op=ap.exports;const Ab=ip(op),bb=np({__proto__:null,default:Ab},[op]),Ch={once:THREE.LoopOnce,repeat:THREE.LoopRepeat,pingpong:THREE.LoopPingPong};var sp=AFRAME.registerComponent("animation-mixer",{schema:{clip:{default:"*"},useRegExp:{default:!1},duration:{default:0},clampWhenFinished:{default:!1,type:"boolean"},crossFadeDuration:{default:0},loop:{default:"repeat",oneOf:Object.keys(Ch)},repetitions:{default:1/0,min:0},timeScale:{default:1},startAt:{default:0}},init:function(){this.model=null,this.mixer=null,this.activeActions=[];const yt=this.el.getObject3D("mesh");yt?this.load(yt):this.el.addEventListener("model-loaded",ht=>{this.load(ht.detail.model)})},load:function(yt){const ht=this.el;this.model=yt,this.mixer=new THREE.AnimationMixer(yt),this.mixer.addEventListener("loop",M=>{ht.emit("animation-loop",{action:M.action,loopDelta:M.loopDelta})}),this.mixer.addEventListener("finished",M=>{ht.emit("animation-finished",{action:M.action,direction:M.direction})}),this.data.clip&&this.update({})},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(yt){if(!yt)return;const ht=this.data,M=AFRAME.utils.diff(ht,yt);if("clip"in M){this.stopAction(),ht.clip&&this.playAction();return}this.activeActions.forEach(N=>{"duration"in M&&ht.duration&&N.setDuration(ht.duration),"clampWhenFinished"in M&&(N.clampWhenFinished=ht.clampWhenFinished),("loop"in M||"repetitions"in M)&&N.setLoop(Ch[ht.loop],ht.repetitions),"timeScale"in M&&N.setEffectiveTimeScale(ht.timeScale)})},stopAction:function(){const yt=this.data;for(let ht=0;ht<this.activeActions.length;ht++)yt.crossFadeDuration?this.activeActions[ht].fadeOut(yt.crossFadeDuration):this.activeActions[ht].stop();this.activeActions.length=0},playAction:function(){if(!this.mixer)return;const yt=this.model,ht=this.data,M=yt.animations||(yt.geometry||{}).animations||[];if(!M.length)return;const N=ht.useRegExp?ht.clip:Eb(ht.clip);for(let $,l=0;$=M[l];l++)if($.name.match(N)){const w=this.mixer.clipAction($,yt);w.enabled=!0,w.clampWhenFinished=ht.clampWhenFinished,ht.duration&&w.setDuration(ht.duration),ht.timeScale!==1&&w.setEffectiveTimeScale(ht.timeScale),w.startAt(this.mixer.time-ht.startAt/1e3),w.setLoop(Ch[ht.loop],ht.repetitions).fadeIn(ht.crossFadeDuration).play(),this.activeActions.push(w)}},tick:function(yt,ht){this.mixer&&!isNaN(ht)&&this.mixer.update(ht/1e3)}});function Eb(yt){return new RegExp("^"+yt.split(/\*+/).map(wb).join(".*")+"$")}function wb(yt){return yt.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}const xb=ip(sp),Mb=np({__proto__:null,default:xb},[sp]),Tb={class:"flex"},Sb={class:"flex h-full w-full flex-col"},_b={class:"box-border flex h-16 w-full items-center justify-between px-6 py-4"},Cb={class:"flex items-center justify-center gap-x-4"},Lb={class:"h-[calc(100%-4rem)] w-full"},jb=Dn({__name:"dashboard",setup(yt){tp(()=>{console.log(bb),console.log(Mb)});const ht=$f(),{navState:M}=Cl(ht);return(N,$)=>{const l=lb,w=hb,A=CA,E=yb;return fr(),ki("main",Tb,[Tr(l,{collapsed:dt(M).collapsed,"onUpdate:collapsed":$[0]||($[0]=d=>dt(M).collapsed=d),open:dt(M).open,"onUpdate:open":$[1]||($[1]=d=>dt(M).open=d)},null,8,["collapsed","open"]),Fn("main",{class:ca(["mt-16 flex h-screen w-full transition-[margin] md:mt-0",dt(M).collapsed?"md:ml-[3.7rem]":"md:ml-[15.15rem]"])},[Fn("div",Sb,[Fn("section",_b,[$[2]||($[2]=Fn("div",null,null,-1)),Fn("div",Cb,[Tr(w),Tr(A),Tr(E)])]),Fn("section",Lb,[qn(N.$slots,"default")])])],2)])}}});export{jb as default};
